<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Linear Regression | Statistics for Soil Survey - Part 2</title>
  <meta name="description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Linear Regression | Statistics for Soil Survey - Part 2" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Linear Regression | Statistics for Soil Survey - Part 2" />
  
  <meta name="twitter:description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  

<meta name="author" content="Soil Survey Staff" />


<meta name="date" content="2021-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ordination.html"/>
<link rel="next" href="acc-unc-categorical-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../book/index.html">Statistics for Soil Survey - Part 1</a></li>
<li><a href="index.html">Statistics for Soil Survey - Part 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Pre-course Assignment</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i><b>0.1</b> Setup</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#create-workspace"><i class="fa fa-check"></i><b>0.1.1</b> Create Workspace</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#configure-rstudio"><i class="fa fa-check"></i><b>0.1.2</b> Configure RStudio</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#install-.rprofile"><i class="fa fa-check"></i><b>0.1.3</b> Install .RProfile</a></li>
<li class="chapter" data-level="0.1.4" data-path="index.html"><a href="index.html#install-required-packages"><i class="fa fa-check"></i><b>0.1.4</b> Install Required Packages</a></li>
<li class="chapter" data-level="0.1.5" data-path="index.html"><a href="index.html#common-errors"><i class="fa fa-check"></i><b>0.1.5</b> Common Errors</a></li>
<li class="chapter" data-level="0.1.6" data-path="index.html"><a href="index.html#packages-not-on-cran"><i class="fa fa-check"></i><b>0.1.6</b> Packages not on CRAN</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#connect-to-local-nasis"><i class="fa fa-check"></i><b>0.2</b> Connect to Local NASIS</a><ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#demonstrate-a-working-connection"><i class="fa fa-check"></i><b>0.2.1</b> Demonstrate a Working Connection</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#additional-supportoptional-readings"><i class="fa fa-check"></i><b>0.3</b> Additional Support/Optional Readings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>2</b> Uncertainty</a><ul>
<li class="chapter" data-level="2.1" data-path="uncertainty.html"><a href="uncertainty.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---dispersion"><i class="fa fa-check"></i><b>2.1.1</b> Exercise - Dispersion</a></li>
<li class="chapter" data-level="2.1.2" data-path="uncertainty.html"><a href="uncertainty.html#exercise---variation-and-certainty"><i class="fa fa-check"></i><b>2.1.2</b> Exercise - Variation and Certainty</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="uncertainty.html"><a href="uncertainty.html#theory-of-uncertainty"><i class="fa fa-check"></i><b>2.2</b> Theory of Uncertainty</a></li>
<li class="chapter" data-level="2.3" data-path="uncertainty.html"><a href="uncertainty.html#resampling-to-estimate-uncertainty"><i class="fa fa-check"></i><b>2.3</b> Resampling to Estimate Uncertainty</a><ul>
<li class="chapter" data-level="2.3.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---resampling"><i class="fa fa-check"></i><b>2.3.1</b> Exercise - Resampling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="uncertainty.html"><a href="uncertainty.html#performance-metrics"><i class="fa fa-check"></i><b>2.4</b> Performance Metrics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---numeric-metrics"><i class="fa fa-check"></i><b>2.4.1</b> Exercise - Numeric Metrics</a></li>
<li class="chapter" data-level="2.4.2" data-path="uncertainty.html"><a href="uncertainty.html#exercise---categorical-metrics"><i class="fa fa-check"></i><b>2.4.2</b> Exercise - Categorical Metrics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="uncertainty.html"><a href="uncertainty.html#validation"><i class="fa fa-check"></i><b>2.5</b> Validation</a></li>
<li class="chapter" data-level="2.6" data-path="uncertainty.html"><a href="uncertainty.html#apparent-validation"><i class="fa fa-check"></i><b>2.6</b> Apparent Validation</a></li>
<li class="chapter" data-level="2.7" data-path="uncertainty.html"><a href="uncertainty.html#inherent-validation"><i class="fa fa-check"></i><b>2.7</b> Inherent Validation</a><ul>
<li class="chapter" data-level="2.7.1" data-path="uncertainty.html"><a href="uncertainty.html#split-sample---a-single-partition-of-the-data-into-a-learning-and-a-calibration-set."><i class="fa fa-check"></i><b>2.7.1</b> Split-sample - A single partition of the data into a learning and a calibration set.</a></li>
<li class="chapter" data-level="2.7.2" data-path="uncertainty.html"><a href="uncertainty.html#cross-validation---alternate-development-and-validation"><i class="fa fa-check"></i><b>2.7.2</b> Cross-validation - Alternate development and validation</a></li>
<li class="chapter" data-level="2.7.3" data-path="uncertainty.html"><a href="uncertainty.html#subsample-resampling-or-sample-simulation"><i class="fa fa-check"></i><b>2.7.3</b> Subsample (Resampling or sample simulation)</a></li>
<li class="chapter" data-level="2.7.4" data-path="uncertainty.html"><a href="uncertainty.html#external-validation"><i class="fa fa-check"></i><b>2.7.4</b> External Validation</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="uncertainty.html"><a href="uncertainty.html#additional-reading"><i class="fa fa-check"></i><b>2.8</b> Additional reading</a></li>
<li class="chapter" data-level="2.9" data-path="uncertainty.html"><a href="uncertainty.html#references-uncertainty"><i class="fa fa-check"></i><b>2.9</b> References (Uncertainty)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ordination.html"><a href="ordination.html"><i class="fa fa-check"></i><b>3</b> Numerical Taxonomy and Ordination</a><ul>
<li class="chapter" data-level="3.1" data-path="ordination.html"><a href="ordination.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ordination.html"><a href="ordination.html#objectives"><i class="fa fa-check"></i><b>3.1.1</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ordination.html"><a href="ordination.html#whirlwind-tour"><i class="fa fa-check"></i><b>3.2</b> Whirlwind Tour</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ordination.html"><a href="ordination.html#similarity-disimilarty-and-distance"><i class="fa fa-check"></i><b>3.2.1</b> Similarity, Disimilarty, and Distance</a></li>
<li class="chapter" data-level="3.2.2" data-path="ordination.html"><a href="ordination.html#standardization-of-characteristics"><i class="fa fa-check"></i><b>3.2.2</b> Standardization of Characteristics</a></li>
<li class="chapter" data-level="3.2.3" data-path="ordination.html"><a href="ordination.html#missing-data"><i class="fa fa-check"></i><b>3.2.3</b> Missing Data</a></li>
<li class="chapter" data-level="3.2.4" data-path="ordination.html"><a href="ordination.html#visualizing-pair-wise-distances-the-dendrogram"><i class="fa fa-check"></i><b>3.2.4</b> Visualizing Pair-Wise Distances: The Dendrogram</a></li>
<li class="chapter" data-level="3.2.5" data-path="ordination.html"><a href="ordination.html#re-arranging-a-dendrogram-for-clarity"><i class="fa fa-check"></i><b>3.2.5</b> Re-arranging a Dendrogram for Clarity</a></li>
<li class="chapter" data-level="3.2.6" data-path="ordination.html"><a href="ordination.html#cluster-analysis-finding-groups-in-data"><i class="fa fa-check"></i><b>3.2.6</b> Cluster Analysis: Finding Groups in Data</a></li>
<li class="chapter" data-level="3.2.7" data-path="ordination.html"><a href="ordination.html#ordination-visualization-in-a-reduced-space"><i class="fa fa-check"></i><b>3.2.7</b> Ordination: Visualization in a Reduced Space</a></li>
<li class="chapter" data-level="3.2.8" data-path="ordination.html"><a href="ordination.html#review-and-discuss-4"><i class="fa fa-check"></i><b>3.2.8</b> Review and Discuss</a></li>
<li class="chapter" data-level="3.2.9" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-soil-profiles"><i class="fa fa-check"></i><b>3.2.9</b> Pair-Wise Distances Between Soil Profiles</a></li>
<li class="chapter" data-level="3.2.10" data-path="ordination.html"><a href="ordination.html#final-discussion"><i class="fa fa-check"></i><b>3.2.10</b> Final Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ordination.html"><a href="ordination.html#excercises"><i class="fa fa-check"></i><b>3.3</b> Excercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ordination.html"><a href="ordination.html#set-up-the-r-session"><i class="fa fa-check"></i><b>3.3.1</b> Set Up the R Session</a></li>
<li class="chapter" data-level="3.3.2" data-path="ordination.html"><a href="ordination.html#evaluating-missing-data"><i class="fa fa-check"></i><b>3.3.2</b> Evaluating Missing Data</a></li>
<li class="chapter" data-level="3.3.3" data-path="ordination.html"><a href="ordination.html#more-on-the-distance-matrix-and-how-to-make-one"><i class="fa fa-check"></i><b>3.3.3</b> More on the Distance Matrix and How to Make One</a></li>
<li class="chapter" data-level="3.3.4" data-path="ordination.html"><a href="ordination.html#hierachrical-clustering"><i class="fa fa-check"></i><b>3.3.4</b> Hierachrical Clustering</a></li>
<li class="chapter" data-level="3.3.5" data-path="ordination.html"><a href="ordination.html#centroid-and-medoid-partitioning-clustering-1"><i class="fa fa-check"></i><b>3.3.5</b> Centroid and Medoid (Partitioning) Clustering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ordination.html"><a href="ordination.html#practical-applications"><i class="fa fa-check"></i><b>3.4</b> Practical Applications</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-soil-profiles-1"><i class="fa fa-check"></i><b>3.4.1</b> Pair-Wise Distances Between Soil Profiles</a></li>
<li class="chapter" data-level="3.4.2" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-soil-series"><i class="fa fa-check"></i><b>3.4.2</b> Pair-Wise Distances Between Soil Series</a></li>
<li class="chapter" data-level="3.4.3" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-subgroup-level-taxa"><i class="fa fa-check"></i><b>3.4.3</b> Pair-Wise Distances Between Subgroup-Level Taxa</a></li>
<li class="chapter" data-level="3.4.4" data-path="ordination.html"><a href="ordination.html#soil-color-signatures"><i class="fa fa-check"></i><b>3.4.4</b> Soil Color Signatures</a></li>
<li class="chapter" data-level="3.4.5" data-path="ordination.html"><a href="ordination.html#clustering-of-soil-colors"><i class="fa fa-check"></i><b>3.4.5</b> Clustering of Soil Colors</a></li>
<li class="chapter" data-level="3.4.6" data-path="ordination.html"><a href="ordination.html#how-do-the-interpretations-compare"><i class="fa fa-check"></i><b>3.4.6</b> “How Do the Interpretations Compare?”</a></li>
<li class="chapter" data-level="3.4.7" data-path="ordination.html"><a href="ordination.html#mlra-concepts-via-climate-and-elevation-samples"><i class="fa fa-check"></i><b>3.4.7</b> MLRA Concepts via Climate and Elevation Samples</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ordination.html"><a href="ordination.html#references-numerical-taxonomy-and-ordination"><i class="fa fa-check"></i><b>3.5</b> References (Numerical Taxonomy and Ordination)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-example"><i class="fa fa-check"></i><b>4.2</b> Linear Regression Example</a></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-regression.html"><a href="linear-regression.html#tidy-raw-files"><i class="fa fa-check"></i><b>4.3.1</b> Tidy Raw Files</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-regression.html"><a href="linear-regression.html#henry-mount-database"><i class="fa fa-check"></i><b>4.3.2</b> Henry Mount Database</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-regression.html"><a href="linear-regression.html#aggregate-time-series"><i class="fa fa-check"></i><b>4.3.3</b> Aggregate Time Series</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-regression.html"><a href="linear-regression.html#final-dataset"><i class="fa fa-check"></i><b>4.3.4</b> Final Dataset</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression.html"><a href="linear-regression.html#spatial-data"><i class="fa fa-check"></i><b>4.4</b> Spatial data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-regression.html"><a href="linear-regression.html#plot-coordinates"><i class="fa fa-check"></i><b>4.4.1</b> Plot Coordinates</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-regression.html"><a href="linear-regression.html#extracting-spatial-data"><i class="fa fa-check"></i><b>4.4.2</b> Extracting Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-regression.html"><a href="linear-regression.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>4.5</b> Exploratory Data Analysis (EDA)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="linear-regression.html"><a href="linear-regression.html#compare-samples-vs-population"><i class="fa fa-check"></i><b>4.5.1</b> Compare Samples vs Population</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="linear-regression.html"><a href="linear-regression.html#linear-modeling"><i class="fa fa-check"></i><b>4.6</b> Linear modeling</a><ul>
<li class="chapter" data-level="4.6.1" data-path="linear-regression.html"><a href="linear-regression.html#diagnostics"><i class="fa fa-check"></i><b>4.6.1</b> Diagnostics</a></li>
<li class="chapter" data-level="4.6.2" data-path="linear-regression.html"><a href="linear-regression.html#variable-selection-model-validation"><i class="fa fa-check"></i><b>4.6.2</b> Variable selection &amp; model validation</a></li>
<li class="chapter" data-level="4.6.3" data-path="linear-regression.html"><a href="linear-regression.html#final-model-accuracy-assessment"><i class="fa fa-check"></i><b>4.6.3</b> Final model &amp; accuracy assessment</a></li>
<li class="chapter" data-level="4.6.4" data-path="linear-regression.html"><a href="linear-regression.html#model-effects"><i class="fa fa-check"></i><b>4.6.4</b> Model Effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="linear-regression.html"><a href="linear-regression.html#generate-spatial-predictions"><i class="fa fa-check"></i><b>4.7</b> Generate spatial predictions</a></li>
<li class="chapter" data-level="4.8" data-path="linear-regression.html"><a href="linear-regression.html#create-map"><i class="fa fa-check"></i><b>4.8</b> Create Map</a></li>
<li class="chapter" data-level="4.9" data-path="linear-regression.html"><a href="linear-regression.html#literature"><i class="fa fa-check"></i><b>4.9</b> Literature</a></li>
<li class="chapter" data-level="4.10" data-path="linear-regression.html"><a href="linear-regression.html#additional-reading-1"><i class="fa fa-check"></i><b>4.10</b> Additional reading</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html"><i class="fa fa-check"></i><b>A</b> Accuracy and Uncertainty for Categorical Predictions</a><ul>
<li class="chapter" data-level="A.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#status-quo"><i class="fa fa-check"></i><b>A.1</b> Status Quo</a></li>
<li class="chapter" data-level="A.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#theses"><i class="fa fa-check"></i><b>A.2</b> Theses</a></li>
<li class="chapter" data-level="A.3" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#soap-box-time"><i class="fa fa-check"></i><b>A.3</b> Soap Box Time</a></li>
<li class="chapter" data-level="A.4" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#concept-demonstration-via-simulated-data"><i class="fa fa-check"></i><b>A.4</b> Concept Demonstration via Simulated Data</a></li>
<li class="chapter" data-level="A.5" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#accuracy"><i class="fa fa-check"></i><b>A.5</b> Accuracy</a><ul>
<li class="chapter" data-level="A.5.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#confusion-matrix-area-under-roc"><i class="fa fa-check"></i><b>A.5.1</b> Confusion Matrix / Area Under ROC</a></li>
<li class="chapter" data-level="A.5.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#brier-scores"><i class="fa fa-check"></i><b>A.5.2</b> Brier Scores</a></li>
<li class="chapter" data-level="A.5.3" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#tau-and-weighted-tau-class-similarity"><i class="fa fa-check"></i><b>A.5.3</b> Tau and Weighted Tau (class-similarity)</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#uncertainty-1"><i class="fa fa-check"></i><b>A.6</b> Uncertainty</a><ul>
<li class="chapter" data-level="A.6.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#shanon-entropy"><i class="fa fa-check"></i><b>A.6.1</b> Shanon Entropy</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#review"><i class="fa fa-check"></i><b>A.7</b> Review</a></li>
<li class="chapter" data-level="A.8" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#example-implementation"><i class="fa fa-check"></i><b>A.8</b> Example Implementation</a></li>
<li class="chapter" data-level="A.9" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#resources"><i class="fa fa-check"></i><b>A.9</b> Resources</a><ul>
<li class="chapter" data-level="A.9.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#evaluating-accuracy-of-categorical-probabilistic-predictions"><i class="fa fa-check"></i><b>A.9.1</b> Evaluating Accuracy of Categorical / Probabilistic Predictions</a></li>
<li class="chapter" data-level="A.9.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#sampling-and-stability-of-estimates"><i class="fa fa-check"></i><b>A.9.2</b> Sampling and Stability of Estimates</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#references-appdx"><i class="fa fa-check"></i><b>A.10</b> References (Appdx)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Soil Survey - Part 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Linear Regression</h1>
<div class="figure">
<img src="figure/logo.jpg" alt="" />
<p class="caption">Statistics for pedologists course banner image</p>
</div>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>Linear regression models the linear relationship between a response variable (y) and an predictor variable (x).</p>
<p><span class="math inline">\(y = a + Bx + e\)</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(y\)</span> = the dependent variable</p>
<ul>
<li><p><span class="math inline">\(a\)</span> = the intercept of the fitted line</p></li>
<li><p><span class="math inline">\(B\)</span> = the Regression coefficient, i.e. slope of the fitted line. Strong relationships will have high values.</p></li>
<li><p><span class="math inline">\(x\)</span> = the independent variable (aka explanatory or predictor variable(s) )</p></li>
<li><p><span class="math inline">\(e\)</span> = the error term</p></li>
</ul></li>
</ul>
<p>Linear regression has been used for soil survey applications since the early 1900s when Briggs and McLane (1907) developed a pedotransfer function to estimate the wilting coefficient as a function of soil particle size.</p>
<p>Wilting coefficient = 0.01(sand) + 0.12(silt) + 0.57(clay)</p>
<p>When more than one independent variable is used in the regression, it is referred to as multiple linear regression. In regression models, the response (or dependent) variable must always be continuous. The predictor (or independent) variable(s) can be continuous or categorical. In order to use linear regression or any linear model, the errors (i.e. residuals) must be normally distributed. Most environmental data are skewed and require transformations to the response variable (such as square root or log) for use in linear models. Normality can be assessed using a QQ plot or histogram of the residuals.</p>
</div>
<div id="linear-regression-example" class="section level2">
<h2><span class="header-section-number">4.2</span> Linear Regression Example</h2>
<p>Now that we’ve got some of the basic theory out of the way we’ll move on to a real example, and address any additional theory where it relates to specific steps in the modeling process. The example selected for this chapter comes from the Mojave desert. The landscape is composed primarily of closed basins ringed by granitic hills and mountains (Peterson, 1981). The problem tackled here is modeling mean annual air temperature as a function of PRISM, digital elevation model (DEM) and Landsat derivatives.</p>
<p>This climate study began in 1998 as part of a national study run by the National Lab and led by Henry Mount (Mount and Paetzold, 2002). The objective was to determine if the hyperthermic line was consistent across the southern US, which at the time was thought to be ~3000 in elevation. Up until 2015 their were 77 active MAST sites, and 12 SCAN sites throughout MLRA 30 and 31.</p>
<p>For more details see the “MLRA 30 - Soil Climate Study - Soil Temperature” project in NASIS, on <a href="https://github.com/smroecker/mast-mojave">GitHub</a>, or by <a href="https://www.researchgate.net/publication/331977150_Modeling_and_Application_of_Soil_Temperature_in_the_Mojave_and_Lower_Colorado_Deserts_of_California/citations">Roecker et al., 2012</a>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb79-1"><a href="linear-regression.html#cb79-1"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb79-2"><a href="linear-regression.html#cb79-2"></a></span>
<span id="cb79-3"><a href="linear-regression.html#cb79-3"></a>prj &lt;-<span class="st"> </span><span class="kw">get_project_from_NASISWebReport</span>(<span class="dt">mlrassoarea =</span> <span class="st">&quot;8-VIC&quot;</span>, <span class="dt">fiscalyear =</span> <span class="dv">2015</span>)</span>
<span id="cb79-4"><a href="linear-regression.html#cb79-4"></a><span class="kw">subset</span>(prj, projectname <span class="op">==</span><span class="st"> &quot;MLRA 30 - Soil Climate Study - Soil Temperature&quot;</span>)</span></code></pre></div>
<p>In addition to the 11-IND MAST modeling efforts there has also been two published studies on the Mojave. The first was by Schmidlin et al. (1983) who examined both the Great Basin and Mojave Deserts in Nevada. The second was by Bai et al. (2010) who examined the Mojave Desert in California. Both studies developed regression models using elevation, but Schmidlin et al. (1983) also incorporated latitude. The results from Bai et al. (2010) displayed considerably larger areas of hyperthermic soils than Schmidlin et al. (1983). This made be due to the unconventional method used by Bai et al. (2010) to measure MAST.</p>
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">4.3</span> Data</h2>
<div id="tidy-raw-files" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Tidy Raw Files</h3>
<p>Typically the data for MAST and other monitoring projets is downloaded annually. However, some sites now are online and can be accessed remotely. Eitherway prior to loading the information into a proper database it is best to store the data in txt files (Excel files are discouraged). If the data is organized and the filenames encode the metadata, an example such as the one below can be used to efficiently import them into R and combine them into a data frame.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb80-1"><a href="linear-regression.html#cb80-1"></a>p &lt;-<span class="st"> &quot;D:/projects/soilTemperatureMonitoring/data/rawTxtFilesClean&quot;</span></span>
<span id="cb80-2"><a href="linear-regression.html#cb80-2"></a><span class="kw">setwd</span>(p)</span>
<span id="cb80-3"><a href="linear-regression.html#cb80-3"></a></span>
<span id="cb80-4"><a href="linear-regression.html#cb80-4"></a><span class="co"># get file names of HOBO temp data</span></span>
<span id="cb80-5"><a href="linear-regression.html#cb80-5"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>()</span>
<span id="cb80-6"><a href="linear-regression.html#cb80-6"></a></span>
<span id="cb80-7"><a href="linear-regression.html#cb80-7"></a><span class="co"># read files</span></span>
<span id="cb80-8"><a href="linear-regression.html#cb80-8"></a>l &lt;-<span class="st"> </span><span class="kw">lapply</span>(files, <span class="cf">function</span>(x) {</span>
<span id="cb80-9"><a href="linear-regression.html#cb80-9"></a></span>
<span id="cb80-10"><a href="linear-regression.html#cb80-10"></a>  <span class="co"># extract the file name</span></span>
<span id="cb80-11"><a href="linear-regression.html#cb80-11"></a>  fileName =<span class="st"> </span><span class="kw">strsplit</span>(x, <span class="st">&#39;[.]&#39;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb80-12"><a href="linear-regression.html#cb80-12"></a>  <span class="co"># parse the siteid from the file name</span></span>
<span id="cb80-13"><a href="linear-regression.html#cb80-13"></a>  siteid   =<span class="st"> </span><span class="kw">strsplit</span>(x, <span class="st">&#39;_&#39;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb80-14"><a href="linear-regression.html#cb80-14"></a></span>
<span id="cb80-15"><a href="linear-regression.html#cb80-15"></a>  <span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;working on&quot;</span>, fileName, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>))</span>
<span id="cb80-16"><a href="linear-regression.html#cb80-16"></a>  f =<span class="st"> </span><span class="kw">paste0</span>(p, <span class="st">&quot;/&quot;</span>, x)</span>
<span id="cb80-17"><a href="linear-regression.html#cb80-17"></a>  <span class="co"># read the files</span></span>
<span id="cb80-18"><a href="linear-regression.html#cb80-18"></a>  f =<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> f, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb80-19"><a href="linear-regression.html#cb80-19"></a>  f<span class="op">$</span>siteid &lt;-<span class="st"> </span>siteid</span>
<span id="cb80-20"><a href="linear-regression.html#cb80-20"></a>  <span class="kw">names</span>(f)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;tempF&quot;</span>,<span class="st">&quot;tempC&quot;</span>)</span>
<span id="cb80-21"><a href="linear-regression.html#cb80-21"></a></span>
<span id="cb80-22"><a href="linear-regression.html#cb80-22"></a>  f<span class="op">$</span>tempF &lt;-<span class="kw">as.numeric</span>(f<span class="op">$</span>tempF)</span>
<span id="cb80-23"><a href="linear-regression.html#cb80-23"></a>  f<span class="op">$</span>tempC &lt;-<span class="kw">as.numeric</span>(f<span class="op">$</span>tempC)</span>
<span id="cb80-24"><a href="linear-regression.html#cb80-24"></a></span>
<span id="cb80-25"><a href="linear-regression.html#cb80-25"></a>  vars =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;siteid&quot;</span>, <span class="st">&quot;tempF&quot;</span>, <span class="st">&quot;tempC&quot;</span>)</span>
<span id="cb80-26"><a href="linear-regression.html#cb80-26"></a>  f    =<span class="st"> </span>f[vars]</span>
<span id="cb80-27"><a href="linear-regression.html#cb80-27"></a>  })</span>
<span id="cb80-28"><a href="linear-regression.html#cb80-28"></a></span>
<span id="cb80-29"><a href="linear-regression.html#cb80-29"></a>mastSeries_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, l)</span>
<span id="cb80-30"><a href="linear-regression.html#cb80-30"></a></span>
<span id="cb80-31"><a href="linear-regression.html#cb80-31"></a></span>
<span id="cb80-32"><a href="linear-regression.html#cb80-32"></a><span class="co"># save cached copy</span></span>
<span id="cb80-33"><a href="linear-regression.html#cb80-33"></a><span class="kw">save</span>(mastSeries_df, <span class="dt">file =</span> <span class="st">&quot;D:/projects/soilTemperatureMonitoring/data/R/mastSeries.Rdata&quot;</span>)</span>
<span id="cb80-34"><a href="linear-regression.html#cb80-34"></a></span>
<span id="cb80-35"><a href="linear-regression.html#cb80-35"></a><span class="kw">length</span>(<span class="kw">unique</span>(mastSeries_df<span class="op">$</span>siteid))</span></code></pre></div>
</div>
<div id="henry-mount-database" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Henry Mount Database</h3>
<p>The Henry Mount Database already has 59 of the sites from the Mojave. The full dataset however has 68 sites.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb81-1"><a href="linear-regression.html#cb81-1"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb81-2"><a href="linear-regression.html#cb81-2"></a></span>
<span id="cb81-3"><a href="linear-regression.html#cb81-3"></a>f &lt;-<span class="st"> </span><span class="kw">fetchHenry</span>(<span class="dt">sso =</span> <span class="st">&quot;8-VIC&quot;</span>)</span>
<span id="cb81-4"><a href="linear-regression.html#cb81-4"></a><span class="kw">length</span>(<span class="kw">unique</span>(f<span class="op">$</span>sensors<span class="op">$</span>user_site_id))</span></code></pre></div>
</div>
<div id="aggregate-time-series" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Aggregate Time Series</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb82-1"><a href="linear-regression.html#cb82-1"></a><span class="co"># load cached versions</span></span>
<span id="cb82-2"><a href="linear-regression.html#cb82-2"></a><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;D:/projects/soilTemperatureMonitoring/data/R/mastSeries.Rdata&quot;</span>)</span>
<span id="cb82-3"><a href="linear-regression.html#cb82-3"></a></span>
<span id="cb82-4"><a href="linear-regression.html#cb82-4"></a></span>
<span id="cb82-5"><a href="linear-regression.html#cb82-5"></a><span class="co"># Plot sites visually inspect for flat lines and spikes</span></span>
<span id="cb82-6"><a href="linear-regression.html#cb82-6"></a>test &lt;-<span class="st"> </span><span class="kw">subset</span>(mastSeries_df, site <span class="op">==</span><span class="st"> &quot;JTNP08&quot;</span>)</span>
<span id="cb82-7"><a href="linear-regression.html#cb82-7"></a>test.zoo &lt;-<span class="st"> </span><span class="kw">read.zoo</span>(test[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)],<span class="dt">format =</span> <span class="st">&quot;%m/%d/%y %H:%M:%S&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;GMT&quot;</span>)</span>
<span id="cb82-8"><a href="linear-regression.html#cb82-8"></a><span class="kw">plot</span>(test.zoo, <span class="dt">ylab =</span> <span class="st">&quot;tempF&quot;</span>)</span>
<span id="cb82-9"><a href="linear-regression.html#cb82-9"></a></span>
<span id="cb82-10"><a href="linear-regression.html#cb82-10"></a></span>
<span id="cb82-11"><a href="linear-regression.html#cb82-11"></a><span class="co"># Aggregate by Year, Month, and Julian day (i.e. 1-365, 366 for leap years)</span></span>
<span id="cb82-12"><a href="linear-regression.html#cb82-12"></a>ms.df &lt;-<span class="st"> </span>mastSeries_df</span>
<span id="cb82-13"><a href="linear-regression.html#cb82-13"></a>ms.df<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(ms.df<span class="op">$</span>date, <span class="dt">format=</span><span class="st">&quot;%m/%d/%y %H:%M:%S&quot;</span>)</span>
<span id="cb82-14"><a href="linear-regression.html#cb82-14"></a>ms.df<span class="op">$</span>day  &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">format</span>(ms.df<span class="op">$</span>date, <span class="st">&quot;%m/%d/%y&quot;</span>))</span>
<span id="cb82-15"><a href="linear-regression.html#cb82-15"></a>ms.df<span class="op">$</span>Jday &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">format</span>(ms.df<span class="op">$</span>date, <span class="st">&quot;%j&quot;</span>))</span>
<span id="cb82-16"><a href="linear-regression.html#cb82-16"></a></span>
<span id="cb82-17"><a href="linear-regression.html#cb82-17"></a><span class="co"># compute number of days per site</span></span>
<span id="cb82-18"><a href="linear-regression.html#cb82-18"></a>ms.D.df &lt;-<span class="st"> </span><span class="kw">aggregate</span>(tempF <span class="op">~</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>day, <span class="dt">data =</span> ms.df, <span class="dt">FUN =</span> mean, <span class="dt">na.action =</span> na.exclude)</span>
<span id="cb82-19"><a href="linear-regression.html#cb82-19"></a>ms.D.df &lt;-<span class="st"> </span><span class="kw">aggregate</span>(day <span class="op">~</span><span class="st"> </span>site, <span class="dt">data =</span> ms.D.df, <span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(x)))</span>
<span id="cb82-20"><a href="linear-regression.html#cb82-20"></a><span class="kw">names</span>(ms.D.df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;siteid&quot;</span>,<span class="st">&quot;numDays&quot;</span>)</span>
<span id="cb82-21"><a href="linear-regression.html#cb82-21"></a></span>
<span id="cb82-22"><a href="linear-regression.html#cb82-22"></a><span class="co"># compute mast per year</span></span>
<span id="cb82-23"><a href="linear-regression.html#cb82-23"></a>ms.Jd.df &lt;-<span class="st"> </span><span class="kw">aggregate</span>(tempF <span class="op">~</span><span class="st"> </span>siteid <span class="op">+</span><span class="st"> </span>Jday, <span class="dt">data =</span> ms.df, mean)</span>
<span id="cb82-24"><a href="linear-regression.html#cb82-24"></a>mastSites.df &lt;-<span class="st"> </span><span class="kw">aggregate</span>(tempF <span class="op">~</span><span class="st"> </span>siteid, <span class="dt">data =</span> ms.Jd.df, mean)</span>
<span id="cb82-25"><a href="linear-regression.html#cb82-25"></a></span>
<span id="cb82-26"><a href="linear-regression.html#cb82-26"></a><span class="co"># merge mast &amp; numDays</span></span>
<span id="cb82-27"><a href="linear-regression.html#cb82-27"></a>mastSites.df &lt;-<span class="st"> </span><span class="kw">merge</span>(mastSites.df, ms.D.df, <span class="dt">by =</span> <span class="st">&quot;siteid&quot;</span>)</span>
<span id="cb82-28"><a href="linear-regression.html#cb82-28"></a><span class="kw">write.csv</span>(mastSites.df, <span class="st">&quot;mastSites.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="final-dataset" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Final Dataset</h3>
<p>Since the Henry Mount database is incomplete we will procede with the aggregation from the txt files.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb83-1"><a href="linear-regression.html#cb83-1"></a><span class="co"># Read tempC data</span></span>
<span id="cb83-2"><a href="linear-regression.html#cb83-2"></a><span class="kw">setwd</span>(<span class="st">&quot;D:/projects/soilTemperatureMonitoring/data/R&quot;</span>)</span>
<span id="cb83-3"><a href="linear-regression.html#cb83-3"></a></span>
<span id="cb83-4"><a href="linear-regression.html#cb83-4"></a>sites_df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;HOBO_List_2013_0923_master.csv&quot;</span>)</span>
<span id="cb83-5"><a href="linear-regression.html#cb83-5"></a>mast_df  &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;mastSites.csv&quot;</span>)</span>
<span id="cb83-6"><a href="linear-regression.html#cb83-6"></a></span>
<span id="cb83-7"><a href="linear-regression.html#cb83-7"></a>mast_df &lt;-<span class="st"> </span><span class="kw">merge</span>(mast_df, sites_df, <span class="dt">by =</span> <span class="st">&quot;siteid&quot;</span>)</span>
<span id="cb83-8"><a href="linear-regression.html#cb83-8"></a>vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;siteid&quot;</span>, <span class="st">&quot;tempF&quot;</span>, <span class="st">&quot;numDays&quot;</span>, <span class="st">&quot;utmeasting&quot;</span>, <span class="st">&quot;utmnorthing&quot;</span>)</span>
<span id="cb83-9"><a href="linear-regression.html#cb83-9"></a>mast_df &lt;-<span class="st"> </span>mast_df[vars]</span>
<span id="cb83-10"><a href="linear-regression.html#cb83-10"></a>mast_df<span class="op">$</span>tempC &lt;-<span class="st"> </span>(mast_df<span class="op">$</span>tempF <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span>)</span></code></pre></div>
</div>
</div>
<div id="spatial-data" class="section level2">
<h2><span class="header-section-number">4.4</span> Spatial data</h2>
<div id="plot-coordinates" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Plot Coordinates</h3>
<p>Where do our points plot? To start we need to convert them to a spatial object first. Then we can create an interactive we map using <code>mapview</code>. Also, if we wish we can also export the locations as a Shapefile.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb84-1"><a href="linear-regression.html#cb84-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb84-2"><a href="linear-regression.html#cb84-2"></a><span class="kw">library</span>(mapview)</span>
<span id="cb84-3"><a href="linear-regression.html#cb84-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb84-4"><a href="linear-regression.html#cb84-4"></a></span>
<span id="cb84-5"><a href="linear-regression.html#cb84-5"></a>githubURL &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/ncss-tech/stats_for_soil_survey/master/data/ch7_data_v2.Rdata&quot;</span></span>
<span id="cb84-6"><a href="linear-regression.html#cb84-6"></a><span class="kw">load</span>(<span class="kw">url</span>(githubURL))</span>
<span id="cb84-7"><a href="linear-regression.html#cb84-7"></a></span>
<span id="cb84-8"><a href="linear-regression.html#cb84-8"></a></span>
<span id="cb84-9"><a href="linear-regression.html#cb84-9"></a><span class="co"># convert to sites to a spatial object</span></span>
<span id="cb84-10"><a href="linear-regression.html#cb84-10"></a>mast_sf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(mast_df,</span>
<span id="cb84-11"><a href="linear-regression.html#cb84-11"></a>                    <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;utmeasting&quot;</span>, <span class="st">&quot;utmnorthing&quot;</span>),</span>
<span id="cb84-12"><a href="linear-regression.html#cb84-12"></a>                    <span class="dt">crs =</span> <span class="dv">26911</span></span>
<span id="cb84-13"><a href="linear-regression.html#cb84-13"></a>                    ) <span class="op">%&gt;%</span></span>
<span id="cb84-14"><a href="linear-regression.html#cb84-14"></a><span class="co"># reproject</span></span>
<span id="cb84-15"><a href="linear-regression.html#cb84-15"></a><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb84-16"><a href="linear-regression.html#cb84-16"></a></span>
<span id="cb84-17"><a href="linear-regression.html#cb84-17"></a><span class="co"># reduce precision</span></span>
<span id="cb84-18"><a href="linear-regression.html#cb84-18"></a>mast_sf2 &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(<span class="kw">as.data.frame</span>(<span class="kw">round</span>(<span class="kw">st_coordinates</span>(mast_sf), <span class="dv">1</span>)),</span>
<span id="cb84-19"><a href="linear-regression.html#cb84-19"></a>                     <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>),</span>
<span id="cb84-20"><a href="linear-regression.html#cb84-20"></a>                     <span class="dt">crs =</span> <span class="dv">4326</span></span>
<span id="cb84-21"><a href="linear-regression.html#cb84-21"></a>                     )</span>
<span id="cb84-22"><a href="linear-regression.html#cb84-22"></a></span>
<span id="cb84-23"><a href="linear-regression.html#cb84-23"></a><span class="co"># reproject</span></span>
<span id="cb84-24"><a href="linear-regression.html#cb84-24"></a>mast_sf &lt;-<span class="st"> </span><span class="kw">st_transform</span>(mast_sf, <span class="dv">5070</span>)</span>
<span id="cb84-25"><a href="linear-regression.html#cb84-25"></a></span>
<span id="cb84-26"><a href="linear-regression.html#cb84-26"></a></span>
<span id="cb84-27"><a href="linear-regression.html#cb84-27"></a><span class="co"># MLRAs</span></span>
<span id="cb84-28"><a href="linear-regression.html#cb84-28"></a>mlra &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="dt">dsn =</span> <span class="st">&quot;D:/geodata/soils/mlra_a_mbr.shp&quot;</span>, <span class="dt">layer =</span> <span class="st">&quot;mlra_a_mbr&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb84-29"><a href="linear-regression.html#cb84-29"></a><span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">4326</span>) <span class="op">%&gt;%</span></span>
<span id="cb84-30"><a href="linear-regression.html#cb84-30"></a><span class="st">  </span><span class="kw">filter</span>(MLRARSYM <span class="op">%in%</span><span class="st"> </span><span class="dv">30</span><span class="op">:</span><span class="dv">31</span>)</span>
<span id="cb84-31"><a href="linear-regression.html#cb84-31"></a></span>
<span id="cb84-32"><a href="linear-regression.html#cb84-32"></a><span class="co"># plot</span></span>
<span id="cb84-33"><a href="linear-regression.html#cb84-33"></a><span class="kw">mapview</span>(mlra, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb84-34"><a href="linear-regression.html#cb84-34"></a><span class="st">  </span><span class="kw">mapview</span>(mast_sf2)</span></code></pre></div>
</div>
<div id="extracting-spatial-data" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Extracting Spatial Data</h3>
<p>Prior to any spatial analysis or modeling, you will need to develop a suite of geodata files that can be intersected with your field data locations. This is, in and of itself a difficult task and should be facilitated by your Regional GIS Specialist. The geodata files typically used would consist of derivatives from a DEM or satellite imagery, and a ‘good’ geology map. Prior to any prediction it is also necessary to ensure the geodata files have the same projection, extent, and cell size. Once we have the necessary files we can construct a list in R of the file names and paths, read the geodata into R, and then extract the geodata values where they intersect with field data.</p>
<p>As you can see below their are numerous variables we could inspect.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb85-1"><a href="linear-regression.html#cb85-1"></a><span class="kw">library</span>(raster)</span>
<span id="cb85-2"><a href="linear-regression.html#cb85-2"></a></span>
<span id="cb85-3"><a href="linear-regression.html#cb85-3"></a><span class="co"># set file path</span></span>
<span id="cb85-4"><a href="linear-regression.html#cb85-4"></a>folder &lt;-<span class="st"> &quot;D:/geodata/project_data/R8-VIC/&quot;</span></span>
<span id="cb85-5"><a href="linear-regression.html#cb85-5"></a></span>
<span id="cb85-6"><a href="linear-regression.html#cb85-6"></a>files &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">elev    =</span> <span class="st">&quot;ned30m_8VIC_elev5.tif&quot;</span>,</span>
<span id="cb85-7"><a href="linear-regression.html#cb85-7"></a>           <span class="dt">slope   =</span> <span class="st">&quot;ned30m_8VIC_slope5.tif&quot;</span>,</span>
<span id="cb85-8"><a href="linear-regression.html#cb85-8"></a>           <span class="dt">aspect  =</span> <span class="st">&quot;ned30m_8VIC_aspect5.tif&quot;</span>,</span>
<span id="cb85-9"><a href="linear-regression.html#cb85-9"></a>           <span class="dt">twi     =</span> <span class="st">&quot;ned30m_8VIC_wetness.tif&quot;</span>,</span>
<span id="cb85-10"><a href="linear-regression.html#cb85-10"></a>           <span class="dt">solar   =</span> <span class="st">&quot;ned30m_8VIC_solar.tif&quot;</span>,</span>
<span id="cb85-11"><a href="linear-regression.html#cb85-11"></a>           <span class="dt">solarcv =</span> <span class="st">&quot;ned30m_8VIC_solarcv.tif&quot;</span>,</span>
<span id="cb85-12"><a href="linear-regression.html#cb85-12"></a>           <span class="dt">tc      =</span> <span class="st">&quot;landsat30m_8VIC_tc123.tif&quot;</span>,</span>
<span id="cb85-13"><a href="linear-regression.html#cb85-13"></a>           <span class="dt">precip  =</span> <span class="st">&quot;prism30m_8VIC_ppt_1981_2010_annual_mm.tif&quot;</span>,</span>
<span id="cb85-14"><a href="linear-regression.html#cb85-14"></a>           <span class="dt">temp    =</span> <span class="st">&quot;prism30m_8VIC_tmean_1981_2010_annual_C.tif&quot;</span></span>
<span id="cb85-15"><a href="linear-regression.html#cb85-15"></a>           )</span>
<span id="cb85-16"><a href="linear-regression.html#cb85-16"></a></span>
<span id="cb85-17"><a href="linear-regression.html#cb85-17"></a><span class="co"># combine the folder directory and file names</span></span>
<span id="cb85-18"><a href="linear-regression.html#cb85-18"></a>geodata_f &lt;-<span class="st"> </span><span class="kw">paste0</span>(folder, files) </span>
<span id="cb85-19"><a href="linear-regression.html#cb85-19"></a><span class="kw">names</span>(geodata_f) &lt;-<span class="st"> </span><span class="kw">names</span>(files)</span>
<span id="cb85-20"><a href="linear-regression.html#cb85-20"></a></span>
<span id="cb85-21"><a href="linear-regression.html#cb85-21"></a><span class="co"># Create a raster stack</span></span>
<span id="cb85-22"><a href="linear-regression.html#cb85-22"></a>geodata_r &lt;-<span class="st"> </span><span class="kw">stack</span>(geodata_f)</span>
<span id="cb85-23"><a href="linear-regression.html#cb85-23"></a></span>
<span id="cb85-24"><a href="linear-regression.html#cb85-24"></a><span class="co"># Extract the geodata and add to a data frame</span></span>
<span id="cb85-25"><a href="linear-regression.html#cb85-25"></a>data &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">extract</span>(geodata_r, <span class="kw">as</span>(mast_sf, <span class="st">&quot;Spatial&quot;</span>), <span class="dt">sp =</span> <span class="ot">TRUE</span>)<span class="op">@</span>data</span>
<span id="cb85-26"><a href="linear-regression.html#cb85-26"></a></span>
<span id="cb85-27"><a href="linear-regression.html#cb85-27"></a><span class="co"># convert aspect</span></span>
<span id="cb85-28"><a href="linear-regression.html#cb85-28"></a>data<span class="op">$</span>northness &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="dv">180</span> <span class="op">-</span><span class="st"> </span>data<span class="op">$</span>aspect)</span>
<span id="cb85-29"><a href="linear-regression.html#cb85-29"></a></span>
<span id="cb85-30"><a href="linear-regression.html#cb85-30"></a><span class="co"># random sample</span></span>
<span id="cb85-31"><a href="linear-regression.html#cb85-31"></a>vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;precip&quot;</span>, <span class="st">&quot;solar&quot;</span>, <span class="st">&quot;tc_1&quot;</span>, <span class="st">&quot;twi&quot;</span>)</span>
<span id="cb85-32"><a href="linear-regression.html#cb85-32"></a>idx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">names</span>(geodata_r) <span class="op">%in%</span><span class="st"> </span>vars)</span>
<span id="cb85-33"><a href="linear-regression.html#cb85-33"></a>geodata_s &lt;-<span class="st"> </span><span class="kw">sampleRegular</span>(geodata_r[[idx]], <span class="dt">size =</span> <span class="dv">5000</span>)</span>
<span id="cb85-34"><a href="linear-regression.html#cb85-34"></a></span>
<span id="cb85-35"><a href="linear-regression.html#cb85-35"></a><span class="co"># cache files</span></span>
<span id="cb85-36"><a href="linear-regression.html#cb85-36"></a><span class="kw">save</span>(data, mast_df, mast_sf2, mlra, geodata_s, <span class="dt">file =</span> <span class="st">&quot;C:/workspace2/github/ncss-tech/stats_for_soil_survey/data/ch7_data_v2.Rdata&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="exploratory-data-analysis-eda" class="section level2">
<h2><span class="header-section-number">4.5</span> Exploratory Data Analysis (EDA)</h2>
<p>Generally before we begin modeling it is good to explore the data. By examining a simple summary we can quickly see the breakdown of our data. It is important to look out for missing or improbable values. Probably the easiest way to identify pecularities in the data is to plot it.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb86-1"><a href="linear-regression.html#cb86-1"></a>githubURL &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/ncss-tech/stats_for_soil_survey/master/data/ch7_data_v2.Rdata&quot;</span></span>
<span id="cb86-2"><a href="linear-regression.html#cb86-2"></a><span class="kw">load</span>(<span class="kw">url</span>(githubURL))</span>
<span id="cb86-3"><a href="linear-regression.html#cb86-3"></a></span>
<span id="cb86-4"><a href="linear-regression.html#cb86-4"></a><span class="kw">summary</span>(data)</span></code></pre></div>
<p>You may recall from discussion of EDA that QQ plots are a visual way to inspect the normality of a variable. If the variable is normally distributed, the points (e.g. soil observations) should line up along the straight line.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb87-1"><a href="linear-regression.html#cb87-1"></a><span class="co"># QQ plot</span></span>
<span id="cb87-2"><a href="linear-regression.html#cb87-2"></a></span>
<span id="cb87-3"><a href="linear-regression.html#cb87-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb87-4"><a href="linear-regression.html#cb87-4"></a></span>
<span id="cb87-5"><a href="linear-regression.html#cb87-5"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">sample =</span> tempC)) <span class="op">+</span></span>
<span id="cb87-6"><a href="linear-regression.html#cb87-6"></a><span class="st">  </span><span class="kw">geom_qq</span>() <span class="op">+</span></span>
<span id="cb87-7"><a href="linear-regression.html#cb87-7"></a><span class="st">  </span><span class="kw">geom_qq_line</span>()</span></code></pre></div>
<p>By examining the correlations between some of the predictors we can also determine wheter they are <em>collinear</em> (e.g. &gt; 0.6). This is common for similar variables such as landsat bands, terrain derivatives, and climatic variables. Variables that are colinear are redundant and contain no additional information. In additino, collinearity will make it difficult to estimate our regression coefficients.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb88-1"><a href="linear-regression.html#cb88-1"></a>vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tempC&quot;</span>, <span class="st">&quot;elev&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;precip&quot;</span>, <span class="st">&quot;tc_2&quot;</span>, <span class="st">&quot;tc_1&quot;</span>, <span class="st">&quot;tc_3&quot;</span>)</span>
<span id="cb88-2"><a href="linear-regression.html#cb88-2"></a>GGally<span class="op">::</span><span class="kw">ggpairs</span>(data[, vars])</span>
<span id="cb88-3"><a href="linear-regression.html#cb88-3"></a></span>
<span id="cb88-4"><a href="linear-regression.html#cb88-4"></a>vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tempC&quot;</span>, <span class="st">&quot;slope&quot;</span>, <span class="st">&quot;twi&quot;</span>, <span class="st">&quot;northness&quot;</span>, <span class="st">&quot;solar&quot;</span>, <span class="st">&quot;solarcv&quot;</span>)</span>
<span id="cb88-5"><a href="linear-regression.html#cb88-5"></a>GGally<span class="op">::</span><span class="kw">ggpairs</span>(data[, vars])</span></code></pre></div>
<p>The correlation matrices and scatter plots above show that that MAST has moderate correlations with some of the variables, particularly the elevation and the climatic variables.</p>
<p>Examining the density plots on the diagonal axis of the scatterplots we can also see that some variables are skewed.</p>
<div id="compare-samples-vs-population" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Compare Samples vs Population</h3>
<p>Since our data was not randomly sampled, we had better check the distribution of our samples vs the population. We can accomplish this by overlaying the sample distribution of predictor variables vs a large random sample.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb89-1"><a href="linear-regression.html#cb89-1"></a>geodata_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(geodata_s)</span>
<span id="cb89-2"><a href="linear-regression.html#cb89-2"></a></span>
<span id="cb89-3"><a href="linear-regression.html#cb89-3"></a>geodata_df &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb89-4"><a href="linear-regression.html#cb89-4"></a>  <span class="kw">data.frame</span>(<span class="dt">source =</span> <span class="st">&quot;sample&quot;</span>,     data[<span class="kw">names</span>(geodata_df)]),</span>
<span id="cb89-5"><a href="linear-regression.html#cb89-5"></a>  <span class="kw">data.frame</span>(<span class="dt">source =</span> <span class="st">&quot;population&quot;</span>, geodata_df)</span>
<span id="cb89-6"><a href="linear-regression.html#cb89-6"></a>)</span>
<span id="cb89-7"><a href="linear-regression.html#cb89-7"></a></span>
<span id="cb89-8"><a href="linear-regression.html#cb89-8"></a>geodata_w &lt;-<span class="st"> </span>reshape<span class="op">::</span><span class="kw">melt</span>(</span>
<span id="cb89-9"><a href="linear-regression.html#cb89-9"></a>  geodata_df,</span>
<span id="cb89-10"><a href="linear-regression.html#cb89-10"></a>  <span class="dt">id.vars =</span> <span class="st">&quot;source&quot;</span>,</span>
<span id="cb89-11"><a href="linear-regression.html#cb89-11"></a>  <span class="dt">measures.vars =</span> vars</span>
<span id="cb89-12"><a href="linear-regression.html#cb89-12"></a>  )</span>
<span id="cb89-13"><a href="linear-regression.html#cb89-13"></a></span>
<span id="cb89-14"><a href="linear-regression.html#cb89-14"></a><span class="kw">ggplot</span>(geodata_w, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> source)) <span class="op">+</span></span>
<span id="cb89-15"><a href="linear-regression.html#cb89-15"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb89-16"><a href="linear-regression.html#cb89-16"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></span>
<span id="cb89-17"><a href="linear-regression.html#cb89-17"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Evaluation of Sample Representativeness&quot;</span>)</span></code></pre></div>
<p>The overlap between our sample and the population appear satistifactory.</p>
</div>
</div>
<div id="linear-modeling" class="section level2">
<h2><span class="header-section-number">4.6</span> Linear modeling</h2>
<p>R has several functions for fitting linear models. The most common is arguably the <code>lm()</code> function from the stats R package, which is loaded by default. The <code>lm()</code> function is also extended thru the use of several additional packages such as the car and caret R packages. Another noteworthy R package for linear modeling is rms, which offers the <code>ols()</code> function for linear modeling. The rms R package (Harrell et al., 2015) offers an ‘almost’ comprehesive alternative to `lm()’ and it’s accessory function. It is difficult to objectively functions say which approach is better. Therefore methods both methods will be demonstrated. Look for comments (i.e. #) below referring to rms, stats, caret or visreg.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb90-1"><a href="linear-regression.html#cb90-1"></a><span class="co"># stats</span></span>
<span id="cb90-2"><a href="linear-regression.html#cb90-2"></a>fit_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(tempC <span class="op">~</span><span class="st"> </span>elev <span class="op">+</span><span class="st"> </span>aspect <span class="op">+</span><span class="st"> </span>twi <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>solarcv <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>precip <span class="op">+</span><span class="st"> </span>temp, <span class="dt">data =</span> data, <span class="dt">weights =</span> data<span class="op">$</span>numDays)</span>
<span id="cb90-3"><a href="linear-regression.html#cb90-3"></a></span>
<span id="cb90-4"><a href="linear-regression.html#cb90-4"></a></span>
<span id="cb90-5"><a href="linear-regression.html#cb90-5"></a><span class="co"># rms</span></span>
<span id="cb90-6"><a href="linear-regression.html#cb90-6"></a></span>
<span id="cb90-7"><a href="linear-regression.html#cb90-7"></a><span class="kw">library</span>(rms)</span>
<span id="cb90-8"><a href="linear-regression.html#cb90-8"></a></span>
<span id="cb90-9"><a href="linear-regression.html#cb90-9"></a>dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(data)</span>
<span id="cb90-10"><a href="linear-regression.html#cb90-10"></a><span class="kw">options</span>(<span class="dt">datadist =</span> <span class="st">&quot;dd&quot;</span>)</span>
<span id="cb90-11"><a href="linear-regression.html#cb90-11"></a></span>
<span id="cb90-12"><a href="linear-regression.html#cb90-12"></a>fit_ols &lt;-<span class="st"> </span><span class="kw">ols</span>(tempC <span class="op">~</span><span class="st"> </span>elev <span class="op">+</span><span class="st"> </span>aspect <span class="op">+</span><span class="st"> </span>twi <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>solarcv <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>precip <span class="op">+</span><span class="st"> </span>temp, <span class="dt">data =</span> data, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>, <span class="dt">weights =</span> data<span class="op">$</span>numDays)</span></code></pre></div>
<div id="diagnostics" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Diagnostics</h3>
<div id="residual-plots" class="section level4">
<h4><span class="header-section-number">4.6.1.1</span> Residual plots</h4>
<p>Once we have a model we need to assess residuals for linearity, normality, and homoscedastivity (or constant variance). Oddly this is one area were the rms R package does not offer convient functions for plotting residuals, therefore we’ll simply access the results of <code>lm()</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb91-1"><a href="linear-regression.html#cb91-1"></a><span class="kw">par</span>(<span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb91-2"><a href="linear-regression.html#cb91-2"></a></span>
<span id="cb91-3"><a href="linear-regression.html#cb91-3"></a><span class="kw">plot</span>(fit_lm)</span>
<span id="cb91-4"><a href="linear-regression.html#cb91-4"></a></span>
<span id="cb91-5"><a href="linear-regression.html#cb91-5"></a><span class="kw">termplot</span>(fit_lm, <span class="dt">partial.resid =</span> <span class="ot">TRUE</span>, <span class="dt">col.res =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
</div>
<div id="multicolinearity" class="section level4">
<h4><span class="header-section-number">4.6.1.2</span> Multicolinearity</h4>
<p>As we mentioned earlier multicolinearity should be avoided. To assess a model for multicolinearity we can compute the <strong>variance inflation factor</strong> (VIF). Its square root indicates the amount of increase in the predictor coefficients standard error. A value greater than 3 indicates a doubling the standard error. Rules of thumb vary, but a square root of vif greater than 2 or 3 indicates an unacceptable value.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb92-1"><a href="linear-regression.html#cb92-1"></a><span class="co"># vif() function from the rms or car packages</span></span>
<span id="cb92-2"><a href="linear-regression.html#cb92-2"></a><span class="kw">sqrt</span>(<span class="kw">vif</span>(fit_lm))</span>
<span id="cb92-3"><a href="linear-regression.html#cb92-3"></a></span>
<span id="cb92-4"><a href="linear-regression.html#cb92-4"></a><span class="co"># or </span></span>
<span id="cb92-5"><a href="linear-regression.html#cb92-5"></a></span>
<span id="cb92-6"><a href="linear-regression.html#cb92-6"></a><span class="kw">sqrt</span>(<span class="kw">vif</span>(fit_ols)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span></span></code></pre></div>
<p>The values above indicate we have several colinear variables in the model, which you might have noticed already from the scatter plot matrix.</p>
</div>
</div>
<div id="variable-selection-model-validation" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Variable selection &amp; model validation</h3>
<p>Modeling is an iterative process that cycles between fitting and evaluating alternative models. Compared to tree and forest models, linear and generalized models typically require more scrunity from the user. Automated model selection procedures are available, but should not be taken at face value because they may result in complex and unstable models. This is in part due to correlation amongst the predictive variables that can confuse the model. Also, the order in which the variables are included or excluded from the model effects the significance of the other variables, and thus several weak predictors might mask the effect of one strong predictor. Regardless of the approach used, variable selection is probably the most controversial aspect of linear modeling.</p>
<p>Both the rms and caret packages offer methods for variable selection and cross-validation. In this instance the rms approach is a bit more convinent, with the one line call to <code>validate()</code>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb93-1"><a href="linear-regression.html#cb93-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb93-2"><a href="linear-regression.html#cb93-2"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb93-3"><a href="linear-regression.html#cb93-3"></a></span>
<span id="cb93-4"><a href="linear-regression.html#cb93-4"></a></span>
<span id="cb93-5"><a href="linear-regression.html#cb93-5"></a><span class="co"># rms</span></span>
<span id="cb93-6"><a href="linear-regression.html#cb93-6"></a><span class="co">## stepwise selection and validation</span></span>
<span id="cb93-7"><a href="linear-regression.html#cb93-7"></a>step_rms &lt;-<span class="st"> </span><span class="kw">validate</span>(fit_ols, <span class="dt">method =</span> <span class="st">&quot;crossvalidation&quot;</span>, <span class="dt">B =</span> <span class="dv">10</span>, <span class="dt">bw =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The results for <code>validate()</code> above and below show which variables were retained and deleted. Below we can see a dot matrix of which variables were retained in during the 10 iterations of the cross validation. In addition, below we can see the difference between the training and test accuracy and error metrics. Remember that it is the test accuracy we should pay attention too.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb94-1"><a href="linear-regression.html#cb94-1"></a><span class="co">## test accuracy and error</span></span>
<span id="cb94-2"><a href="linear-regression.html#cb94-2"></a>step_rms</span></code></pre></div>
<p>The caret package option for variable selection and validation is a bit more verbose than the rms package. However, the caret package is a more versatile package, with options for over 50 different models, such as other tree-based models.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb95-1"><a href="linear-regression.html#cb95-1"></a><span class="co"># caret</span></span>
<span id="cb95-2"><a href="linear-regression.html#cb95-2"></a><span class="kw">library</span>(caret)</span>
<span id="cb95-3"><a href="linear-regression.html#cb95-3"></a></span>
<span id="cb95-4"><a href="linear-regression.html#cb95-4"></a><span class="co">## cross validation parameters</span></span>
<span id="cb95-5"><a href="linear-regression.html#cb95-5"></a>train.control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, <span class="dt">returnData =</span> <span class="ot">TRUE</span>)</span>
<span id="cb95-6"><a href="linear-regression.html#cb95-6"></a></span>
<span id="cb95-7"><a href="linear-regression.html#cb95-7"></a><span class="co">## stepwise selection and validation</span></span>
<span id="cb95-8"><a href="linear-regression.html#cb95-8"></a>step_caret &lt;-<span class="st"> </span><span class="kw">train</span>(tempC <span class="op">~</span><span class="st"> </span>elev <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>aspect <span class="op">+</span><span class="st"> </span>twi <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>solarcv <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(precip) <span class="op">+</span><span class="st"> </span>temp<span class="op">^</span><span class="dv">2</span>, </span>
<span id="cb95-9"><a href="linear-regression.html#cb95-9"></a>                    <span class="dt">data =</span> data,</span>
<span id="cb95-10"><a href="linear-regression.html#cb95-10"></a>                    <span class="dt">weights =</span> data<span class="op">$</span>numDays,</span>
<span id="cb95-11"><a href="linear-regression.html#cb95-11"></a>                    <span class="dt">method =</span> <span class="st">&quot;lmStepAIC&quot;</span>,</span>
<span id="cb95-12"><a href="linear-regression.html#cb95-12"></a>                    <span class="dt">trace =</span> <span class="ot">FALSE</span>,</span>
<span id="cb95-13"><a href="linear-regression.html#cb95-13"></a>                    <span class="dt">trControl =</span> train.control,</span>
<span id="cb95-14"><a href="linear-regression.html#cb95-14"></a>                    <span class="dt">na.action =</span> na.exclude</span>
<span id="cb95-15"><a href="linear-regression.html#cb95-15"></a>                    )</span>
<span id="cb95-16"><a href="linear-regression.html#cb95-16"></a></span>
<span id="cb95-17"><a href="linear-regression.html#cb95-17"></a><span class="co">## test accuracy and error</span></span>
<span id="cb95-18"><a href="linear-regression.html#cb95-18"></a><span class="kw">summary</span>(step_caret<span class="op">$</span>resample)</span></code></pre></div>
<p>The output from caret is somewhat different. Notice it selected a slightly different combination of variables and more optimistic test accuracy and error.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb96-1"><a href="linear-regression.html#cb96-1"></a><span class="co"># summary</span></span>
<span id="cb96-2"><a href="linear-regression.html#cb96-2"></a><span class="kw">summary</span>(step_caret<span class="op">$</span>finalModel)</span></code></pre></div>
</div>
<div id="final-model-accuracy-assessment" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Final model &amp; accuracy assessment</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb97-1"><a href="linear-regression.html#cb97-1"></a><span class="co"># rms</span></span>
<span id="cb97-2"><a href="linear-regression.html#cb97-2"></a>final_ols &lt;-<span class="st"> </span><span class="kw">ols</span>(tempC <span class="op">~</span><span class="st"> </span>elev <span class="op">+</span><span class="st"> </span>solarcv <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span>, <span class="dt">data =</span> data, <span class="dt">weights =</span> data<span class="op">$</span>numDays, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>)</span>
<span id="cb97-3"><a href="linear-regression.html#cb97-3"></a></span>
<span id="cb97-4"><a href="linear-regression.html#cb97-4"></a><span class="kw">validate</span>(final_ols, <span class="dt">method =</span> <span class="st">&quot;crossvalidation&quot;</span>, <span class="dt">B =</span> <span class="dv">10</span>)</span>
<span id="cb97-5"><a href="linear-regression.html#cb97-5"></a></span>
<span id="cb97-6"><a href="linear-regression.html#cb97-6"></a></span>
<span id="cb97-7"><a href="linear-regression.html#cb97-7"></a><span class="co"># caret</span></span>
<span id="cb97-8"><a href="linear-regression.html#cb97-8"></a>final_caret &lt;-<span class="st"> </span><span class="kw">train</span>(tempC <span class="op">~</span><span class="st"> </span>elev <span class="op">+</span><span class="st"> </span>solarcv <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span>, </span>
<span id="cb97-9"><a href="linear-regression.html#cb97-9"></a>                     <span class="dt">data =</span> data,</span>
<span id="cb97-10"><a href="linear-regression.html#cb97-10"></a>                     <span class="dt">weights =</span> data<span class="op">$</span>numDays,</span>
<span id="cb97-11"><a href="linear-regression.html#cb97-11"></a>                     <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb97-12"><a href="linear-regression.html#cb97-12"></a>                     <span class="dt">trControl =</span> train.control,</span>
<span id="cb97-13"><a href="linear-regression.html#cb97-13"></a>                     <span class="dt">na.action =</span> na.exclude</span>
<span id="cb97-14"><a href="linear-regression.html#cb97-14"></a>                     )</span>
<span id="cb97-15"><a href="linear-regression.html#cb97-15"></a>final_caret<span class="op">$</span>results</span>
<span id="cb97-16"><a href="linear-regression.html#cb97-16"></a>final_lm &lt;-<span class="st"> </span>final_caret<span class="op">$</span>finalModel</span></code></pre></div>
</div>
<div id="model-effects" class="section level3">
<h3><span class="header-section-number">4.6.4</span> Model Effects</h3>
<div class="sourceCode" id="cb98"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb98-1"><a href="linear-regression.html#cb98-1"></a><span class="kw">summary</span>(final_lm)</span>
<span id="cb98-2"><a href="linear-regression.html#cb98-2"></a></span>
<span id="cb98-3"><a href="linear-regression.html#cb98-3"></a></span>
<span id="cb98-4"><a href="linear-regression.html#cb98-4"></a><span class="co"># analyis of variance</span></span>
<span id="cb98-5"><a href="linear-regression.html#cb98-5"></a></span>
<span id="cb98-6"><a href="linear-regression.html#cb98-6"></a>dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(data)</span>
<span id="cb98-7"><a href="linear-regression.html#cb98-7"></a><span class="kw">options</span>(<span class="dt">datadist =</span> <span class="st">&quot;dd&quot;</span>)</span>
<span id="cb98-8"><a href="linear-regression.html#cb98-8"></a></span>
<span id="cb98-9"><a href="linear-regression.html#cb98-9"></a><span class="kw">anova</span>(final_ols)</span>
<span id="cb98-10"><a href="linear-regression.html#cb98-10"></a></span>
<span id="cb98-11"><a href="linear-regression.html#cb98-11"></a><span class="kw">anova</span>(final_lm)</span>
<span id="cb98-12"><a href="linear-regression.html#cb98-12"></a></span>
<span id="cb98-13"><a href="linear-regression.html#cb98-13"></a></span>
<span id="cb98-14"><a href="linear-regression.html#cb98-14"></a><span class="co"># rms</span></span>
<span id="cb98-15"><a href="linear-regression.html#cb98-15"></a></span>
<span id="cb98-16"><a href="linear-regression.html#cb98-16"></a><span class="kw">plot</span>(<span class="kw">Predict</span>(final_ols))</span>
<span id="cb98-17"><a href="linear-regression.html#cb98-17"></a></span>
<span id="cb98-18"><a href="linear-regression.html#cb98-18"></a><span class="kw">plot</span>(<span class="kw">Predict</span>(final_ols, <span class="dt">elev =</span> <span class="ot">NA</span>, <span class="dt">solarcv =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">33</span>, <span class="dv">51</span>)))</span>
<span id="cb98-19"><a href="linear-regression.html#cb98-19"></a></span>
<span id="cb98-20"><a href="linear-regression.html#cb98-20"></a></span>
<span id="cb98-21"><a href="linear-regression.html#cb98-21"></a><span class="co"># visreg</span></span>
<span id="cb98-22"><a href="linear-regression.html#cb98-22"></a></span>
<span id="cb98-23"><a href="linear-regression.html#cb98-23"></a><span class="kw">library</span>(visreg)</span>
<span id="cb98-24"><a href="linear-regression.html#cb98-24"></a></span>
<span id="cb98-25"><a href="linear-regression.html#cb98-25"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb98-26"><a href="linear-regression.html#cb98-26"></a><span class="kw">visreg</span>(final_lm)</span>
<span id="cb98-27"><a href="linear-regression.html#cb98-27"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb98-28"><a href="linear-regression.html#cb98-28"></a></span>
<span id="cb98-29"><a href="linear-regression.html#cb98-29"></a><span class="kw">visreg</span>(final_lm, <span class="dt">xvar =</span> <span class="st">&quot;elev&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;solarcv&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">33</span>, <span class="dv">51</span>), <span class="dt">overlay =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="generate-spatial-predictions" class="section level2">
<h2><span class="header-section-number">4.7</span> Generate spatial predictions</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb99-1"><a href="linear-regression.html#cb99-1"></a><span class="co"># Predict tempC model</span></span>
<span id="cb99-2"><a href="linear-regression.html#cb99-2"></a>predfun &lt;-<span class="st"> </span><span class="cf">function</span>(model, data) {</span>
<span id="cb99-3"><a href="linear-regression.html#cb99-3"></a>  v &lt;-<span class="st"> </span><span class="kw">predict</span>(model, data, <span class="dt">se.fit=</span><span class="ot">TRUE</span>)</span>
<span id="cb99-4"><a href="linear-regression.html#cb99-4"></a>  }</span>
<span id="cb99-5"><a href="linear-regression.html#cb99-5"></a></span>
<span id="cb99-6"><a href="linear-regression.html#cb99-6"></a>mast_r &lt;-<span class="st"> </span><span class="kw">predict</span>(geodata_r, final_lm, <span class="dt">fun =</span> predfun, <span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">progress =</span> <span class="st">&#39;text&#39;</span>)</span>
<span id="cb99-7"><a href="linear-regression.html#cb99-7"></a></span>
<span id="cb99-8"><a href="linear-regression.html#cb99-8"></a><span class="kw">writeRaster</span>(mast_r[[<span class="dv">1</span>]], <span class="dt">filename =</span> <span class="st">&quot;C:/workspace2/mast.tif&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;GTiff&quot;</span>, <span class="dt">progress =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb99-9"><a href="linear-regression.html#cb99-9"></a></span>
<span id="cb99-10"><a href="linear-regression.html#cb99-10"></a><span class="kw">writeRaster</span>(mast_r[[<span class="dv">2</span>]], <span class="dt">filename =</span> <span class="st">&quot;C:/workspace2/mast_se.tif&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;GTiff&quot;</span>, <span class="dt">progress =</span> <span class="st">&quot;text&quot;</span>)</span></code></pre></div>
</div>
<div id="create-map" class="section level2">
<h2><span class="header-section-number">4.8</span> Create Map</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb100-1"><a href="linear-regression.html#cb100-1"></a><span class="kw">library</span>(raster)</span>
<span id="cb100-2"><a href="linear-regression.html#cb100-2"></a></span>
<span id="cb100-3"><a href="linear-regression.html#cb100-3"></a>mlra &lt;-<span class="st"> </span><span class="kw">st_transform</span>(mlra, <span class="dv">5070</span>)</span>
<span id="cb100-4"><a href="linear-regression.html#cb100-4"></a></span>
<span id="cb100-5"><a href="linear-regression.html#cb100-5"></a><span class="co"># mast</span></span>
<span id="cb100-6"><a href="linear-regression.html#cb100-6"></a>mast &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;C:/workspace2/mast.tif&quot;</span>)</span>
<span id="cb100-7"><a href="linear-regression.html#cb100-7"></a><span class="kw">crs</span>(mast) &lt;-<span class="st"> &quot;+init=epsg:5070&quot;</span></span>
<span id="cb100-8"><a href="linear-regression.html#cb100-8"></a></span>
<span id="cb100-9"><a href="linear-regression.html#cb100-9"></a><span class="kw">plot</span>(mast)</span>
<span id="cb100-10"><a href="linear-regression.html#cb100-10"></a><span class="kw">plot</span>(mlra[<span class="dv">1</span>], <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb100-11"><a href="linear-regression.html#cb100-11"></a></span>
<span id="cb100-12"><a href="linear-regression.html#cb100-12"></a></span>
<span id="cb100-13"><a href="linear-regression.html#cb100-13"></a><span class="co"># mast standard error</span></span>
<span id="cb100-14"><a href="linear-regression.html#cb100-14"></a>mast_se &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;C:/workspace2/mast_se.tif&quot;</span>)</span>
<span id="cb100-15"><a href="linear-regression.html#cb100-15"></a><span class="kw">crs</span>(mast_se) &lt;-<span class="st"> &quot;+init=epsg:5070&quot;</span></span>
<span id="cb100-16"><a href="linear-regression.html#cb100-16"></a></span>
<span id="cb100-17"><a href="linear-regression.html#cb100-17"></a><span class="kw">plot</span>(mast_se)</span>
<span id="cb100-18"><a href="linear-regression.html#cb100-18"></a><span class="kw">plot</span>(mlra[<span class="dv">1</span>], <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="literature" class="section level2">
<h2><span class="header-section-number">4.9</span> Literature</h2>
<p>Bai, Y., T.A. Scott, W. Chen, R.C. Graham, L. Wu, A.C. Chang, and L.J. Lund, 2010. Soil Temperature Regimes in the Mojave Desert. Soil Science, 175(8):398-404.</p>
<p>Harrell, F.E., 2015. Regression Modeling Strategies: With Applications to Linear Models, Logisitc and Ordinal Regression, and Survival Analysis. Springer, New York. <a href="https://link.springer.com/book/10.1007%2F978-3-319-19425-7">https://link.springer.com/book/10.1007%2F978-3-319-19425-7</a></p>
<p>Mount, H.R., and R.F. Paetzold, 2002. The temperature regime for selected soils in the United States. United States Department of Agriculture, Natural Resources Con-servation Service, National Soil Survey Center, Lincoln, Nebraska, Soil Survey Investi-gation Report No. 48.</p>
<p>Peterson, F.F., 1992. Status of Soil Climate Studies in Nevada. pp1-11.</p>
<p><a href="https://www.researchgate.net/publication/331977150_Modeling_and_Application_of_Soil_Temperature_in_the_Mojave_and_Lower_Colorado_Deserts_of_California/citations">Roecker, S.M. and C.A. Haydu-Houdeshell, 2012. Modeling and Application of Soil Temperature in the Mojave and Lower Colorado Deserts of California. 2012 Western Regional Cooperative Soil Survey Conference.</a></p>
<p>Schmidlin, T.W., F.F. Peterson, and R.O. Gifford, 1983. Soil Temperature Regimes of Nevada. Soil So. Sci. Am. J., 47:977-982.</p>
</div>
<div id="additional-reading-1" class="section level2">
<h2><span class="header-section-number">4.10</span> Additional reading</h2>
<p>Faraway, J.J., 2002. Practical Regression and Anova using R. CRC Press, New York. <a href="https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf">https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf</a></p>
<p>James, G., D. Witten, T. Hastie, and R. Tibshirani, 2014. An Introduction to Statistical Learning: with Applications in R. Springer, New York. <a href="http://www-bcf.usc.edu/~gareth/ISL/">http://www-bcf.usc.edu/~gareth/ISL/</a></p>
<p>Hengl, T. 2009. A Practical Guide to Geostatistical Mapping, 2nd Edt. University of Amsterdam, www.lulu.com, 291 p. ISBN 978-90-9024981-0. <a href="http://spatial-analyst.net/book/system/files/Hengl_2009_GEOSTATe2c0w.pdf">http://spatial-analyst.net/book/system/files/Hengl_2009_GEOSTATe2c0w.pdf</a></p>
<p>Webster, R. 1997. Regression and functional relations. European Journal of Soil Science, 48, 557-566. <a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1365-2389.1997.tb00222.x/abstract">http://onlinelibrary.wiley.com/doi/10.1111/j.1365-2389.1997.tb00222.x/abstract</a></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="ordination.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="acc-unc-categorical-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["s4ssbook.pdf", "s4ssbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
