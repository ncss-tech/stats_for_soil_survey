<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Generalized Linear Models | Statistics for Soil Survey - Part 2</title>
  <meta name="description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Generalized Linear Models | Statistics for Soil Survey - Part 2" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Generalized Linear Models | Statistics for Soil Survey - Part 2" />
  
  <meta name="twitter:description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  

<meta name="author" content="Soil Survey Staff" />


<meta name="date" content="2021-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="tree-based-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../book/index.html">Statistics for Soil Survey - Part 1</a></li>
<li><a href="index.html">Statistics for Soil Survey - Part 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Pre-course Assignment</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i><b>0.1</b> Setup</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#create-workspace"><i class="fa fa-check"></i><b>0.1.1</b> Create Workspace</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#configure-rstudio"><i class="fa fa-check"></i><b>0.1.2</b> Configure RStudio</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#install-.rprofile"><i class="fa fa-check"></i><b>0.1.3</b> Install .RProfile</a></li>
<li class="chapter" data-level="0.1.4" data-path="index.html"><a href="index.html#install-required-packages"><i class="fa fa-check"></i><b>0.1.4</b> Install Required Packages</a></li>
<li class="chapter" data-level="0.1.5" data-path="index.html"><a href="index.html#common-errors"><i class="fa fa-check"></i><b>0.1.5</b> Common Errors</a></li>
<li class="chapter" data-level="0.1.6" data-path="index.html"><a href="index.html#packages-not-on-cran"><i class="fa fa-check"></i><b>0.1.6</b> Packages not on CRAN</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#connect-to-local-nasis"><i class="fa fa-check"></i><b>0.2</b> Connect to Local NASIS</a><ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#demonstrate-a-working-connection"><i class="fa fa-check"></i><b>0.2.1</b> Demonstrate a Working Connection</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#additional-supportoptional-readings"><i class="fa fa-check"></i><b>0.3</b> Additional Support/Optional Readings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>2</b> Uncertainty</a><ul>
<li class="chapter" data-level="2.1" data-path="uncertainty.html"><a href="uncertainty.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---dispersion"><i class="fa fa-check"></i><b>2.1.1</b> Exercise - Dispersion</a></li>
<li class="chapter" data-level="2.1.2" data-path="uncertainty.html"><a href="uncertainty.html#exercise---variation-and-certainty"><i class="fa fa-check"></i><b>2.1.2</b> Exercise - Variation and Certainty</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="uncertainty.html"><a href="uncertainty.html#theory-of-uncertainty"><i class="fa fa-check"></i><b>2.2</b> Theory of Uncertainty</a></li>
<li class="chapter" data-level="2.3" data-path="uncertainty.html"><a href="uncertainty.html#resampling-to-estimate-uncertainty"><i class="fa fa-check"></i><b>2.3</b> Resampling to Estimate Uncertainty</a><ul>
<li class="chapter" data-level="2.3.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---resampling"><i class="fa fa-check"></i><b>2.3.1</b> Exercise - Resampling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="uncertainty.html"><a href="uncertainty.html#performance-metrics"><i class="fa fa-check"></i><b>2.4</b> Performance Metrics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---numeric-metrics"><i class="fa fa-check"></i><b>2.4.1</b> Exercise - Numeric Metrics</a></li>
<li class="chapter" data-level="2.4.2" data-path="uncertainty.html"><a href="uncertainty.html#exercise---categorical-metrics"><i class="fa fa-check"></i><b>2.4.2</b> Exercise - Categorical Metrics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="uncertainty.html"><a href="uncertainty.html#validation"><i class="fa fa-check"></i><b>2.5</b> Validation</a></li>
<li class="chapter" data-level="2.6" data-path="uncertainty.html"><a href="uncertainty.html#apparent-validation"><i class="fa fa-check"></i><b>2.6</b> Apparent Validation</a></li>
<li class="chapter" data-level="2.7" data-path="uncertainty.html"><a href="uncertainty.html#inherent-validation"><i class="fa fa-check"></i><b>2.7</b> Inherent Validation</a><ul>
<li class="chapter" data-level="2.7.1" data-path="uncertainty.html"><a href="uncertainty.html#split-sample---a-single-partition-of-the-data-into-a-learning-and-a-calibration-set."><i class="fa fa-check"></i><b>2.7.1</b> Split-sample - A single partition of the data into a learning and a calibration set.</a></li>
<li class="chapter" data-level="2.7.2" data-path="uncertainty.html"><a href="uncertainty.html#cross-validation---alternate-development-and-validation"><i class="fa fa-check"></i><b>2.7.2</b> Cross-validation - Alternate development and validation</a></li>
<li class="chapter" data-level="2.7.3" data-path="uncertainty.html"><a href="uncertainty.html#subsample-resampling-or-sample-simulation"><i class="fa fa-check"></i><b>2.7.3</b> Subsample (Resampling or sample simulation)</a></li>
<li class="chapter" data-level="2.7.4" data-path="uncertainty.html"><a href="uncertainty.html#external-validation"><i class="fa fa-check"></i><b>2.7.4</b> External Validation</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="uncertainty.html"><a href="uncertainty.html#additional-reading"><i class="fa fa-check"></i><b>2.8</b> Additional reading</a></li>
<li class="chapter" data-level="2.9" data-path="uncertainty.html"><a href="uncertainty.html#references-uncertainty"><i class="fa fa-check"></i><b>2.9</b> References (Uncertainty)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="numerical-tax.html"><a href="numerical-tax.html"><i class="fa fa-check"></i><b>3</b> Numerical Taxonomy and Ordination</a><ul>
<li class="chapter" data-level="3.1" data-path="numerical-tax.html"><a href="numerical-tax.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="numerical-tax.html"><a href="numerical-tax.html#objectives"><i class="fa fa-check"></i><b>3.1.1</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="numerical-tax.html"><a href="numerical-tax.html#whirlwind-tour"><i class="fa fa-check"></i><b>3.2</b> Whirlwind Tour</a><ul>
<li class="chapter" data-level="3.2.1" data-path="numerical-tax.html"><a href="numerical-tax.html#similarity-disimilarty-and-distance"><i class="fa fa-check"></i><b>3.2.1</b> Similarity, Disimilarty, and Distance</a></li>
<li class="chapter" data-level="3.2.2" data-path="numerical-tax.html"><a href="numerical-tax.html#standardization-of-characteristics"><i class="fa fa-check"></i><b>3.2.2</b> Standardization of Characteristics</a></li>
<li class="chapter" data-level="3.2.3" data-path="numerical-tax.html"><a href="numerical-tax.html#missing-data"><i class="fa fa-check"></i><b>3.2.3</b> Missing Data</a></li>
<li class="chapter" data-level="3.2.4" data-path="numerical-tax.html"><a href="numerical-tax.html#visualizing-pair-wise-distances-the-dendrogram"><i class="fa fa-check"></i><b>3.2.4</b> Visualizing Pair-Wise Distances: The Dendrogram</a></li>
<li class="chapter" data-level="3.2.5" data-path="numerical-tax.html"><a href="numerical-tax.html#re-arranging-a-dendrogram-for-clarity"><i class="fa fa-check"></i><b>3.2.5</b> Re-arranging a Dendrogram for Clarity</a></li>
<li class="chapter" data-level="3.2.6" data-path="numerical-tax.html"><a href="numerical-tax.html#cluster-analysis-finding-groups-in-data"><i class="fa fa-check"></i><b>3.2.6</b> Cluster Analysis: Finding Groups in Data</a></li>
<li class="chapter" data-level="3.2.7" data-path="numerical-tax.html"><a href="numerical-tax.html#ordination-visualization-in-a-reduced-space"><i class="fa fa-check"></i><b>3.2.7</b> Ordination: Visualization in a Reduced Space</a></li>
<li class="chapter" data-level="3.2.8" data-path="numerical-tax.html"><a href="numerical-tax.html#review-and-discuss-4"><i class="fa fa-check"></i><b>3.2.8</b> Review and Discuss</a></li>
<li class="chapter" data-level="3.2.9" data-path="numerical-tax.html"><a href="numerical-tax.html#pair-wise-distances-between-soil-profiles"><i class="fa fa-check"></i><b>3.2.9</b> Pair-Wise Distances Between Soil Profiles</a></li>
<li class="chapter" data-level="3.2.10" data-path="numerical-tax.html"><a href="numerical-tax.html#final-discussion"><i class="fa fa-check"></i><b>3.2.10</b> Final Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="numerical-tax.html"><a href="numerical-tax.html#excercises"><i class="fa fa-check"></i><b>3.3</b> Excercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="numerical-tax.html"><a href="numerical-tax.html#set-up-the-r-session"><i class="fa fa-check"></i><b>3.3.1</b> Set Up the R Session</a></li>
<li class="chapter" data-level="3.3.2" data-path="numerical-tax.html"><a href="numerical-tax.html#evaluating-missing-data"><i class="fa fa-check"></i><b>3.3.2</b> Evaluating Missing Data</a></li>
<li class="chapter" data-level="3.3.3" data-path="numerical-tax.html"><a href="numerical-tax.html#more-on-the-distance-matrix-and-how-to-make-one"><i class="fa fa-check"></i><b>3.3.3</b> More on the Distance Matrix and How to Make One</a></li>
<li class="chapter" data-level="3.3.4" data-path="numerical-tax.html"><a href="numerical-tax.html#hierachrical-clustering"><i class="fa fa-check"></i><b>3.3.4</b> Hierachrical Clustering</a></li>
<li class="chapter" data-level="3.3.5" data-path="numerical-tax.html"><a href="numerical-tax.html#centroid-and-medoid-partitioning-clustering-1"><i class="fa fa-check"></i><b>3.3.5</b> Centroid and Medoid (Partitioning) Clustering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="numerical-tax.html"><a href="numerical-tax.html#practical-applications"><i class="fa fa-check"></i><b>3.4</b> Practical Applications</a><ul>
<li class="chapter" data-level="3.4.1" data-path="numerical-tax.html"><a href="numerical-tax.html#pair-wise-distances-between-soil-profiles-1"><i class="fa fa-check"></i><b>3.4.1</b> Pair-Wise Distances Between Soil Profiles</a></li>
<li class="chapter" data-level="3.4.2" data-path="numerical-tax.html"><a href="numerical-tax.html#pair-wise-distances-between-soil-series"><i class="fa fa-check"></i><b>3.4.2</b> Pair-Wise Distances Between Soil Series</a></li>
<li class="chapter" data-level="3.4.3" data-path="numerical-tax.html"><a href="numerical-tax.html#pair-wise-distances-between-subgroup-level-taxa"><i class="fa fa-check"></i><b>3.4.3</b> Pair-Wise Distances Between Subgroup-Level Taxa</a></li>
<li class="chapter" data-level="3.4.4" data-path="numerical-tax.html"><a href="numerical-tax.html#soil-color-signatures"><i class="fa fa-check"></i><b>3.4.4</b> Soil Color Signatures</a></li>
<li class="chapter" data-level="3.4.5" data-path="numerical-tax.html"><a href="numerical-tax.html#clustering-of-soil-colors"><i class="fa fa-check"></i><b>3.4.5</b> Clustering of Soil Colors</a></li>
<li class="chapter" data-level="3.4.6" data-path="numerical-tax.html"><a href="numerical-tax.html#how-do-the-interpretations-compare"><i class="fa fa-check"></i><b>3.4.6</b> “How Do the Interpretations Compare?”</a></li>
<li class="chapter" data-level="3.4.7" data-path="numerical-tax.html"><a href="numerical-tax.html#mlra-concepts-via-climate-and-elevation-samples"><i class="fa fa-check"></i><b>3.4.7</b> MLRA Concepts via Climate and Elevation Samples</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="numerical-tax.html"><a href="numerical-tax.html#references-numerical-taxonomy-and-ordination"><i class="fa fa-check"></i><b>3.5</b> References (Numerical Taxonomy and Ordination)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-example"><i class="fa fa-check"></i><b>4.2</b> Linear Regression Example</a></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-regression.html"><a href="linear-regression.html#henry-mount-database"><i class="fa fa-check"></i><b>4.3.1</b> Henry Mount Database</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-regression.html"><a href="linear-regression.html#aggregate-time-series"><i class="fa fa-check"></i><b>4.3.2</b> Aggregate Time Series</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-regression.html"><a href="linear-regression.html#final-dataset"><i class="fa fa-check"></i><b>4.3.3</b> Final Dataset</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression.html"><a href="linear-regression.html#spatial-data"><i class="fa fa-check"></i><b>4.4</b> Spatial data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-regression.html"><a href="linear-regression.html#plot-coordinates"><i class="fa fa-check"></i><b>4.4.1</b> Plot Coordinates</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-regression.html"><a href="linear-regression.html#extracting-spatial-data"><i class="fa fa-check"></i><b>4.4.2</b> Extracting Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-regression.html"><a href="linear-regression.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>4.5</b> Exploratory Data Analysis (EDA)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="linear-regression.html"><a href="linear-regression.html#compare-samples-vs-population"><i class="fa fa-check"></i><b>4.5.1</b> Compare Samples vs Population</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="linear-regression.html"><a href="linear-regression.html#linear-modeling"><i class="fa fa-check"></i><b>4.6</b> Linear modeling</a><ul>
<li class="chapter" data-level="4.6.1" data-path="linear-regression.html"><a href="linear-regression.html#diagnostics"><i class="fa fa-check"></i><b>4.6.1</b> Diagnostics</a></li>
<li class="chapter" data-level="4.6.2" data-path="linear-regression.html"><a href="linear-regression.html#variable-selection-model-validation"><i class="fa fa-check"></i><b>4.6.2</b> Variable selection &amp; model validation</a></li>
<li class="chapter" data-level="4.6.3" data-path="linear-regression.html"><a href="linear-regression.html#final-model-accuracy-assessment"><i class="fa fa-check"></i><b>4.6.3</b> Final model &amp; accuracy assessment</a></li>
<li class="chapter" data-level="4.6.4" data-path="linear-regression.html"><a href="linear-regression.html#model-effects"><i class="fa fa-check"></i><b>4.6.4</b> Model Effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="linear-regression.html"><a href="linear-regression.html#generate-spatial-predictions"><i class="fa fa-check"></i><b>4.7</b> Generate spatial predictions</a></li>
<li class="chapter" data-level="4.8" data-path="linear-regression.html"><a href="linear-regression.html#create-map"><i class="fa fa-check"></i><b>4.8</b> Create Map</a></li>
<li class="chapter" data-level="4.9" data-path="linear-regression.html"><a href="linear-regression.html#literature"><i class="fa fa-check"></i><b>4.9</b> Literature</a></li>
<li class="chapter" data-level="4.10" data-path="linear-regression.html"><a href="linear-regression.html#additional-reading-1"><i class="fa fa-check"></i><b>4.10</b> Additional reading</a></li>
<li class="chapter" data-level="4.11" data-path="linear-regression.html"><a href="linear-regression.html#references-linear-models"><i class="fa fa-check"></i><b>4.11</b> References (Linear Models)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>5</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="5.1" data-path="glm.html"><a href="glm.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="glm.html"><a href="glm.html#logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="5.3" data-path="glm.html"><a href="glm.html#examples"><i class="fa fa-check"></i><b>5.3</b> Examples</a></li>
<li class="chapter" data-level="5.4" data-path="glm.html"><a href="glm.html#exercise"><i class="fa fa-check"></i><b>5.4</b> Exercise</a><ul>
<li class="chapter" data-level="5.4.1" data-path="glm.html"><a href="glm.html#load-packages"><i class="fa fa-check"></i><b>5.4.1</b> Load packages</a></li>
<li class="chapter" data-level="5.4.2" data-path="glm.html"><a href="glm.html#read-in-data"><i class="fa fa-check"></i><b>5.4.2</b> Read in data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="glm.html"><a href="glm.html#exploratory-analysis-eda"><i class="fa fa-check"></i><b>5.5</b> Exploratory analysis (EDA)</a><ul>
<li class="chapter" data-level="5.5.1" data-path="glm.html"><a href="glm.html#data-wrangling"><i class="fa fa-check"></i><b>5.5.1</b> Data wrangling</a></li>
<li class="chapter" data-level="5.5.2" data-path="glm.html"><a href="glm.html#geomorphic-data"><i class="fa fa-check"></i><b>5.5.2</b> Geomorphic data</a></li>
<li class="chapter" data-level="5.5.3" data-path="glm.html"><a href="glm.html#soil-scientist-bias"><i class="fa fa-check"></i><b>5.5.3</b> Soil Scientist Bias</a></li>
<li class="chapter" data-level="5.5.4" data-path="glm.html"><a href="glm.html#plot-coordinates-1"><i class="fa fa-check"></i><b>5.5.4</b> Plot coordinates</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="glm.html"><a href="glm.html#exercise-1-view-the-data-in-arcgis"><i class="fa fa-check"></i><b>5.6</b> Exercise 1: View the data in ArcGIS</a><ul>
<li class="chapter" data-level="5.6.1" data-path="glm.html"><a href="glm.html#extracting-spatial-data-1"><i class="fa fa-check"></i><b>5.6.1</b> Extracting spatial data</a></li>
<li class="chapter" data-level="5.6.2" data-path="glm.html"><a href="glm.html#examine-spatial-data"><i class="fa fa-check"></i><b>5.6.2</b> Examine spatial data</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="glm.html"><a href="glm.html#constructing-the-model"><i class="fa fa-check"></i><b>5.7</b> Constructing the model</a><ul>
<li class="chapter" data-level="5.7.1" data-path="glm.html"><a href="glm.html#diagnostic"><i class="fa fa-check"></i><b>5.7.1</b> Diagnostic</a></li>
<li class="chapter" data-level="5.7.2" data-path="glm.html"><a href="glm.html#variable-selection-model-validation-1"><i class="fa fa-check"></i><b>5.7.2</b> Variable Selection &amp; model validation</a></li>
<li class="chapter" data-level="5.7.3" data-path="glm.html"><a href="glm.html#final-model-accuracy"><i class="fa fa-check"></i><b>5.7.3</b> Final model &amp; accuracy</a></li>
<li class="chapter" data-level="5.7.4" data-path="glm.html"><a href="glm.html#model-effects-1"><i class="fa fa-check"></i><b>5.7.4</b> Model effects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="glm.html"><a href="glm.html#generate-spatial-predictions-1"><i class="fa fa-check"></i><b>5.8</b> Generate spatial predictions</a></li>
<li class="chapter" data-level="5.9" data-path="glm.html"><a href="glm.html#exercise-2-view-the-prediction-in-arcgis"><i class="fa fa-check"></i><b>5.9</b> Exercise 2: View the prediction in ArcGIS</a></li>
<li class="chapter" data-level="5.10" data-path="glm.html"><a href="glm.html#additional-reading-2"><i class="fa fa-check"></i><b>5.10</b> Additional reading</a></li>
<li class="chapter" data-level="5.11" data-path="glm.html"><a href="glm.html#literature-cited"><i class="fa fa-check"></i><b>5.11</b> Literature Cited</a></li>
<li class="chapter" data-level="5.12" data-path="glm.html"><a href="glm.html#references-glm"><i class="fa fa-check"></i><b>5.12</b> References (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tree-based-models.html"><a href="tree-based-models.html"><i class="fa fa-check"></i><b>6</b> Tree-based Models</a><ul>
<li class="chapter" data-level="6.1" data-path="tree-based-models.html"><a href="tree-based-models.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="tree-based-models.html"><a href="tree-based-models.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>6.2</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="6.2.1" data-path="tree-based-models.html"><a href="tree-based-models.html#getting-data-into-r-and-exporting-to-shapefile"><i class="fa fa-check"></i><b>6.2.1</b> Getting Data Into R and Exporting to Shapefile</a></li>
<li class="chapter" data-level="6.2.2" data-path="tree-based-models.html"><a href="tree-based-models.html#examining-data-in-r"><i class="fa fa-check"></i><b>6.2.2</b> Examining Data in R</a></li>
<li class="chapter" data-level="6.2.3" data-path="tree-based-models.html"><a href="tree-based-models.html#exercise-1"><i class="fa fa-check"></i><b>6.2.3</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tree-based-models.html"><a href="tree-based-models.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>6.3</b> Classification and Regression Trees (CART)</a><ul>
<li class="chapter" data-level="6.3.1" data-path="tree-based-models.html"><a href="tree-based-models.html#exercise-2-rpart"><i class="fa fa-check"></i><b>6.3.1</b> Exercise 2: rpart</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tree-based-models.html"><a href="tree-based-models.html#random-forest"><i class="fa fa-check"></i><b>6.4</b> Random Forest</a><ul>
<li class="chapter" data-level="6.4.1" data-path="tree-based-models.html"><a href="tree-based-models.html#exercise-3-randomforest"><i class="fa fa-check"></i><b>6.4.1</b> Exercise 3: randomForest</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tree-based-models.html"><a href="tree-based-models.html#prediction-using-tree-based-models"><i class="fa fa-check"></i><b>6.5</b> Prediction using Tree-based Models</a></li>
<li class="chapter" data-level="6.6" data-path="tree-based-models.html"><a href="tree-based-models.html#summary"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="tree-based-models.html"><a href="tree-based-models.html#additional-reading-3"><i class="fa fa-check"></i><b>6.7</b> Additional Reading</a></li>
<li class="chapter" data-level="6.8" data-path="tree-based-models.html"><a href="tree-based-models.html#references-tree-based-models"><i class="fa fa-check"></i><b>6.8</b> References (Tree-based Models)</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html"><i class="fa fa-check"></i><b>A</b> Accuracy and Uncertainty for Categorical Predictions</a><ul>
<li class="chapter" data-level="A.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#status-quo"><i class="fa fa-check"></i><b>A.1</b> Status Quo</a></li>
<li class="chapter" data-level="A.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#theses"><i class="fa fa-check"></i><b>A.2</b> Theses</a></li>
<li class="chapter" data-level="A.3" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#soap-box-time"><i class="fa fa-check"></i><b>A.3</b> Soap Box Time</a></li>
<li class="chapter" data-level="A.4" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#concept-demonstration-via-simulated-data"><i class="fa fa-check"></i><b>A.4</b> Concept Demonstration via Simulated Data</a></li>
<li class="chapter" data-level="A.5" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#accuracy"><i class="fa fa-check"></i><b>A.5</b> Accuracy</a><ul>
<li class="chapter" data-level="A.5.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#confusion-matrix-area-under-roc"><i class="fa fa-check"></i><b>A.5.1</b> Confusion Matrix / Area Under ROC</a></li>
<li class="chapter" data-level="A.5.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#brier-scores"><i class="fa fa-check"></i><b>A.5.2</b> Brier Scores</a></li>
<li class="chapter" data-level="A.5.3" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#tau-and-weighted-tau-class-similarity"><i class="fa fa-check"></i><b>A.5.3</b> Tau and Weighted Tau (class-similarity)</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#uncertainty-1"><i class="fa fa-check"></i><b>A.6</b> Uncertainty</a><ul>
<li class="chapter" data-level="A.6.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#shanon-entropy"><i class="fa fa-check"></i><b>A.6.1</b> Shanon Entropy</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#review"><i class="fa fa-check"></i><b>A.7</b> Review</a></li>
<li class="chapter" data-level="A.8" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#example-implementation"><i class="fa fa-check"></i><b>A.8</b> Example Implementation</a></li>
<li class="chapter" data-level="A.9" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#resources"><i class="fa fa-check"></i><b>A.9</b> Resources</a><ul>
<li class="chapter" data-level="A.9.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#evaluating-accuracy-of-categorical-probabilistic-predictions"><i class="fa fa-check"></i><b>A.9.1</b> Evaluating Accuracy of Categorical / Probabilistic Predictions</a></li>
<li class="chapter" data-level="A.9.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#sampling-and-stability-of-estimates"><i class="fa fa-check"></i><b>A.9.2</b> Sampling and Stability of Estimates</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#references-class-accuracy-uncertainty"><i class="fa fa-check"></i><b>A.10</b> References (Class Accuracy / Uncertainty)</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="commentary-selecting-a-modeling-framework.html"><a href="commentary-selecting-a-modeling-framework.html"><i class="fa fa-check"></i><b>B</b> Commentary: Selecting a Modeling Framework</a><ul>
<li class="chapter" data-level="B.1" data-path="commentary-selecting-a-modeling-framework.html"><a href="commentary-selecting-a-modeling-framework.html#soil-temperature-regime-modeling-in-ca792"><i class="fa fa-check"></i><b>B.1</b> Soil Temperature Regime Modeling in CA792</a></li>
<li class="chapter" data-level="B.2" data-path="commentary-selecting-a-modeling-framework.html"><a href="commentary-selecting-a-modeling-framework.html#references-modeling-frameworks"><i class="fa fa-check"></i><b>B.2</b> References (Modeling Frameworks)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Soil Survey - Part 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glm" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Generalized Linear Models</h1>
<p><img src="static-figures/logo.jpg" /></p>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>Generalized linear models (GLM) as the name implies are a generalization of the linear modeling framework to allow for the modeling of response variables (e.g. soil attributes) with non-normal distributions and heterogeneous variances. Whereas linear models are designed for predicting continuous soil properties such as clay content or soil temperature, GLM can be used to predict the presence/absence of argillic horizons (i.e. logistic regression) or counts of a plant species along a transect (i.e. Poisson regression). These generalizations greatly expand the applicability of the linear modeling framework, while still allowing for a similar fitting procedure and interpretation of the resulting models.</p>
<p>In the past in order to handle non-linearity and heterogeneous variances, transformations have been made to the response variable, such as the log(x). However, such transformations complicate the models interpretation because the results refer to the transformed scale (e.g. log(x)). These response transformations are not guaranteed to achieve both normality and constant variance simultaneously. GLM approaches transform the response, but also preserve the scale of the response, and provide separate functions to transform the mean response and variance, known as the link and variance functions respectively. So instead of looking like this:</p>
<p><span class="math inline">\(f(y) = \beta_{0} + \beta_{1}x + \varepsilon\)</span></p>
<p>you get this:</p>
<p><span class="math inline">\(g(\mu)\)</span> or <span class="math inline">\(\eta = \beta_{0} + \beta_{1}x + \varepsilon\)</span></p>
<p>with <span class="math inline">\(g(\mu)\)</span> or <span class="math inline">\(\eta\)</span> symbolizing the link function.</p>
<p>Another alteration of the classical linear model is that with GLM the coefficients are estimated iteratively by maximum likelihood estimation instead of ordinary least squares. This results in the GLM minimizing the deviance, instead of the sum of squares. However, for the Gaussian (i.e. normal) distributions the deviance and sum of squares are equivalent.</p>
</div>
<div id="logistic-regression" class="section level2">
<h2><span class="header-section-number">5.2</span> Logistic Regression</h2>
<p>Logistic regression is a specific type of GLM designed to model data that has a binomial distribution (i.e. presence/absence, yes/no, or proportional data), which in statistical learning parlance is considered a classification problem. For binomial data the logit link transform is generally used. The effect of the logit transform can be seen in the following figure. It creates a sigmoidal curve, which enhances the separation between the two groups. It also has the effect of ensuring that the values range between 0 and 1.</p>
<p><img src="005-glm_files/figure-html/logit-function-1.png" width="672" /></p>
<p>When comparing a simple linear model vs a simple logistic model we can see the effect of the logit transform on the relationship between the response and predictor variable. As before it follows a sigmoidal curve and prevents predictions from exceeding 0 and 1.</p>
<p><img src="005-glm_files/figure-html/logit-example-1.png" width="768" /></p>
</div>
<div id="examples" class="section level2">
<h2><span class="header-section-number">5.3</span> Examples</h2>
<div class="figure">
<img src="static-figures/mollisol.png" alt="" />
<p class="caption">Example 1: Probability of Mollisols (Beaudette &amp; O’Geen, 2009)</p>
</div>
<div class="figure">
<img src="static-figures/redclay.png" alt="" />
<p class="caption">Example 2: Probability of Red Clay (Evans &amp; Hartemink, 2014)</p>
</div>
<div class="figure">
<img src="static-figures/ponded.png" alt="" />
<p class="caption">Example 3: Probability of Ponding (NRCS Unpublished)</p>
</div>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">5.4</span> Exercise</h2>
<p>Now that we’ve discussed some of the basic background GLM theory we’ll move on to a real exercise, and address any additional theory where it relates to specific steps in the modeling process. The examples selected for this chapter come from Joshua Tree National Park (JTNP)(i.e. CA794) in the Mojave desert. The problem tackled here is a familiar one: Where can I expect to find argillic horizons on fan piedmonts? Argillic horizons within the Mojave are typically found on fan remnants, which are a stable landform that is a remnant of the Pleistocene (Peterson, 1981). Despite the low relief of most fans, fan remnants are uplands in the sense that they generally don’t receive run-on or active deposition.</p>
<p>With this dataset we’ll encounter some challenges. To start with, fan piedmont landscapes typically have relatively little relief. Since most of our predictors will be derivatives of elevation, that won’t leave us with much to work with. Also, our elevation data comes from the USGS National Elevation dataset (NED), which provides considerably less detail than say LiDAR or IFSAR data (Shi et al., 2012). Lastly our pedon dataset like most in NASIS, hasn’t received near as much quality control as have the components. So we’ll need to wrangle some of the pedon data before we can analyze it. These are all typical problems encountered in any data analysis and should be good practice. Ideally, it would be more interesting to try and model individual soil series with argillic horizons, but due to some of the challenges previously mentioned it would be difficult with this dataset. However, at the end we’ll look at one simple approach to try and separate individual soil series with argillic horizons.</p>
<div id="load-packages" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Load packages</h3>
<p>To start, as always we need to load some extra packages. This will become a familiar routine every time you start R. Most of the basic functions we need to develop a logistic regression model are contained in base R, but the following contain some useful spatial and data manipulation functions. Believe it or not we will use all of them and more.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="glm.html#cb157-1"></a><span class="kw">library</span>(aqp)     <span class="co"># specialized soil classes and functions</span></span>
<span id="cb157-2"><a href="glm.html#cb157-2"></a><span class="kw">library</span>(soilDB)  <span class="co"># NASIS and SDA import functions</span></span>
<span id="cb157-3"><a href="glm.html#cb157-3"></a><span class="kw">library</span>(raster)  <span class="co"># guess</span></span>
<span id="cb157-4"><a href="glm.html#cb157-4"></a><span class="kw">library</span>(sf)      <span class="co"># vector data functions</span></span>
<span id="cb157-5"><a href="glm.html#cb157-5"></a><span class="co"># library(mapview) # interactive mapping</span></span>
<span id="cb157-6"><a href="glm.html#cb157-6"></a><span class="kw">library</span>(ggplot2) <span class="co"># graphing</span></span>
<span id="cb157-7"><a href="glm.html#cb157-7"></a><span class="kw">library</span>(tidyr)   <span class="co"># data manipulation</span></span>
<span id="cb157-8"><a href="glm.html#cb157-8"></a><span class="kw">library</span>(caret)   <span class="co"># classification and regression training</span></span>
<span id="cb157-9"><a href="glm.html#cb157-9"></a><span class="kw">library</span>(car)     <span class="co"># additional regression tools</span></span></code></pre></div>
</div>
<div id="read-in-data" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Read in data</h3>
<p>Hopefully like all good soil scientists and ecological site specialists you enter your field data into NASIS. Better yet hopefully someone else did it for you! Once data are captured in NASIS it is much easier to import the data into R, extract the pieces you need, manipulate it, model it, etc. If it’s not entered into NASIS, it may as well not exist. For this exercise we’ll load a cached dataset on GitHub.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="glm.html#cb158-1"></a><span class="co"># pedons &lt;- fetchNASIS()</span></span>
<span id="cb158-2"><a href="glm.html#cb158-2"></a>githubURL &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/ncss-tech/stats_for_soil_survey/master/data/ch7_data.Rdata&quot;</span></span>
<span id="cb158-3"><a href="glm.html#cb158-3"></a><span class="kw">load</span>(<span class="kw">url</span>(githubURL))</span>
<span id="cb158-4"><a href="glm.html#cb158-4"></a></span>
<span id="cb158-5"><a href="glm.html#cb158-5"></a><span class="co"># Examine the makeup of the data we imported from NASIS</span></span>
<span id="cb158-6"><a href="glm.html#cb158-6"></a><span class="kw">str</span>(pedons, <span class="dt">max.level =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Formal class &#39;SoilProfileCollection&#39; [package &quot;aqp&quot;] with 9 slots
##   ..@ idcol       : chr &quot;peiid&quot;
##   ..@ hzidcol     : chr &quot;phiid&quot;
##   ..@ depthcols   : chr [1:2] &quot;hzdept&quot; &quot;hzdepb&quot;
##   ..@ metadata    :&#39;data.frame&#39;: 1 obs. of  2 variables:
##   ..@ horizons    :&#39;data.frame&#39;: 5163 obs. of  54 variables:
##   ..@ site        :&#39;data.frame&#39;: 1220 obs. of  122 variables:
##   ..@ sp          :Formal class &#39;SpatialPoints&#39; [package &quot;sp&quot;] with 3 slots
##   ..@ diagnostic  :&#39;data.frame&#39;: 2161 obs. of  4 variables:
##   ..@ restrictions:&#39;data.frame&#39;: 0 obs. of  0 variables</code></pre>
</div>
</div>
<div id="exploratory-analysis-eda" class="section level2">
<h2><span class="header-section-number">5.5</span> Exploratory analysis (EDA)</h2>
<div id="data-wrangling" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Data wrangling</h3>
<p>Generally before we begin modeling you should spend some time exploring the data. By examining a simple summary we can quickly see the breakdown of how many argillic horizons we have. Unfortunately, odds are good that all the argillic horizons haven’t been consistently populated in the diagnostic horizon table like they should be. Luckily for us, the desert argillic horizons always pop up in the taxonomic name, so we can use pattern matching to extract it. By doing this we gain an additional 11 pedons with argillic horizons and are able to label the missing values (i.e. NA). At a minimum for modeling purposes we probably need 10 pedons of the target we’re interested in and a total of 100 observations overall.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="glm.html#cb160-1"></a><span class="co"># Check consistency of argillic horizon population</span></span>
<span id="cb160-2"><a href="glm.html#cb160-2"></a></span>
<span id="cb160-3"><a href="glm.html#cb160-3"></a><span class="co"># get the site table</span></span>
<span id="cb160-4"><a href="glm.html#cb160-4"></a>s &lt;-<span class="st"> </span><span class="kw">site</span>(pedons) </span></code></pre></div>
<pre><code>## aqp_df_class metadata entry not found - run aqp::rebuildSPC() to fix</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="glm.html#cb162-1"></a><span class="co"># tabulate the number of argillic horizons observed</span></span>
<span id="cb162-2"><a href="glm.html#cb162-2"></a><span class="kw">table</span>(s<span class="op">$</span>argillic.horizon, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>) </span></code></pre></div>
<pre><code>## 
## FALSE  TRUE  &lt;NA&gt; 
##   790   263   167</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="glm.html#cb164-1"></a><span class="co"># or</span></span>
<span id="cb164-2"><a href="glm.html#cb164-2"></a></span>
<span id="cb164-3"><a href="glm.html#cb164-3"></a><span class="co"># summary(s$argillic.horizon) </span></span>
<span id="cb164-4"><a href="glm.html#cb164-4"></a></span>
<span id="cb164-5"><a href="glm.html#cb164-5"></a><span class="co"># Extract argillic presence from the taxonomic subgroup</span></span>
<span id="cb164-6"><a href="glm.html#cb164-6"></a>s<span class="op">$</span>argillic &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;arg&quot;</span>, s<span class="op">$</span>taxsubgrp)</span>
<span id="cb164-7"><a href="glm.html#cb164-7"></a></span>
<span id="cb164-8"><a href="glm.html#cb164-8"></a><span class="kw">table</span>(s<span class="op">$</span>argillic, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##  1022   198</code></pre>
<p>Ideally, if the diagnostic horizon table had been populated consistently we could have used the upper depth to diagnostic feature to filter out argillic horizons that start below 50cm, which may not be representative of “good” argillic horizons and may therefore have gotten correlated to a Torripsamments anyway. Not only are unrepresentative sites confusing for scientists, they’re equally confusing for models. However, as we saw earlier, some pedons don’t appear to be fully populated, so we’ll stick with those pedons that have the argillic specified in their taxonomic subgroup name, since it gives us the biggest sample.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="glm.html#cb166-1"></a>d &lt;-<span class="st"> </span><span class="kw">diagnostic_hz</span>(pedons)</span></code></pre></div>
<pre><code>## aqp_df_class metadata entry not found - run aqp::rebuildSPC() to fix</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="glm.html#cb168-1"></a>d_sub &lt;-<span class="st"> </span><span class="kw">subset</span>(d, featkind <span class="op">==</span><span class="st"> &quot;argillic horizon&quot;</span> <span class="op">&amp;</span><span class="st"> </span>featdept <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>)</span>
<span id="cb168-2"><a href="glm.html#cb168-2"></a></span>
<span id="cb168-3"><a href="glm.html#cb168-3"></a>s<span class="op">$</span>argillic.horizon50 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(s<span class="op">$</span>peiid <span class="op">%in%</span><span class="st"> </span>d_sub<span class="op">$</span>peiid, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</span>
<span id="cb168-4"><a href="glm.html#cb168-4"></a></span>
<span id="cb168-5"><a href="glm.html#cb168-5"></a><span class="kw">table</span>(s<span class="op">$</span>argillic.horizon50, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   998   222</code></pre>
</div>
<div id="geomorphic-data" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Geomorphic data</h3>
<p>Another obvious place to look is at the geomorphic data in the site table. This information is intended to help differentiate where our soil observations exist on the landscape. If populated consistently it could potentially be used in future disaggregation efforts, as demonstrated by Nauman and Thompson (2014).</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="glm.html#cb170-1"></a><span class="co"># Landform vs argillic presence</span></span>
<span id="cb170-2"><a href="glm.html#cb170-2"></a></span>
<span id="cb170-3"><a href="glm.html#cb170-3"></a><span class="co"># Subset</span></span>
<span id="cb170-4"><a href="glm.html#cb170-4"></a>s_sub &lt;-<span class="st"> </span><span class="kw">subset</span>(s, argillic <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</span>
<span id="cb170-5"><a href="glm.html#cb170-5"></a></span>
<span id="cb170-6"><a href="glm.html#cb170-6"></a><span class="co"># Cross tabulate landform vs argillic horizon presence</span></span>
<span id="cb170-7"><a href="glm.html#cb170-7"></a>test &lt;-<span class="st"> </span><span class="kw">with</span>(s_sub, </span>
<span id="cb170-8"><a href="glm.html#cb170-8"></a>             <span class="kw">table</span>(landform, argillic, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span>
<span id="cb170-9"><a href="glm.html#cb170-9"></a>             )</span>
<span id="cb170-10"><a href="glm.html#cb170-10"></a><span class="co"># Subset and print landform.string with &gt; 3 observations</span></span>
<span id="cb170-11"><a href="glm.html#cb170-11"></a>test[test <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>, ]</span></code></pre></div>
<pre><code>##              alluvial fans                 fan aprons 
##                          6                         19 
## fan aprons on fan remnants               fan remnants 
##                          4                         72 
##                      hills                 hillslopes 
##                         15                         28 
##                  low hills            mountain slopes 
##                          5                          8 
##                  mountains                  pediments 
##                          4                          9 
##                       &lt;NA&gt; 
##                          7</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="glm.html#cb172-1"></a><span class="co"># generalize the landform.string</span></span>
<span id="cb172-2"><a href="glm.html#cb172-2"></a>s<span class="op">$</span>landform_generic &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;fan|terrace|sheet|drainageway|wash&quot;</span>, s<span class="op">$</span>landform), <span class="st">&quot;fan&quot;</span>, <span class="st">&quot;hill&quot;</span>) </span></code></pre></div>
<p>Examining the above frequency table we can see that argillic horizons occur predominantly on fan remnants as was alluded too earlier. However, they also seem to occur frequently on other landforms - some of which are curious combinations of landforms or redundant terms.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="glm.html#cb173-1"></a><span class="co"># Hillslope position</span></span>
<span id="cb173-2"><a href="glm.html#cb173-2"></a></span>
<span id="cb173-3"><a href="glm.html#cb173-3"></a><span class="co"># Subset fan landforms</span></span>
<span id="cb173-4"><a href="glm.html#cb173-4"></a>s_sub &lt;-<span class="st"> </span><span class="kw">subset</span>(s, landform_generic <span class="op">==</span><span class="st"> &quot;fan&quot;</span>) </span>
<span id="cb173-5"><a href="glm.html#cb173-5"></a></span>
<span id="cb173-6"><a href="glm.html#cb173-6"></a><span class="co"># Cross tabulate and calculate proportions, the &quot;2&quot; calculates the proportions relative to the column totals</span></span>
<span id="cb173-7"><a href="glm.html#cb173-7"></a><span class="kw">with</span>(s_sub, <span class="kw">round</span>(</span>
<span id="cb173-8"><a href="glm.html#cb173-8"></a>  <span class="kw">prop.table</span>(<span class="kw">table</span>(hillslopeprof, argillic, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>), <span class="dv">2</span>)</span>
<span id="cb173-9"><a href="glm.html#cb173-9"></a>  <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb173-10"><a href="glm.html#cb173-10"></a>  ) </span></code></pre></div>
<pre><code>##              argillic
## hillslopeprof FALSE TRUE
##     summit       16   39
##     shoulder      4    2
##     backslope    14   20
##     footslope     2    1
##     toeslope     16    4
##     &lt;NA&gt;         48   34</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="glm.html#cb175-1"></a><span class="co"># Slope shape</span></span>
<span id="cb175-2"><a href="glm.html#cb175-2"></a><span class="kw">with</span>(s_sub, <span class="kw">round</span>(</span>
<span id="cb175-3"><a href="glm.html#cb175-3"></a>  <span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">paste</span>(shapedown, shapeacross), argillic, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>), <span class="dv">2</span>)</span>
<span id="cb175-4"><a href="glm.html#cb175-4"></a>  <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb175-5"><a href="glm.html#cb175-5"></a>  )</span></code></pre></div>
<pre><code>##                  argillic
##                   FALSE TRUE
##   concave concave     1    0
##   concave convex      0    0
##   concave linear      4    3
##   convex concave      0    1
##   convex convex       7    7
##   convex linear       6    9
##   linear concave      6    1
##   linear convex      21   32
##   linear linear      44   38
##   linear NA           0    0
##   NA NA              11   10</code></pre>
<p>Looking at the hillslope position of fan landforms we can see a slightly higher proportion of argillic horizons are found on summits, while less are found on toeslopes. Slope shape doesn’t seem to provide any useful information for distinguishing argillic horizons.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="glm.html#cb177-1"></a><span class="co"># Subset to just look and fans, and select numeric columns</span></span>
<span id="cb177-2"><a href="glm.html#cb177-2"></a>s_sub &lt;-<span class="st"> </span><span class="kw">subset</span>(s, landform_generic <span class="op">==</span><span class="st"> &quot;fan&quot;</span>, <span class="dt">select =</span> <span class="kw">c</span>(argillic, bedrckdepth, slope, elev, surface_total_frags_pct)) </span>
<span id="cb177-3"><a href="glm.html#cb177-3"></a></span>
<span id="cb177-4"><a href="glm.html#cb177-4"></a><span class="co"># convert s_sub to wide data format</span></span>
<span id="cb177-5"><a href="glm.html#cb177-5"></a>s_w &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(s_sub, <span class="dt">id.vars =</span> <span class="st">&quot;argillic&quot;</span>, <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;bedrckdepth&quot;</span>, <span class="st">&quot;slope&quot;</span>, <span class="st">&quot;elev&quot;</span>, <span class="st">&quot;surface_total_frags_pct&quot;</span>))</span>
<span id="cb177-6"><a href="glm.html#cb177-6"></a><span class="kw">head</span>(s_w, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   argillic    variable value
## 1    FALSE bedrckdepth    NA
## 2    FALSE bedrckdepth    11</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="glm.html#cb179-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb179-2"><a href="glm.html#cb179-2"></a></span>
<span id="cb179-3"><a href="glm.html#cb179-3"></a><span class="kw">ggplot</span>(s_w, <span class="kw">aes</span>(<span class="dt">x =</span> argillic, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb179-4"><a href="glm.html#cb179-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb179-5"><a href="glm.html#cb179-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">scale =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 680 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="005-glm_files/figure-html/surface-1.png" width="672" /></p>
<p>Looking at boxplots of our numeric variables we can see none of them show much separation between the presense/absense of argillic horizons.</p>
</div>
<div id="soil-scientist-bias" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Soil Scientist Bias</h3>
<p>Next we’ll look at soil scientist bias. The question being: Are some soil scientists more likely to describe argillic horizons than others? Due to the excess number of soil scientist that have worked on CA794, including detailees, we’ve filtered the names of soil scientist to include just the top 3 mappers and given priority to the most senior soil scientists when they occur together.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="glm.html#cb181-1"></a><span class="co"># Custom function to filter out the top 3 soil scientists</span></span>
<span id="cb181-2"><a href="glm.html#cb181-2"></a>s &lt;-<span class="st"> </span><span class="kw">within</span>(s, {</span>
<span id="cb181-3"><a href="glm.html#cb181-3"></a>  old =<span class="st"> </span>descname</span>
<span id="cb181-4"><a href="glm.html#cb181-4"></a>  descname2 =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb181-5"><a href="glm.html#cb181-5"></a>  descname2[<span class="kw">grepl</span>(<span class="st">&quot;Stephen&quot;</span>, old)] =<span class="st"> &quot;Stephen&quot;</span> <span class="co"># least senior</span></span>
<span id="cb181-6"><a href="glm.html#cb181-6"></a>  descname2[<span class="kw">grepl</span>(<span class="st">&quot;Paul&quot;</span>,    old)] =<span class="st"> &quot;Paul&quot;</span></span>
<span id="cb181-7"><a href="glm.html#cb181-7"></a>  descname2[<span class="kw">grepl</span>(<span class="st">&quot;Peter&quot;</span>,   old)] =<span class="st"> &quot;Peter&quot;</span>   <span class="co"># most senior</span></span>
<span id="cb181-8"><a href="glm.html#cb181-8"></a>  })</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="glm.html#cb182-1"></a>s_sub &lt;-<span class="st"> </span><span class="kw">subset</span>(s, landform_generic <span class="op">==</span><span class="st"> &quot;fan&quot;</span>)</span>
<span id="cb182-2"><a href="glm.html#cb182-2"></a></span>
<span id="cb182-3"><a href="glm.html#cb182-3"></a><span class="co"># By frequency</span></span>
<span id="cb182-4"><a href="glm.html#cb182-4"></a><span class="kw">with</span>(s_sub, <span class="kw">table</span>(descname2, argillic, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>))</span></code></pre></div>
<pre><code>##          argillic
## descname2 FALSE TRUE
##   Paul       77   28
##   Peter     268   29
##   Stephen    66   13
##   &lt;NA&gt;      157   45</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="glm.html#cb184-1"></a><span class="co"># By proportion</span></span>
<span id="cb184-2"><a href="glm.html#cb184-2"></a><span class="kw">with</span>(s_sub, <span class="kw">round</span>(</span>
<span id="cb184-3"><a href="glm.html#cb184-3"></a>  <span class="kw">prop.table</span>(<span class="kw">table</span>(descname2, argillic), <span class="dt">margin =</span> <span class="dv">1</span>)</span>
<span id="cb184-4"><a href="glm.html#cb184-4"></a>  <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb184-5"><a href="glm.html#cb184-5"></a>  )</span></code></pre></div>
<pre><code>##          argillic
## descname2 FALSE TRUE
##   Paul       73   27
##   Peter      90   10
##   Stephen    84   16</code></pre>
<p>For fan landforms, one of the soil scientists seems more likely than the others to describe argillic horizons. However while this information is suggestive, it is far from definitive in showing a potential bias because it doesn’t take into account other factors. We’ll examine this more closely later.</p>
</div>
<div id="plot-coordinates-1" class="section level3">
<h3><span class="header-section-number">5.5.4</span> Plot coordinates</h3>
<p>Where do our points plot? To start we need to convert them to a spatial object first. Then we can create an interactive we map using <code>mapview</code>. Also, if we wish we can also export the locations as a Shapefile.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="glm.html#cb186-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb186-2"><a href="glm.html#cb186-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb186-3"><a href="glm.html#cb186-3"></a></span>
<span id="cb186-4"><a href="glm.html#cb186-4"></a><span class="co"># create an index to remove sites without coordinates</span></span>
<span id="cb186-5"><a href="glm.html#cb186-5"></a>idx &lt;-<span class="st"> </span><span class="kw">complete.cases</span>(s<span class="op">$</span>x_sdt, s<span class="op">$</span>y_std)</span>
<span id="cb186-6"><a href="glm.html#cb186-6"></a>s_sub &lt;-<span class="st"> </span>s[idx, ]</span>
<span id="cb186-7"><a href="glm.html#cb186-7"></a></span>
<span id="cb186-8"><a href="glm.html#cb186-8"></a><span class="co"># convert to sites to a spatial object</span></span>
<span id="cb186-9"><a href="glm.html#cb186-9"></a>s_sf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(s_sub,</span>
<span id="cb186-10"><a href="glm.html#cb186-10"></a>                 <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;x_std&quot;</span>, <span class="st">&quot;y_std&quot;</span>),</span>
<span id="cb186-11"><a href="glm.html#cb186-11"></a>                 <span class="dt">crs =</span> <span class="dv">4326</span></span>
<span id="cb186-12"><a href="glm.html#cb186-12"></a>                 ) <span class="op">%&gt;%</span></span>
<span id="cb186-13"><a href="glm.html#cb186-13"></a><span class="st">  </span><span class="co"># reproject</span></span>
<span id="cb186-14"><a href="glm.html#cb186-14"></a><span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">5070</span>)</span>
<span id="cb186-15"><a href="glm.html#cb186-15"></a></span>
<span id="cb186-16"><a href="glm.html#cb186-16"></a></span>
<span id="cb186-17"><a href="glm.html#cb186-17"></a><span class="co"># Read in soil survey area boundaries</span></span>
<span id="cb186-18"><a href="glm.html#cb186-18"></a>ca794 &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="dt">dsn =</span> <span class="st">&quot;D:/geodata/soils/soilsa_a_nrcs.shp&quot;</span>, <span class="dt">layer =</span> <span class="st">&quot;soilsa_a_nrcs&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb186-19"><a href="glm.html#cb186-19"></a><span class="st">  </span><span class="co"># subset out Joshua Tree National Park</span></span>
<span id="cb186-20"><a href="glm.html#cb186-20"></a><span class="st">  </span><span class="kw">filter</span>(areasymbol <span class="op">==</span><span class="st"> &quot;CA794&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb186-21"><a href="glm.html#cb186-21"></a><span class="st">  </span><span class="co"># reproject</span></span>
<span id="cb186-22"><a href="glm.html#cb186-22"></a><span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">5070</span>)</span>
<span id="cb186-23"><a href="glm.html#cb186-23"></a></span>
<span id="cb186-24"><a href="glm.html#cb186-24"></a></span>
<span id="cb186-25"><a href="glm.html#cb186-25"></a><span class="co"># Plot</span></span>
<span id="cb186-26"><a href="glm.html#cb186-26"></a><span class="kw">library</span>(mapview)</span>
<span id="cb186-27"><a href="glm.html#cb186-27"></a></span>
<span id="cb186-28"><a href="glm.html#cb186-28"></a><span class="co"># mapview(ca794, fill = NA) +</span></span>
<span id="cb186-29"><a href="glm.html#cb186-29"></a>  <span class="kw">mapview</span>(s_sf, <span class="dt">zcol =</span> <span class="st">&quot;argillic&quot;</span>)</span>
<span id="cb186-30"><a href="glm.html#cb186-30"></a></span>
<span id="cb186-31"><a href="glm.html#cb186-31"></a></span>
<span id="cb186-32"><a href="glm.html#cb186-32"></a><span class="co"># Write shapefile of pedons</span></span>
<span id="cb186-33"><a href="glm.html#cb186-33"></a><span class="kw">write_sf</span>(s_sf, <span class="dt">dsn =</span> <span class="st">&quot;C:/workspace2&quot;</span>, <span class="st">&quot;ca794_pedons&quot;</span>, <span class="dt">driver =</span> <span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">delete_dsn =</span>  <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="exercise-1-view-the-data-in-arcgis" class="section level2">
<h2><span class="header-section-number">5.6</span> Exercise 1: View the data in ArcGIS</h2>
<ul>
<li>Examine the interactive map or shapefile in ArcGIS along with our potential predictive variables.</li>
<li>Discuss with your group, and report your observations or hypotheses.</li>
</ul>
<div id="extracting-spatial-data-1" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Extracting spatial data</h3>
<p>Prior to any spatial analysis or modeling, you will need to develop a suite of geodata files that can be intersected with your field data locations. This is, in and of itself a difficult task, and should be facilitated by your Regional GIS Specialist. Typically, these geodata files would primarily consist of derivatives from a DEM or satellite imagery. Prior to any prediction it is also necessary to ensure the geodata files have the same projection, extent, and cell size. Once we have the necessary files we can construct a list in R of the file names and paths, read the geodata into R, and then extract the geodata values where they intersect with field data.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="glm.html#cb187-1"></a><span class="kw">library</span>(raster)</span>
<span id="cb187-2"><a href="glm.html#cb187-2"></a></span>
<span id="cb187-3"><a href="glm.html#cb187-3"></a><span class="co"># set file path</span></span>
<span id="cb187-4"><a href="glm.html#cb187-4"></a>folder &lt;-<span class="st"> &quot;D:/geodata/project_data/R8-VIC/ca794/&quot;</span></span>
<span id="cb187-5"><a href="glm.html#cb187-5"></a></span>
<span id="cb187-6"><a href="glm.html#cb187-6"></a><span class="co"># list of file names</span></span>
<span id="cb187-7"><a href="glm.html#cb187-7"></a>files &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb187-8"><a href="glm.html#cb187-8"></a>  <span class="dt">z      =</span> <span class="st">&quot;ned30m_8VIC.tif&quot;</span>, <span class="co"># elevation</span></span>
<span id="cb187-9"><a href="glm.html#cb187-9"></a>  <span class="dt">slp    =</span> <span class="st">&quot;ned30m_8VIC_slope5.tif&quot;</span>, <span class="co"># slope gradient</span></span>
<span id="cb187-10"><a href="glm.html#cb187-10"></a>  <span class="dt">asp    =</span> <span class="st">&quot;ned30m_8VIC_aspect5.tif&quot;</span>, <span class="co"># slope aspect</span></span>
<span id="cb187-11"><a href="glm.html#cb187-11"></a>  <span class="dt">twi    =</span> <span class="st">&quot;ned30m_8VIC_wetness.tif&quot;</span>, <span class="co"># topographic wetness index</span></span>
<span id="cb187-12"><a href="glm.html#cb187-12"></a>  <span class="dt">twi_sc =</span> <span class="st">&quot;ned30m_8VIC_wetness_sc.tif&quot;</span>, <span class="co"># transformed twi</span></span>
<span id="cb187-13"><a href="glm.html#cb187-13"></a>  <span class="dt">ch     =</span> <span class="st">&quot;ned30m_8VIC_cheight.tif&quot;</span>, <span class="co"># catchment height</span></span>
<span id="cb187-14"><a href="glm.html#cb187-14"></a>  <span class="dt">z2str  =</span> <span class="st">&quot;ned30m_8VIC_z2stream.tif&quot;</span>, <span class="co"># height above streams</span></span>
<span id="cb187-15"><a href="glm.html#cb187-15"></a>  <span class="dt">mrrtf  =</span> <span class="st">&quot;ned30m_8VIC_mrrtf.tif&quot;</span>, <span class="co"># multiresolution ridgetop flatness index</span></span>
<span id="cb187-16"><a href="glm.html#cb187-16"></a>  <span class="dt">mrvbf  =</span> <span class="st">&quot;ned30m_8VIC_mrvbf.tif&quot;</span>, <span class="co"># multiresolution valley bottom flatness index</span></span>
<span id="cb187-17"><a href="glm.html#cb187-17"></a>  <span class="dt">solar  =</span> <span class="st">&quot;ned30m_8VIC_solar.tif&quot;</span>, <span class="co"># solar radiation</span></span>
<span id="cb187-18"><a href="glm.html#cb187-18"></a>  <span class="dt">precip =</span> <span class="st">&quot;prism30m_8VIC_ppt_1981_2010_annual_mm.tif&quot;</span>, <span class="co"># annual precipitation</span></span>
<span id="cb187-19"><a href="glm.html#cb187-19"></a>  <span class="dt">precipsum =</span> <span class="st">&quot;prism30m_8VIC_ppt_1981_2010_summer_mm.tif&quot;</span>, <span class="co"># summer precipitation</span></span>
<span id="cb187-20"><a href="glm.html#cb187-20"></a>  <span class="dt">temp   =</span> <span class="st">&quot;prism30m_8VIC_tmean_1981_2010_annual_C.tif&quot;</span>, <span class="co"># annual temperature</span></span>
<span id="cb187-21"><a href="glm.html#cb187-21"></a>  <span class="dt">mast   =</span> <span class="st">&quot;mast30m_ca794_2013.tif&quot;</span>, <span class="co"># mean annual soil temperature</span></span>
<span id="cb187-22"><a href="glm.html#cb187-22"></a>  <span class="dt">ls     =</span> <span class="st">&quot;landsat30m_8VIC_b123457.tif&quot;</span>, <span class="co"># landsat bands</span></span>
<span id="cb187-23"><a href="glm.html#cb187-23"></a>  <span class="dt">pc     =</span> <span class="st">&quot;landsat30m_8VIC_pc123456.tif&quot;</span>, <span class="co"># principal components of landsat</span></span>
<span id="cb187-24"><a href="glm.html#cb187-24"></a>  <span class="dt">tc     =</span> <span class="st">&quot;landsat30m_8VIC_tc123.tif&quot;</span>, <span class="co"># tasseled cap components of landsat</span></span>
<span id="cb187-25"><a href="glm.html#cb187-25"></a>  <span class="dt">k      =</span> <span class="st">&quot;gamma30m_8VIC_namrad_k.tif&quot;</span>, <span class="co"># gamma radiometrics signatures</span></span>
<span id="cb187-26"><a href="glm.html#cb187-26"></a>  <span class="dt">th     =</span> <span class="st">&quot;gamma30m_8VIC_namrad_th.tif&quot;</span>,</span>
<span id="cb187-27"><a href="glm.html#cb187-27"></a>  <span class="dt">u      =</span> <span class="st">&quot;gamma30m_8VIC_namrad_u.tif&quot;</span>,</span>
<span id="cb187-28"><a href="glm.html#cb187-28"></a>  <span class="dt">cluster =</span> <span class="st">&quot;cluster152.tif&quot;</span>, <span class="co"># unsupervised classification</span></span>
<span id="cb187-29"><a href="glm.html#cb187-29"></a>  <span class="dt">geo    =</span> <span class="st">&quot;sgmc30m_8-VIC_geology.tif&quot;</span></span>
<span id="cb187-30"><a href="glm.html#cb187-30"></a>  )</span>
<span id="cb187-31"><a href="glm.html#cb187-31"></a></span>
<span id="cb187-32"><a href="glm.html#cb187-32"></a><span class="co"># combine the folder directory and file names</span></span>
<span id="cb187-33"><a href="glm.html#cb187-33"></a>geodata_f &lt;-<span class="st"> </span><span class="kw">paste0</span>(folder, files) </span>
<span id="cb187-34"><a href="glm.html#cb187-34"></a><span class="kw">names</span>(geodata_f) &lt;-<span class="st"> </span><span class="kw">names</span>(files)</span>
<span id="cb187-35"><a href="glm.html#cb187-35"></a></span>
<span id="cb187-36"><a href="glm.html#cb187-36"></a><span class="co"># Create a raster stack</span></span>
<span id="cb187-37"><a href="glm.html#cb187-37"></a>geodata_r &lt;-<span class="st"> </span><span class="kw">stack</span>(geodata_f)</span>
<span id="cb187-38"><a href="glm.html#cb187-38"></a></span>
<span id="cb187-39"><a href="glm.html#cb187-39"></a><span class="co"># Extract the geodata and add to a data frame</span></span>
<span id="cb187-40"><a href="glm.html#cb187-40"></a>data &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">extract</span>(geodata_r, <span class="kw">as</span>(s_sf, <span class="st">&quot;Spatial&quot;</span>), <span class="dt">sp =</span> <span class="ot">TRUE</span>)<span class="op">@</span>data</span>
<span id="cb187-41"><a href="glm.html#cb187-41"></a></span>
<span id="cb187-42"><a href="glm.html#cb187-42"></a><span class="co"># Modify some of the geodata variables</span></span>
<span id="cb187-43"><a href="glm.html#cb187-43"></a>data &lt;-<span class="st"> </span><span class="kw">within</span>(data, {</span>
<span id="cb187-44"><a href="glm.html#cb187-44"></a>  cluster  =<span class="st"> </span><span class="kw">factor</span>(cluster)</span>
<span id="cb187-45"><a href="glm.html#cb187-45"></a>  geo      =<span class="st"> </span><span class="kw">factor</span>(geo)</span>
<span id="cb187-46"><a href="glm.html#cb187-46"></a>  twi_sc   =<span class="st"> </span><span class="kw">abs</span>(twi <span class="op">-</span><span class="st"> </span><span class="fl">13.8</span>) <span class="co"># 13.8 = twi median</span></span>
<span id="cb187-47"><a href="glm.html#cb187-47"></a>  gsi      =<span class="st"> </span>(ls_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>ls_<span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(ls_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>ls_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>ls_<span class="dv">1</span>)</span>
<span id="cb187-48"><a href="glm.html#cb187-48"></a>  ndvi     =<span class="st"> </span>(ls_<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>ls_<span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>(ls_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>ls_<span class="dv">3</span>)</span>
<span id="cb187-49"><a href="glm.html#cb187-49"></a>  })</span>
<span id="cb187-50"><a href="glm.html#cb187-50"></a></span>
<span id="cb187-51"><a href="glm.html#cb187-51"></a><span class="co"># save(data, ca794, pedons, file = &quot;C:/workspace2/github/ncss-tech/stats_for_soil_survey/data/ch7_data.Rdata&quot;)</span></span></code></pre></div>
</div>
<div id="examine-spatial-data" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Examine spatial data</h3>
<p>With our spatial data in hand, we can now see whether any of the variables will help us separate the presence/absence of argillic horizons. Because we’re dealing with a classification problem, we’ll compare the numeric variables using boxplots. What we’re looking for are variables with the least amount of overlap in their distribution (i.e. the greatest separation in their median values).</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="glm.html#cb188-1"></a><span class="co"># Load data</span></span>
<span id="cb188-2"><a href="glm.html#cb188-2"></a><span class="co"># githubURL &lt;- &quot;https://raw.githubusercontent.com/ncss-tech/stats_for_soil_survey/master/data/ch7_data.Rdata&quot;</span></span>
<span id="cb188-3"><a href="glm.html#cb188-3"></a><span class="co"># load(url(githubURL))</span></span>
<span id="cb188-4"><a href="glm.html#cb188-4"></a><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;C:/workspace2/github/ncss-tech/stats_for_soil_survey/data/ch7_data.Rdata&quot;</span>)</span>
<span id="cb188-5"><a href="glm.html#cb188-5"></a>train &lt;-<span class="st"> </span>data</span>
<span id="cb188-6"><a href="glm.html#cb188-6"></a></span>
<span id="cb188-7"><a href="glm.html#cb188-7"></a><span class="co"># Select argillic horizons with &quot;arg&quot; in the subgroup name and on fans</span></span>
<span id="cb188-8"><a href="glm.html#cb188-8"></a><span class="co"># Argillic horizons that occur on hills and mountains more than likely form by different process, and therefore would require a different model.train$argillic </span></span>
<span id="cb188-9"><a href="glm.html#cb188-9"></a>train &lt;-<span class="st"> </span><span class="kw">transform</span>(</span>
<span id="cb188-10"><a href="glm.html#cb188-10"></a>  train, </span>
<span id="cb188-11"><a href="glm.html#cb188-11"></a>  <span class="dt">argillic  =</span> <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;arg&quot;</span>, taxsubgrp) <span class="op">&amp;</span><span class="st"> </span>train<span class="op">$</span>mrvbf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.15</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>),</span>
<span id="cb188-12"><a href="glm.html#cb188-12"></a>  <span class="dt">ch_log  =</span> <span class="kw">log</span>(ch <span class="op">+</span><span class="st"> </span><span class="dv">1</span>),</span>
<span id="cb188-13"><a href="glm.html#cb188-13"></a>  <span class="dt">z2str_log =</span> <span class="kw">log</span>(z2str <span class="op">+</span><span class="st"> </span><span class="dv">1</span>),</span>
<span id="cb188-14"><a href="glm.html#cb188-14"></a>  <span class="dt">ch    =</span> <span class="ot">NULL</span>,</span>
<span id="cb188-15"><a href="glm.html#cb188-15"></a>  <span class="dt">z2str =</span> <span class="ot">NULL</span></span>
<span id="cb188-16"><a href="glm.html#cb188-16"></a>  )</span>
<span id="cb188-17"><a href="glm.html#cb188-17"></a>idx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">names</span>(train) <span class="op">==</span><span class="st"> &quot;z&quot;</span>)</span>
<span id="cb188-18"><a href="glm.html#cb188-18"></a>train &lt;-<span class="st"> </span>train[idx<span class="op">:</span><span class="kw">ncol</span>(train)]</span>
<span id="cb188-19"><a href="glm.html#cb188-19"></a></span>
<span id="cb188-20"><a href="glm.html#cb188-20"></a>data_m &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(train[<span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">31</span><span class="op">:</span><span class="dv">32</span>)], <span class="dt">key =</span> key, <span class="dt">value =</span> value, <span class="op">-</span><span class="st"> </span>argillic)</span>
<span id="cb188-21"><a href="glm.html#cb188-21"></a>data_m &lt;-<span class="st"> </span><span class="kw">subset</span>(data_m, <span class="op">!</span><span class="kw">is.na</span>(value))</span>
<span id="cb188-22"><a href="glm.html#cb188-22"></a></span>
<span id="cb188-23"><a href="glm.html#cb188-23"></a><span class="kw">ggplot</span>(data_m, <span class="kw">aes</span>(<span class="dt">x =</span> argillic, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb188-24"><a href="glm.html#cb188-24"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb188-25"><a href="glm.html#cb188-25"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="constructing-the-model" class="section level2">
<h2><span class="header-section-number">5.7</span> Constructing the model</h2>
<p>R has several functions for fitting linear models. The most common is arguably the <code>glm()</code> function from the stats R package, which is loaded by default. The <code>glm()</code> function is also extended thru the use of several additional packages such as the car and caret R packages. Another noteworthy R package for logistic regrssion is rms, which offers the <code>lrm()</code> function. The rms R package (Harrell et al., 2015) offers an ‘almost’ comprehesive alternative to <code>glm()</code> and it’s accessory function. It is difficult to objectively functions say which approach is better. Therefore methods both methods will be demonstrated. Look for comments (i.e. #) below referring to rms, stats, caret or visreg.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="glm.html#cb189-1"></a><span class="co"># stats</span></span>
<span id="cb189-2"><a href="glm.html#cb189-2"></a></span>
<span id="cb189-3"><a href="glm.html#cb189-3"></a>fit_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(argillic <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>slp <span class="op">+</span><span class="st"> </span>twi_sc <span class="op">+</span><span class="st"> </span>ch_log <span class="op">+</span><span class="st"> </span>z2str_log <span class="op">+</span><span class="st"> </span>mrrtf <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>precip <span class="op">+</span><span class="st"> </span>precipsum <span class="op">+</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>mast <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>th <span class="op">+</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>cluster, <span class="dt">data =</span> train, <span class="dt">family =</span> binomial)</span>
<span id="cb189-4"><a href="glm.html#cb189-4"></a></span>
<span id="cb189-5"><a href="glm.html#cb189-5"></a></span>
<span id="cb189-6"><a href="glm.html#cb189-6"></a><span class="co"># rms</span></span>
<span id="cb189-7"><a href="glm.html#cb189-7"></a></span>
<span id="cb189-8"><a href="glm.html#cb189-8"></a><span class="kw">library</span>(rms)</span>
<span id="cb189-9"><a href="glm.html#cb189-9"></a></span>
<span id="cb189-10"><a href="glm.html#cb189-10"></a>dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(train)</span>
<span id="cb189-11"><a href="glm.html#cb189-11"></a><span class="kw">options</span>(<span class="dt">datadist =</span> <span class="st">&quot;dd&quot;</span>)</span>
<span id="cb189-12"><a href="glm.html#cb189-12"></a></span>
<span id="cb189-13"><a href="glm.html#cb189-13"></a>fit_lrm &lt;-<span class="st"> </span><span class="kw">lrm</span>(argillic <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>slp <span class="op">+</span><span class="st"> </span>twi_sc <span class="op">+</span><span class="st"> </span>ch_log <span class="op">+</span><span class="st"> </span>z2str_log <span class="op">+</span><span class="st"> </span>mrrtf <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>precip <span class="op">+</span><span class="st"> </span>precipsum <span class="op">+</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>mast <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>th <span class="op">+</span><span class="st"> </span>u, <span class="dt">data =</span> train, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div id="diagnostic" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Diagnostic</h3>
<div id="residual-plots-1" class="section level4">
<h4><span class="header-section-number">5.7.1.1</span> Residual plots</h4>
<p>One unfortunate side effect of side effect of logistic regression is that the default residual plots are not interpretable. However the partial residual plots can be useful for identifying outliers and nonlinear trends.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="glm.html#cb190-1"></a><span class="kw">par</span>(<span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb190-2"><a href="glm.html#cb190-2"></a><span class="kw">plot</span>(fit_glm)</span>
<span id="cb190-3"><a href="glm.html#cb190-3"></a><span class="kw">par</span>(<span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb190-4"><a href="glm.html#cb190-4"></a></span>
<span id="cb190-5"><a href="glm.html#cb190-5"></a></span>
<span id="cb190-6"><a href="glm.html#cb190-6"></a>car<span class="op">::</span><span class="kw">residualPlots</span>(fit_glm, <span class="dt">fit =</span> <span class="ot">FALSE</span>, <span class="dt">tests =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="multicolinearity-1" class="section level4">
<h4><span class="header-section-number">5.7.1.2</span> Multicolinearity</h4>
<p>As we mentioned earlier multicolinearity should be avoided. To assess a model for multicolinearity we can compute the variance inflation factor (VIF). Its square root indicates the amount of increase in the predictor coefficients standard error. A value greater than 3 indicates a doubling the standard error. Rules of thumb vary, but a square root of vif greater than 2 or 3 indicates an unacceptable value.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="glm.html#cb191-1"></a><span class="kw">sqrt</span>(<span class="kw">vif</span>(fit_glm))</span></code></pre></div>
</div>
</div>
<div id="variable-selection-model-validation-1" class="section level3">
<h3><span class="header-section-number">5.7.2</span> Variable Selection &amp; model validation</h3>
<p>Modeling is an iterative process that cycles between fitting and evaluating alternative models. Compared to tree and forest models, linear and generalized models typically require more scrunity from the user. Automated model selection procedures are available, but should not be taken at face value because they may result in complex and unstable models. This is in part due to correlation amongst the predictive variables that can confuse the model. Also, the order in which the variables are included or excluded from the model effects the significance of the other variables, and thus several weak predictors might mask the effect of one strong predictor. Regardless of the approach used, variable selection is probably the most controversial aspect of linear modeling.</p>
<p>Both the rms and caret packages offer methods for variable selection and cross-validation. In this instance the rms approach is a bit more convinent and faster, with the one line call to validate().</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="glm.html#cb192-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb192-2"><a href="glm.html#cb192-2"></a></span>
<span id="cb192-3"><a href="glm.html#cb192-3"></a><span class="co"># rms</span></span>
<span id="cb192-4"><a href="glm.html#cb192-4"></a><span class="co">## stepwise selection and validation</span></span>
<span id="cb192-5"><a href="glm.html#cb192-5"></a>step_rms &lt;-<span class="st"> </span><span class="kw">validate</span>(fit_lrm, <span class="dt">method =</span> <span class="st">&quot;crossvalidation&quot;</span>, <span class="dt">B =</span> <span class="dv">10</span>, <span class="dt">bw =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The results for validate() above and below show which variables were retained and deleted. Below we can see a dot matrix of which variables were retained in during the 10 iterations of the cross validation. In addition, below we can see the difference between the training and test accuracy and error metrics. Remember that it is the test accuracy we should pay attention too.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="glm.html#cb193-1"></a><span class="co">## test accuracy and error</span></span>
<span id="cb193-2"><a href="glm.html#cb193-2"></a>step_rms</span></code></pre></div>
<p>The caret package option for variable selection and validation is a bit more verbose than the rms package. However, the caret package is a more versatile package, with options for over 50 different models, such as other tree-based models.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="glm.html#cb194-1"></a><span class="co"># caret</span></span>
<span id="cb194-2"><a href="glm.html#cb194-2"></a><span class="kw">library</span>(caret)</span>
<span id="cb194-3"><a href="glm.html#cb194-3"></a></span>
<span id="cb194-4"><a href="glm.html#cb194-4"></a><span class="co">## cross validation parameters</span></span>
<span id="cb194-5"><a href="glm.html#cb194-5"></a>train.control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, </span>
<span id="cb194-6"><a href="glm.html#cb194-6"></a>                              <span class="dt">number =</span> <span class="dv">10</span>, </span>
<span id="cb194-7"><a href="glm.html#cb194-7"></a>                              <span class="dt">classProbs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb194-8"><a href="glm.html#cb194-8"></a>                              <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb194-9"><a href="glm.html#cb194-9"></a>                              <span class="dt">summaryFunction =</span> twoClassSummary</span>
<span id="cb194-10"><a href="glm.html#cb194-10"></a>                              )</span>
<span id="cb194-11"><a href="glm.html#cb194-11"></a></span>
<span id="cb194-12"><a href="glm.html#cb194-12"></a><span class="co"># stepwise selection and validation</span></span>
<span id="cb194-13"><a href="glm.html#cb194-13"></a>step_caret &lt;-<span class="st"> </span><span class="kw">train</span>(argillic <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>slp <span class="op">+</span><span class="st"> </span>twi_sc <span class="op">+</span><span class="st"> </span>ch_log <span class="op">+</span><span class="st"> </span>z2str_log <span class="op">+</span><span class="st"> </span>mrrtf <span class="op">+</span><span class="st"> </span>solar <span class="op">+</span><span class="st"> </span>precip <span class="op">+</span><span class="st"> </span>precipsum <span class="op">+</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>mast <span class="op">+</span><span class="st"> </span>tc_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>tc_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>th <span class="op">+</span><span class="st"> </span>u,</span>
<span id="cb194-14"><a href="glm.html#cb194-14"></a>                     <span class="dt">data =</span> train,</span>
<span id="cb194-15"><a href="glm.html#cb194-15"></a>                     <span class="dt">method=</span><span class="st">&quot;glmStepAIC&quot;</span>, </span>
<span id="cb194-16"><a href="glm.html#cb194-16"></a>                     <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb194-17"><a href="glm.html#cb194-17"></a>                     <span class="dt">direction =</span><span class="st">&quot;backward&quot;</span>,</span>
<span id="cb194-18"><a href="glm.html#cb194-18"></a>                     <span class="dt">trace =</span> <span class="ot">FALSE</span>,</span>
<span id="cb194-19"><a href="glm.html#cb194-19"></a>                     <span class="dt">trControl =</span> train.control,</span>
<span id="cb194-20"><a href="glm.html#cb194-20"></a>                     <span class="dt">na.action =</span> na.exclude</span>
<span id="cb194-21"><a href="glm.html#cb194-21"></a>                     )</span>
<span id="cb194-22"><a href="glm.html#cb194-22"></a></span>
<span id="cb194-23"><a href="glm.html#cb194-23"></a><span class="co"># test accuracy &amp; error</span></span>
<span id="cb194-24"><a href="glm.html#cb194-24"></a>step_caret<span class="op">$</span>results</span>
<span id="cb194-25"><a href="glm.html#cb194-25"></a></span>
<span id="cb194-26"><a href="glm.html#cb194-26"></a></span>
<span id="cb194-27"><a href="glm.html#cb194-27"></a><span class="co"># summary</span></span>
<span id="cb194-28"><a href="glm.html#cb194-28"></a><span class="kw">summary</span>(step_glm &lt;-<span class="st"> </span>step_caret<span class="op">$</span>finalModel)</span></code></pre></div>
</div>
<div id="final-model-accuracy" class="section level3">
<h3><span class="header-section-number">5.7.3</span> Final model &amp; accuracy</h3>
<p>Because we’re dealing with a classification problem, we have to consider both errors of commission (Type I) and omission (Type II), or their corresponding accuracies of sensitivity (producer’s accuracy) and positive predicted value (user’s accuracy or precision) respectively. Before we can assess the error, however, we need to select a probability threshold.</p>
<ul>
<li><strong>Sensitivity</strong> and <strong>specificity</strong> examine how well the ground truth or reference data compares to the predictions.</li>
<li><strong>Positive</strong> and <strong>negative</strong> predicted values (user’s accuracy) examine the inverse concept of how well the predictions match the reference data</li>
</ul>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="glm.html#cb195-1"></a><span class="co"># examine possible thresholds</span></span>
<span id="cb195-2"><a href="glm.html#cb195-2"></a>train<span class="op">$</span>predict &lt;-<span class="st"> </span><span class="kw">predict</span>(step_glm, train, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb195-3"><a href="glm.html#cb195-3"></a></span>
<span id="cb195-4"><a href="glm.html#cb195-4"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> predict, <span class="dt">fill =</span> argillic)) <span class="op">+</span></span>
<span id="cb195-5"><a href="glm.html#cb195-5"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb195-6"><a href="glm.html#cb195-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="fl">0.5</span>), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb195-7"><a href="glm.html#cb195-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;probability&quot;</span>) <span class="op">+</span></span>
<span id="cb195-8"><a href="glm.html#cb195-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>))</span>
<span id="cb195-9"><a href="glm.html#cb195-9"></a></span>
<span id="cb195-10"><a href="glm.html#cb195-10"></a>train<span class="op">$</span>predict &lt;-<span class="st"> </span><span class="kw">ifelse</span>(train<span class="op">$</span>predict <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.3</span>, <span class="st">&#39;yes&#39;</span>, <span class="st">&#39;no&#39;</span>)</span>
<span id="cb195-11"><a href="glm.html#cb195-11"></a></span>
<span id="cb195-12"><a href="glm.html#cb195-12"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb195-13"><a href="glm.html#cb195-13"></a>cm &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">observed =</span> train<span class="op">$</span>argillic, <span class="dt">predicted =</span> train<span class="op">$</span>predict)</span>
<span id="cb195-14"><a href="glm.html#cb195-14"></a><span class="kw">confusionMatrix</span>(cm, <span class="dt">positive =</span> <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb195-15"><a href="glm.html#cb195-15"></a></span>
<span id="cb195-16"><a href="glm.html#cb195-16"></a><span class="co"># Deviance squared</span></span>
<span id="cb195-17"><a href="glm.html#cb195-17"></a><span class="kw">library</span>(modEvA)</span>
<span id="cb195-18"><a href="glm.html#cb195-18"></a></span>
<span id="cb195-19"><a href="glm.html#cb195-19"></a><span class="co"># Deviance squared</span></span>
<span id="cb195-20"><a href="glm.html#cb195-20"></a><span class="kw">Dsquared</span>(step_glm)</span>
<span id="cb195-21"><a href="glm.html#cb195-21"></a></span>
<span id="cb195-22"><a href="glm.html#cb195-22"></a><span class="co"># Adjusted deviance squared</span></span>
<span id="cb195-23"><a href="glm.html#cb195-23"></a><span class="kw">Dsquared</span>(step_glm, <span class="dt">adjust =</span> <span class="ot">TRUE</span>)</span>
<span id="cb195-24"><a href="glm.html#cb195-24"></a></span>
<span id="cb195-25"><a href="glm.html#cb195-25"></a></span>
<span id="cb195-26"><a href="glm.html#cb195-26"></a><span class="co"># Spatially variable accuracy</span></span>
<span id="cb195-27"><a href="glm.html#cb195-27"></a>temp &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span></span>
<span id="cb195-28"><a href="glm.html#cb195-28"></a><span class="st">  </span><span class="kw">group_by</span>(cluster) <span class="op">%&gt;%</span></span>
<span id="cb195-29"><a href="glm.html#cb195-29"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(</span>
<span id="cb195-30"><a href="glm.html#cb195-30"></a>    <span class="dt">TP       =</span> <span class="kw">sum</span>(predict <span class="op">==</span><span class="st"> &quot;yes&quot;</span> <span class="op">&amp;</span><span class="st"> </span>argillic <span class="op">==</span><span class="st"> &quot;yes&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb195-31"><a href="glm.html#cb195-31"></a>    <span class="dt">FN       =</span> <span class="kw">sum</span>(predict <span class="op">==</span><span class="st"> &quot;no&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>argillic <span class="op">==</span><span class="st"> &quot;yes&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb195-32"><a href="glm.html#cb195-32"></a>    <span class="dt">sensitivity =</span> TP <span class="op">/</span><span class="st"> </span>(TP <span class="op">+</span><span class="st"> </span>FN)</span>
<span id="cb195-33"><a href="glm.html#cb195-33"></a>    )</span>
<span id="cb195-34"><a href="glm.html#cb195-34"></a></span>
<span id="cb195-35"><a href="glm.html#cb195-35"></a><span class="kw">ggplot</span>(temp, <span class="kw">aes</span>(<span class="dt">x =</span> cluster, <span class="dt">y =</span> sensitivity)) <span class="op">+</span></span>
<span id="cb195-36"><a href="glm.html#cb195-36"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb195-37"><a href="glm.html#cb195-37"></a></span>
<span id="cb195-38"><a href="glm.html#cb195-38"></a><span class="kw">table</span>(train<span class="op">$</span>argillic, train<span class="op">$</span>cluster)</span></code></pre></div>
<ul>
<li>Discuss the variability of the predictions across the clusters, perhaps different models need to be constructed in each cluster, some clusters appear to be dominated by specific soil series, these data aren’t clean enough (nor are the series concepts usually) to model series separately, however, we could use the clusters as an additional model to attempt to separate the series. Do the hyperthermic clusters perform differently.</li>
</ul>
</div>
<div id="model-effects-1" class="section level3">
<h3><span class="header-section-number">5.7.4</span> Model effects</h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="glm.html#cb196-1"></a><span class="co"># summary</span></span>
<span id="cb196-2"><a href="glm.html#cb196-2"></a><span class="kw">summary</span>(step_glm)</span>
<span id="cb196-3"><a href="glm.html#cb196-3"></a></span>
<span id="cb196-4"><a href="glm.html#cb196-4"></a></span>
<span id="cb196-5"><a href="glm.html#cb196-5"></a><span class="co"># Convert the coefficients to an odds scale, who here gambles?</span></span>
<span id="cb196-6"><a href="glm.html#cb196-6"></a><span class="kw">exp</span>(<span class="kw">coef</span>(step_glm))</span>
<span id="cb196-7"><a href="glm.html#cb196-7"></a></span>
<span id="cb196-8"><a href="glm.html#cb196-8"></a></span>
<span id="cb196-9"><a href="glm.html#cb196-9"></a><span class="co"># analysis of deviance</span></span>
<span id="cb196-10"><a href="glm.html#cb196-10"></a><span class="kw">anova</span>(step_glm)</span>
<span id="cb196-11"><a href="glm.html#cb196-11"></a></span>
<span id="cb196-12"><a href="glm.html#cb196-12"></a></span>
<span id="cb196-13"><a href="glm.html#cb196-13"></a><span class="co"># visreg</span></span>
<span id="cb196-14"><a href="glm.html#cb196-14"></a><span class="kw">library</span>(visreg)</span>
<span id="cb196-15"><a href="glm.html#cb196-15"></a></span>
<span id="cb196-16"><a href="glm.html#cb196-16"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb196-17"><a href="glm.html#cb196-17"></a><span class="kw">visreg</span>(step_glm, <span class="dt">scale =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;argillic probability&quot;</span>)</span></code></pre></div>
<ul>
<li>View the results in ArcGIS and examine the accuracy at individual points</li>
<li>Discuss the effects of data quality, including both NASIS and GIS</li>
<li>Discuss how the modeling process isn’t an end in itself, but serves to uncover trends, possibly generate additional questions and direct future investigations</li>
</ul>
</div>
</div>
<div id="generate-spatial-predictions-1" class="section level2">
<h2><span class="header-section-number">5.8</span> Generate spatial predictions</h2>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="glm.html#cb197-1"></a><span class="co"># Custom function to return the predictions and their standard errors</span></span>
<span id="cb197-2"><a href="glm.html#cb197-2"></a></span>
<span id="cb197-3"><a href="glm.html#cb197-3"></a><span class="kw">library</span>(raster)</span>
<span id="cb197-4"><a href="glm.html#cb197-4"></a></span>
<span id="cb197-5"><a href="glm.html#cb197-5"></a>predfun &lt;-<span class="st"> </span><span class="cf">function</span>(model, data) {</span>
<span id="cb197-6"><a href="glm.html#cb197-6"></a>  v &lt;-<span class="st"> </span><span class="kw">predict</span>(model, data, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</span>
<span id="cb197-7"><a href="glm.html#cb197-7"></a>  <span class="kw">cbind</span>(</span>
<span id="cb197-8"><a href="glm.html#cb197-8"></a>    <span class="dt">p =</span> <span class="kw">as.vector</span>(v<span class="op">$</span>fit),</span>
<span id="cb197-9"><a href="glm.html#cb197-9"></a>    <span class="dt">se =</span> <span class="kw">as.vector</span>(v<span class="op">$</span>se.fit)</span>
<span id="cb197-10"><a href="glm.html#cb197-10"></a>    )</span>
<span id="cb197-11"><a href="glm.html#cb197-11"></a>  }</span>
<span id="cb197-12"><a href="glm.html#cb197-12"></a>  </span>
<span id="cb197-13"><a href="glm.html#cb197-13"></a><span class="co"># Generate spatial predictions</span></span>
<span id="cb197-14"><a href="glm.html#cb197-14"></a>r &lt;-<span class="st"> </span><span class="kw">predict</span>(geodata_r, step_glm, <span class="dt">fun =</span> predfun, <span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">progress =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb197-15"><a href="glm.html#cb197-15"></a></span>
<span id="cb197-16"><a href="glm.html#cb197-16"></a><span class="co"># Export the results</span></span>
<span id="cb197-17"><a href="glm.html#cb197-17"></a><span class="kw">writeRaster</span>(r[[<span class="dv">1</span>]], <span class="st">&quot;argi.tif&quot;</span>, <span class="dt">overwrite =</span> T, <span class="dt">progress =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb197-18"><a href="glm.html#cb197-18"></a></span>
<span id="cb197-19"><a href="glm.html#cb197-19"></a><span class="kw">writeRaster</span>(r[[<span class="dv">2</span>]], <span class="st">&quot;argi_se.tif&quot;</span>, <span class="dt">overwrite =</span> T, <span class="dt">progress =</span> <span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="glm.html#cb198-1"></a><span class="kw">library</span>(raster)</span>
<span id="cb198-2"><a href="glm.html#cb198-2"></a></span>
<span id="cb198-3"><a href="glm.html#cb198-3"></a><span class="co"># argillic probability</span></span>
<span id="cb198-4"><a href="glm.html#cb198-4"></a><span class="kw">plot</span>(<span class="kw">raster</span>(<span class="st">&quot;C:/workspace2/argi.tif&quot;</span>))</span>
<span id="cb198-5"><a href="glm.html#cb198-5"></a><span class="kw">plot</span>(ca794[<span class="dv">1</span>], <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb198-6"><a href="glm.html#cb198-6"></a></span>
<span id="cb198-7"><a href="glm.html#cb198-7"></a><span class="co"># argillic standard error</span></span>
<span id="cb198-8"><a href="glm.html#cb198-8"></a><span class="kw">plot</span>(<span class="kw">raster</span>(<span class="st">&quot;C:/workspace2/argi_se.tif&quot;</span>))</span>
<span id="cb198-9"><a href="glm.html#cb198-9"></a><span class="kw">plot</span>(ca794[<span class="dv">1</span>], <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="glm.html#cb199-1"></a><span class="co"># Download clipped example from Pinto Basin Joshua Tree</span></span>
<span id="cb199-2"><a href="glm.html#cb199-2"></a>githubURL &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/ncss-tech/stats_for_soil_survey/master/data/logistic/argi_pb.zip&quot;</span></span>
<span id="cb199-3"><a href="glm.html#cb199-3"></a></span>
<span id="cb199-4"><a href="glm.html#cb199-4"></a><span class="kw">download.file</span>(githubURL, <span class="dt">destfile =</span> <span class="st">&quot;C:/workspace2/argi_pb.zip&quot;</span>)</span>
<span id="cb199-5"><a href="glm.html#cb199-5"></a></span>
<span id="cb199-6"><a href="glm.html#cb199-6"></a><span class="kw">unzip</span>(<span class="dt">zipfile=</span><span class="st">&quot;C:/workspace2/argi_pb.zip&quot;</span>, <span class="dt">exdir=</span><span class="st">&quot;C:/workspace2&quot;</span>)</span></code></pre></div>
</div>
<div id="exercise-2-view-the-prediction-in-arcgis" class="section level2">
<h2><span class="header-section-number">5.9</span> Exercise 2: View the prediction in ArcGIS</h2>
<ul>
<li>Examine the raster predictions in ArcGIS and compare them to the Shapefile of that contains the original observations (hint classify the Shapefile symbology using the argillic column)</li>
<li>Discuss with your group, and report your observations or hypotheses</li>
</ul>
</div>
<div id="additional-reading-2" class="section level2">
<h2><span class="header-section-number">5.10</span> Additional reading</h2>
<p>Lane, P.W., 2002. Generalized linear models in soil science. European Journal of Soil Science 53, 241- 251. <a href="http://onlinelibrary.wiley.com/doi/10.1046/j.1365-2389.2002.00440.x/abstract">http://onlinelibrary.wiley.com/doi/10.1046/j.1365-2389.2002.00440.x/abstract</a></p>
<p>James, G., D. Witten, T. Hastie, and R. Tibshirani, 2014. An Introduction to Statistical Learning: with Applications in R. Springer, New York. <a href="http://www-bcf.usc.edu/~gareth/ISL/">http://www-bcf.usc.edu/~gareth/ISL/</a></p>
<p>Hengl, T. 2009. A Practical Guide to Geostatistical Mapping, 2nd Edt. University of Amsterdam, www.lulu.com, 291 p. ISBN 978-90-9024981-0. <a href="http://spatial-analyst.net/book/system/files/Hengl_2009_GEOSTATe2c0w.pdf">http://spatial-analyst.net/book/system/files/Hengl_2009_GEOSTATe2c0w.pdf</a></p>
<!-- integrate into bibtext -->
</div>
<div id="literature-cited" class="section level2">
<h2><span class="header-section-number">5.11</span> Literature Cited</h2>
<p>Beaudette, D. E., &amp; O’Geen, A. T, 2009. Quantifying the aspect effect: an application of solar radiation modeling for soil survey. Soil Science Society of America Journal, 73:1345-1352</p>
<p>Gessler, P. E., Moore, I. D., McKenzie, N. J., &amp; Ryan, P. J, 1995. Soil-landscape modelling and spatial prediction of soil attributes. International Journal of Geographical Information Systems, 9:421-432</p>
<p>Gorsevski, P. V., Gessler, P. E., Foltz, R. B., &amp; Elliot, W. J, 2006. Spatial prediction of landslide hazard using logistic regression and ROC analysis. Transactions in GIS, 10:395-415</p>
<p>Evans, D.M. and Hartemink, A.E., 2014. Digital soil mapping of a red clay subsoil covered by loess. Geoderma, 230:296-304.</p>
<p>Harrell, F.E., 2015. Regression Modeling Strategies: With Applications to Linear Models, Logisitc and Ordinal Regression, and Survival Analysis. Springer, New York. <a href="https://link.springer.com/book/10.1007%2F978-3-319-19425-7">https://link.springer.com/book/10.1007%2F978-3-319-19425-7</a></p>
<p>Hosmer Jr, D.W., Lemeshow, S. and Sturdivant, R.X., 2013. Applied logistic regression (Vol. 398). John Wiley &amp; Sons</p>
<p>Kempen, B., Brus, D. J., Heuvelink, G., &amp; Stoorvogel, J. J. (2009). Updating the 1: 50,000 Dutch soil map using legacy soil data: A multinomial logistic regression approach. Geoderma, 151:311-326.</p>
<p>Nauman, T. W., and J. A. Thompson, 2014. Semi-automated disaggregation of conventional soil maps using knowledge driven data mining and classification trees. Geoderma 213:385-399. <a href="http://www.sciencedirect.com/science/article/pii/S0016706113003066">http://www.sciencedirect.com/science/article/pii/S0016706113003066</a></p>
<p>Peterson, F.F., 1981. Landforms of the basin and range province: defined for soil survey. Nevada Agricultural Experiment Station Technical Bulletin 28, University of Nevada - Reno, NV. 52 p. <a href="http://jornada.nmsu.edu/files/Peterson_LandformsBasinRangeProvince.pdf">http://jornada.nmsu.edu/files/Peterson_LandformsBasinRangeProvince.pdf</a></p>
<p>Shi, X., L. Girod, R. Long, R. DeKett, J. Philippe, and T. Burke, 2012. A comparison of LiDAR-based DEMs and USGS-sourced DEMs in terrain analysis for knowledge-based digital soil mapping. Geoderma 170:217-226. <a href="http://www.sciencedirect.com/science/article/pii/S0016706111003387">http://www.sciencedirect.com/science/article/pii/S0016706111003387</a></p>
</div>
<div id="references-glm" class="section level2">
<h2><span class="header-section-number">5.12</span> References (GLM)</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tree-based-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["s4ssbook.pdf", "s4ssbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
