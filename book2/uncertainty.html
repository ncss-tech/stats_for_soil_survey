<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Uncertainty | Statistics for Soil Survey - Part 2</title>
  <meta name="description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Uncertainty | Statistics for Soil Survey - Part 2" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Uncertainty | Statistics for Soil Survey - Part 2" />
  
  <meta name="twitter:description" content="Web-based course content for Statistics for Soil Survey - Part 2 made with bookdown::gitbook." />
  

<meta name="author" content="Soil Survey Staff" />


<meta name="date" content="2021-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="ordination.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../book/index.html">Statistics for Soil Survey - Part 1</a></li>
<li><a href="index.html">Statistics for Soil Survey - Part 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Pre-course Assignment</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i><b>0.1</b> Setup</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#create-workspace"><i class="fa fa-check"></i><b>0.1.1</b> Create Workspace</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#configure-rstudio"><i class="fa fa-check"></i><b>0.1.2</b> Configure RStudio</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#install-.rprofile"><i class="fa fa-check"></i><b>0.1.3</b> Install .RProfile</a></li>
<li class="chapter" data-level="0.1.4" data-path="index.html"><a href="index.html#install-required-packages"><i class="fa fa-check"></i><b>0.1.4</b> Install Required Packages</a></li>
<li class="chapter" data-level="0.1.5" data-path="index.html"><a href="index.html#common-errors"><i class="fa fa-check"></i><b>0.1.5</b> Common Errors</a></li>
<li class="chapter" data-level="0.1.6" data-path="index.html"><a href="index.html#packages-not-on-cran"><i class="fa fa-check"></i><b>0.1.6</b> Packages not on CRAN</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#connect-to-local-nasis"><i class="fa fa-check"></i><b>0.2</b> Connect to Local NASIS</a><ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#demonstrate-a-working-connection"><i class="fa fa-check"></i><b>0.2.1</b> Demonstrate a Working Connection</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#additional-supportoptional-readings"><i class="fa fa-check"></i><b>0.3</b> Additional Support/Optional Readings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>2</b> Uncertainty</a><ul>
<li class="chapter" data-level="2.1" data-path="uncertainty.html"><a href="uncertainty.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---dispersion"><i class="fa fa-check"></i><b>2.1.1</b> Exercise - Dispersion</a></li>
<li class="chapter" data-level="2.1.2" data-path="uncertainty.html"><a href="uncertainty.html#exercise---variation-and-certainty"><i class="fa fa-check"></i><b>2.1.2</b> Exercise - Variation and Certainty</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="uncertainty.html"><a href="uncertainty.html#theory-of-uncertainty"><i class="fa fa-check"></i><b>2.2</b> Theory of Uncertainty</a></li>
<li class="chapter" data-level="2.3" data-path="uncertainty.html"><a href="uncertainty.html#resampling-to-estimate-uncertainty"><i class="fa fa-check"></i><b>2.3</b> Resampling to Estimate Uncertainty</a><ul>
<li class="chapter" data-level="2.3.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---resampling"><i class="fa fa-check"></i><b>2.3.1</b> Exercise - Resampling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="uncertainty.html"><a href="uncertainty.html#performance-metrics"><i class="fa fa-check"></i><b>2.4</b> Performance Metrics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="uncertainty.html"><a href="uncertainty.html#exercise---numeric-metrics"><i class="fa fa-check"></i><b>2.4.1</b> Exercise - Numeric Metrics</a></li>
<li class="chapter" data-level="2.4.2" data-path="uncertainty.html"><a href="uncertainty.html#exercise---categorical-metrics"><i class="fa fa-check"></i><b>2.4.2</b> Exercise - Categorical Metrics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="uncertainty.html"><a href="uncertainty.html#validation"><i class="fa fa-check"></i><b>2.5</b> Validation</a></li>
<li class="chapter" data-level="2.6" data-path="uncertainty.html"><a href="uncertainty.html#apparent-validation"><i class="fa fa-check"></i><b>2.6</b> Apparent Validation</a></li>
<li class="chapter" data-level="2.7" data-path="uncertainty.html"><a href="uncertainty.html#inherent-validation"><i class="fa fa-check"></i><b>2.7</b> Inherent Validation</a><ul>
<li class="chapter" data-level="2.7.1" data-path="uncertainty.html"><a href="uncertainty.html#split-sample---a-single-partition-of-the-data-into-a-learning-and-a-calibration-set."><i class="fa fa-check"></i><b>2.7.1</b> Split-sample - A single partition of the data into a learning and a calibration set.</a></li>
<li class="chapter" data-level="2.7.2" data-path="uncertainty.html"><a href="uncertainty.html#cross-validation---alternate-development-and-validation"><i class="fa fa-check"></i><b>2.7.2</b> Cross-validation - Alternate development and validation</a></li>
<li class="chapter" data-level="2.7.3" data-path="uncertainty.html"><a href="uncertainty.html#subsample-resampling-or-sample-simulation"><i class="fa fa-check"></i><b>2.7.3</b> Subsample (Resampling or sample simulation)</a></li>
<li class="chapter" data-level="2.7.4" data-path="uncertainty.html"><a href="uncertainty.html#external-validation"><i class="fa fa-check"></i><b>2.7.4</b> External Validation</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="uncertainty.html"><a href="uncertainty.html#additional-reading"><i class="fa fa-check"></i><b>2.8</b> Additional reading</a></li>
<li class="chapter" data-level="2.9" data-path="uncertainty.html"><a href="uncertainty.html#references-uncertainty"><i class="fa fa-check"></i><b>2.9</b> References (Uncertainty)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ordination.html"><a href="ordination.html"><i class="fa fa-check"></i><b>3</b> Numerical Taxonomy and Ordination</a><ul>
<li class="chapter" data-level="3.1" data-path="ordination.html"><a href="ordination.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ordination.html"><a href="ordination.html#objectives"><i class="fa fa-check"></i><b>3.1.1</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ordination.html"><a href="ordination.html#whirlwind-tour"><i class="fa fa-check"></i><b>3.2</b> Whirlwind Tour</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ordination.html"><a href="ordination.html#similarity-disimilarty-and-distance"><i class="fa fa-check"></i><b>3.2.1</b> Similarity, Disimilarty, and Distance</a></li>
<li class="chapter" data-level="3.2.2" data-path="ordination.html"><a href="ordination.html#standardization-of-characteristics"><i class="fa fa-check"></i><b>3.2.2</b> Standardization of Characteristics</a></li>
<li class="chapter" data-level="3.2.3" data-path="ordination.html"><a href="ordination.html#missing-data"><i class="fa fa-check"></i><b>3.2.3</b> Missing Data</a></li>
<li class="chapter" data-level="3.2.4" data-path="ordination.html"><a href="ordination.html#visualizing-pair-wise-distances-the-dendrogram"><i class="fa fa-check"></i><b>3.2.4</b> Visualizing Pair-Wise Distances: The Dendrogram</a></li>
<li class="chapter" data-level="3.2.5" data-path="ordination.html"><a href="ordination.html#re-arranging-a-dendrogram-for-clarity"><i class="fa fa-check"></i><b>3.2.5</b> Re-arranging a Dendrogram for Clarity</a></li>
<li class="chapter" data-level="3.2.6" data-path="ordination.html"><a href="ordination.html#cluster-analysis-finding-groups-in-data"><i class="fa fa-check"></i><b>3.2.6</b> Cluster Analysis: Finding Groups in Data</a></li>
<li class="chapter" data-level="3.2.7" data-path="ordination.html"><a href="ordination.html#ordination-visualization-in-a-reduced-space"><i class="fa fa-check"></i><b>3.2.7</b> Ordination: Visualization in a Reduced Space</a></li>
<li class="chapter" data-level="3.2.8" data-path="ordination.html"><a href="ordination.html#review-and-discuss-4"><i class="fa fa-check"></i><b>3.2.8</b> Review and Discuss</a></li>
<li class="chapter" data-level="3.2.9" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-soil-profiles"><i class="fa fa-check"></i><b>3.2.9</b> Pair-Wise Distances Between Soil Profiles</a></li>
<li class="chapter" data-level="3.2.10" data-path="ordination.html"><a href="ordination.html#final-discussion"><i class="fa fa-check"></i><b>3.2.10</b> Final Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ordination.html"><a href="ordination.html#excercises"><i class="fa fa-check"></i><b>3.3</b> Excercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ordination.html"><a href="ordination.html#set-up-the-r-session"><i class="fa fa-check"></i><b>3.3.1</b> Set Up the R Session</a></li>
<li class="chapter" data-level="3.3.2" data-path="ordination.html"><a href="ordination.html#evaluating-missing-data"><i class="fa fa-check"></i><b>3.3.2</b> Evaluating Missing Data</a></li>
<li class="chapter" data-level="3.3.3" data-path="ordination.html"><a href="ordination.html#more-on-the-distance-matrix-and-how-to-make-one"><i class="fa fa-check"></i><b>3.3.3</b> More on the Distance Matrix and How to Make One</a></li>
<li class="chapter" data-level="3.3.4" data-path="ordination.html"><a href="ordination.html#hierachrical-clustering"><i class="fa fa-check"></i><b>3.3.4</b> Hierachrical Clustering</a></li>
<li class="chapter" data-level="3.3.5" data-path="ordination.html"><a href="ordination.html#centroid-and-medoid-partitioning-clustering-1"><i class="fa fa-check"></i><b>3.3.5</b> Centroid and Medoid (Partitioning) Clustering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ordination.html"><a href="ordination.html#practical-applications"><i class="fa fa-check"></i><b>3.4</b> Practical Applications</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-soil-profiles-1"><i class="fa fa-check"></i><b>3.4.1</b> Pair-Wise Distances Between Soil Profiles</a></li>
<li class="chapter" data-level="3.4.2" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-soil-series"><i class="fa fa-check"></i><b>3.4.2</b> Pair-Wise Distances Between Soil Series</a></li>
<li class="chapter" data-level="3.4.3" data-path="ordination.html"><a href="ordination.html#pair-wise-distances-between-subgroup-level-taxa"><i class="fa fa-check"></i><b>3.4.3</b> Pair-Wise Distances Between Subgroup-Level Taxa</a></li>
<li class="chapter" data-level="3.4.4" data-path="ordination.html"><a href="ordination.html#soil-color-signatures"><i class="fa fa-check"></i><b>3.4.4</b> Soil Color Signatures</a></li>
<li class="chapter" data-level="3.4.5" data-path="ordination.html"><a href="ordination.html#clustering-of-soil-colors"><i class="fa fa-check"></i><b>3.4.5</b> Clustering of Soil Colors</a></li>
<li class="chapter" data-level="3.4.6" data-path="ordination.html"><a href="ordination.html#how-do-the-interpretations-compare"><i class="fa fa-check"></i><b>3.4.6</b> “How Do the Interpretations Compare?”</a></li>
<li class="chapter" data-level="3.4.7" data-path="ordination.html"><a href="ordination.html#mlra-concepts-via-climate-and-elevation-samples"><i class="fa fa-check"></i><b>3.4.7</b> MLRA Concepts via Climate and Elevation Samples</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ordination.html"><a href="ordination.html#references-numerical-taxonomy-and-ordination"><i class="fa fa-check"></i><b>3.5</b> References (Numerical Taxonomy and Ordination)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-example"><i class="fa fa-check"></i><b>4.2</b> Linear Regression Example</a></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-regression.html"><a href="linear-regression.html#tidy-raw-files"><i class="fa fa-check"></i><b>4.3.1</b> Tidy Raw Files</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-regression.html"><a href="linear-regression.html#henry-mount-database"><i class="fa fa-check"></i><b>4.3.2</b> Henry Mount Database</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-regression.html"><a href="linear-regression.html#aggregate-time-series"><i class="fa fa-check"></i><b>4.3.3</b> Aggregate Time Series</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-regression.html"><a href="linear-regression.html#final-dataset"><i class="fa fa-check"></i><b>4.3.4</b> Final Dataset</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression.html"><a href="linear-regression.html#spatial-data"><i class="fa fa-check"></i><b>4.4</b> Spatial data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-regression.html"><a href="linear-regression.html#plot-coordinates"><i class="fa fa-check"></i><b>4.4.1</b> Plot Coordinates</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-regression.html"><a href="linear-regression.html#extracting-spatial-data"><i class="fa fa-check"></i><b>4.4.2</b> Extracting Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-regression.html"><a href="linear-regression.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>4.5</b> Exploratory Data Analysis (EDA)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="linear-regression.html"><a href="linear-regression.html#compare-samples-vs-population"><i class="fa fa-check"></i><b>4.5.1</b> Compare Samples vs Population</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="linear-regression.html"><a href="linear-regression.html#linear-modeling"><i class="fa fa-check"></i><b>4.6</b> Linear modeling</a><ul>
<li class="chapter" data-level="4.6.1" data-path="linear-regression.html"><a href="linear-regression.html#diagnostics"><i class="fa fa-check"></i><b>4.6.1</b> Diagnostics</a></li>
<li class="chapter" data-level="4.6.2" data-path="linear-regression.html"><a href="linear-regression.html#variable-selection-model-validation"><i class="fa fa-check"></i><b>4.6.2</b> Variable selection &amp; model validation</a></li>
<li class="chapter" data-level="4.6.3" data-path="linear-regression.html"><a href="linear-regression.html#final-model-accuracy-assessment"><i class="fa fa-check"></i><b>4.6.3</b> Final model &amp; accuracy assessment</a></li>
<li class="chapter" data-level="4.6.4" data-path="linear-regression.html"><a href="linear-regression.html#model-effects"><i class="fa fa-check"></i><b>4.6.4</b> Model Effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="linear-regression.html"><a href="linear-regression.html#generate-spatial-predictions"><i class="fa fa-check"></i><b>4.7</b> Generate spatial predictions</a></li>
<li class="chapter" data-level="4.8" data-path="linear-regression.html"><a href="linear-regression.html#create-map"><i class="fa fa-check"></i><b>4.8</b> Create Map</a></li>
<li class="chapter" data-level="4.9" data-path="linear-regression.html"><a href="linear-regression.html#literature"><i class="fa fa-check"></i><b>4.9</b> Literature</a></li>
<li class="chapter" data-level="4.10" data-path="linear-regression.html"><a href="linear-regression.html#additional-reading-1"><i class="fa fa-check"></i><b>4.10</b> Additional reading</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html"><i class="fa fa-check"></i><b>A</b> Accuracy and Uncertainty for Categorical Predictions</a><ul>
<li class="chapter" data-level="A.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#status-quo"><i class="fa fa-check"></i><b>A.1</b> Status Quo</a></li>
<li class="chapter" data-level="A.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#theses"><i class="fa fa-check"></i><b>A.2</b> Theses</a></li>
<li class="chapter" data-level="A.3" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#soap-box-time"><i class="fa fa-check"></i><b>A.3</b> Soap Box Time</a></li>
<li class="chapter" data-level="A.4" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#concept-demonstration-via-simulated-data"><i class="fa fa-check"></i><b>A.4</b> Concept Demonstration via Simulated Data</a></li>
<li class="chapter" data-level="A.5" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#accuracy"><i class="fa fa-check"></i><b>A.5</b> Accuracy</a><ul>
<li class="chapter" data-level="A.5.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#confusion-matrix-area-under-roc"><i class="fa fa-check"></i><b>A.5.1</b> Confusion Matrix / Area Under ROC</a></li>
<li class="chapter" data-level="A.5.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#brier-scores"><i class="fa fa-check"></i><b>A.5.2</b> Brier Scores</a></li>
<li class="chapter" data-level="A.5.3" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#tau-and-weighted-tau-class-similarity"><i class="fa fa-check"></i><b>A.5.3</b> Tau and Weighted Tau (class-similarity)</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#uncertainty-1"><i class="fa fa-check"></i><b>A.6</b> Uncertainty</a><ul>
<li class="chapter" data-level="A.6.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#shanon-entropy"><i class="fa fa-check"></i><b>A.6.1</b> Shanon Entropy</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#review"><i class="fa fa-check"></i><b>A.7</b> Review</a></li>
<li class="chapter" data-level="A.8" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#example-implementation"><i class="fa fa-check"></i><b>A.8</b> Example Implementation</a></li>
<li class="chapter" data-level="A.9" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#resources"><i class="fa fa-check"></i><b>A.9</b> Resources</a><ul>
<li class="chapter" data-level="A.9.1" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#evaluating-accuracy-of-categorical-probabilistic-predictions"><i class="fa fa-check"></i><b>A.9.1</b> Evaluating Accuracy of Categorical / Probabilistic Predictions</a></li>
<li class="chapter" data-level="A.9.2" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#sampling-and-stability-of-estimates"><i class="fa fa-check"></i><b>A.9.2</b> Sampling and Stability of Estimates</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="acc-unc-categorical-data.html"><a href="acc-unc-categorical-data.html#references-appdx"><i class="fa fa-check"></i><b>A.10</b> References (Appdx)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Soil Survey - Part 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="uncertainty" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Uncertainty</h1>
<p><img src="static-figures/logo.jpg" /></p>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">2.1</span> Introduction</h2>
<p>Validating and assessing the uncertainty of a model is just as, if not more important, than generating the model itself. Validation quantifies the model’s ability to explain variance in the data while uncertainty quantifies the confidence of model prediction. Uncertainty and validation assessments enable the end user to better understand model error, the nature and distribution of the input data, and the overall accuracy and spatial applicability of the model. Within a soil model, there are several sources of error:</p>
<ul>
<li>Measurement errors</li>
<li>Interpretation errors</li>
<li>Digitization errors</li>
<li>Classification errors</li>
<li>Generalization errors</li>
<li>Interpolation errors</li>
</ul>
<p>Errors are simply the difference between reality and our representation of reality. Assessing the data structure with simple statistical measures such as mean, median and mode can be useful for understanding the central tendency of the data, but more complicated calculations are needed to get at dispersion or the variation of a property within a population to further assess error and uncertainty (Zar, 1999).</p>
<p><strong>Measure of Dispersion</strong></p>
<ul>
<li>Range: The difference between the highest and lowest values measured or observed. Not always reliable because it can include outliers, error, or misclassified data.</li>
<li>Quantiles: These refer to 25% increments in the rank of observations. Typically, the 25th and 75th quantiles are used to represent the spread of the most typical values around the central tendency.</li>
</ul>
<p><strong>Measure of Variation</strong>
* Variance: The deviation of from the mean is calculated as sum of squares (SS) to use absolute deviation (eliminate any distinction between negative and positive correlation). <span class="math inline">\(variance (sample) = \frac{SS}{n-1}\)</span></p>
<ul>
<li><span class="math inline">\(SS = \sum{(X - x)^2}\)</span></li>
<li>Standard deviation: Used to return variance to the original units <span class="math inline">\(sd = \sqrt{\frac{SS}{n-1}}\)</span></li>
<li>Coefficient of variation: Scale standard deviation with mean so that multiple properties can be compared <span class="math inline">\(CV = \frac{SD}{x}\)</span></li>
</ul>
<p><strong>Measures of Certainty</strong></p>
<ul>
<li>Standard Error: represents the variance of the mean that would be found with repeated sampling. Estimated by dividing standard deviation by the square root of n. The concept of standard error is important for hypothesis testing.</li>
<li>Confidence interval: Interval in which you are confident that a given percentage (known as the confidence limit 95, 80, 75%) of the population lie. If a normal distribution is assumed, for a 95% confidence interval, it can be estimated that the value is 95% likely to fall between as SD * 1.96 +/- mean.</li>
</ul>
<div id="exercise---dispersion" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Exercise - Dispersion</h3>
<p>Create an example data-set and evaluate dispersion.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb7-1"><a href="uncertainty.html#cb7-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="uncertainty.html#cb7-2"></a></span>
<span id="cb7-3"><a href="uncertainty.html#cb7-3"></a><span class="co"># set random seed, so that we all get the same results</span></span>
<span id="cb7-4"><a href="uncertainty.html#cb7-4"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-5"><a href="uncertainty.html#cb7-5"></a></span>
<span id="cb7-6"><a href="uncertainty.html#cb7-6"></a><span class="co"># create a sample dataset with 10 values between 20 - 60</span></span>
<span id="cb7-7"><a href="uncertainty.html#cb7-7"></a>d1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb7-8"><a href="uncertainty.html#cb7-8"></a>  <span class="dt">soil =</span> <span class="st">&quot;alpha&quot;</span>,</span>
<span id="cb7-9"><a href="uncertainty.html#cb7-9"></a>  <span class="dt">depth =</span> <span class="kw">sample</span>(<span class="dv">20</span><span class="op">:</span><span class="dv">60</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-10"><a href="uncertainty.html#cb7-10"></a>  )</span>
<span id="cb7-11"><a href="uncertainty.html#cb7-11"></a></span>
<span id="cb7-12"><a href="uncertainty.html#cb7-12"></a><span class="co"># create a sample dataset with 100 values between 20 - 60</span></span>
<span id="cb7-13"><a href="uncertainty.html#cb7-13"></a>d2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb7-14"><a href="uncertainty.html#cb7-14"></a>  <span class="dt">soil =</span> <span class="st">&quot;beta&quot;</span>,</span>
<span id="cb7-15"><a href="uncertainty.html#cb7-15"></a>  <span class="dt">depth =</span> <span class="kw">sample</span>(<span class="dv">20</span><span class="op">:</span><span class="dv">60</span>, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-16"><a href="uncertainty.html#cb7-16"></a>  )</span>
<span id="cb7-17"><a href="uncertainty.html#cb7-17"></a></span>
<span id="cb7-18"><a href="uncertainty.html#cb7-18"></a><span class="co"># combine d1 and d2</span></span>
<span id="cb7-19"><a href="uncertainty.html#cb7-19"></a>d3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(d1, d2)</span>
<span id="cb7-20"><a href="uncertainty.html#cb7-20"></a></span>
<span id="cb7-21"><a href="uncertainty.html#cb7-21"></a><span class="kw">aggregate</span>(depth <span class="op">~</span><span class="st"> </span>soil, <span class="dt">data =</span> d3, quantile)</span>
<span id="cb7-22"><a href="uncertainty.html#cb7-22"></a></span>
<span id="cb7-23"><a href="uncertainty.html#cb7-23"></a><span class="co"># examine box plots</span></span>
<span id="cb7-24"><a href="uncertainty.html#cb7-24"></a><span class="kw">ggplot</span>(d3, <span class="kw">aes</span>(<span class="dt">x =</span> soil, <span class="dt">y =</span> depth)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p>Dispersion or variance is a characteristic of the population being evaluated. While more or better sample collection might give you better precision of those estimates, we would not expect them to change the dispersion calculated. Conversely, measures of certainty of the central tendency (how sure are you of the typical value reported) depends both on the characteristic dispersion/variance and the number of samples collected.</p>
</div>
<div id="exercise---variation-and-certainty" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Exercise - Variation and Certainty</h3>
<p>Create an example data-set and and evaluate variation and certainty.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb8-1"><a href="uncertainty.html#cb8-1"></a><span class="co"># calculate the mean of depth</span></span>
<span id="cb8-2"><a href="uncertainty.html#cb8-2"></a>m &lt;-<span class="st"> </span><span class="kw">mean</span>(d2<span class="op">$</span>depth)</span>
<span id="cb8-3"><a href="uncertainty.html#cb8-3"></a> </span>
<span id="cb8-4"><a href="uncertainty.html#cb8-4"></a><span class="co"># subtract mean from each value and square (i.e. residuals)</span></span>
<span id="cb8-5"><a href="uncertainty.html#cb8-5"></a>d2<span class="op">$</span>S &lt;-<span class="st"> </span>(d2<span class="op">$</span>depth <span class="op">-</span><span class="st"> </span>m)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb8-6"><a href="uncertainty.html#cb8-6"></a> </span>
<span id="cb8-7"><a href="uncertainty.html#cb8-7"></a><span class="co">#calculate overall sum of squares</span></span>
<span id="cb8-8"><a href="uncertainty.html#cb8-8"></a>SS &lt;-<span class="st"> </span><span class="kw">sum</span>(d2<span class="op">$</span>S)</span>
<span id="cb8-9"><a href="uncertainty.html#cb8-9"></a> </span>
<span id="cb8-10"><a href="uncertainty.html#cb8-10"></a><span class="co">#calculate sample variance (length gives us the total number of sample/observations)</span></span>
<span id="cb8-11"><a href="uncertainty.html#cb8-11"></a>SS <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(d2<span class="op">$</span>depth) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<p>Note the differences in range and variance calculated for Depth in both examples (10 samples vs. 100)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb9-1"><a href="uncertainty.html#cb9-1"></a><span class="kw">aggregate</span>(depth <span class="op">~</span><span class="st"> </span>soil, <span class="dt">data =</span> d3, var)</span></code></pre></div>
<p>Now Compare Standard Error (standard deviation / square root of n)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb10-1"><a href="uncertainty.html#cb10-1"></a>SE &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))</span>
<span id="cb10-2"><a href="uncertainty.html#cb10-2"></a></span>
<span id="cb10-3"><a href="uncertainty.html#cb10-3"></a><span class="kw">aggregate</span>(depth <span class="op">~</span><span class="st"> </span>soil, <span class="dt">data =</span> d3, SE)</span></code></pre></div>
<p>Why are the standard errors different?</p>
</div>
</div>
<div id="theory-of-uncertainty" class="section level2">
<h2><span class="header-section-number">2.2</span> Theory of Uncertainty</h2>
<p>At it’s most basic level, uncertainty is simply a lack of certainty. In soil survey, uncertainty encompasses both of these aspects:</p>
<ol style="list-style-type: decimal">
<li>you’ve gathered multiple observations and you need to describe them in relation to one another, and</li>
<li>you must predict a property or characteristic at unobserved locations.</li>
</ol>
<p>It is difficult to quantify the knowledge we have about data and information uncertainty. While we may have good data of the accuracy of our GPS, how likely are we to include that in our estimates of model error? How important is it? In other disciplines, they spend a lot of time quantifying and tracking measurement error. In soil science, we tend to treat measurement as having an exact known location and value. Given the unknowns in mapping and predicting soil properties, this is a reasonable treatment of relatively small levels of error.</p>
<p>When using secondary information as data (or data that is actually a prior prediction or result of a model, including soil components), considering incorporated error can be crucial. One way to deal with this is through re-sampling an alternate way is to through error propagation theory. The most common way to deal with this in soil survey and digital soil mapping is to assess error through model validation.</p>
<p><strong>Explanatory vs. Predictive Modelling</strong></p>
<p>While explanatory and predictive modeling can use the same types of models, data and even questions, the errors and uncertainty are important for different reasons</p>
<p><strong>Explanatory or Descriptive</strong> - data are collected and analyzed in order to test causal hypothesis and observe correlations and relationships between data element. Often used at the beginning phases of soil-landscape exploration. How does the soil relate to each of the soil forming factors?</p>
<p><strong>Predictive</strong> - applying a model or algorithm to data for the purpose of making a prediction (in new or unknown locations) (Shueli, 2010).</p>
</div>
<div id="resampling-to-estimate-uncertainty" class="section level2">
<h2><span class="header-section-number">2.3</span> Resampling to Estimate Uncertainty</h2>
<p>When calculating many basic statistical parameters, the assumption is that the data is parametric. That implies that the data is continuous (ratio or interval) and normally distributed. This is rarely the case with soil data. Soil properties are often not normally distributed (you cannot have less that 0% organic matter, for instance) and often we are trying to predict soil taxa or other nominal classes.</p>
<p>Re-sampling is a general term that defines any procedure to repeatedly draw samples form a given data-set. You are essentially pretending to collect a series of separate samples from your sample set then calculating a statistic on that sample. Re-sampling techniques can be used on known and unknown data distributions for uncertainty estimation and validation (Good, 2001).</p>
<div id="exercise---resampling" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Exercise - Resampling</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb11-1"><a href="uncertainty.html#cb11-1"></a><span class="co"># this bootstrap is estimating the uncertainty associated with the variance of d2$depth</span></span>
<span id="cb11-2"><a href="uncertainty.html#cb11-2"></a><span class="co"># an example of getting a confidence interval through bootstrapping (no assumption of a normal distribution)</span></span>
<span id="cb11-3"><a href="uncertainty.html#cb11-3"></a></span>
<span id="cb11-4"><a href="uncertainty.html#cb11-4"></a><span class="co"># abbreviate our data to simply the commands</span></span>
<span id="cb11-5"><a href="uncertainty.html#cb11-5"></a>d &lt;-<span class="st"> </span>d2<span class="op">$</span>depth</span>
<span id="cb11-6"><a href="uncertainty.html#cb11-6"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(d)</span>
<span id="cb11-7"><a href="uncertainty.html#cb11-7"></a></span>
<span id="cb11-8"><a href="uncertainty.html#cb11-8"></a><span class="co"># set number of iterations</span></span>
<span id="cb11-9"><a href="uncertainty.html#cb11-9"></a>N &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb11-10"><a href="uncertainty.html#cb11-10"></a></span>
<span id="cb11-11"><a href="uncertainty.html#cb11-11"></a><span class="co"># create a data frame to store the results</span></span>
<span id="cb11-12"><a href="uncertainty.html#cb11-12"></a>boot_stats &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb11-13"><a href="uncertainty.html#cb11-13"></a>  <span class="dt">vars =</span> <span class="kw">numeric</span>(N),</span>
<span id="cb11-14"><a href="uncertainty.html#cb11-14"></a>  <span class="dt">means =</span> <span class="kw">numeric</span>(N)</span>
<span id="cb11-15"><a href="uncertainty.html#cb11-15"></a>  )</span>
<span id="cb11-16"><a href="uncertainty.html#cb11-16"></a></span>
<span id="cb11-17"><a href="uncertainty.html#cb11-17"></a><span class="co"># for each instance (i) in the set from 1 to N (50 in this case)</span></span>
<span id="cb11-18"><a href="uncertainty.html#cb11-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb11-19"><a href="uncertainty.html#cb11-19"></a>  <span class="co"># create a new variable dB from each bootstrap sample of d</span></span>
<span id="cb11-20"><a href="uncertainty.html#cb11-20"></a>  boot.sample =<span class="st"> </span><span class="kw">sample</span>(d, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb11-21"><a href="uncertainty.html#cb11-21"></a>  boot_stats<span class="op">$</span>means[i] =<span class="st"> </span><span class="kw">mean</span>(boot.sample)</span>
<span id="cb11-22"><a href="uncertainty.html#cb11-22"></a>  boot_stats<span class="op">$</span>vars[i] =<span class="st"> </span><span class="kw">var</span>(boot.sample)</span>
<span id="cb11-23"><a href="uncertainty.html#cb11-23"></a>  }</span>
<span id="cb11-24"><a href="uncertainty.html#cb11-24"></a></span>
<span id="cb11-25"><a href="uncertainty.html#cb11-25"></a><span class="kw">quantile</span>(boot_stats<span class="op">$</span>vars)</span>
<span id="cb11-26"><a href="uncertainty.html#cb11-26"></a></span>
<span id="cb11-27"><a href="uncertainty.html#cb11-27"></a><span class="kw">stripchart</span>(boot_stats<span class="op">$</span>vars)</span>
<span id="cb11-28"><a href="uncertainty.html#cb11-28"></a></span>
<span id="cb11-29"><a href="uncertainty.html#cb11-29"></a></span>
<span id="cb11-30"><a href="uncertainty.html#cb11-30"></a><span class="co"># Traditional Approach</span></span>
<span id="cb11-31"><a href="uncertainty.html#cb11-31"></a>ci &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb11-32"><a href="uncertainty.html#cb11-32"></a>  <span class="co"># lower 5th</span></span>
<span id="cb11-33"><a href="uncertainty.html#cb11-33"></a>  <span class="dt">l =</span> <span class="kw">mean</span>(d) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(d) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n),</span>
<span id="cb11-34"><a href="uncertainty.html#cb11-34"></a>  <span class="co"># upper 95th</span></span>
<span id="cb11-35"><a href="uncertainty.html#cb11-35"></a>  <span class="dt">u =</span> <span class="kw">mean</span>(d) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(d) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb11-36"><a href="uncertainty.html#cb11-36"></a>  )</span>
<span id="cb11-37"><a href="uncertainty.html#cb11-37"></a></span>
<span id="cb11-38"><a href="uncertainty.html#cb11-38"></a><span class="co"># Compare Bootstrap to Confidence Interval</span></span>
<span id="cb11-39"><a href="uncertainty.html#cb11-39"></a><span class="kw">quantile</span>(boot_stats<span class="op">$</span>means, <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb11-40"><a href="uncertainty.html#cb11-40"></a></span>
<span id="cb11-41"><a href="uncertainty.html#cb11-41"></a>ci</span></code></pre></div>
</div>
</div>
<div id="performance-metrics" class="section level2">
<h2><span class="header-section-number">2.4</span> Performance Metrics</h2>
<p><strong>Numerical</strong></p>
<ul>
<li>Coefficient of variation (<span class="math inline">\(R^2\)</span>): % of variance explained</li>
<li>Mean Error (ME): average error</li>
<li>Root Mean Square Error (RMSE): average residual</li>
</ul>
<p><strong>Categorical</strong> (derivatives of confusion matrix)</p>
<ul>
<li>Overall Accuracy: % of observations that were correctly classified, for all classes</li>
<li>Precision (i.e. user’s accuracy, errors of commission (Type II): % of observations that were correctly classified, for an individual class</li>
<li>Sensitivity (i.e. producer’s accuracy, errors of omission (Type I)): % of predictions that were correctly classified, for an individual class</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Confusion Matrix</th>
<th>Observed</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Predicted</strong></td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>No</td>
<td>True Negative (TN)</td>
<td>False Negative (FN)</td>
</tr>
<tr class="odd">
<td>Yes</td>
<td>False Positive (FP)</td>
<td>True Positive (TP)</td>
</tr>
</tbody>
</table>
<div id="exercise---numeric-metrics" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Exercise - Numeric Metrics</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb12-1"><a href="uncertainty.html#cb12-1"></a><span class="co">### Numeric error metrics</span></span>
<span id="cb12-2"><a href="uncertainty.html#cb12-2"></a></span>
<span id="cb12-3"><a href="uncertainty.html#cb12-3"></a><span class="co">### Linear model example</span></span>
<span id="cb12-4"><a href="uncertainty.html#cb12-4"></a></span>
<span id="cb12-5"><a href="uncertainty.html#cb12-5"></a><span class="co"># Create a Ficticous Data-set</span></span>
<span id="cb12-6"><a href="uncertainty.html#cb12-6"></a>d_num &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb12-7"><a href="uncertainty.html#cb12-7"></a>  <span class="dt">depth =</span> <span class="dv">21</span><span class="op">:</span><span class="dv">60</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">10</span>),</span>
<span id="cb12-8"><a href="uncertainty.html#cb12-8"></a>  <span class="dt">slope =</span> <span class="dv">60</span><span class="op">:</span><span class="dv">21</span></span>
<span id="cb12-9"><a href="uncertainty.html#cb12-9"></a>  )</span>
<span id="cb12-10"><a href="uncertainty.html#cb12-10"></a></span>
<span id="cb12-11"><a href="uncertainty.html#cb12-11"></a>num_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(depth <span class="op">~</span><span class="st"> </span>slope, <span class="dt">data =</span> d_num, <span class="dt">y =</span> <span class="ot">TRUE</span>)</span>
<span id="cb12-12"><a href="uncertainty.html#cb12-12"></a></span>
<span id="cb12-13"><a href="uncertainty.html#cb12-13"></a><span class="co"># R2</span></span>
<span id="cb12-14"><a href="uncertainty.html#cb12-14"></a><span class="kw">summary</span>(num_lm)<span class="op">$</span>r.squared</span>
<span id="cb12-15"><a href="uncertainty.html#cb12-15"></a></span>
<span id="cb12-16"><a href="uncertainty.html#cb12-16"></a><span class="co"># or</span></span>
<span id="cb12-17"><a href="uncertainty.html#cb12-17"></a></span>
<span id="cb12-18"><a href="uncertainty.html#cb12-18"></a>predicted &lt;-<span class="st"> </span>num_lm<span class="op">$</span>fitted.values</span>
<span id="cb12-19"><a href="uncertainty.html#cb12-19"></a>observed &lt;-<span class="st"> </span>num_lm<span class="op">$</span>y</span>
<span id="cb12-20"><a href="uncertainty.html#cb12-20"></a></span>
<span id="cb12-21"><a href="uncertainty.html#cb12-21"></a><span class="kw">cor</span>(predicted, observed)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb12-22"><a href="uncertainty.html#cb12-22"></a></span>
<span id="cb12-23"><a href="uncertainty.html#cb12-23"></a><span class="co"># ME</span></span>
<span id="cb12-24"><a href="uncertainty.html#cb12-24"></a><span class="kw">mean</span>(predicted <span class="op">-</span><span class="st"> </span>observed)</span>
<span id="cb12-25"><a href="uncertainty.html#cb12-25"></a></span>
<span id="cb12-26"><a href="uncertainty.html#cb12-26"></a><span class="co"># RMSE</span></span>
<span id="cb12-27"><a href="uncertainty.html#cb12-27"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((predicted <span class="op">-</span><span class="st"> </span>observed)<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
</div>
<div id="exercise---categorical-metrics" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Exercise - Categorical Metrics</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb13-1"><a href="uncertainty.html#cb13-1"></a><span class="co"># Create a Ficticous Data-set</span></span>
<span id="cb13-2"><a href="uncertainty.html#cb13-2"></a>r &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">175</span>)</span>
<span id="cb13-3"><a href="uncertainty.html#cb13-3"></a>idx &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">which</span>(r <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dv">75</span>)</span>
<span id="cb13-4"><a href="uncertainty.html#cb13-4"></a>r &lt;-<span class="st"> </span>r[<span class="op">-</span>idx]</span>
<span id="cb13-5"><a href="uncertainty.html#cb13-5"></a></span>
<span id="cb13-6"><a href="uncertainty.html#cb13-6"></a>d_cat =<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb13-7"><a href="uncertainty.html#cb13-7"></a>  <span class="dt">predicted =</span> r, </span>
<span id="cb13-8"><a href="uncertainty.html#cb13-8"></a>  <span class="dt">observed  =</span> (r <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> <span class="fl">0.2</span>)) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb13-9"><a href="uncertainty.html#cb13-9"></a>  )</span>
<span id="cb13-10"><a href="uncertainty.html#cb13-10"></a></span>
<span id="cb13-11"><a href="uncertainty.html#cb13-11"></a><span class="co"># Compute Confusion Matrix</span></span>
<span id="cb13-12"><a href="uncertainty.html#cb13-12"></a>cm &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">predicted =</span> d_cat<span class="op">$</span>predicted <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">observed =</span> d_cat<span class="op">$</span>observed)</span>
<span id="cb13-13"><a href="uncertainty.html#cb13-13"></a><span class="kw">print</span>(cm)</span>
<span id="cb13-14"><a href="uncertainty.html#cb13-14"></a></span>
<span id="cb13-15"><a href="uncertainty.html#cb13-15"></a><span class="co"># or</span></span>
<span id="cb13-16"><a href="uncertainty.html#cb13-16"></a></span>
<span id="cb13-17"><a href="uncertainty.html#cb13-17"></a><span class="kw">library</span>(caret)</span>
<span id="cb13-18"><a href="uncertainty.html#cb13-18"></a><span class="kw">confusionMatrix</span>(cm, <span class="dt">positive =</span> <span class="st">&quot;TRUE&quot;</span>)</span>
<span id="cb13-19"><a href="uncertainty.html#cb13-19"></a></span>
<span id="cb13-20"><a href="uncertainty.html#cb13-20"></a></span>
<span id="cb13-21"><a href="uncertainty.html#cb13-21"></a><span class="co"># Examine threshoold</span></span>
<span id="cb13-22"><a href="uncertainty.html#cb13-22"></a><span class="kw">ggplot</span>(d_cat, <span class="kw">aes</span>(<span class="dt">x =</span> predicted, <span class="dt">color =</span> observed)) <span class="op">+</span></span>
<span id="cb13-23"><a href="uncertainty.html#cb13-23"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb13-24"><a href="uncertainty.html#cb13-24"></a></span>
<span id="cb13-25"><a href="uncertainty.html#cb13-25"></a></span>
<span id="cb13-26"><a href="uncertainty.html#cb13-26"></a><span class="co"># Trade Precision for Sensitivity by Varying the Threshold </span></span>
<span id="cb13-27"><a href="uncertainty.html#cb13-27"></a>cm &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">predicted =</span> d_cat<span class="op">$</span>predicted <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.4</span>, <span class="dt">observed =</span> d_cat<span class="op">$</span>observed)</span>
<span id="cb13-28"><a href="uncertainty.html#cb13-28"></a><span class="kw">confusionMatrix</span>(cm, <span class="dt">positive =</span> <span class="st">&quot;TRUE&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="validation" class="section level2">
<h2><span class="header-section-number">2.5</span> Validation</h2>
<p>Validation refers to the process and the result of a process where the validity of a model is tested. That is, how well does the model represent reality? There are varying degrees of formality and thoroughness that can be used in validation. While multiple stages of the modeling process can be validated, usually it’s the output of the model that is investigated and reported. You can group initial validation into three broad groups: Expert evaluation, Theoretical Analysis and Prediction Accuracy.</p>
<p><strong>Expert Evaluation:</strong> In this case, the model output is inspected by an expert user. The first evaluator will be you (the developer), but ideally an outside expert will be utilized. This is often a step in an iterative process. Evaluate the model output, does it make sense, do you see things that need to be improved? Then make changes to the model to improve the output.</p>
<p><strong>Theoretical Analysis:</strong> compare the results of the model to what is theoretically possible. In systems modeling, this might include diagnostics statistics including residual analysis, cross-correlation of variables and outputs, sensitivity analysis and model analysis such as Akaike Information Criterion (AIC). This can also include simple comparison of output to known possible values. This is especially important for linear regression where the slope of the model is assumed to be steady no matter the values of the dependent variables.</p>
<p><strong>Prediction Accuracy</strong>: The correctness of the parameter being predicted by the model (soil taxa, property etc.). Ideally this is done with an independent set of data.</p>
<p>In soil science, we typically use the term model validation to refer to a statistical analysis that assesses how well a model will predict at an unknown location. A complete model should have a formal statistical evaluation that can be reported and stored as model and output meta-data. That is the portion of validation we will focus. For this discussion, validation can be thought of as an assessment of prediction error and variance.</p>
<p><strong>Three types of validation used in the course</strong></p>
<ul>
<li>Apparent - Performance on sample used to develop model</li>
<li>Internal - Performance on population underlying the sample</li>
<li>External - Performance on related (similar/adjacent) but independent population</li>
</ul>
</div>
<div id="apparent-validation" class="section level2">
<h2><span class="header-section-number">2.6</span> Apparent Validation</h2>
<p>In this exploratory and explanatory phase you are looking for relationships that can be used later for predictive purposes.</p>
<ul>
<li>Use Goodness of fit tests on all the data in your sample
<ul>
<li>Correlation (R2, rho, etc.)</li>
<li>P-values (test questions about individual or combinations of variables)</li>
</ul></li>
<li>Analyze Residuals (distribution of model errors) to diagnose modeling problems. One or more of these issues indicate that one or more important variables was omitted from the model or that an incorrect functional form was used (linear when the function should be non-linear)
<ul>
<li>Heteroscedasticity</li>
<li>Normality</li>
<li>Spatial distribution (auto-correlation)</li>
</ul></li>
</ul>
</div>
<div id="inherent-validation" class="section level2">
<h2><span class="header-section-number">2.7</span> Inherent Validation</h2>
<div id="split-sample---a-single-partition-of-the-data-into-a-learning-and-a-calibration-set." class="section level3">
<h3><span class="header-section-number">2.7.1</span> Split-sample - A single partition of the data into a learning and a calibration set.</h3>
<ul>
<li>Achieve an independent validation by partitioning the samples into calibration or training and validation data-sets (70% of the samples available are recommended for calibration)
<ul>
<li>Build model on calibration (training) data-set</li>
<li>Test model on validation (test) data-set</li>
<li>Report accuracy on the validation data-set</li>
</ul></li>
<li>This method is relatively simple (conceptually and computationally). Results depend on having an adequate sample size to both develop and test the model.</li>
</ul>
</div>
<div id="cross-validation---alternate-development-and-validation" class="section level3">
<h3><span class="header-section-number">2.7.2</span> Cross-validation - Alternate development and validation</h3>
<p><strong>Leave-One-Out Cross-Validation (LOOCV)</strong></p>
<ul>
<li>One observation is used for testing and all others are used to develop model</li>
<li>Repeat n (total number of observations) times</li>
<li>Average error over n</li>
<li>The mean of the accuracy is the expected accuracy of the model (this assumes that new data is from the same population) (Efron, 1983)</li>
</ul>
<p><strong>k-fold Cross-Validation (k-fold) CV</strong></p>
<ul>
<li>Randomly divide observations into calibration and validation sets.</li>
<li>Repeat k times, each time one k group is used for error estimates</li>
<li>Average error of k</li>
<li>Less computationally intensive than LOOCV, but it is more robust and can be done with smaller sample sizes than a simple split.</li>
<li>Several R packages have tools to cross-validate predictions, including: <code>DAAG</code> and <code>boot</code> for <code>lm()</code> and <code>glm()</code> objects, <code>caret</code>, <code>rms</code>,</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r codeBlock"><code class="sourceCode r"><span id="cb14-1"><a href="uncertainty.html#cb14-1"></a><span class="co">### Linear model example</span></span>
<span id="cb14-2"><a href="uncertainty.html#cb14-2"></a><span class="co"># Create folds</span></span>
<span id="cb14-3"><a href="uncertainty.html#cb14-3"></a>folds &lt;-<span class="st"> </span><span class="kw">createFolds</span>(d_num<span class="op">$</span>depth, <span class="dt">k =</span> <span class="dv">10</span>)</span>
<span id="cb14-4"><a href="uncertainty.html#cb14-4"></a></span>
<span id="cb14-5"><a href="uncertainty.html#cb14-5"></a><span class="co"># Cross validate</span></span>
<span id="cb14-6"><a href="uncertainty.html#cb14-6"></a>lm_cv &lt;-<span class="st"> </span><span class="kw">lapply</span>(folds, <span class="cf">function</span>(x) {</span>
<span id="cb14-7"><a href="uncertainty.html#cb14-7"></a>  train   =<span class="st"> </span>d_num[<span class="op">-</span>x,]</span>
<span id="cb14-8"><a href="uncertainty.html#cb14-8"></a>  test    =<span class="st"> </span>d_num[x,]</span>
<span id="cb14-9"><a href="uncertainty.html#cb14-9"></a>  model   =<span class="st"> </span><span class="kw">lm</span>(depth <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> train, <span class="dt">y =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-10"><a href="uncertainty.html#cb14-10"></a>  actual  =<span class="st"> </span>test<span class="op">$</span>depth</span>
<span id="cb14-11"><a href="uncertainty.html#cb14-11"></a>  predict =<span class="st"> </span><span class="kw">predict</span>(model, test)</span>
<span id="cb14-12"><a href="uncertainty.html#cb14-12"></a>  RMSE    =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>((actual <span class="op">-</span><span class="st"> </span>predict)<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb14-13"><a href="uncertainty.html#cb14-13"></a>  R2      =<span class="st"> </span><span class="kw">cor</span>(actual, predict, <span class="dt">use =</span> <span class="st">&quot;pairwise&quot;</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb14-14"><a href="uncertainty.html#cb14-14"></a>  <span class="kw">return</span>(<span class="kw">c</span>(<span class="dt">RMSE =</span> RMSE, <span class="dt">R2 =</span> R2))</span>
<span id="cb14-15"><a href="uncertainty.html#cb14-15"></a>  }</span>
<span id="cb14-16"><a href="uncertainty.html#cb14-16"></a>  )</span>
<span id="cb14-17"><a href="uncertainty.html#cb14-17"></a></span>
<span id="cb14-18"><a href="uncertainty.html#cb14-18"></a><span class="co"># Convert to a data.frame</span></span>
<span id="cb14-19"><a href="uncertainty.html#cb14-19"></a>lm_cv &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, lm_cv)</span>
<span id="cb14-20"><a href="uncertainty.html#cb14-20"></a></span>
<span id="cb14-21"><a href="uncertainty.html#cb14-21"></a><span class="co"># Summarize results</span></span>
<span id="cb14-22"><a href="uncertainty.html#cb14-22"></a><span class="kw">summary</span>(lm_cv)</span></code></pre></div>
</div>
<div id="subsample-resampling-or-sample-simulation" class="section level3">
<h3><span class="header-section-number">2.7.3</span> Subsample (Resampling or sample simulation)</h3>
<p>In this method, the ‘leave-out’ method can be random (Bootstrap) or observation selection can use a more sophisticated method to select observations to represent the population including Monte Carlo (Molarino, 2005) and .632+bootstrap of Efron &amp; Tibshirani (1997). The details of those aren’t important, except to know that they can give you a better idea of the robustness of your model.</p>
<ul>
<li>As with re-sampling for uncertainty estimation, observations are repeatedly sampled
<ul>
<li>Select a number of samples (Randomly or from known distribution).</li>
<li>Develop the model</li>
<li>Estimate model accuracy on unselected samples</li>
<li>Repeat the process (with independent sample) a large number of times, 500 - 5,000.</li>
<li>The expected model accuracy is then the mean of the estimates.</li>
</ul></li>
</ul>
<p><strong>NOTE:</strong> The BEST model should not be assumed to be the one that makes the ‘truest’ predictions. Beware of over-fitting. When a model is over-fit, it predicts due to very specific “quirks” in the calibration data set and not due to explanatory relationships that will apply to validation and independent data-sets. One strategy to avoid this situation is to build models with as few variables as possible. Parsimonious models (those that use the least amount of information possible to obtain the same result or convey the same meaning) often have higher predicative validity. The use of metrics such as Akaike’s Information Criterion (AIC) can be helpful for balancing error and parameter minimization.</p>
</div>
<div id="external-validation" class="section level3">
<h3><span class="header-section-number">2.7.4</span> External Validation</h3>
<p>In this case, an independent data-set is used as the test case.</p>
<ul>
<li>Independent observations predicted with model</li>
<li>Errors (ME, RMSE) calculated on predicted vs. actual</li>
<li>Some exploratory analysis can be helpful to diagnose and explain model performance.</li>
</ul>
<p>The use of validation will be demonstrated as part of each modeling section. The size of the data-set used, understanding of the variables involved and the nature of the statistical models and algorithms used all influence which validation techniques are most convenient and appropriate.</p>
</div>
</div>
<div id="additional-reading" class="section level2">
<h2><span class="header-section-number">2.8</span> Additional reading</h2>
<p>James, G., D. Witten, T. Hastie, and R. Tibshirani, 2014. An Introduction to Statistical Learning: with Applications in R. Springer, New York. <a href="http://www-bcf.usc.edu/~gareth/ISL/">http://www-bcf.usc.edu/~gareth/ISL/</a></p>
<p>Hastie, T., R. Tibshirani, and J. Friedman 2009. The Elements of Statistical Learning: Data Mining, Inference, and Prediction. Springer, New York. <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/">http://statweb.stanford.edu/~tibs/ElemStatLearn/</a></p>
</div>
<div id="references-uncertainty" class="section level2">
<h2><span class="header-section-number">2.9</span> References (Uncertainty)</h2>
<p>Efron, B., Tibshirani, R.J., 1993. An introduction to the bootstrap. Monographs on Statistics and Applied Probability, vol. 57. Chapman &amp; Hall, London, UK.</p>
<p>Good, P.I., 2001. Resampling methods. Birkhäuser.</p>
<p>James, G., D. Witten, T. Hastie, and R. Tibshirani, 2014. An Introduction to Statistical Learning: with Applications in R. Springer, New York. <a href="http://www-bcf.usc.edu/~gareth/ISL/">http://www-bcf.usc.edu/~gareth/ISL/</a></p>
<p>Molinaro, A. M. (2005). Prediction error estimation: a comparison of resampling methods. Bioinformatics, 21(15), 3301-3307. <a href="doi:10.1093/bioinformatics/bti499" class="uri">doi:10.1093/bioinformatics/bti499</a></p>
<p>Shmueli, G.. (2010). To Explain or to Predict?. Statistical Science, 25(3), 289:310. Retrieved from <a href="http://www.jstor.org/stable/41058949" class="uri">http://www.jstor.org/stable/41058949</a></p>
<p>Zar, J.H., 1999. Biostatistical analysis. Pearson Education India.</p>

<!-- load libraries for examples, which run before any code is displayed -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ordination.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["s4ssbook.pdf", "s4ssbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
