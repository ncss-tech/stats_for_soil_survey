<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 The Data We Use | Statistics for Soil Survey - Part 1</title>
  <meta name="description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 The Data We Use | Statistics for Soil Survey - Part 1" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 The Data We Use | Statistics for Soil Survey - Part 1" />
  
  <meta name="twitter:description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  

<meta name="author" content="Soil Survey Staff" />


<meta name="date" content="2021-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="exploratory-data-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for Soil Survey - Part 1</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> or the development version</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#create-workspace"><i class="fa fa-check"></i><b>1.1</b> Create Workspace</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#configure-rstudio"><i class="fa fa-check"></i><b>1.2</b> Configure RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#essentials"><i class="fa fa-check"></i><b>1.3</b> Essentials</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#personalization"><i class="fa fa-check"></i><b>1.4</b> Personalization</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#install-.rprofile"><i class="fa fa-check"></i><b>1.5</b> Install .RProfile</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#install-required-packages"><i class="fa fa-check"></i><b>1.6</b> Install Required Packages</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#character-vector-of-packages"><i class="fa fa-check"></i><b>1.7</b> character vector of packages</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#install-vector-of-cran-packages-safely"><i class="fa fa-check"></i><b>1.8</b> install vector of CRAN packages “safely”</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#up-true-to-download-all-packages"><i class="fa fa-check"></i><b>1.9</b> up = TRUE to download all packages</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#up-false-to-download-only-packages-you-dont-already-have-installed"><i class="fa fa-check"></i><b>1.10</b> up = FALSE to download only packages you don’t already have installed</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#common-errors"><i class="fa fa-check"></i><b>1.11</b> Common Errors</a><ul>
<li class="chapter" data-level="1.11.1" data-path="index.html"><a href="index.html#no-output-is-produced-after-pasting-into-console"><i class="fa fa-check"></i><b>1.11.1</b> No output is produced after pasting into console</a></li>
<li class="chapter" data-level="1.11.2" data-path="index.html"><a href="index.html#somepackage-is-not-available-for-r-version-x.y.z"><i class="fa fa-check"></i><b>1.11.2</b> <code>‘SOMEPACKAGE’ is not available (for R version X.Y.Z)</code></a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#packages-not-on-cran"><i class="fa fa-check"></i><b>1.12</b> Packages not on CRAN</a></li>
<li class="chapter" data-level="1.13" data-path="index.html"><a href="index.html#connect-local-nasis"><i class="fa fa-check"></i><b>1.13</b> Connect Local NASIS</a></li>
<li class="chapter" data-level="1.14" data-path="index.html"><a href="index.html#proof"><i class="fa fa-check"></i><b>1.14</b> Proof</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#course-overview"><i class="fa fa-check"></i><b>2.2</b> Course Overview</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#course-objectives"><i class="fa fa-check"></i><b>2.2.1</b> Course Objectives</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#why-is-this-training-needed"><i class="fa fa-check"></i><b>2.2.2</b> Why is this training needed?</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#why-is-course-organized-this-way"><i class="fa fa-check"></i><b>2.2.3</b> Why is course organized this way?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>2.3</b> What is R?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#why-should-i-learn-r"><i class="fa fa-check"></i><b>2.3.1</b> Why Should I Learn R?</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#what-can-r-do"><i class="fa fa-check"></i><b>2.3.2</b> What can R do?</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>2.3.3</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rstudio-an-integrated-development-environment-ide-for-r"><i class="fa fa-check"></i><b>2.4</b> RStudio: An Integrated Development Environment (IDE) for R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#usda-computer-setup"><i class="fa fa-check"></i><b>2.4.1</b> USDA Computer Setup</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#basic-tips-for-using-r"><i class="fa fa-check"></i><b>2.4.2</b> Basic Tips for using R</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#working-directories"><i class="fa fa-check"></i><b>2.4.3</b> Working Directories</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#more-rstudio-project-features"><i class="fa fa-check"></i><b>2.4.4</b> More RStudio Project Features</a></li>
<li class="chapter" data-level="2.4.5" data-path="intro.html"><a href="intro.html#data-management-in-rstudio"><i class="fa fa-check"></i><b>2.4.5</b> Data Management in RStudio</a></li>
<li class="chapter" data-level="2.4.6" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>2.4.6</b> Getting Help</a></li>
<li class="chapter" data-level="2.4.7" data-path="intro.html"><a href="intro.html#packages-1"><i class="fa fa-check"></i><b>2.4.7</b> Packages</a></li>
<li class="chapter" data-level="2.4.8" data-path="intro.html"><a href="intro.html#writing-scripts"><i class="fa fa-check"></i><b>2.4.8</b> Writing Scripts</a></li>
<li class="chapter" data-level="2.4.9" data-path="intro.html"><a href="intro.html#saving-r-files"><i class="fa fa-check"></i><b>2.4.9</b> Saving R Files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#this-is-not-something-we-should-encourage-people-to-do.-not-reproducible.-we-tell-them-to-turn-off-this-feature-in-the-pre-course-and-i-sure-hope-they-do-because-it-is-a-monstrous-waste-of-their-and-our-debugging-time."><i class="fa fa-check"></i><b>2.5</b> This is not something we should encourage people to do. Not reproducible. We tell them to turn off this “feature” in the pre-course and I sure hope they do because it is a monstrous waste of their and our debugging time.</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#history-is-the-only-thing-they-should-save-unless-they-explicitly-are-selecting-the-objects-to-save-and-using-e.g.-save-saverds-load-etc.--agb"><i class="fa fa-check"></i><b>2.6</b> History is the only thing they should save, unless they explicitly are selecting the objects to save and using e.g. save(), saveRDS() / load() etc. -AGB</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#rcmdr-r-commander-a-graphical-user-interface-for-r"><i class="fa fa-check"></i><b>2.7</b> Rcmdr (R Commander): A Graphical User Interface for R</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#review"><i class="fa fa-check"></i><b>2.8</b> Review</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#additional-reading-introduction"><i class="fa fa-check"></i><b>2.9</b> Additional Reading (Introduction)</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#references-introduction"><i class="fa fa-check"></i><b>2.10</b> References (Introduction)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-data-we-use.html"><a href="the-data-we-use.html"><i class="fa fa-check"></i><b>3</b> The Data We Use</a><ul>
<li class="chapter" data-level="3.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#objectives-data"><i class="fa fa-check"></i><b>3.1</b> Objectives (Data)</a></li>
<li class="chapter" data-level="3.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#the-structure-of-our-data"><i class="fa fa-check"></i><b>3.2</b> The Structure of Our Data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#package-references"><i class="fa fa-check"></i><b>3.2.1</b> Package References</a></li>
<li class="chapter" data-level="3.2.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#soildb-functions-for-tabular-data"><i class="fa fa-check"></i><b>3.2.2</b> soilDB functions for tabular data</a></li>
<li class="chapter" data-level="3.2.3" data-path="the-data-we-use.html"><a href="the-data-we-use.html#importance-of-pedon-data"><i class="fa fa-check"></i><b>3.2.3</b> Importance of Pedon Data</a></li>
<li class="chapter" data-level="3.2.4" data-path="the-data-we-use.html"><a href="the-data-we-use.html#some-issues-with-pedon-data"><i class="fa fa-check"></i><b>3.2.4</b> Some Issues With Pedon Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-data-we-use.html"><a href="the-data-we-use.html#challenges-with-pedon-data"><i class="fa fa-check"></i><b>3.3</b> Challenges with Pedon Data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#meeting-the-challenges"><i class="fa fa-check"></i><b>3.3.1</b> Meeting the Challenges</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-data-we-use.html"><a href="the-data-we-use.html#the-aqp-soilprofilecollection"><i class="fa fa-check"></i><b>3.4</b> The <code>aqp</code> <code>SoilProfileCollection</code></a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#soilprofilecollection-methods"><i class="fa fa-check"></i><b>3.4.1</b> SoilProfileCollection methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-data-we-use.html"><a href="the-data-we-use.html#using-the-soildb-package"><i class="fa fa-check"></i><b>3.5</b> Using the <code>soilDB</code> Package</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#open-database-connectivity-odbc-connection-to-nasis"><i class="fa fa-check"></i><b>3.5.1</b> Open Database Connectivity (ODBC) Connection to NASIS</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#fetchnasis"><i class="fa fa-check"></i><b>3.5.2</b> <code>fetchNASIS()</code></a></li>
<li class="chapter" data-level="3.5.3" data-path="the-data-we-use.html"><a href="the-data-we-use.html#the-gopheridge-soildb-dataset"><i class="fa fa-check"></i><b>3.5.3</b> The <code>gopheridge</code> <code>soilDB</code> Dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-data-we-use.html"><a href="the-data-we-use.html#working-with-data-in-r"><i class="fa fa-check"></i><b>3.6</b> Working with Data in R</a><ul>
<li class="chapter" data-level="3.6.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#summaries"><i class="fa fa-check"></i><b>3.6.1</b> Summaries</a></li>
<li class="chapter" data-level="3.6.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#missing-values"><i class="fa fa-check"></i><b>3.6.2</b> Missing Values</a></li>
<li class="chapter" data-level="3.6.3" data-path="the-data-we-use.html"><a href="the-data-we-use.html#logical-operators"><i class="fa fa-check"></i><b>3.6.3</b> Logical Operators</a></li>
<li class="chapter" data-level="3.6.4" data-path="the-data-we-use.html"><a href="the-data-we-use.html#pattern-matching"><i class="fa fa-check"></i><b>3.6.4</b> Pattern Matching</a></li>
<li class="chapter" data-level="3.6.5" data-path="the-data-we-use.html"><a href="the-data-we-use.html#filtering"><i class="fa fa-check"></i><b>3.6.5</b> Filtering</a></li>
<li class="chapter" data-level="3.6.6" data-path="the-data-we-use.html"><a href="the-data-we-use.html#filtering-data-by-logical-criteria-with-aqpsubset"><i class="fa fa-check"></i><b>3.6.6</b> Filtering Data by Logical Criteria with <code>aqp::subset</code></a></li>
<li class="chapter" data-level="3.6.7" data-path="the-data-we-use.html"><a href="the-data-we-use.html#dates-and-times"><i class="fa fa-check"></i><b>3.6.7</b> Dates and Times</a></li>
<li class="chapter" data-level="3.6.8" data-path="the-data-we-use.html"><a href="the-data-we-use.html#exercise-prepare-example-data"><i class="fa fa-check"></i><b>3.6.8</b> EXERCISE: Prepare Example Data</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="the-data-we-use.html"><a href="the-data-we-use.html#comparing-results-with-rmhzerrors"><i class="fa fa-check"></i><b>3.7</b> Comparing Results with <code>rmHzErrors</code></a></li>
<li class="chapter" data-level="3.8" data-path="the-data-we-use.html"><a href="the-data-we-use.html#extended-data-functions"><i class="fa fa-check"></i><b>3.8</b> Extended Data Functions</a><ul>
<li class="chapter" data-level="3.8.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#elements-of-get_extended_data_from_nasis"><i class="fa fa-check"></i><b>3.8.1</b> Elements of <code>get_extended_data_from_NASIS()</code></a></li>
<li class="chapter" data-level="3.8.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#visualizing-common-landforms"><i class="fa fa-check"></i><b>3.8.2</b> Visualizing Common Landforms</a></li>
<li class="chapter" data-level="3.8.3" data-path="the-data-we-use.html"><a href="the-data-we-use.html#diagnostic-features"><i class="fa fa-check"></i><b>3.8.3</b> Diagnostic Features</a></li>
<li class="chapter" data-level="3.8.4" data-path="the-data-we-use.html"><a href="the-data-we-use.html#comparing-horizon-data-within-diagnostic-featuresintervals"><i class="fa fa-check"></i><b>3.8.4</b> Comparing Horizon Data within Diagnostic Features/Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="the-data-we-use.html"><a href="the-data-we-use.html#soil-reports"><i class="fa fa-check"></i><b>3.9</b> Soil Reports</a><ul>
<li class="chapter" data-level="3.9.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#extending-soilreports"><i class="fa fa-check"></i><b>3.9.1</b> Extending <code>soilReports</code></a></li>
<li class="chapter" data-level="3.9.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#requirements"><i class="fa fa-check"></i><b>3.9.2</b> Requirements</a></li>
<li class="chapter" data-level="3.9.3" data-path="the-data-we-use.html"><a href="the-data-we-use.html#instructions"><i class="fa fa-check"></i><b>3.9.3</b> Instructions</a></li>
<li class="chapter" data-level="3.9.4" data-path="the-data-we-use.html"><a href="the-data-we-use.html#exercise-run-the-region11lab_summary_by_taxonname"><i class="fa fa-check"></i><b>3.9.4</b> Exercise: run the region11/lab_summary_by_taxonname</a></li>
<li class="chapter" data-level="3.9.5" data-path="the-data-we-use.html"><a href="the-data-we-use.html#exercise-run-mapunit-comparison"><i class="fa fa-check"></i><b>3.9.5</b> Exercise: Run Mapunit Comparison</a></li>
<li class="chapter" data-level="3.9.6" data-path="the-data-we-use.html"><a href="the-data-we-use.html#exercise-run-shiny-pedon-summary"><i class="fa fa-check"></i><b>3.9.6</b> Exercise: Run Shiny Pedon Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="the-data-we-use.html"><a href="the-data-we-use.html#customized-queries-to-local-nasis-database"><i class="fa fa-check"></i><b>3.10</b> Customized Queries to Local NASIS Database</a><ul>
<li class="chapter" data-level="3.10.1" data-path="the-data-we-use.html"><a href="the-data-we-use.html#rodbc-package"><i class="fa fa-check"></i><b>3.10.1</b> <code>RODBC</code> package</a></li>
<li class="chapter" data-level="3.10.2" data-path="the-data-we-use.html"><a href="the-data-we-use.html#dbi"><i class="fa fa-check"></i><b>3.10.2</b> <code>DBI</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#objectives-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.1</b> Objectives (Exploratory Data Analysis)</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#statistics"><i class="fa fa-check"></i><b>4.2</b> Statistics</a></li>
<li class="chapter" data-level="4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-inspection"><i class="fa fa-check"></i><b>4.3</b> Data Inspection</a><ul>
<li class="chapter" data-level="4.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercise-fetch-and-inspect"><i class="fa fa-check"></i><b>4.3.1</b> Exercise: fetch and inspect</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>4.4</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>4.4.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="4.4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#measures-of-dispersion"><i class="fa fa-check"></i><b>4.4.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="4.4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#correlation"><i class="fa fa-check"></i><b>4.4.3</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#graphical-methods"><i class="fa fa-check"></i><b>4.5</b> Graphical Methods</a><ul>
<li class="chapter" data-level="4.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#distributions"><i class="fa fa-check"></i><b>4.5.1</b> Distributions</a></li>
<li class="chapter" data-level="4.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#bar-plot"><i class="fa fa-check"></i><b>4.5.2</b> Bar Plot</a></li>
<li class="chapter" data-level="4.5.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#histogram"><i class="fa fa-check"></i><b>4.5.3</b> Histogram</a></li>
<li class="chapter" data-level="4.5.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#density-curve"><i class="fa fa-check"></i><b>4.5.4</b> Density Curve</a></li>
<li class="chapter" data-level="4.5.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#box-plots"><i class="fa fa-check"></i><b>4.5.5</b> Box plots</a></li>
<li class="chapter" data-level="4.5.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#quantile-comparison-plots-qqplot"><i class="fa fa-check"></i><b>4.5.6</b> Quantile comparison plots (QQplot)</a></li>
<li class="chapter" data-level="4.5.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-normal-distribution"><i class="fa fa-check"></i><b>4.5.7</b> The ‘Normal’ distribution</a></li>
<li class="chapter" data-level="4.5.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>4.5.8</b> Scatterplots and Line Plots</a></li>
<li class="chapter" data-level="4.5.9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#rd-dimension---color-shape-size-layers-etc"><i class="fa fa-check"></i><b>4.5.9</b> 3rd Dimension - Color, Shape, Size, Layers, etc…</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#transformations"><i class="fa fa-check"></i><b>4.6</b> Transformations</a><ul>
<li class="chapter" data-level="4.6.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ph"><i class="fa fa-check"></i><b>4.6.1</b> pH</a></li>
<li class="chapter" data-level="4.6.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#circular-data"><i class="fa fa-check"></i><b>4.6.2</b> Circular data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#references-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.7</b> References (Exploratory Data Analysis)</a></li>
<li class="chapter" data-level="4.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#additional-reading-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.8</b> Additional Reading (Exploratory Data Analysis)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html"><i class="fa fa-check"></i><b>5</b> Spatial Data in R</a><ul>
<li class="chapter" data-level="5.1" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#objectives-spatial-data-structures"><i class="fa fa-check"></i><b>5.1</b> Objectives (Spatial Data Structures)</a></li>
<li class="chapter" data-level="5.2" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#making-maps-with-r"><i class="fa fa-check"></i><b>5.2</b> Making Maps with R</a></li>
<li class="chapter" data-level="5.3" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#spatial-data-sources"><i class="fa fa-check"></i><b>5.3</b> Spatial Data Sources</a></li>
<li class="chapter" data-level="5.4" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#viewing-pedon-locations"><i class="fa fa-check"></i><b>5.4</b> Viewing Pedon Locations</a><ul>
<li class="chapter" data-level="5.4.1" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#plotting-geographic-data"><i class="fa fa-check"></i><b>5.4.1</b> Plotting Geographic Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#displaying-pedon-data-in-google-earth"><i class="fa fa-check"></i><b>5.4.2</b> Displaying Pedon Data in Google Earth</a></li>
<li class="chapter" data-level="5.4.3" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#exporting-pedon-data-to-an-esri-shapefile"><i class="fa fa-check"></i><b>5.4.3</b> Exporting Pedon Data to an ESRI Shapefile</a></li>
<li class="chapter" data-level="5.4.4" data-path="the-data-we-use.html"><a href="the-data-we-use.html#follow-along-with-your-own-data"><i class="fa fa-check"></i><b>5.4.4</b> Follow along with your own data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#many-packages-many-spatial-representations"><i class="fa fa-check"></i><b>5.5</b> Many Packages, Many Spatial Representations</a><ul>
<li class="chapter" data-level="5.5.1" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#the-sf-package"><i class="fa fa-check"></i><b>5.5.1</b> The <code>sf</code> package</a></li>
<li class="chapter" data-level="5.5.2" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#the-sp-package"><i class="fa fa-check"></i><b>5.5.2</b> The <code>sp</code> Package</a></li>
<li class="chapter" data-level="5.5.3" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#converting-sp-and-sf"><i class="fa fa-check"></i><b>5.5.3</b> Converting <code>sp</code> and <code>sf</code></a></li>
<li class="chapter" data-level="5.5.4" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#importing-exporting-vector-data"><i class="fa fa-check"></i><b>5.5.4</b> Importing / Exporting Vector Data</a></li>
<li class="chapter" data-level="5.5.5" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#interactive-mapping-with-mapview-and-leaflet"><i class="fa fa-check"></i><b>5.5.5</b> Interactive mapping with <code>mapview</code> and <code>leaflet</code></a></li>
<li class="chapter" data-level="5.5.6" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#the-raster-package"><i class="fa fa-check"></i><b>5.5.6</b> The <code>raster</code> Package</a></li>
<li class="chapter" data-level="5.5.7" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#converting-vector-to-raster"><i class="fa fa-check"></i><b>5.5.7</b> Converting Vector to Raster</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>5.6</b> Coordinate Reference Systems</a><ul>
<li class="chapter" data-level="5.6.1" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#assigning-and-transforming-coordinate-systems"><i class="fa fa-check"></i><b>5.6.1</b> Assigning and Transforming Coordinate Systems</a></li>
<li class="chapter" data-level="5.6.2" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#accessing-spatial-data-sources-via-gdalogr"><i class="fa fa-check"></i><b>5.6.2</b> Accessing Spatial Data Sources via GDAL/OGR</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#operations-on-example-data"><i class="fa fa-check"></i><b>5.7</b> Operations on Example Data</a><ul>
<li class="chapter" data-level="5.7.1" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#load-required-packages"><i class="fa fa-check"></i><b>5.7.1</b> Load Required Packages</a></li>
<li class="chapter" data-level="5.7.2" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#download-example-data"><i class="fa fa-check"></i><b>5.7.2</b> Download Example Data</a></li>
<li class="chapter" data-level="5.7.3" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#load-the-data"><i class="fa fa-check"></i><b>5.7.3</b> Load the Data</a></li>
<li class="chapter" data-level="5.7.4" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#spatial-overlay-operations"><i class="fa fa-check"></i><b>5.7.4</b> Spatial Overlay Operations</a></li>
<li class="chapter" data-level="5.7.5" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#sampling-and-extraction"><i class="fa fa-check"></i><b>5.7.5</b> Sampling and Extraction</a></li>
<li class="chapter" data-level="5.7.6" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#more-spatial-exploratory-data-analysis"><i class="fa fa-check"></i><b>5.7.6</b> More Spatial Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="spatial-data-in-r.html"><a href="spatial-data-in-r.html#additional-reading-spatial"><i class="fa fa-check"></i><b>5.8</b> Additional Reading (Spatial)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>6</b> Sampling</a><ul>
<li class="chapter" data-level="6.1" data-path="sampling.html"><a href="sampling.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sampling.html"><a href="sampling.html#sampling-strategies"><i class="fa fa-check"></i><b>6.2</b> Sampling Strategies</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sampling.html"><a href="sampling.html#simple-random"><i class="fa fa-check"></i><b>6.2.1</b> Simple Random</a></li>
<li class="chapter" data-level="6.2.2" data-path="sampling.html"><a href="sampling.html#stratified-random"><i class="fa fa-check"></i><b>6.2.2</b> Stratified Random</a></li>
<li class="chapter" data-level="6.2.3" data-path="sampling.html"><a href="sampling.html#multistage-stratified-random"><i class="fa fa-check"></i><b>6.2.3</b> Multistage Stratified Random</a></li>
<li class="chapter" data-level="6.2.4" data-path="sampling.html"><a href="sampling.html#systematic"><i class="fa fa-check"></i><b>6.2.4</b> Systematic</a></li>
<li class="chapter" data-level="6.2.5" data-path="sampling.html"><a href="sampling.html#cluster"><i class="fa fa-check"></i><b>6.2.5</b> Cluster</a></li>
<li class="chapter" data-level="6.2.6" data-path="sampling.html"><a href="sampling.html#conditioned-latin-hypercube-clhs"><i class="fa fa-check"></i><b>6.2.6</b> Conditioned Latin Hypercube (cLHS)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sampling.html"><a href="sampling.html#evaluating-a-sampling-strategy"><i class="fa fa-check"></i><b>6.3</b> Evaluating a Sampling Strategy</a><ul>
<li class="chapter" data-level="6.3.1" data-path="sampling.html"><a href="sampling.html#exercise-design-a-sampling-strategy"><i class="fa fa-check"></i><b>6.3.1</b> Exercise: Design a Sampling Strategy</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="sampling.html"><a href="sampling.html#other-tools-for-selecting-random-features"><i class="fa fa-check"></i><b>6.4</b> Other Tools for Selecting Random Features</a><ul>
<li class="chapter" data-level="6.4.1" data-path="sampling.html"><a href="sampling.html#clhs-using-teui"><i class="fa fa-check"></i><b>6.4.1</b> cLHS Using TEUI</a></li>
<li class="chapter" data-level="6.4.2" data-path="sampling.html"><a href="sampling.html#two-stage-stratified-random-sample-design-using-arcgis"><i class="fa fa-check"></i><b>6.4.2</b> Two-Stage Stratified Random Sample Design Using ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="sampling.html"><a href="sampling.html#references-sampling"><i class="fa fa-check"></i><b>6.5</b> References (Sampling)</a></li>
<li class="chapter" data-level="6.6" data-path="sampling.html"><a href="sampling.html#additional-reading-sampling"><i class="fa fa-check"></i><b>6.6</b> Additional Reading (Sampling)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Soil Survey - Part 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-data-we-use" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> The Data We Use</h1>
<p><img src="static-figures/logo.jpg" /></p>
<div id="objectives-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Objectives (Data)</h2>
<ul>
<li>Learn more about R and how to inspect objects and data types</li>
<li>Use the soilDB package to load NASIS pedon data into R</li>
<li>Learn about the checks run on data loaded by the <code>fetchNASIS()</code> function</li>
<li>Understand the structure of data stored in a <code>SoilProfileCollection</code> (SPC)</li>
<li>Learn ways to logically filter and subset data in R</li>
<li>Learn how functions can be used to bundle operations</li>
<li>Review additional data that is accessible via extended data functions</li>
<li>Introduce <code>soilReports</code> R package</li>
</ul>
</div>
<div id="the-structure-of-our-data" class="section level2">
<h2><span class="header-section-number">3.2</span> The Structure of Our Data</h2>
<p>What if you could extract, organize, and visualize data from NASIS and many other commonly used soil database sources with a couple of lines of code?</p>
<p><img src="static-figures/soilDB_figure.png" /></p>
<p>We have created the soilDB package just for this! soilDB returns tabular data, spatial data objects and SoilProfileCollection objects! SoilProfileCollection objects are defined in the aqp (Algorithms for Quantitative Pedology) package as a handy abstraction for commonly used data and “bookkeeping” of said data.</p>
<div id="package-references" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Package References</h3>
<ul>
<li><p><a href="http://ncss-tech.github.io/AQP/aqp/aqp-intro.html"><strong>SoilProfileCollection Object Introduction</strong></a></p></li>
<li><p><a href="http://ncss-tech.github.io/AQP/"><strong>Tutorials on the AQP website</strong></a></p></li>
<li><p><a href="http://ncss-tech.github.io/aqp/docs/"><strong>Package ‘aqp’ manual</strong></a></p></li>
<li><p><a href="http://ncss-tech.github.io/soilDB/docs/"><strong>Package ‘soilDB’ manual</strong></a></p></li>
<li><p><a href="http://ncss-tech.github.io/sharpshootR/docs/"><strong>Package ‘sharpshootR’ manual</strong></a></p></li>
</ul>
<p>The manual pages for <code>soilDB</code> and <code>aqp</code> are accessible (click <strong>index</strong> at the bottom of the <strong>Help</strong> tab in RStudio) by entering the following into the R console:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="the-data-we-use.html#cb1-1"></a><span class="co"># not run</span></span>
<span id="cb1-2"><a href="the-data-we-use.html#cb1-2"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb1-3"><a href="the-data-we-use.html#cb1-3"></a><span class="kw">help</span>(soilDB)</span>
<span id="cb1-4"><a href="the-data-we-use.html#cb1-4"></a></span>
<span id="cb1-5"><a href="the-data-we-use.html#cb1-5"></a><span class="co"># for links to lots of great examples look here!</span></span>
<span id="cb1-6"><a href="the-data-we-use.html#cb1-6"></a><span class="kw">library</span>(aqp)</span>
<span id="cb1-7"><a href="the-data-we-use.html#cb1-7"></a><span class="kw">help</span>(aqp)</span></code></pre></div>
</div>
<div id="soildb-functions-for-tabular-data" class="section level3">
<h3><span class="header-section-number">3.2.2</span> soilDB functions for tabular data</h3>
<p><code>soilDB</code> functions are the quickest way to get up and running:</p>
<ul>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchNASIS.html">fetchNASIS()</a></strong></p>
<ul>
<li>Gets and re-packages data from a local NASIS database.
<ul>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/fetchNASIS-mini-tutorial.html">NASIS pedon/horizon data</a></li>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/NASIS-component-data.html">NASIS DMU/MU/component data</a></li>
</ul></li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchNASISLabData.html">fetchNASISLabData()</a></strong></p>
<ul>
<li>Gets KSSL laboratory pedon/horizon layer data from a local NASIS database.</li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchNASISWebReport.html">fetchNASISWebReport()</a></strong></p></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchKSSL.html">fetchKSSL()</a></strong></p>
<ul>
<li>Gets KSSL data from the SoilWeb system via BBOX, MLRA, or series name query.
<ul>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/KSSL-demo.html">KSSL Data Demo</a></li>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/fetchKSSL-VG-demo.html">Water Retention Curve Development from KSSL Data</a></li>
</ul></li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchOSD.html">fetchOSD()</a></strong></p>
<ul>
<li>Fetches a limited subset of horizon- and site-level attributes for named soil series from the SoilWeb system.</li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/OSDquery.html">OSDquery()</a></strong></p>
<ul>
<li>Full-text searching of OSD sections.</li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchRaCA.html">fetchRaCA()</a></strong></p>
<ul>
<li>Gets Rapid Carbon Assessment (RaCA) data by State, geographic bounding-box, RaCA site ID, or series query from the SoilWeb system.
<ul>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/RaCA-demo.html">RaCA Data Demo</a></li>
</ul></li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchSCAN.html">fetchSCAN()</a></strong></p>
<ul>
<li>Queries soil and climate data from USDA-NRCS SCAN Stations.
<ul>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/fetchSCAN-demo.html">A Unified Interface to SCAN/SNOTEL Data</a></li>
</ul></li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchHenry.html">fetchHenry()</a></strong></p>
<ul>
<li>Downloads data from the Henry Mount Soil Climate Database.
<ul>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/Henry-demo.html">Henry Mount Soil Climate Database Tutorial</a></li>
</ul></li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchPedonPC.html">fetchPedonPC()</a></strong></p>
<ul>
<li>Fetches commonly used site and horizon data from a PedonPC v.5 database.</li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/fetchSDA_component.html">fetchSDA()</a></strong></p>
<ul>
<li>Fetches component data from Soil Data Access.</li>
</ul></li>
<li><p><strong><a href="http://ncss-tech.github.io/soilDB/docs/reference/SDA_query.html">SDA_query()</a></strong></p>
<ul>
<li>Submits queries to the Soil Data Access system.
<ul>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/SDA-tutorial.html">Soil Data Access Tutorial</a></li>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/SDA-tutorial-2.html">SDA and Spatial Data</a></li>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/SDA-cointerp-tutorial.html">SDA and Interpretations</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="importance-of-pedon-data" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Importance of Pedon Data</h3>
<p>The importance of pedon data for present and future work cannot be overstated. These data represent decades of on-the-ground observations of the soil resource for a given area.</p>
<p>As difficult as it may be to take the time to enter legacy pedon data, it is vitally important that we capture this resource and get these data into NASIS as an archive of point observations.</p>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<p><img src="s4ssbook_files/figure-html/pedons_a-1.png" width="672" /></p>
<p><img src="static-figures/sites_nat.png" /></p>
</div>
<div id="some-issues-with-pedon-data" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Some Issues With Pedon Data</h3>
<ul>
<li><p>Making and documenting observations of soil requires hard work. Digging is difficult, and writing soil descriptions is time consuming!</p></li>
<li><p>Our confidence in observations commonly weakens with the depth of the material described.</p>
<ul>
<li>If we acknowledge this, which we must, then how do we deal with it in pedon data?
<ul>
<li>Use a cutoff depth, for example 100 cm, can be used to truncate observations to a zone of greater confidence.</li>
<li>Show the relative confidence of the data with depth.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="challenges-with-pedon-data" class="section level2">
<h2><span class="header-section-number">3.3</span> Challenges with Pedon Data</h2>
<ul>
<li>Consistency
<ul>
<li>Missing data</li>
</ul></li>
<li>Confidence in the observations
<ul>
<li>Uncertainty with depth</li>
</ul></li>
<li>Description style differences
<ul>
<li>Depth described, horizonation usage styles</li>
</ul></li>
<li>Legacy data vintage
<ul>
<li>Decadal span of data</li>
<li>Taxonomy updates, horizon nomenclature</li>
</ul></li>
<li>Location confidence
<ul>
<li>Origin of the location information</li>
<li>Datum used for data collection</li>
<li>Accuracy for GPS values at the time of data collection</li>
</ul></li>
</ul>
<div id="meeting-the-challenges" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Meeting the Challenges</h3>
<ul>
<li>Graphical display of the data and summary outputs (<a href="http://ncss-tech.github.io/AQP/aqp/profile-summary.html"><strong>slice-wise aggregation</strong></a>)</li>
<li>Generalized Horizon Labels (GHL). Derive an aggregate soil profile and summarize soil properties for groups of similar soils.
<ul>
<li>More on that process can be seen in the following tutorial:
<a href="http://ncss-tech.github.io/AQP/presentations/ghl-aggregation.html"><strong>GHL Aggregation Presentation</strong></a> and <a href="http://ncss-tech.github.io/AQP/aqp/gen-hz-application.html"><strong>GHL Aggregation Tutorial</strong></a>.</li>
</ul></li>
</ul>
<p>For more information regarding difficult pedon data, see the following tutorial in the “aqp” package:<br />
<a href="http://ncss-tech.github.io/AQP/aqp/dealing-with-bad-data.html"><strong>Dealing with Troublesome data</strong></a>.</p>
</div>
</div>
<div id="the-aqp-soilprofilecollection" class="section level2">
<h2><span class="header-section-number">3.4</span> The <code>aqp</code> <code>SoilProfileCollection</code></h2>
<p>The <a href="http://ncss-tech.github.io/AQP/aqp/aqp-intro.html"><code>SoilProfileCollection</code></a> class (SPC) provided by the <code>aqp</code> package is a soil-specific tool.</p>
<p>It is a type of object that simplifies the process of working with collections of data associated with soil profiles, e.g., site-level data, horizon-level data, spatial data, diagnostic horizon data, metadata, etc.</p>
<p>A <code>SoilProfileCollection</code> is like the NASIS Pedon “object” in that it provides generalizations, specific routines and rules about the fundamental tables and their relationships that are relevant to soil observations.</p>
<p>In many ways the SPC is more adaptable than the NASIS Pedon concept, strictly speaking. It can “contain” aggregations of any relevant parts of any soil data schema (table and column structure). Through this mechanism, it can be a <em>mediator</em> between formats and algorithms.</p>
<div id="soilprofilecollection-methods" class="section level3">
<h3><span class="header-section-number">3.4.1</span> SoilProfileCollection methods</h3>
<p>Many “familiar” methods are defined for the <code>SoilProfileCollection</code> object. Some are unique, and others operate like more common functions of vector and <code>data.frame</code> objects, such as <code>nrow()</code> (<em>“how many horizons?”</em>) or <code>length()</code> (<em>“how many sites/pedons?”</em>).</p>
<p>Perhaps most importantly, when you access the <code>site()</code> data or the <code>horizons()</code> data of a <code>SoilProfileCollection</code>, you get a <code>data.frame</code> object that you can use like any other you might use or make in R.</p>
<div id="promoting-data.frame-to-soilprofilecollection" class="section level4">
<h4><span class="header-section-number">3.4.1.1</span> Promoting <code>data.frame</code> to <code>SoilProfileCollection</code></h4>
<p>The <code>SoilProfileCollection</code> object is a collection of 1-D profile descriptions, of the type conventionally described on a Form 232, or on tabular data returned from laboratory.</p>
<p>The object is “horizon data forward” in that you start with that, and can create site-level attributes by normalization, joins, calculations and more.</p>
<p>Most of the time if you are using your NASIS data, or an official database, there are defined ways of getting the data out.</p>
<p>In the pre-course, we had you set up a process so you could connect to your local NASIS instance to “fetch” data and have methods like <code>fetchNASIS</code> put things together for you.</p>
<p>This input to make a <code>SoilProfileCollection</code> can be represented most simply as a <code>data.frame</code> with unique site or profile ID and depth combinations for each horizon or layer – for example, a subset of the <code>phorizon</code> or <code>chorizon</code> table in NASIS.</p>
<p>A simple example of this type oftabular horizon data is the <code>sp4</code> data set: some serpentine soil profiles stored in a <code>data.frame</code> in the <code>aqp</code> package (after McGahan et al., 2009).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="the-data-we-use.html#cb5-1"></a><span class="kw">library</span>(aqp)</span></code></pre></div>
<pre><code>## This is aqp 1.27</code></pre>
<pre><code>## 
## Attaching package: &#39;aqp&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     combine, filter, group_by, mutate, slice, summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="the-data-we-use.html#cb10-1"></a><span class="co"># Load sample serpentine soil data (McGahan et al., 2009)</span></span>
<span id="cb10-2"><a href="the-data-we-use.html#cb10-2"></a><span class="kw">data</span>(sp4, <span class="dt">package =</span> <span class="st">&quot;aqp&quot;</span>)</span>
<span id="cb10-3"><a href="the-data-we-use.html#cb10-3"></a></span>
<span id="cb10-4"><a href="the-data-we-use.html#cb10-4"></a><span class="kw">head</span>(sp4)</span></code></pre></div>
<pre><code>##       id name top bottom   K   Mg  Ca CEC_7 ex_Ca_to_Mg sand silt clay   CF
## 1 colusa    A   0      3 0.3 25.7 9.0  23.0        0.35   46   33   21 0.12
## 2 colusa  ABt   3      8 0.2 23.7 5.6  21.4        0.23   42   31   27 0.27
## 3 colusa  Bt1   8     30 0.1 23.2 1.9  23.7        0.08   40   28   32 0.27
## 4 colusa  Bt2  30     42 0.1 44.3 0.3  43.0        0.01   27   18   55 0.16
## 5  glenn    A   0      9 0.2 21.9 4.4  18.8        0.20   54   20   25 0.55
## 6  glenn   Bt   9     34 0.3 18.9 4.5  27.5        0.20   49   18   34 0.84</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="the-data-we-use.html#cb12-1"></a><span class="kw">class</span>(sp4)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>To convert this horizon data into a <code>SoilProfileCollection</code>, we need to identify three parameters: <code>idname</code>, <code>top</code>, and <code>bottom</code>. These parameters refer to the columns of unique profile IDs, top depths and bottom depths, respectively.</p>
<p>These three define the “logical consistency” of 1-D descriptions within the collection. We specify this for your input <code>data.frame</code> using the <code>depths&lt;-</code> function.</p>
<p>Use a formula to specify column names in the <code>data.frame</code>, in this case <code>"id"</code>, <code>"top"</code> and <code>"bottom"</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="the-data-we-use.html#cb14-1"></a><span class="co">#</span></span>
<span id="cb14-2"><a href="the-data-we-use.html#cb14-2"></a><span class="co">#      profile ID ~ top depth + bottom depth</span></span>
<span id="cb14-3"><a href="the-data-we-use.html#cb14-3"></a><span class="co">#              </span></span>
<span id="cb14-4"><a href="the-data-we-use.html#cb14-4"></a><span class="kw">depths</span>(sp4) &lt;-<span class="st"> </span>id <span class="op">~</span><span class="st"> </span>top <span class="op">+</span><span class="st"> </span>bottom</span>
<span id="cb14-5"><a href="the-data-we-use.html#cb14-5"></a></span>
<span id="cb14-6"><a href="the-data-we-use.html#cb14-6"></a><span class="kw">class</span>(sp4)</span></code></pre></div>
<pre><code>## [1] &quot;SoilProfileCollection&quot;
## attr(,&quot;package&quot;)
## [1] &quot;aqp&quot;</code></pre>
<div id="syntax-explanation" class="section level5">
<h5><span class="header-section-number">3.4.1.1.1</span> Syntax Explanation</h5>
<p>The formula expresses the idea that a profile 1-dimensional description <code>id</code> has a vertical extent (Z, in profile) defined by set of <code>top</code> and <code>bottom</code> depths described for that profile.</p>
<p>In this simplified 1-dimensional model we are concerned about keeping track of things like thickness, order, overlaps, gaps, or duplication in the data. From this, we can do a lot of “logic” checks – strictly from a perspective of basic physical representation of the horizon data.</p>
<!--
NOTE: A character vector with same names has the same effect, and can be easier to "program" with than the formula-based syntax.


```r
depths(sp4) <- c("id","top","bottom")
```

```
## This is already a SoilProfileCollection-class object, doing nothing.
```
### Extending the `SoilProfileCollection` Spatial Model 

The "spatial" definition that comes with defining the horizon depths at object creation can be further extended to real space using the `coordinates<-` method to define "X" and "Y" and `proj4string<-` to define the Coordinate Reference System (more on that later). Elevation ("Z", landscape) is generally recorded as a site attribute.
-->
</div>
</div>
<div id="extracting-site-and-horizon-data" class="section level4">
<h4><span class="header-section-number">3.4.1.2</span> Extracting Site and Horizon Data</h4>
<p>The <code>SoilProfileCollection</code> is an S4 R object. S4 objects have slots. Of primary importance, it has slots for site-level data and horizon-level data.</p>
<p>You can extract values from these slots using the <code>site()</code> and <code>horizons()</code> functions. These create <code>data.frame</code> objects that are separate from the <code>SoilProfileCollection</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="the-data-we-use.html#cb16-1"></a><span class="co"># extract site data from SPC into new data.frame &#39;s&#39;</span></span>
<span id="cb16-2"><a href="the-data-we-use.html#cb16-2"></a>s &lt;-<span class="st"> </span><span class="kw">site</span>(sp4)</span>
<span id="cb16-3"><a href="the-data-we-use.html#cb16-3"></a><span class="kw">str</span>(s)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	10 obs. of  1 variable:
##  $ id: chr  &quot;colusa&quot; &quot;glenn&quot; &quot;kings&quot; &quot;mariposa&quot; ...</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="the-data-we-use.html#cb18-1"></a><span class="co"># extract horizon data from SPC into new data.frame &#39;h&#39;</span></span>
<span id="cb18-2"><a href="the-data-we-use.html#cb18-2"></a>h &lt;-<span class="st"> </span><span class="kw">horizons</span>(sp4)</span>
<span id="cb18-3"><a href="the-data-we-use.html#cb18-3"></a><span class="kw">str</span>(h)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	30 obs. of  14 variables:
##  $ id         : chr  &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; ...
##  $ name       : chr  &quot;A&quot; &quot;ABt&quot; &quot;Bt1&quot; &quot;Bt2&quot; ...
##  $ top        : int  0 3 8 30 0 9 0 4 13 0 ...
##  $ bottom     : int  3 8 30 42 9 34 4 13 40 3 ...
##  $ K          : num  0.3 0.2 0.1 0.1 0.2 0.3 0.2 0.6 0.8 0.6 ...
##  $ Mg         : num  25.7 23.7 23.2 44.3 21.9 18.9 12.1 12.1 17.7 28.3 ...
##  $ Ca         : num  9 5.6 1.9 0.3 4.4 4.5 1.4 7 4.4 5.8 ...
##  $ CEC_7      : num  23 21.4 23.7 43 18.8 27.5 23.7 18 20 29.3 ...
##  $ ex_Ca_to_Mg: num  0.35 0.23 0.08 0.01 0.2 0.2 0.58 0.51 0.25 0.2 ...
##  $ sand       : int  46 42 40 27 54 49 43 36 27 42 ...
##  $ silt       : int  33 31 28 18 20 18 55 49 45 26 ...
##  $ clay       : int  21 27 32 55 25 34 3 15 27 32 ...
##  $ CF         : num  0.12 0.27 0.27 0.16 0.55 0.84 0.5 0.75 0.67 0.25 ...
##  $ hzID       : chr  &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</code></pre>
</div>
<div id="methods-like-data.frame" class="section level4">
<h4><span class="header-section-number">3.4.1.3</span> Methods like <code>data.frame</code></h4>
<p>The base R functions for accessing and setting <code>data.frame</code> columns by name such as <code>$</code> and <code>[[</code> work for <code>SoilProfileCollection</code> objects, too.</p>
<div id="and" class="section level5">
<h5><span class="header-section-number">3.4.1.3.1</span> <code>$</code> and <code>[[</code></h5>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="the-data-we-use.html#cb20-1"></a><span class="co"># SoilProfileCollection</span></span>
<span id="cb20-2"><a href="the-data-we-use.html#cb20-2"></a>sp4<span class="op">$</span>clay</span></code></pre></div>
<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40 51 67 24 25 32</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="the-data-we-use.html#cb22-1"></a>sp4[[<span class="st">&#39;clay&#39;</span>]]</span></code></pre></div>
<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40 51 67 24 25 32</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="the-data-we-use.html#cb24-1"></a><span class="co"># horizon data.frame</span></span>
<span id="cb24-2"><a href="the-data-we-use.html#cb24-2"></a>h<span class="op">$</span>clay</span></code></pre></div>
<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40 51 67 24 25 32</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="the-data-we-use.html#cb26-1"></a>h[[<span class="st">&#39;clay&#39;</span>]]</span></code></pre></div>
<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40 51 67 24 25 32</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="the-data-we-use.html#cb28-1"></a><span class="co"># use $&lt;- / [[&lt;- to set proportional clay content</span></span>
<span id="cb28-2"><a href="the-data-we-use.html#cb28-2"></a>sp4<span class="op">$</span>clay &lt;-<span class="st"> </span>sp4[[<span class="st">&#39;clay&#39;</span>]] <span class="op">/</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb28-3"><a href="the-data-we-use.html#cb28-3"></a></span>
<span id="cb28-4"><a href="the-data-we-use.html#cb28-4"></a><span class="co"># undo what we did above; back to percentage</span></span>
<span id="cb28-5"><a href="the-data-we-use.html#cb28-5"></a>sp4[[<span class="st">&#39;clay&#39;</span>]] &lt;-<span class="st"> </span>sp4<span class="op">$</span>clay <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb28-6"><a href="the-data-we-use.html#cb28-6"></a></span>
<span id="cb28-7"><a href="the-data-we-use.html#cb28-7"></a><span class="co"># create new site variable (recycled for all sites)</span></span>
<span id="cb28-8"><a href="the-data-we-use.html#cb28-8"></a><span class="kw">site</span>(sp4)<span class="op">$</span>newvar1 &lt;-<span class="st"> &quot;numberone&quot;</span></span>
<span id="cb28-9"><a href="the-data-we-use.html#cb28-9"></a></span>
<span id="cb28-10"><a href="the-data-we-use.html#cb28-10"></a><span class="co"># create new horizon variable (recycled for all horizons)</span></span>
<span id="cb28-11"><a href="the-data-we-use.html#cb28-11"></a><span class="kw">horizons</span>(sp4)<span class="op">$</span>newvar2 &lt;-<span class="st"> &quot;numbertwo&quot;</span></span></code></pre></div>
</div>
<div id="section" class="section level5">
<h5><span class="header-section-number">3.4.1.3.2</span> <code>[</code></h5>
<p>The <code>SoilProfileCollection</code> also has <code>[</code> – but a different interpretation from the <code>[i, j]</code> indexing in <code>data.frame</code>.</p>
<ul>
<li><p>In a <code>data.frame</code> you have <code>object[row, column, drop=TRUE]</code>; the result is a <code>data.frame</code> (or a vector with default <code>drop</code>).</p></li>
<li><p>In a <code>SoilProfileCollection</code> you have <code>object[site, horizon]</code>; the result is a <code>SoilProfileCollection</code>.</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="the-data-we-use.html#cb29-1"></a><span class="co"># object[i, j]</span></span>
<span id="cb29-2"><a href="the-data-we-use.html#cb29-2"></a></span>
<span id="cb29-3"><a href="the-data-we-use.html#cb29-3"></a><span class="co"># i-index: 2 profiles, 6 horizons</span></span>
<span id="cb29-4"><a href="the-data-we-use.html#cb29-4"></a>sp4[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ] <span class="co"># first two profiles, all horizons</span></span></code></pre></div>
<pre><code>## SoilProfileCollection with 2 profiles and 6 horizons
## profile ID: id  |  horizon ID: hzID 
## Depth range: 34 - 42 cm
## 
## ----- Horizons (6 / 6 rows  |  10 / 15 columns) -----
##      id hzID top bottom name   K   Mg  Ca CEC_7 ex_Ca_to_Mg
##  colusa    1   0      3    A 0.3 25.7 9.0  23.0        0.35
##  colusa    2   3      8  ABt 0.2 23.7 5.6  21.4        0.23
##  colusa    3   8     30  Bt1 0.1 23.2 1.9  23.7        0.08
##  colusa    4  30     42  Bt2 0.1 44.3 0.3  43.0        0.01
##   glenn    5   0      9    A 0.2 21.9 4.4  18.8        0.20
##   glenn    6   9     34   Bt 0.3 18.9 4.5  27.5        0.20
## 
## ----- Sites (2 / 2 rows  |  2 / 2 columns) -----
##      id   newvar1
##  colusa numberone
##   glenn numberone
## 
## Spatial Data: [EMPTY]</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="the-data-we-use.html#cb31-1"></a><span class="co"># j-index: 10 profiles; 20 horizons</span></span>
<span id="cb31-2"><a href="the-data-we-use.html#cb31-2"></a>sp4[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="co"># first two horizons of each profile </span></span></code></pre></div>
<pre><code>## SoilProfileCollection with 10 profiles and 20 horizons
## profile ID: id  |  horizon ID: hzID 
## Depth range: 5 - 40 cm
## 
## ----- Horizons (6 / 20 rows  |  10 / 15 columns) -----
##      id hzID top bottom name   K   Mg  Ca CEC_7 ex_Ca_to_Mg
##  colusa    1   0      3    A 0.3 25.7 9.0  23.0        0.35
##  colusa    2   3      8  ABt 0.2 23.7 5.6  21.4        0.23
##   glenn    5   0      9    A 0.2 21.9 4.4  18.8        0.20
##   glenn    6   9     34   Bt 0.3 18.9 4.5  27.5        0.20
##   kings    7   0      4    A 0.2 12.1 1.4  23.7        0.58
##   kings    8   4     13  Bt1 0.6 12.1 7.0  18.0        0.51
## [... more horizons ...]
## 
## ----- Sites (6 / 10 rows  |  2 / 2 columns) -----
##         id   newvar1
##     colusa numberone
##      glenn numberone
##      kings numberone
##   mariposa numberone
##  mendocino numberone
##       napa numberone
## [... more sites ...]
## 
## Spatial Data: [EMPTY]</code></pre>
<p>Everything has gets subset simultaneously – sites, horizons, spatial data, diagnostics, etc. in one command.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="the-data-we-use.html#cb33-1"></a><span class="co"># First profile, first two horizons</span></span>
<span id="cb33-2"><a href="the-data-we-use.html#cb33-2"></a><span class="kw">horizons</span>(sp4[<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<pre><code>##       id name top bottom   K   Mg  Ca CEC_7 ex_Ca_to_Mg sand silt clay   CF hzID   newvar2
## 1 colusa    A   0      3 0.3 25.7 9.0  23.0        0.35   46   33   21 0.12    1 numbertwo
## 2 colusa  ABt   3      8 0.2 23.7 5.6  21.4        0.23   42   31   27 0.27    2 numbertwo</code></pre>
<!--
##### Optional: `tibble` and `data.table` `SoilProfileCollection` objects

Since the CRAN release of `aqp` 1.25 there has been support for `tibble` and `data.table` `data.frame` subclasses in the slots of the `SoilProfileCollection`. 

Most methods that make `SoilProfileCollections` for you (e.g. `fetchNASIS`) only use `data.frame` objects, so this is, at this point, a completely optional feature.


```r
data("gopheridge", package="soilDB")
pedons <- gopheridge

# before: data.frame
class(horizons(pedons))

# set a new data.frame class with aqp_df_class<- then rebuild the SPC
aqp_df_class(pedons) <- "tibble" # or "tbl_df", "data.table", "data.frame"
pedons <- rebuildSPC(pedons)

# after: tbl_df, a subclass of data.frame
class(horizons(pedons))
```

This is an nice feature if you are a user of the `tidyverse` metapackage -- or scripts that use it -- as these use `tibble` as the "central" `data.frame`-class object -- and you may be frustrated by the old behavior of SPCs behaving erratically when given `tibble`, or turning your `tibble` into `data.frame`.

If you want to take advantage of high performance code for manipulating tabular data in the `data.table` package, you can also use that as the internal data.frame subclass. 

`data.table` is now _silently_ used in `aqp` for several operations to increase efficiency. If you prefer to use `data.table` in your scripts, integration with the `SoilProfileCollection` is now easier than ever.

### Why bother with a `SoilProfileCollection`?

As discussed at the beginning of the chapter, typical soil data sets have several tables with complex relationships between them. Manually keeping data sets in sync can range somewhere between a "chore" and a "Real Big Problem&trade;". We could manually do almost anything with or without a `SoilProfileCollection`... So _why bother_ with another data type?

Well, there are _lots_ of things we could do from scratch -- most of us do not do those things. If we did we _might_ mess something up if we weren't doing it all the time. 

We don't go and re-write the NASIS queries we use for each new project... We re-use the same tools in new project areas. In the same way, logic in the `SoilProfileCollection` is "off-loaded" onto special procedures. In the case of `aqp` and the SPC, these have been around for years and are rigorously unit-tested. 

This is why we use the `SoilProfileCollection`. We can "trust" it to take care of certain things -- reducing the amount of indexing and other book keeping needed in our own analysis code. 

The thinking has been put into the "schema" of the object and its methods up front, which makes it so that the user can focus on her or his analysis. This goal, in principle, is why NASIS, and all of the other soil databases and data models, exist. 

There are of course a variety of other tools available for managing spatial and relational data in and out of R -- this course does not seek to be comprehensive in covering those tools. Many tools can be used in tandem with `SoilProfileCollection` objects or the outputs they create.

If you understand the basic object types involved, you will see that the `SoilProfileCollection` is not the answer to every problem, but rather a convenient, efficient abstraction tailored for soil data work, and harmonious with a variety of R objects and data structures.

All of the above together means that more time and energy can be put towards to solving _soil_ problems, rather than computer problems. 
-->
</div>
</div>
</div>
</div>
<div id="using-the-soildb-package" class="section level2">
<h2><span class="header-section-number">3.5</span> Using the <code>soilDB</code> Package</h2>
<p>The <code>soilDB</code> package for R works provides functions for accessing data stored in in NASIS, KSSL, SDA, SoilWeb, SoilGrids and other sources. These are wrappers around an internal database interface to NASIS; the one that you set up during the pre-course.</p>
<p>Basic data checks are run within <code>fetch</code> functions. <code>get</code> functions are a usually a step lower in terms of abstraction – and generally return single <code>data.frame</code> or <code>list</code> of <code>data.frame</code>.</p>
<p>You can set up scripts to make custom queries against these or other sources on your own – there is an example at the end of this section.</p>
<p>For now, we will start with the <code>fetch</code> functions and others that will get you a large variety of data you can use for soil and ecological site analyses.</p>
<div id="open-database-connectivity-odbc-connection-to-nasis" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Open Database Connectivity (ODBC) Connection to NASIS</h3>
<p>After setting up an ODBC connection, you can use R to access data from a selected set defined in your local NASIS database.</p>
<p><a href="http://ncss-tech.github.io/AQP/soilDB/setup_local_nasis.html"><strong>How to Create an ODBC Connection to local NASIS database for R</strong></a>.</p>
<p><em>Does NASIS need to be open and running to query data using soilDB?</em></p>
<p>No, <code>fetchNASIS()</code> works whether the NASIS application is running or not. You just need to make sure that the data you want has been loaded into your selected set.</p>
</div>
<div id="fetchnasis" class="section level3">
<h3><span class="header-section-number">3.5.2</span> <code>fetchNASIS()</code></h3>
<p>The <code>[fetchNASIS()](http://ncss-tech.github.io/soilDB/docs/reference/fetchNASIS.html)</code> convenience function extracts data from a NASIS selected set via Structured Query Language (SQL).</p>
<p>Note that the import process in <code>fetchNASIS()</code>, and the other methods, is not comprehensive. It does not pull every column for every table related to pedon data out of NASIS.</p>
<p>Instead, it pulls essential / commonly used pedon and horizon data. Higher level functions like <code>fetchNASIS()</code> bundle a series of lower-level queries to get specific parts of the Pedon or Component data structures. Much of the nested complexity of NASIS is simplified in the resulting object. You may need to make more detailed queries and joins to resolve specific questions.</p>
<pre><code>## 
## Attaching package: &#39;diagram&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:aqp&#39;:
## 
##     coordinates</code></pre>
<p><img src="s4ssbook_files/figure-html/structure_diagram_a-1.png" width="672" /></p>
<p>Many-to-one relationships are “flattened” where possible by <code>fetchNASIS()</code>. This aggregates the data from various tables into one “site” record with related horizon records, per profile.</p>
<p>You can see the child tables that are aggregated using the <code>get_extended_data_from_NASIS()</code> method, which returns a named list of child table sources that are joined to the <code>SoilProfileCollection</code> made with <code>fetchNASIS()</code> using the internal record IDs in the respective tables.</p>
<div id="fetchnasis-arguments" class="section level4">
<h4><span class="header-section-number">3.5.2.1</span> fetchNASIS arguments</h4>
<p><code>fetchNASIS()</code> has many arguments:</p>
<ul>
<li><strong>from = ‘pedons’ or ‘components’ or ‘pedon_report’</strong>
<ul>
<li>This option allows you to select which data you want to load from NASIS. Choosing either ‘pedons’ or ‘components’ will load data from your local database. If ‘pedon_report’ is specified then it will load data from the text file generated by the NASIS report ‘fetchNASIS’.</li>
</ul></li>
<li><strong>url =</strong> ‘<a href="https://nasis.sc.egov.usda.gov/OfflineReports/fetchNASIS_04e6ec7d-fab5-4a90-bb88-9b9dc56dfdd8.txt" class="uri">https://nasis.sc.egov.usda.gov/OfflineReports/fetchNASIS_04e6ec7d-fab5-4a90-bb88-9b9dc56dfdd8.txt</a>’
<ul>
<li>If from = ‘pedon_report’ this option will load data from the URL that is generated when the NASIS report ‘fetchNASIS’ is run offline against the national database. This is useful for loading more than 20,000 pedons at one time, such for an entire Soil Survey Region.</li>
</ul></li>
<li><strong>SS = <code>TRUE</code>/<code>FALSE</code></strong>
<ul>
<li>The Selected Set (SS) option allows you to choose whether you want the data to load from your current selected set in NASIS or from the local database tables. The default is set to <code>TRUE</code> so if unspecified <code>fetchNASIS()</code> will always load from the data in the selected set.</li>
</ul></li>
<li><strong>stringAsFactors = <code>TRUE</code>/<code>FALSE</code></strong>
<ul>
<li>This option allows you to select whether to convert strings into factors or not. The default is set to <strong>FALSE</strong>, which will handle strings as character formats. Manually set this option to <code>TRUE</code> if you wish to handle character strings as factors.</li>
</ul></li>
<li><strong>rmHzErrors = <code>TRUE</code>/<code>FALSE</code></strong>
<ul>
<li>Setting this value to <code>TRUE</code> (the default) enables checks for horizon depth consistency. Consider setting this argument to <code>FALSE</code> if you aren’t concerned about horizon-depth errors or if you know that your selected set contains many combination horizons (e.g., consisting of E/Bt horizons or similar two-part horizons described individually for the same depth range). Note that any pedons flagged as having horizon-depth errors (rmHzErrors = <code>TRUE</code>) are omitted from the data returned by <code>fetchNASIS()</code>.</li>
</ul></li>
<li><strong>nullFragsAreZero = <code>TRUE</code>/<code>FALSE</code></strong>
<ul>
<li>Setting this value to <code>TRUE</code> (the default) converts null entries for rock fragment volumes to 0. This is typically the right assumption because rock fragment data are typically populated only when observed. If you know that your data contain a combination of omitted information (e.g. no rock fragment volumes are populated) then consider setting this argument to <code>FALSE</code>.</li>
</ul></li>
<li><strong>soilColorState = ‘moist’ or ‘dry’</strong>
<ul>
<li>Select dry or moist colors to be converted and placed into a horizon-level attribute called <code>soil_color</code>. Moist and dry colors are also stored in <code>moist_soil_color</code> and <code>dry_soil_color</code>.</li>
</ul></li>
<li><strong>lab = <code>TRUE</code>/<code>FALSE</code></strong>
<ul>
<li>This option allows for loading the data associated with horizons that may be in the <code>phlabresults</code> table. The default is set to <code>FALSE</code>, which will not load records from the <code>phlabresults</code> table.</li>
</ul></li>
</ul>
<p>For more information on the data checks and adjusting the default options to <code>fetchNASIS()</code> function, see the following resource: <a href="http://ncss-tech.github.io/AQP/soilDB/fetchNASIS-mini-tutorial.html"><strong>Tips on Getting Data from NASIS into R</strong></a>.</p>
</div>
</div>
<div id="the-gopheridge-soildb-dataset" class="section level3">
<h3><span class="header-section-number">3.5.3</span> The <code>gopheridge</code> <code>soilDB</code> Dataset</h3>
<p>The <code>gopheridge</code> sample data set is a sample R object returned from <code>fetchNASIS()</code> in a self-contained <code>.rda</code> file stored in <code>soilDB</code>.</p>
<p>Open RStudio, and set up the environment by loading packages and the <code>gopheridge</code> sample dataset.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="the-data-we-use.html#cb37-1"></a><span class="kw">library</span>(aqp)</span>
<span id="cb37-2"><a href="the-data-we-use.html#cb37-2"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb37-3"><a href="the-data-we-use.html#cb37-3"></a></span>
<span id="cb37-4"><a href="the-data-we-use.html#cb37-4"></a><span class="co"># load example dataset</span></span>
<span id="cb37-5"><a href="the-data-we-use.html#cb37-5"></a><span class="kw">data</span>(gopheridge, <span class="dt">package =</span> <span class="st">&quot;soilDB&quot;</span>)</span>
<span id="cb37-6"><a href="the-data-we-use.html#cb37-6"></a></span>
<span id="cb37-7"><a href="the-data-we-use.html#cb37-7"></a><span class="co"># what kind of object is this?</span></span>
<span id="cb37-8"><a href="the-data-we-use.html#cb37-8"></a><span class="kw">class</span>(gopheridge)</span></code></pre></div>
<pre><code>## [1] &quot;SoilProfileCollection&quot;
## attr(,&quot;package&quot;)
## [1] &quot;aqp&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="the-data-we-use.html#cb39-1"></a><span class="co"># what does the internal structure look like?</span></span>
<span id="cb39-2"><a href="the-data-we-use.html#cb39-2"></a><span class="kw">str</span>(gopheridge, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Formal class &#39;SoilProfileCollection&#39; [package &quot;aqp&quot;] with 9 slots
##   ..@ idcol       : chr &quot;peiid&quot;
##   ..@ hzidcol     : chr &quot;phiid&quot;
##   ..@ depthcols   : chr [1:2] &quot;hzdept&quot; &quot;hzdepb&quot;
##   ..@ metadata    :List of 8
##   ..@ horizons    :&#39;data.frame&#39;:	317 obs. of  73 variables:
##   ..@ site        :&#39;data.frame&#39;:	52 obs. of  114 variables:
##   ..@ sp          :Formal class &#39;SpatialPoints&#39; [package &quot;sp&quot;] with 3 slots
##   ..@ diagnostic  :&#39;data.frame&#39;:	164 obs. of  4 variables:
##   ..@ restrictions:&#39;data.frame&#39;:	56 obs. of  8 variables:</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="the-data-we-use.html#cb41-1"></a><span class="co"># the fields at the site and horizon levels within the SPC</span></span>
<span id="cb41-2"><a href="the-data-we-use.html#cb41-2"></a><span class="kw">siteNames</span>(gopheridge)</span></code></pre></div>
<pre><code>##   [1] &quot;peiid&quot;                                    &quot;siteiid&quot;                                 
##   [3] &quot;pedon_id&quot;                                 &quot;site_id&quot;                                 
##   [5] &quot;obs_date&quot;                                 &quot;utmzone&quot;                                 
##   [7] &quot;utmeasting&quot;                               &quot;utmnorthing&quot;                             
##   [9] &quot;x&quot;                                        &quot;y&quot;                                       
##  [11] &quot;horizdatnm&quot;                               &quot;x_std&quot;                                   
##  [13] &quot;y_std&quot;                                    &quot;gpspositionalerror&quot;                      
##  [15] &quot;describer&quot;                                &quot;pedonpurpose&quot;                            
##  [17] &quot;pedontype&quot;                                &quot;pedlabsampnum&quot;                           
##  [19] &quot;labdatadescflag&quot;                          &quot;tsectstopnum&quot;                            
##  [21] &quot;tsectinterval&quot;                            &quot;utransectid&quot;                             
##  [23] &quot;tsectkind&quot;                                &quot;tsectselmeth&quot;                            
##  [25] &quot;elev_field&quot;                               &quot;slope_field&quot;                             
##  [27] &quot;aspect_field&quot;                             &quot;plantassocnm&quot;                            
##  [29] &quot;earthcovkind1&quot;                            &quot;earthcovkind2&quot;                           
##  [31] &quot;erocl&quot;                                    &quot;bedrckdepth&quot;                             
##  [33] &quot;bedrckkind&quot;                               &quot;bedrckhardness&quot;                          
##  [35] &quot;hillslopeprof&quot;                            &quot;geomslopeseg&quot;                            
##  [37] &quot;shapeacross&quot;                              &quot;shapedown&quot;                               
##  [39] &quot;slopecomplex&quot;                             &quot;drainagecl&quot;                              
##  [41] &quot;flodfreqcl&quot;                               &quot;floddurcl&quot;                               
##  [43] &quot;flodmonthbeg&quot;                             &quot;pondfreqcl&quot;                              
##  [45] &quot;ponddurcl&quot;                                &quot;pondmonthbeg&quot;                            
##  [47] &quot;geomposhill&quot;                              &quot;geomposmntn&quot;                             
##  [49] &quot;geomposflats&quot;                             &quot;swaterdepth&quot;                             
##  [51] &quot;slope_shape&quot;                              &quot;classdate&quot;                               
##  [53] &quot;classifier&quot;                               &quot;classtype&quot;                               
##  [55] &quot;taxonname&quot;                                &quot;localphase&quot;                              
##  [57] &quot;taxonkind&quot;                                &quot;seriesstatus&quot;                            
##  [59] &quot;taxpartsize&quot;                              &quot;taxorder&quot;                                
##  [61] &quot;taxsuborder&quot;                              &quot;taxgrtgroup&quot;                             
##  [63] &quot;taxsubgrp&quot;                                &quot;soiltaxedition&quot;                          
##  [65] &quot;osdtypelocflag&quot;                           &quot;taxmoistcl&quot;                              
##  [67] &quot;taxtempregime&quot;                            &quot;taxfamother&quot;                             
##  [69] &quot;psctopdepth&quot;                              &quot;pscbotdepth&quot;                             
##  [71] &quot;selection_method&quot;                         &quot;ecositeid&quot;                               
##  [73] &quot;ecositenm&quot;                                &quot;ecositecorrdate&quot;                         
##  [75] &quot;es_classifier&quot;                            &quot;es_selection_method&quot;                     
##  [77] &quot;ochric.epipedon&quot;                          &quot;argillic.horizon&quot;                        
##  [79] &quot;paralithic.contact&quot;                       &quot;lithic.contact&quot;                          
##  [81] &quot;umbric.epipedon&quot;                          &quot;cambic.horizon&quot;                          
##  [83] &quot;mollic.epipedon&quot;                          &quot;paralithic.materials&quot;                    
##  [85] &quot;lithologic.discontinuity&quot;                 &quot;andic.soil.properties&quot;                   
##  [87] &quot;densic.contact&quot;                           &quot;abrupt.textural.change&quot;                  
##  [89] &quot;aquic.conditions&quot;                         &quot;duripan&quot;                                 
##  [91] &quot;slickensides&quot;                             &quot;redox.depletions.with.chroma.2.or.less&quot;  
##  [93] &quot;redox.concentrations&quot;                     &quot;reduced.matrix&quot;                          
##  [95] &quot;densic.materials&quot;                         &quot;volcanic.glass&quot;                          
##  [97] &quot;folistic.epipedon&quot;                        &quot;albic.materials&quot;                         
##  [99] &quot;human.transported.material&quot;               &quot;strongly.contrasting.particle.size.class&quot;
## [101] &quot;secondary.carbonates&quot;                     &quot;anthropic.epipedon&quot;                      
## [103] &quot;surface_fgravel&quot;                          &quot;surface_gravel&quot;                          
## [105] &quot;surface_cobbles&quot;                          &quot;surface_stones&quot;                          
## [107] &quot;surface_boulders&quot;                         &quot;surface_channers&quot;                        
## [109] &quot;surface_flagstones&quot;                       &quot;surface_paragravel&quot;                      
## [111] &quot;surface_paracobbles&quot;                      &quot;landform_string&quot;                         
## [113] &quot;pmkind&quot;                                   &quot;pmorigin&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="the-data-we-use.html#cb43-1"></a><span class="kw">horizonNames</span>(gopheridge)</span></code></pre></div>
<pre><code>##  [1] &quot;phiid&quot;                &quot;peiid&quot;                &quot;hzname&quot;               &quot;genhz&quot;               
##  [5] &quot;hzdept&quot;               &quot;hzdepb&quot;               &quot;bounddistinct&quot;        &quot;boundtopo&quot;           
##  [9] &quot;clay&quot;                 &quot;silt&quot;                 &quot;sand&quot;                 &quot;fragvoltot&quot;          
## [13] &quot;texture&quot;              &quot;texcl&quot;                &quot;lieutex&quot;              &quot;phfield&quot;             
## [17] &quot;effclass&quot;             &quot;labsampnum&quot;           &quot;rupresblkdry&quot;         &quot;rupresblkmst&quot;        
## [21] &quot;rupresblkcem&quot;         &quot;stickiness&quot;           &quot;plasticity&quot;           &quot;ksatpedon&quot;           
## [25] &quot;texture_class&quot;        &quot;d_r&quot;                  &quot;d_g&quot;                  &quot;d_b&quot;                 
## [29] &quot;d_hue&quot;                &quot;d_value&quot;              &quot;d_chroma&quot;             &quot;d_sigma&quot;             
## [33] &quot;m_r&quot;                  &quot;m_g&quot;                  &quot;m_b&quot;                  &quot;m_hue&quot;               
## [37] &quot;m_value&quot;              &quot;m_chroma&quot;             &quot;m_sigma&quot;              &quot;moist_soil_color&quot;    
## [41] &quot;dry_soil_color&quot;       &quot;fine_gravel&quot;          &quot;gravel&quot;               &quot;cobbles&quot;             
## [45] &quot;stones&quot;               &quot;boulders&quot;             &quot;channers&quot;             &quot;flagstones&quot;          
## [49] &quot;parafine_gravel&quot;      &quot;paragravel&quot;           &quot;paracobbles&quot;          &quot;parastones&quot;          
## [53] &quot;paraboulders&quot;         &quot;parachanners&quot;         &quot;paraflagstones&quot;       &quot;unspecified&quot;         
## [57] &quot;total_frags_pct_nopf&quot; &quot;total_frags_pct&quot;      &quot;art_fgr&quot;              &quot;art_gr&quot;              
## [61] &quot;art_cb&quot;               &quot;art_st&quot;               &quot;art_by&quot;               &quot;art_ch&quot;              
## [65] &quot;art_fl&quot;               &quot;art_unspecified&quot;      &quot;total_art_pct&quot;        &quot;huartvol_cohesive&quot;   
## [69] &quot;huartvol_penetrable&quot;  &quot;huartvol_innocuous&quot;   &quot;huartvol_persistent&quot;  &quot;soil_color&quot;          
## [73] &quot;hzID&quot;</code></pre>
<div id="make-profile-sketches" class="section level4">
<h4><span class="header-section-number">3.5.3.1</span> Make profile sketches</h4>
<p>The <code>plot()</code> function applied to a <code>SoilProfileCollection</code> object generates sketches based on horizon depths, designations, and colors.</p>
<p>The <code>fetchNASIS()</code> function automatically converts moist Munsell colors into R-style colors.</p>
<p>Multiple colors per horizon are mixed to make the ones that are shown by default in the calculated <code>soil_color</code> fields. See <code>?plotSPC</code> for a detailed list of arguments and examples.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="the-data-we-use.html#cb45-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb45-2"><a href="the-data-we-use.html#cb45-2"></a></span>
<span id="cb45-3"><a href="the-data-we-use.html#cb45-3"></a><span class="co"># omitting pedon IDs and horizon designations</span></span>
<span id="cb45-4"><a href="the-data-we-use.html#cb45-4"></a><span class="kw">plot</span>(gopheridge,</span>
<span id="cb45-5"><a href="the-data-we-use.html#cb45-5"></a>     <span class="dt">print.id =</span> <span class="ot">FALSE</span>,</span>
<span id="cb45-6"><a href="the-data-we-use.html#cb45-6"></a>     <span class="dt">name =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb45-7"><a href="the-data-we-use.html#cb45-7"></a>     <span class="dt">width =</span> <span class="fl">0.3</span>)</span>
<span id="cb45-8"><a href="the-data-we-use.html#cb45-8"></a><span class="kw">title</span>(<span class="st">&#39;Pedons from the `gopheridge` sample dataset&#39;</span>, <span class="dt">line =</span> <span class="fl">-0.5</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<p>When you load pedons using the <code>fetchNASIS()</code> function, the following data checks are performed:</p>
<ul>
<li><p><strong>Presence of multiple map datums</strong>. Results reported to the user and the data are not modified.</p></li>
<li><p><strong>Inconsistent horizon boundaries</strong>. Pedons with inconsistent horizon boundaries are not loaded. In most cases, this occurs when the bottom depth of a horizon is not the same as the upper depth of the next lower horizon.</p></li>
</ul>
<pre><code>##   hzname top bot
## 1      A   0  30
## 2    Bt1  38  56
## 3    Bt2  56 121
## 4     Bk 121 135
## 5      R 135  NA</code></pre>
<p>Note the issue above. The bottom depth of the A horizon and the upper depth of the Bt1 horizon should be the same: either 30 or 38 cm. The correct depth needs to be determined and fixed in the database</p>
<ul>
<li><p><strong>Missing lower horizon depths.</strong> Offending horizons are fixed by replacing the missing bottom depth with the top depth plus 2 cm. In the case of the profile shown above, a bottom depth of 137 cm would be inserted where the depth is missing.</p></li>
<li><p><strong>Sites missing pedon records</strong>. Data without corresponding horizons are not loaded.</p></li>
</ul>
</div>
<div id="find-pedons-with-errors" class="section level4">
<h4><span class="header-section-number">3.5.3.2</span> Find Pedons with Errors</h4>
<p>If errors in the pedon data are detected when loading data using <code>fetchNASIS()</code>, the following “get” commands can trace them back to the corresponding records in NASIS.</p>
<p>These access an option that is stored in a special object called an <code>Environment</code> associated with the soilDB package – they generally contain vectors of profile IDs.</p>
<ul>
<li><code>get('sites.missing.pedons', envir = soilDB.env)</code>
<ul>
<li>Returns user site ID for sites missing pedons</li>
</ul></li>
<li><code>get('dup.pedon.ids', envir = soilDB.env)</code>
<ul>
<li>Returns user pedon ID for sites with duplicate pedon ID</li>
</ul></li>
<li><code>get('bad.pedon.ids', envir = soilDB.env)</code>
<ul>
<li>Returns user pedon ID for pedons with inconsistent horizon depths</li>
</ul></li>
<li><code>get('bad.horizons', envir = soilDB.env)</code>
<ul>
<li>Returns a data.frame of horizon-level information for pedons with inconsistent horizon depths</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="the-data-we-use.html#cb47-1"></a><span class="kw">get</span>(<span class="st">&#39;sites.missing.pedons&#39;</span>, <span class="dt">envir =</span> soilDB.env)</span>
<span id="cb47-2"><a href="the-data-we-use.html#cb47-2"></a><span class="kw">get</span>(<span class="st">&#39;dup.pedon.ids&#39;</span>, <span class="dt">envir =</span> soilDB.env)</span>
<span id="cb47-3"><a href="the-data-we-use.html#cb47-3"></a><span class="kw">get</span>(<span class="st">&#39;bad.pedon.ids&#39;</span>, <span class="dt">envir =</span> soilDB.env)</span>
<span id="cb47-4"><a href="the-data-we-use.html#cb47-4"></a><span class="kw">get</span>(<span class="st">&#39;bad.horizons&#39;</span>, <span class="dt">envir =</span> soilDB.env)</span></code></pre></div>
<p>These <code>get()</code> calls access variables stored in the package environment <code>soilDB.env</code>. The variables only exist if there are “problems” / values in them – and if you fix the errors in database, they will be removed accordingly on next run.</p>
<p>For more information on the design of soilDB functions, see the following documentation: <a href="http://ncss-tech.github.io/AQP/soilDB/soilDB-Intro.html"><strong>Introduction to soilDB</strong></a>.</p>
<p>Additional documentation and examples can be found in:</p>
<ul>
<li><p><a href="http://ncss-tech.github.io/AQP/aqp/aqp-intro.html">http://ncss-tech.github.io/AQP/aqp/aqp-intro.html</a></p></li>
<li><p><a href="http://ncss-tech.github.io/AQP/aqp/merged-legend-plot.html">http://ncss-tech.github.io/AQP/aqp/merged-legend-plot.html</a></p></li>
<li><p><a href="http://ncss-tech.github.io/AQP/aqp/profile-summary.html">http://ncss-tech.github.io/AQP/aqp/profile-summary.html</a></p></li>
<li><p><a href="http://ncss-tech.github.io/AQP/aqp/SPC-plotting-ideas.html">http://ncss-tech.github.io/AQP/aqp/SPC-plotting-ideas.html</a></p></li>
</ul>
</div>
</div>
</div>
<div id="working-with-data-in-r" class="section level2">
<h2><span class="header-section-number">3.6</span> Working with Data in R</h2>
<div id="summaries" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Summaries</h3>
<p>Now that you’ve loaded some data, you can look at additional ways to summarize and interact with data elements.</p>
<div id="table" class="section level4">
<h4><span class="header-section-number">3.6.1.1</span> <code>table()</code></h4>
<p>The base R <code>table()</code> function is very useful for quick summary operations. It returns a named vector with the amount of each unique level of the a given vector.</p>
<p>The numeric vector of “counts” is commonly combined with other functions such as <code>sort()</code>, <code>order()</code>, <code>prop.table()</code>, <code>is.na()</code> or <code>!is.na()</code> (is not NA) to identify abundance, proportions, or missing data (<code>NA</code>).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="the-data-we-use.html#cb48-1"></a><span class="co"># load required packages</span></span>
<span id="cb48-2"><a href="the-data-we-use.html#cb48-2"></a><span class="kw">library</span>(aqp)</span>
<span id="cb48-3"><a href="the-data-we-use.html#cb48-3"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb48-4"><a href="the-data-we-use.html#cb48-4"></a></span>
<span id="cb48-5"><a href="the-data-we-use.html#cb48-5"></a><span class="kw">data</span>(<span class="st">&quot;gopheridge&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;soilDB&quot;</span>)</span>
<span id="cb48-6"><a href="the-data-we-use.html#cb48-6"></a></span>
<span id="cb48-7"><a href="the-data-we-use.html#cb48-7"></a><span class="co"># for these examples, we use the gopheridge dataset as our &quot;selected set&quot;</span></span>
<span id="cb48-8"><a href="the-data-we-use.html#cb48-8"></a>pedons &lt;-<span class="st"> </span>gopheridge <span class="co"># fetchNASIS() # you can use fetchNASIS</span></span>
<span id="cb48-9"><a href="the-data-we-use.html#cb48-9"></a></span>
<span id="cb48-10"><a href="the-data-we-use.html#cb48-10"></a><span class="co"># summarize which soil taxa we have loaded</span></span>
<span id="cb48-11"><a href="the-data-we-use.html#cb48-11"></a><span class="kw">table</span>(pedons<span class="op">$</span>taxonname)</span></code></pre></div>
<pre><code>## 
## Gopheridge 
##         52</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="the-data-we-use.html#cb50-1"></a><span class="co"># sort results in descending order</span></span>
<span id="cb50-2"><a href="the-data-we-use.html#cb50-2"></a><span class="kw">sort</span>(<span class="kw">table</span>(pedons<span class="op">$</span>taxonname), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Gopheridge 
##         52</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="the-data-we-use.html#cb52-1"></a><span class="co"># could do the same thing for taxonomic subgroups or any column of the SPC at the site or horizon levels</span></span>
<span id="cb52-2"><a href="the-data-we-use.html#cb52-2"></a><span class="kw">table</span>(pedons<span class="op">$</span>taxsubgrp)</span></code></pre></div>
<pre><code>## 
## mollic haploxeralfs  typic haploxerepts  ultic haploxeralfs  ultic haploxerolls 
##                   1                   6                  44                   1</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="the-data-we-use.html#cb54-1"></a><span class="kw">sort</span>(<span class="kw">table</span>(pedons<span class="op">$</span>taxsubgrp), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  ultic haploxeralfs  typic haploxerepts mollic haploxeralfs  ultic haploxerolls 
##                  44                   6                   1                   1</code></pre>
</div>
<div id="dput" class="section level4">
<h4><span class="header-section-number">3.6.1.2</span> <code>dput()</code></h4>
<p>Another very useful function is <code>dput()</code>, which prints a string-representation of the output of an R expression as code that generates that output so that you can re-use it.</p>
<p>It is also good short-hand for concatenating a comma-delimited list.</p>
<p>Here, we select the first four <code>pedon_id</code> values in <code>pedons</code> site table, and print out a comma-separated <code>c()</code> expression showing those values as a static R expression.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="the-data-we-use.html#cb56-1"></a><span class="kw">dput</span>(<span class="kw">site</span>(pedons)<span class="op">$</span>pedon_id[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span></code></pre></div>
<pre><code>## c(&quot;08DWB028&quot;, &quot;07RJV098&quot;, &quot;07RJV099&quot;, &quot;S2007CA009002&quot;)</code></pre>
<p>This result string can be copy-pasted as a comma-delimited string, used as string for NASIS list queries or other things.</p>
<p>The <code>dput()</code> function is helpful when sending questions or example data to colleagues. Here, we see that the results of <code>dput()</code> are equivalent to the input after evaluation by R.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="the-data-we-use.html#cb58-1"></a><span class="kw">all</span>(<span class="kw">c</span>(<span class="st">&quot;08DWB028&quot;</span>, <span class="st">&quot;07RJV098&quot;</span>, <span class="st">&quot;07RJV099&quot;</span>, <span class="st">&quot;S2007CA009002&quot;</span>) <span class="op">==</span><span class="st"> </span><span class="kw">site</span>(pedons)<span class="op">$</span>pedon_id[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="the-dplyr-package-and-tidy-data-principles" class="section level4">
<h4><span class="header-section-number">3.6.1.3</span> The <code>dplyr</code> package and “tidy” data principles</h4>
<p><strong><a href="https://tidyr.tidyverse.org/articles/tidy-data.html">Tidy Data Principles</a></strong></p>
<p>This is a stub to talk about <code>dplyr</code> some links to tidyverse-centric examples of working with <code>data.frame</code>/<code>tibble</code> and summarizing them.</p>
<p>Talk about cool things like <code>rowwise()</code>, <code>across()</code> and translation to high-performance code (<code>dtplyr</code>) and SQL (<code>dbplyr</code>).</p>
<!--
Brief point on why students learning R probably should use it for certain things at least. 

 - Abundant resources available
 
 - Now mature

 - Many options for inputs, ways to do things
 
 - Possibly more expressive code, in a consistent style (easier to share with others?)
 
But also that they should have a basic understanding how could be done in base R -- if nothing else to be better-informed of their (probably easier `dplyr`) choices. 

Anecdote about using `dplyr` for very simple base R things, and deprecation/package stability in general. `dplyr` is stable now, but it wasn't. Be aware of that kind of thing when you use a new package.
-->
<!--
##### `dplyr` and `aqp`

This is a stub to talk about making dplyr and aqp play nice in the NAMESPACE.
-->
</div>
</div>
<div id="missing-values" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Missing Values</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="the-data-we-use.html#cb60-1"></a><span class="kw">table</span>(pedons<span class="op">$</span>taxsubgrp, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## 
## mollic haploxeralfs  typic haploxerepts  ultic haploxeralfs  ultic haploxerolls 
##                   1                   6                  44                   1</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="the-data-we-use.html#cb62-1"></a><span class="co">#  is.na(...) </span></span>
<span id="cb62-2"><a href="the-data-we-use.html#cb62-2"></a><span class="kw">table</span>(<span class="kw">is.na</span>(pedons<span class="op">$</span>taxsubgrp))</span></code></pre></div>
<pre><code>## 
## FALSE 
##    52</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="the-data-we-use.html#cb64-1"></a><span class="co">#  is NOT NA !is.na(...)</span></span>
<span id="cb64-2"><a href="the-data-we-use.html#cb64-2"></a><span class="kw">table</span>(<span class="op">!</span><span class="kw">is.na</span>(pedons<span class="op">$</span>taxsubgrp))</span></code></pre></div>
<pre><code>## 
## TRUE 
##   52</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="the-data-we-use.html#cb66-1"></a><span class="co"># it can also be applied to horizon level columns in the SPC</span></span>
<span id="cb66-2"><a href="the-data-we-use.html#cb66-2"></a><span class="kw">sort</span>(<span class="kw">table</span>(pedons<span class="op">$</span>texture), <span class="dt">decreasing=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##        BR         L      GR-L     GRV-L     CBV-L       SPM     GRX-L       SIL    GRV-CL    CBV-CL 
##        58        36        33        24        18        14        12        12         9         8 
##    GR-SIL     CBX-L    GRX-CL    CBX-CL   GRV-SIL        CL   GRV-SCL     GRX-C       MPM        SL 
##         7         6         5         4         4         3         3         3         3         3 
##      CB-L     GR-CL   GRX-SCL     PGR-C    PGRX-L      SICL    STV-CL     STV-L     STX-C     STX-L 
##         2         2         2         2         2         2         2         2         2         2 
##         C      CB-C     CB-CL    CB-SCL    CB-SIL   CBV-SIL   CBX-SCL      CN-L   CN-SICL     CNX-L 
##         1         1         1         1         1         1         1         1         1         1 
##  CNX-SICL     FLV-L      GR-C    GR-SIC  GRV-SICL   GRX-SIC   GRX-SIL  PCB-SICL PCBV-SICL     PCN-C 
##         1         1         1         1         1         1         1         1         1         1 
##   PCNX-CL    PGRV-C   PGRV-CL  PGRX-SCL  PGRX-SIL      ST-L     STV-C    STX-CL  STX-SICL 
##         1         1         1         1         1         1         1         1         1</code></pre>
</div>
<div id="logical-operators" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Logical Operators</h3>
<ul>
<li>Less than <code>&lt;</code>, greater than <code>&gt;</code>, less than or equal to <code>&lt;=</code>, and greater than or equal to <code>&gt;=</code>.</li>
<li><code>%in%</code> Equivalent to <code>IN ()</code> in SQL; same logic as <code>match()</code>
<ul>
<li>Example: <code>pedons$taxpartsize %in% c('loamy-skeletal', 'sandy-skeletal')</code></li>
<li>Returns a vector of <code>TRUE</code>/<code>FALSE</code> equal in length to left-hand side.</li>
</ul></li>
<li><code>!=</code> Not-equal-to character “string.”</li>
<li><code>==</code> Note in the example above that R uses a double equal sign as “equal to.”</li>
</ul>
</div>
<div id="pattern-matching" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Pattern Matching</h3>
<p>The following examples use the <code>grep()</code> function to pattern match within the data, create an index of the <code>SoilProfileCollection</code> for records that match the specified pattern within that column, and then use that index to filter to specific sites and their corresponding profiles.
Patterns are specified using <a href="http://regexr.com/">regular expression</a> (REGEX) syntax.</p>
<p>This process can be applied to many different columns in the SPC based on how you need to filter the data. This example pattern matches on the <code>tax_subgroup</code> column, but another useful application might be to pattern match on geomorphology or parent material.</p>
<p>Say we want to see what the variation of particle size classes are within a specific subgroup? We can use <code>grep()</code> to create a row index, then apply that index to the <code>SoilProfileCollection</code>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="the-data-we-use.html#cb68-1"></a><span class="co"># create a numeric index for pedons with taxsubgroup containing &#39;typic&#39;</span></span>
<span id="cb68-2"><a href="the-data-we-use.html#cb68-2"></a>idx &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&#39;typic&#39;</span>, pedons<span class="op">$</span>taxsubgrp)</span>
<span id="cb68-3"><a href="the-data-we-use.html#cb68-3"></a>idx</span></code></pre></div>
<pre><code>## [1] 11 12 13 14 26 50</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="the-data-we-use.html#cb70-1"></a><span class="co"># use square bracket notation to subset &#39;typic&#39; soils in `subset1` object</span></span>
<span id="cb70-2"><a href="the-data-we-use.html#cb70-2"></a>subset1 &lt;-<span class="st"> </span>pedons[idx,]</span>
<span id="cb70-3"><a href="the-data-we-use.html#cb70-3"></a>subset1</span></code></pre></div>
<pre><code>## SoilProfileCollection with 6 profiles and 37 horizons
## profile ID: peiid  |  horizon ID: phiid 
## Depth range: 200 - 200 cm
## 
## ----- Horizons (6 / 37 rows  |  10 / 73 columns) -----
##   peiid   phiid hzdept hzdepb hzname genhz bounddistinct boundtopo clay silt
##  351685 1567471      0     10     A1     A         clear    smooth   20   35
##  351685 1567472     10     18     A2     A         clear      wavy   20   35
##  351685 1567473     18     28     A3     A         clear      wavy   20   35
##  351685 1567474     28     43    Bw1    Bt         clear      wavy   20   35
##  351685 1567475     43     51    Bw2    Bt         clear      wavy   20   35
##  351685 1567476     51     58     BC   BCt        abrupt      wavy   20   35
## [... more horizons ...]
## 
## ----- Sites (6 / 6 rows  |  10 / 114 columns) -----
##   peiid siteiid pedon_id       site_id   obs_date utmzone utmeasting utmnorthing         x        y
##  351685  352173 07RJV100 07CA630RJV100 2007-09-17      10   731914.0     4180918 -120.3678 37.74611
##  351686  352174 07RJV101 07CA630RJV101 2007-09-17      10   732398.3     4180564 -120.3625 37.74278
##  351687  352175 07RJV102 07CA630RJV102 2007-09-17      10   732298.0     4181093 -120.3633 37.74778
##  351688  352176 07RJV103 07CA630RJV103 2007-09-24      10   731470.3     4177508 -120.3739 37.71556
##  352495  352964 07RJV093 07CA630RJV093 2007-08-28      10   733216.8     4181168 -120.3531 37.74805
##  640650  646344 07JCR008 07CA630JCR008 2007-06-14      10   700696.7     4201941 -120.7161 37.94278
## 
## Spatial Data: [EMPTY]</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="the-data-we-use.html#cb72-1"></a><span class="co"># or use the index directly to summarize taxpartsize for &#39;typic&#39; soils</span></span>
<span id="cb72-2"><a href="the-data-we-use.html#cb72-2"></a><span class="kw">sort</span>(<span class="kw">table</span>(pedons<span class="op">$</span>taxpartsize[idx]), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  loamy-skeletal clayey-skeletal 
##               5               1</code></pre>
<p>Note: <code>grep()</code> below has an <code>invert</code> argument (default <code>FALSE</code>). This option is very useful for excluding the results of the pattern matching process by inverting whatever the result is. <code>grepl()</code> is the <em>logical</em> version of <code>grep()</code>, so you can invert it using the logical NOT operator: <code>!</code>.</p>
<p>Another method is to create an index using <code>which()</code> function. <code>which()</code> takes any logical vector (or expression), and it returns the indices (positions) where that expression returns <code>TRUE</code>.</p>
<p><em>Do a graphical check to see the “typic” profiles are selected.</em></p>
<p>Plot them in R using the <code>SoilProfileCollection</code> “plot” method (e.g., specialized version of the generic <code>plot()</code> function).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="the-data-we-use.html#cb74-1"></a><span class="co"># adjust margins</span></span>
<span id="cb74-2"><a href="the-data-we-use.html#cb74-2"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb74-3"><a href="the-data-we-use.html#cb74-3"></a></span>
<span id="cb74-4"><a href="the-data-we-use.html#cb74-4"></a><span class="co"># plot the first 10 profiles of subset1</span></span>
<span id="cb74-5"><a href="the-data-we-use.html#cb74-5"></a><span class="kw">plot</span>(subset1[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ], <span class="dt">label =</span> <span class="st">&#39;taxsubgrp&#39;</span>, <span class="dt">max.depth =</span> <span class="dv">60</span>)</span>
<span id="cb74-6"><a href="the-data-we-use.html#cb74-6"></a><span class="kw">title</span>(<span class="st">&#39;Pedons with the word &quot;typic&quot; at subgroup-level of Soil Taxonomy&#39;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-17-1.png" width="768" /></p>
<p>For more information on using regular expressions in <code>grep()</code> for pattern matching operations, see: <a href="https://www.gnu.org/software/findutils/manual/html_node/find_html/grep-regular-expression-syntax.html">Regular-expression-syntax</a>.</p>
<p>Quick check: <em>Compare or run these commands with some code, and review the documentation, to answer the questions.</em></p>
<ul>
<li><em>True or False</em>: <code>grepl()</code> returns a <em>numeric</em> vector</li>
<li><em>True or False</em>: <code>which(grepl('typic', pedons$taxsubgrp))</code> is the same as <code>grep('typic', pedons$taxsubgrp)</code>.</li>
</ul>
<div id="important-syntax-options-for-regex-pattern-matching" class="section level4">
<h4><span class="header-section-number">3.6.4.1</span> Important syntax options for REGEX pattern matching</h4>
<ul>
<li><code>|</code> <code>OR</code> operator for multiple expressions:
<ul>
<li>Example: <code>grep('loamy|sandy', c("loamy-skeletal","sandy","sandy-skeletal"))</code>
<ul>
<li>“loamy <em>OR</em> sandy”</li>
</ul></li>
</ul></li>
<li><code>^</code> Anchor to beginning of string / line:
<ul>
<li>Example: <code>grep('^sandy', c("loamy-skeletal","sandy","sandy-skeletal"))</code>
<ul>
<li>“<em>STARTS WITH</em> sandy”</li>
</ul></li>
</ul></li>
<li><code>$</code> Anchor to end of string / line:
<ul>
<li>Example: <code>grep('skeletal$', c("loamy-skeletal","sandy","sandy-skeletal"))</code>
<ul>
<li>“<em>ENDS WITH</em> skeletal”</li>
</ul></li>
</ul></li>
<li><code>\\b</code> Anchor to word boundary:
<ul>
<li>Example: <code>grep('\\bmesic', c("mesic","thermic","isomesic"))</code>
<ul>
<li>“<em>WORD STARTS WITH</em> mesic” (e.g. not “isomesic”)</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="resources-for-learning-about-regular-expressions" class="section level4">
<h4><span class="header-section-number">3.6.4.2</span> Resources for learning about regular expressions</h4>
<ul>
<li><a href="https://regex101.com/" class="uri">https://regex101.com/</a> &amp; <a href="https://regexr.com/" class="uri">https://regexr.com/</a> - Online regular expression testers</li>
<li><a href="http://www.regular-expressions.info/quickstart.html" class="uri">http://www.regular-expressions.info/quickstart.html</a> - One-page regular expression quick start guide</li>
</ul>
</div>
</div>
<div id="filtering" class="section level3">
<h3><span class="header-section-number">3.6.5</span> Filtering</h3>
<p>A variety of methods are available to subset or “filter” R data objects, from <code>data.frame</code> or vector, to something more complex like a <code>Spatial</code> object or a <code>SoilProfileCollection</code>.</p>
<p>You can index many R objects using numeric or logical expressions as above. There are also methods that make this process a little easier.</p>
<p>The base R method for this is <code>subset()</code> and it works on <code>data.frame</code> objects. It is nice because you can specify column names without explicitly referencing the data set, since subset uses non-standard evaluation of expressions passed as arguments.</p>
</div>
<div id="filtering-data-by-logical-criteria-with-aqpsubset" class="section level3">
<h3><span class="header-section-number">3.6.6</span> Filtering Data by Logical Criteria with <code>aqp::subset</code></h3>
<p>We use the <code>SoilProfileCollection</code> <code>subset</code> method, where we first specify a data (<code>pedons</code>) object then we can write expressions for the columns that exist in that object.</p>
<p>Here, we combine two logical expressions to find <code>taxsubgrp</code> containing <code>"alfs"</code> (Alfisols) with <code>obsdate</code> before January 1st, 2010.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="the-data-we-use.html#cb75-1"></a>subset2 &lt;-<span class="kw">subset</span>(pedons, <span class="kw">grepl</span>(<span class="st">&quot;alfs&quot;</span>, taxsubgrp) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb75-2"><a href="the-data-we-use.html#cb75-2"></a><span class="st">                           </span>obs_date <span class="op">&lt;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="st">&quot;2010-01-01&quot;</span>))</span>
<span id="cb75-3"><a href="the-data-we-use.html#cb75-3"></a></span>
<span id="cb75-4"><a href="the-data-we-use.html#cb75-4"></a><span class="co"># check taxonomic range of particle size classes in the data</span></span>
<span id="cb75-5"><a href="the-data-we-use.html#cb75-5"></a><span class="co"># overwhelmingly these are described as loamy-skeletal ultic haploxeralfs</span></span>
<span id="cb75-6"><a href="the-data-we-use.html#cb75-6"></a><span class="kw">sort</span>(<span class="kw">table</span>(subset2<span class="op">$</span>taxsubgrp), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  ultic haploxeralfs mollic haploxeralfs 
##                  28                   1</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="the-data-we-use.html#cb77-1"></a><span class="kw">sort</span>(<span class="kw">table</span>(subset2<span class="op">$</span>taxpartsize), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  loamy-skeletal clayey-skeletal            fine      fine-loamy 
##              25               2               1               1</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="the-data-we-use.html#cb79-1"></a><span class="co"># a double equal sign &#39;==&#39; is used for exact character or numeric criteria</span></span>
<span id="cb79-2"><a href="the-data-we-use.html#cb79-2"></a>subset3 &lt;-<span class="st"> </span><span class="kw">subset</span>(subset2, taxpartsize <span class="op">==</span><span class="st"> &#39;loamy-skeletal&#39;</span>)</span>
<span id="cb79-3"><a href="the-data-we-use.html#cb79-3"></a></span>
<span id="cb79-4"><a href="the-data-we-use.html#cb79-4"></a><span class="kw">table</span>(subset3<span class="op">$</span>taxpartsize)</span></code></pre></div>
<pre><code>## 
## loamy-skeletal 
##             25</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="the-data-we-use.html#cb81-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb81-2"><a href="the-data-we-use.html#cb81-2"></a><span class="kw">plotSPC</span>(subset3[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, ], <span class="dt">print.id =</span> <span class="ot">FALSE</span>)</span>
<span id="cb81-3"><a href="the-data-we-use.html#cb81-3"></a><span class="kw">title</span>(<span class="st">&#39;Loamy-skeletal Ultic Haploxeralfs&#39;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
</div>
<div id="dates-and-times" class="section level3">
<h3><span class="header-section-number">3.6.7</span> Dates and Times</h3>
<p>Unix time is a system for describing a point in time. It is the number of seconds that have elapsed since the Unix epoch, minus leap seconds; the Unix epoch is 00:00:00 UTC on 1 January 1970.</p>
<p>Above, we use the fact that you can logically compare dates and times if their string representation is converted to a common base R UNIX time representation known as <code>POSIXlt</code>.</p>
<p>This conversion accounts for important things like timezone, using your current locale – which is important to keep in mind.</p>
<div id="zoo-package" class="section level4">
<h4><span class="header-section-number">3.6.7.1</span> <code>zoo</code> package</h4>
<p>Tools for totally ordered indexed observations – especially irregular time series.</p>
<p><a href="https://cran.r-project.org/web/packages/zoo/vignettes/zoo-quickref.pdf">zoo Quick Reference</a></p>
</div>
<div id="tidyverts-and-the-tsibble-package" class="section level4">
<h4><span class="header-section-number">3.6.7.2</span> <code>tidyverts</code> and the <code>tsibble</code> package</h4>
<p><a href="https://tidyverts.org/"><code>tidyerts</code></a> is all about <em>time-series</em> in the <a href="https://tidyverse.org/">tidyverse</a>.</p>
<p>The <a href="https://github.com/tidyverts/tsibble"><code>tsibble</code></a> package provides a data structure for tidy temporal data and models.</p>
</div>
</div>
<div id="exercise-prepare-example-data" class="section level3">
<h3><span class="header-section-number">3.6.8</span> EXERCISE: Prepare Example Data</h3>
<p>This is a sample “selected set” that will be used in the following sections.</p>
<p>For reproducibility and the sake of time, you can download the above two objects (<code>mt663</code> and <code>mt663err</code>) with the following code – without loading them into your selected set.</p>
<p>To download the sample <code>2015MT663%</code> data from the course page with R:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="the-data-we-use.html#cb82-1"></a>example.data.dir &lt;-<span class="st"> &quot;C:/workspace2&quot;</span></span>
<span id="cb82-2"><a href="the-data-we-use.html#cb82-2"></a>example.data.path &lt;-<span class="st"> </span><span class="kw">file.path</span>(example.data.dir, <span class="st">&quot;mt663.zip&quot;</span>)</span>
<span id="cb82-3"><a href="the-data-we-use.html#cb82-3"></a></span>
<span id="cb82-4"><a href="the-data-we-use.html#cb82-4"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">dir.exists</span>(example.data.dir))</span>
<span id="cb82-5"><a href="the-data-we-use.html#cb82-5"></a>  <span class="kw">dir.create</span>(example.data.dir, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb82-6"><a href="the-data-we-use.html#cb82-6"></a></span>
<span id="cb82-7"><a href="the-data-we-use.html#cb82-7"></a><span class="kw">download.file</span>(<span class="st">&quot;http://ncss-tech.github.io/stats_for_soil_survey/data/book/02/mt663.zip&quot;</span>, <span class="dt">destfile =</span> example.data.path)</span>
<span id="cb82-8"><a href="the-data-we-use.html#cb82-8"></a></span>
<span id="cb82-9"><a href="the-data-we-use.html#cb82-9"></a><span class="kw">unzip</span>(example.data.path, <span class="dt">exdir =</span> example.data.dir, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Before continuing, <em>imagine</em> opening the NASIS client, populating your selected set with <code>2015MT663%</code> using a query like “<em>NSSC Pangaea – POINT-Pedon/Site by User Pedon ID</em>”</p>
<p>And then using <code>fetchNASIS()</code> to get a <code>SoilProfileCollection</code> with and without <code>rmHzErrors</code> as shown (commented out) below:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="the-data-we-use.html#cb83-1"></a><span class="co">## for this to work in this example, you need 2015MT663% in your NASIS selected set</span></span>
<span id="cb83-2"><a href="the-data-we-use.html#cb83-2"></a><span class="co"># mt663err &lt;- fetchNASIS(rmHzErrors = FALSE)</span></span>
<span id="cb83-3"><a href="the-data-we-use.html#cb83-3"></a><span class="co"># mt663 &lt;- fetchNASIS()</span></span></code></pre></div>
<p>When you ran the sample data download code, that code is essentially what you did. To load that sample object data into R, just use <code>load()</code> and the path to the <em>.rda</em> file (<code>example.data.path</code> or <code>"C:/workspace2/mt663.rda"</code>)</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="the-data-we-use.html#cb84-1"></a><span class="co"># load the sample data</span></span>
<span id="cb84-2"><a href="the-data-we-use.html#cb84-2"></a>example.data.dir &lt;-<span class="st"> &quot;C:/workspace2&quot;</span></span>
<span id="cb84-3"><a href="the-data-we-use.html#cb84-3"></a><span class="kw">load</span>(<span class="kw">file.path</span>(example.data.dir, <span class="st">&quot;mt663.rda&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="comparing-results-with-rmhzerrors" class="section level2">
<h2><span class="header-section-number">3.7</span> Comparing Results with <code>rmHzErrors</code></h2>
<p>Here we compare the number of ochric epipedons that are shown as present in the site table of the <code>SoilProfileCollection</code></p>
<p>With the default <code>rmHzErrors = TRUE</code> most of the profiles with ochric epipedons are <em>removed</em> – this is something you need to be aware of and inspect!</p>
<p>There are a lot of reasons why this can happen, which we will now investigate.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="the-data-we-use.html#cb85-1"></a><span class="co">## rmHzErrors == TRUE (DEFAULT)</span></span>
<span id="cb85-2"><a href="the-data-we-use.html#cb85-2"></a><span class="kw">length</span>(mt663)</span></code></pre></div>
<pre><code>## [1] 46</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="the-data-we-use.html#cb87-1"></a><span class="kw">site</span>(mt663)<span class="op">$</span>ochric.epipedon</span></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [17] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE
## [33] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="the-data-we-use.html#cb89-1"></a><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">site</span>(mt663)<span class="op">$</span>ochric.epipedon))</span></code></pre></div>
<pre><code>## [1] 46</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="the-data-we-use.html#cb91-1"></a><span class="kw">subset</span>(<span class="kw">site</span>(mt663), ochric.epipedon)</span></code></pre></div>
<pre><code>##    siteiid   peiid      pedon_id       site_id   obs_date utmzone utmeasting utmnorthing         x
## 18 1100755 1092665 2015MT6630556 2015MT6630556 2015-09-03      12   305081.6     5399079 -113.6499
## 24 1183405 1155011 2015MT6633522 2015MT6633522 2015-08-14      12   289926.5     5418878 -113.8658
## 25 1183412 1155018 2015MT6633529 2015MT6633529 2015-08-16      12   288676.1     5415611 -113.8812
## 26 1183413 1155019 2015MT6633530 2015MT6633530 2015-08-16      12   289240.8     5416496 -113.8739
## 31 1191592 1161198 2015MT6635255 2015MT6635255 2015-07-20      12   297939.2     5423022 -113.7587
## 34 1191603 1161209 2015MT6635266 2015MT6635266 2015-09-01      12   328171.5     5372499 -113.3253
## 41 1191610 1161216 2015MT6635273 2015MT6635273 2015-09-23      12   300260.3     5396456 -113.7141
## 46 1191616 1161222 2015MT6635279 2015MT6635279 2015-09-24      12   301042.5     5398455 -113.7045
##           y horizdatnm     x_std    y_std gpspositionalerror
## 18 48.71425      WGS84 -113.6499 48.71425                 NA
## 24 48.88721      WGS84 -113.8658 48.88721                 NA
## 25 48.85744      WGS84 -113.8812 48.85744                 NA
## 26 48.86558      WGS84 -113.8739 48.86558                 NA
## 31 48.92711      WGS84 -113.7587 48.92711                 NA
## 34 48.48212      WGS84 -113.3253 48.48212                 NA
## 41 48.68916      WGS84 -113.7141 48.68915                 NA
## 46 48.70736      WGS84 -113.7045 48.70737                 NA
##                                              describer          pedonpurpose             pedontype
## 18                            Jay Skovlin, Beth Rowley soil survey inventory undefined observation
## 24                            Joe Capella, Beth Rowley soil survey inventory undefined observation
## 25                            Jay Skovlin, Beth Rowley soil survey inventory undefined observation
## 26                            Jay Skovlin, Beth Rowley soil survey inventory undefined observation
## 31                  Patrick O&#39;Connell, Carmel Johnston soil survey inventory undefined observation
## 34                      Beth Rowley, Patrick O&#39;Connell soil survey inventory undefined observation
## 41 Patrick O&#39;Connell, Jay Skovlin, Stephanie Shoemaker soil survey inventory undefined observation
## 46 Jay Skovlin, Patrick O&#39;Connell, Stephanie Shoemaker soil survey inventory undefined observation
##    pedlabsampnum labdatadescflag tsectstopnum tsectinterval utransectid tsectkind tsectselmeth
## 18            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 24            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 25            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 26            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 31            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 34            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 41            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
## 46            NA               0           NA            NA          NA      &lt;NA&gt;         &lt;NA&gt;
##    elev_field slope_field aspect_field plantassocnm earthcovkind1 earthcovkind2 erocl bedrckdepth
## 18       2149          13          190         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          NA
## 24       1657          11          210         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          NA
## 25       2086          13          160         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          53
## 26       2120          55          200         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          NA
## 31          0          35          185         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          NA
## 34       2245           8          200         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          54
## 41       2027           6          290         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          41
## 46       2156          12          190         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          NA
##     bedrckkind bedrckhardness hillslopeprof geomslopeseg shapeacross shapedown slopecomplex
## 18        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;      linear    linear         &lt;NA&gt;
## 24        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;      convex    linear         &lt;NA&gt;
## 25 pillow lava           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;      linear   concave         &lt;NA&gt;
## 26        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;      linear    linear         &lt;NA&gt;
## 31        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;      linear   concave         &lt;NA&gt;
## 34   argillite      indurated      shoulder         &lt;NA&gt;     concave    linear         &lt;NA&gt;
## 41   argillite      indurated      toeslope         &lt;NA&gt;      convex    linear         &lt;NA&gt;
## 46        &lt;NA&gt;           &lt;NA&gt;      toeslope         &lt;NA&gt;      convex    linear         &lt;NA&gt;
##     drainagecl flodfreqcl floddurcl flodmonthbeg pondfreqcl ponddurcl pondmonthbeg geomposhill
## 18        well       none      &lt;NA&gt;         &lt;NA&gt;       none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;
## 24        well       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  nose slope
## 25        well       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;
## 26        well       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;
## 31        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope
## 34        well       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       crest
## 41        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  base slope
## 46 very poorly       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  base slope
##                   geomposmntn geomposflats swaterdepth      slope_shape  classdate classifier
## 18                       &lt;NA&gt;         &lt;NA&gt;          NA  linear / linear 2015-12-11        JMS
## 24                       &lt;NA&gt;         &lt;NA&gt;          NA  convex / linear 2015-11-06       &lt;NA&gt;
## 25                       &lt;NA&gt;         &lt;NA&gt;          NA linear / concave 2015-11-06       &lt;NA&gt;
## 26                       &lt;NA&gt;         &lt;NA&gt;          NA  linear / linear 2015-11-06       &lt;NA&gt;
## 31 mountainflank, lower third         &lt;NA&gt;          NA linear / concave 2015-11-04       &lt;NA&gt;
## 34                       &lt;NA&gt;         &lt;NA&gt;          NA concave / linear 2015-11-05       &lt;NA&gt;
## 41                       &lt;NA&gt;         &lt;NA&gt;          NA  convex / linear 2015-11-05       &lt;NA&gt;
## 46                       &lt;NA&gt;         &lt;NA&gt;          NA  convex / linear 2015-11-06       &lt;NA&gt;
##    classtype taxonname localphase taxonkind seriesstatus                       taxpartsize
## 18     field      null         NA    series         &lt;NA&gt;                    loamy-skeletal
## 24     field   unnamed         NA    family         &lt;NA&gt;                    loamy-skeletal
## 25     field   unnamed         NA    family         &lt;NA&gt; ashy-skeletal over loamy-skeletal
## 26     field   unnamed         NA    family         &lt;NA&gt;                    sandy-skeletal
## 31      &lt;NA&gt;      null         NA    family         &lt;NA&gt;                    loamy-skeletal
## 34      &lt;NA&gt;      null         NA    family         &lt;NA&gt;                    loamy-skeletal
## 41      &lt;NA&gt;      null         NA    family         &lt;NA&gt;                    loamy-skeletal
## 46      &lt;NA&gt;      null         NA    family         &lt;NA&gt;                    loamy-skeletal
##       taxorder taxsuborder  taxgrtgroup           taxsubgrp   soiltaxedition osdtypelocflag
## 18    andisols     cryands haplocryands spodic haplocryands eleventh edition              0
## 24 inceptisols     cryepts haplocryepts  typic haplocryepts             &lt;NA&gt;              0
## 25 inceptisols     cryepts haplocryepts  andic haplocryepts             &lt;NA&gt;              0
## 26    entisols    orthents  cryorthents   typic cryorthents             &lt;NA&gt;              0
## 31 inceptisols     cryepts haplocryepts  typic haplocryepts             &lt;NA&gt;              0
## 34 inceptisols     cryepts haplocryepts  typic haplocryepts             &lt;NA&gt;              0
## 41 inceptisols     cryepts haplocryepts lithic haplocryepts             &lt;NA&gt;              0
## 46 inceptisols     cryepts haplocryepts  aquic haplocryepts             &lt;NA&gt;              0
##    taxmoistcl taxtempregime taxfamother psctopdepth pscbotdepth selection_method ochric.epipedon
## 18       &lt;NA&gt;         cryic        &lt;NA&gt;          28         103    single record            TRUE
## 24       udic         cryic        &lt;NA&gt;          25         100    single record            TRUE
## 25       udic         cryic        &lt;NA&gt;          25          53    single record            TRUE
## 26       udic         cryic        &lt;NA&gt;          25         100    single record            TRUE
## 31       udic         cryic        &lt;NA&gt;          25         100    single record            TRUE
## 34       udic         cryic        &lt;NA&gt;          25          54    single record            TRUE
## 41       udic         cryic        &lt;NA&gt;          25          41    single record            TRUE
## 46       udic         cryic        &lt;NA&gt;          25         100    single record            TRUE
##    cambic.horizon lithic.contact mollic.epipedon argillic.horizon redox.concentrations
## 18           TRUE          FALSE           FALSE            FALSE                FALSE
## 24           TRUE          FALSE           FALSE            FALSE                FALSE
## 25           TRUE           TRUE           FALSE            FALSE                FALSE
## 26          FALSE          FALSE           FALSE            FALSE                FALSE
## 31           TRUE          FALSE           FALSE            FALSE                FALSE
## 34           TRUE           TRUE           FALSE            FALSE                FALSE
## 41           TRUE           TRUE           FALSE            FALSE                FALSE
## 46          FALSE          FALSE           FALSE            FALSE                FALSE
##    andic.soil.properties secondary.carbonates aquic.conditions sapric.soil.materials reduced.matrix
## 18                  TRUE                FALSE            FALSE                 FALSE          FALSE
## 24                 FALSE                FALSE            FALSE                 FALSE          FALSE
## 25                 FALSE                FALSE            FALSE                 FALSE          FALSE
## 26                 FALSE                FALSE            FALSE                 FALSE          FALSE
## 31                 FALSE                FALSE            FALSE                 FALSE          FALSE
## 34                 FALSE                FALSE            FALSE                 FALSE          FALSE
## 41                 FALSE                FALSE            FALSE                 FALSE          FALSE
## 46                 FALSE                FALSE            FALSE                 FALSE          FALSE
##    albic.horizon spodic.horizon glossic.horizon spodic.materials lithologic.discontinuity
## 18         FALSE          FALSE           FALSE            FALSE                    FALSE
## 24         FALSE          FALSE           FALSE            FALSE                    FALSE
## 25         FALSE          FALSE           FALSE            FALSE                     TRUE
## 26         FALSE          FALSE           FALSE            FALSE                    FALSE
## 31         FALSE          FALSE           FALSE            FALSE                    FALSE
## 34         FALSE          FALSE           FALSE            FALSE                    FALSE
## 41         FALSE          FALSE           FALSE            FALSE                    FALSE
## 46         FALSE          FALSE           FALSE            FALSE                    FALSE
##    densic.materials umbric.epipedon albic.materials surface_fgravel surface_gravel surface_cobbles
## 18            FALSE           FALSE           FALSE               0              0               0
## 24            FALSE           FALSE           FALSE               0              0               0
## 25            FALSE           FALSE           FALSE               0              0               0
## 26            FALSE           FALSE           FALSE               0              0               0
## 31            FALSE           FALSE           FALSE               0              0               0
## 34            FALSE           FALSE           FALSE               0              0               0
## 41            FALSE           FALSE           FALSE               0              0               0
## 46            FALSE           FALSE           FALSE               0              0               0
##    surface_stones surface_boulders surface_channers surface_flagstones surface_paragravel
## 18            0.8                0                0                  0                  0
## 24            0.0                0                0                  0                  0
## 25            0.0                0                0                  0                  0
## 26            0.0                0                0                  0                  0
## 31            0.0                0                0                  0                  0
## 34            0.0                0                0                  0                  0
## 41            0.0                0                0                  0                  0
## 46            0.0                0                0                  0                  0
##    surface_paracobbles              landform_string                           pmkind
## 18                   0                 cirque floor volcanic ash &amp; till, unspecified
## 24                   0              avalanche chute                        colluvium
## 25                   0 depression &amp; roche moutonnee          volcanic ash &amp; residuum
## 26                   0              colluvial apron                        colluvium
## 31                   0               mountain slope                till, unspecified
## 34                   0                        ridge                         residuum
## 41                   0                 cirque floor                         residuum
## 46                   0                 cirque floor                        colluvium
##                             pmorigin
## 18 NA &amp; metasedimentary, unspecified
## 24                                NA
## 25                                NA
## 26                                NA
## 31      metasedimentary, unspecified
## 34      metasedimentary, unspecified
## 41      metasedimentary, unspecified
## 46      metasedimentary, unspecified</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="the-data-we-use.html#cb93-1"></a><span class="co">## rmHzErrors == FALSE</span></span>
<span id="cb93-2"><a href="the-data-we-use.html#cb93-2"></a><span class="kw">length</span>(mt663err)</span></code></pre></div>
<pre><code>## [1] 115</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="the-data-we-use.html#cb95-1"></a><span class="kw">site</span>(mt663err)<span class="op">$</span>ochric.epipedon</span></code></pre></div>
<pre><code>##   [1]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
##  [16] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
##  [31]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
##  [46]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE
##  [61]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [76]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
##  [91]  TRUE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE
## [106] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="the-data-we-use.html#cb97-1"></a><span class="kw">sum</span>(<span class="kw">site</span>(mt663err)<span class="op">$</span>ochric.epipedon)</span></code></pre></div>
<pre><code>## [1] 61</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="the-data-we-use.html#cb99-1"></a><span class="kw">subset</span>(<span class="kw">site</span>(mt663err), ochric.epipedon)</span></code></pre></div>
<pre><code>##     siteiid   peiid      pedon_id       site_id   obs_date utmzone utmeasting utmnorthing         x
## 1   1100702 1092608 2015MT6630502 2015MT6630502 2015-06-19      12   269662.2     5387224 -114.1242
## 2   1100703 1092609 2015MT6630503 2015MT6630503 2015-06-19      12   271991.7     5386371 -114.0921
## 4   1100705 1092611 2015MT6630506 2015MT6630506 2015-07-17      12   291297.7     5417307 -113.8463
## 5   1100706 1092612 2015MT6630507 2015MT6630507 2015-07-18      12   294229.4     5419511 -113.8075
## 6   1100707 1092613 2015MT6630508 2015MT6630508 2015-07-18      12   294287.4     5419237 -113.8066
## 7   1100708 1092614 2015MT6630509 2015MT6630509 2015-07-19      12   292852.8     5419775 -113.8264
## 9   1100710 1092616 2015MT6630511 2015MT6630511 2015-07-20      12   296781.7     5422241 -113.7741
## 20  1100738 1092627 2015MT6630522 2015MT6630522 2015-08-11      12   286499.1     5431224 -113.9190
## 21  1100739 1092628 2015MT6630523 2015MT6630523 2015-08-11      12   287430.6     5430761 -113.9060
## 22  1100740 1092629 2015MT6630524 2015MT6630524 2015-08-11      12   287518.6     5429977 -113.9044
## 23  1100741 1092630 2015MT6630525 2015MT6630525 2015-08-11      12   287592.8     5428273 -113.9025
## 25  1100743 1092632 2015MT6630527 2015MT6630527 2015-08-12      12   288133.8     5424664 -113.8932
## 26  1100744 1092633 2015MT6630528 2015MT6630528 2015-08-12      12   287808.0     5426537 -113.8987
## 27  1100745 1092634 2015MT6630529 2015MT6630529 2015-08-13      12   287813.9     5425919 -113.8982
## 28  1100747 1092636 2015MT6630531 2015MT6630531 2015-08-13      12   288297.5     5425268 -113.8913
## 31  1100750 1092639 2015MT6630534 2015MT6630534 2015-08-14      12   287699.2     5423004 -113.8983
## 32  1100751 1092640 2015MT6630535 2015MT6630535 2015-08-15      12   286934.7     5421391 -113.9079
## 33  1100718 1092641 2015MT6630536 2015MT6630536 2015-08-15      12   287150.7     5421809 -113.9052
## 36  1100722 1092645 2015MT6630540 2015MT6630540 2015-08-18      12   286501.1     5418262 -113.9122
## 37  1100723 1092646 2015MT6630541 2015MT6630541 2015-08-18      12   286946.5     5416028 -113.9049
## 39  1100725 1092648 2015MT6630543 2015MT6630543 2015-08-19      12   284943.1     5421653 -113.9352
## 40  1100726 1092649 2015MT6630544 2015MT6630544 2015-08-19      12   285061.3     5421582 -113.9335
## 41  1100727 1092650 2015MT6630545 2015MT6630545 2015-08-19      12   286095.2     5421328 -113.9193
## 46  1100755 1092665 2015MT6630556 2015MT6630556 2015-09-03      12   305081.6     5399079 -113.6499
## 48  1100757 1092667 2015MT6630500 2015MT6630500 2015-11-04      11   697420.9     5427849 -114.3023
## 52  1183389 1154995 2015MT6633506 2015MT6633506 2015-07-18      12   291612.2     5417626 -113.8422
## 54  1183391 1154997 2015MT6633508 2015MT6633508 2015-07-19      12   290065.1     5417929 -113.8634
## 55  1183393 1154999 2015MT6633510 2015MT6633510 2015-07-19      12   290527.8     5417789 -113.8571
## 57  1183395 1155001 2015MT6633512 2015MT6633512 2015-07-22      12   301596.4     5423268 -113.7089
## 59  1183397 1155003 2015MT6633514 2015MT6633514 2015-08-11      12   287067.8     5426891 -113.9089
## 60  1183398 1155004 2015MT6633515 2015MT6633515 2015-08-11      12   285109.9     5425753 -113.9350
## 61  1183399 1155005 2015MT6633516 2015MT6633516 2015-08-11      12   283923.0     5425695 -113.9512
## 63  1183402 1155008 2015MT6633519 2015MT6633519 2015-08-12      12   284528.9     5425340 -113.9428
## 64  1183404 1155010 2015MT6633521 2015MT6633521 2015-08-13      12   287119.9     5420129 -113.9047
## 65  1183405 1155011 2015MT6633522 2015MT6633522 2015-08-14      12   289926.5     5418878 -113.8658
## 66  1183406 1155012 2015MT6633523 2015MT6633523 2015-08-14      12   289637.7     5418872 -113.8697
## 67  1183407 1155013 2015MT6633524 2015MT6633524 2015-08-14      12   288379.0     5419236 -113.8871
## 68  1183408 1155014 2015MT6633525 2015MT6633525 2015-08-15      12   286815.9     5421508 -113.9096
## 69  1183409 1155015 2015MT6633526 2015MT6633526 2015-08-15      12   287165.8     5420915 -113.9045
## 70  1183410 1155016 2015MT6633527 2015MT6633527 2015-08-15      12   287189.5     5420235 -113.9038
## 71  1183411 1155017 2015MT6633528 2015MT6633528 2015-08-15      12   286878.0     5419574 -113.9077
## 72  1183412 1155018 2015MT6633529 2015MT6633529 2015-08-16      12   288676.1     5415611 -113.8812
## 73  1183413 1155019 2015MT6633530 2015MT6633530 2015-08-16      12   289240.8     5416496 -113.8739
## 74  1183414 1155020 2015MT6633531 2015MT6633531 2015-08-17      12   286901.6     5419901 -113.9076
## 75  1183415 1155021 2015MT6633532 2015MT6633532 2015-08-18      12   286530.7     5418357 -113.9118
## 76  1183416 1155022 2015MT6633533 2015MT6633533 2015-08-18      12   286580.7     5418032 -113.9109
## 77  1183417 1155023 2015MT6633534 2015MT6633534 2015-08-18      12   286556.9     5416655 -113.9106
## 78  1183418 1155024 2015MT6633535 2015MT6633535 2015-08-18      12   286575.6     5417278 -113.9106
## 79  1183419 1155025 2015MT6633536 2015MT6633536 2015-08-19      12   285324.0     5421424 -113.9298
## 80  1183421 1155027 2015MT6633538 2015MT6633538 2015-08-19      12   285935.6     5421376 -113.9215
## 81  1183422 1155028 2015MT6633539 2015MT6633539 2015-08-19      12   286105.8     5421172 -113.9191
## 82  1183423 1155029 2015MT6633540 2015MT6633540 2015-09-02      12   305303.3     5426957 -113.6601
## 83  1183424 1155030 2015MT6633541 2015MT6633541 2015-09-02      12   305458.0     5427338 -113.6582
## 84  1183425 1155031 2015MT6633542 2015MT6633542 2015-09-02      12   305537.0     5428074 -113.6575
## 91  1191592 1161198 2015MT6635255 2015MT6635255 2015-07-20      12   297939.2     5423022 -113.7587
## 93  1191594 1161200 2015MT6635257 2015MT6635257 2015-07-21      12   299984.8     5423257 -113.7309
## 95  1191596 1161202 2015MT6635259 2015MT6635259 2015-07-22      12   301567.2     5423596 -113.7095
## 100 1191601 1161207 2015MT6635264 2015MT6635264 2015-08-11      12   288420.6     5426478 -113.8903
## 102 1191603 1161209 2015MT6635266 2015MT6635266 2015-09-01      12   328171.5     5372499 -113.3253
## 109 1191610 1161216 2015MT6635273 2015MT6635273 2015-09-23      12   300260.3     5396456 -113.7141
## 115 1191616 1161222 2015MT6635279 2015MT6635279 2015-09-24      12   301042.5     5398455 -113.7045
##            y horizdatnm     x_std    y_std gpspositionalerror
## 1   48.59568      WGS84 -114.1241 48.59568                 NA
## 2   48.58887      WGS84 -114.0921 48.58888                 NA
## 4   48.87357      WGS84 -113.8463 48.87357                 NA
## 5   48.89434      WGS84 -113.8075 48.89435                 NA
## 6   48.89191      WGS84 -113.8066 48.89191                 NA
## 7   48.89626      WGS84 -113.8264 48.89626                 NA
## 9   48.91971      WGS84 -113.7741 48.91971                 NA
## 20  48.99696      WGS84 -113.9190 48.99696                 NA
## 21  48.99312      WGS84 -113.9060 48.99312                 NA
## 22  48.98611      WGS84 -113.9044 48.98611                 NA
## 23  48.97083      WGS84 -113.9025 48.97083                 NA
## 25  48.93859      WGS84 -113.8932 48.93859                 NA
## 26  48.95530      WGS84 -113.8987 48.95530                 NA
## 27  48.94975      WGS84 -113.8982 48.94975                 NA
## 28  48.94408      WGS84 -113.8913 48.94407                 NA
## 31  48.92352      WGS84 -113.8983 48.92352                 NA
## 32  48.90878      WGS84 -113.9079 48.90878                 NA
## 33  48.91261      WGS84 -113.9052 48.91260                 NA
## 36  48.88051      WGS84 -113.9122 48.88051                 NA
## 37  48.86059      WGS84 -113.9049 48.86059                 NA
## 39  48.91044      WGS84 -113.9352 48.91044                 NA
## 40  48.90984      WGS84 -113.9335 48.90984                 NA
## 41  48.90792      WGS84 -113.9193 48.90791                 NA
## 46  48.71425      WGS84 -113.6499 48.71425                 NA
## 48  48.97198      WGS84 -114.3023 48.97199                 NA
## 52  48.87653      WGS84 -113.8422 48.87654                 NA
## 54  48.87874      WGS84 -113.8634 48.87874                 NA
## 55  48.87763      WGS84 -113.8571 48.87763                 NA
## 57  48.93051      WGS84 -113.7089 48.93051                 NA
## 59  48.95823      WGS84 -113.9089 48.95823                 NA
## 60  48.94733      WGS84 -113.9350 48.94733                 NA
## 61  48.94640      WGS84 -113.9512 48.94640                 NA
## 63  48.94342      WGS84 -113.9428 48.94342                 NA
## 64  48.89750      WGS84 -113.9047 48.89750                 NA
## 65  48.88721      WGS84 -113.8658 48.88721                 NA
## 66  48.88707      WGS84 -113.8697 48.88707                 NA
## 67  48.88991      WGS84 -113.8871 48.88991                 NA
## 68  48.90979      WGS84 -113.9096 48.90978                 NA
## 69  48.90457      WGS84 -113.9045 48.90457                 NA
## 70  48.89847      WGS84 -113.9038 48.89848                 NA
## 71  48.89243      WGS84 -113.9077 48.89243                 NA
## 72  48.85744      WGS84 -113.8812 48.85744                 NA
## 73  48.86558      WGS84 -113.8739 48.86558                 NA
## 74  48.89537      WGS84 -113.9076 48.89537                 NA
## 75  48.88138      WGS84 -113.9118 48.88138                 NA
## 76  48.87847      WGS84 -113.9109 48.87847                 NA
## 77  48.86609      WGS84 -113.9106 48.86609                 NA
## 78  48.87170      WGS84 -113.9106 48.87170                 NA
## 79  48.90852      WGS84 -113.9298 48.90852                 NA
## 80  48.90829      WGS84 -113.9215 48.90829                 NA
## 81  48.90652      WGS84 -113.9191 48.90652                 NA
## 82  48.96484      WGS84 -113.6601 48.96484                 NA
## 83  48.96830      WGS84 -113.6582 48.96830                 NA
## 84  48.97495      WGS84 -113.6575 48.97494                 NA
## 91  48.92711      WGS84 -113.7587 48.92711                 NA
## 93  48.92989      WGS84 -113.7309 48.92989                 NA
## 95  48.93344      WGS84 -113.7095 48.93344                 NA
## 100 48.95499      WGS84 -113.8903 48.95499                 NA
## 102 48.48212      WGS84 -113.3253 48.48212                 NA
## 109 48.68916      WGS84 -113.7141 48.68915                 NA
## 115 48.70736      WGS84 -113.7045 48.70737                 NA
##                                                  describer          pedonpurpose
## 1                                 Jay Skovlin, Joe Capella soil survey inventory
## 2                                 Jay Skovlin, Joe Capella soil survey inventory
## 4                         Jay Skovlin, Stephanie Shoemaker soil survey inventory
## 5                                 Jay Skovlin, Joe Capella soil survey inventory
## 6                                 Jay Skovlin, Joe Capella soil survey inventory
## 7                             Jay Skovlin, Carmel Johnston soil survey inventory
## 9                                 Jay Skovlin, Joe Capella soil survey inventory
## 20                            Jay Skovlin, Carmel Johnston soil survey inventory
## 21                            Jay Skovlin, Carmel Johnston soil survey inventory
## 22                            Jay Skovlin, Carmel Johnston soil survey inventory
## 23                            Jay Skovlin, Carmel Johnston soil survey inventory
## 25                                Jay Skovlin, Joe Capella soil survey inventory
## 26                                Jay Skovlin, Joe Capella soil survey inventory
## 27                                Jay Skovlin, Joe Capella soil survey inventory
## 28                                Jay Skovlin, Joe Capella soil survey inventory
## 31                            Jay Skovlin, Carmel Johnston soil survey inventory
## 32  Jay Skovlin, Beth Rowley, Carmel Johnston, Joe Capella soil survey inventory
## 33                            Jay Skovlin, Carmel Johnston soil survey inventory
## 36                            Jay Skovlin, Carmel Johnston soil survey inventory
## 37                            Jay Skovlin, Carmel Johnston soil survey inventory
## 39                                Jay Skovlin, Joe Capella soil survey inventory
## 40                                Jay Skovlin, Joe Capella soil survey inventory
## 41                                Jay Skovlin, Joe Capella soil survey inventory
## 46                                Jay Skovlin, Beth Rowley soil survey inventory
## 48                                             Jay Skovlin soil survey inventory
## 52                            Carmel Johnston, Beth Rowley soil survey inventory
## 54                            Carmel Johnston, Beth Rowley soil survey inventory
## 55                            Beth Rowley, Carmel Johnston soil survey inventory
## 57                                             Beth Rowley soil survey inventory
## 59                                             Beth Rowley soil survey inventory
## 60                                               B. Rowley soil survey inventory
## 61                                               B. Rowley soil survey inventory
## 63                            Beth Rowley, Carmel Johnston soil survey inventory
## 64                            Beth Rowley, Carmel Johnston soil survey inventory
## 65                                Joe Capella, Beth Rowley soil survey inventory
## 66                                Joe Capella, Beth Rowley soil survey inventory
## 67                                Joe Capella, Beth Rowley soil survey inventory
## 68  Jay Skovlin, Beth Rowley, Carmel Johnston, Joe Capella soil survey inventory
## 69                                Joe Capella, Beth Rowley soil survey inventory
## 70                                Joe Capella, Beth Rowley soil survey inventory
## 71                                Joe Capella, Beth Rowley soil survey inventory
## 72                                Jay Skovlin, Beth Rowley soil survey inventory
## 73                                Jay Skovlin, Beth Rowley soil survey inventory
## 74                            Beth Rowley, Carmel Johnston soil survey inventory
## 75                                Joe Capella, Beth Rowley soil survey inventory
## 76  Beth Rowley, Joe Capella, Jay Skovlin, Carmel Johnston soil survey inventory
## 77                                             Beth Rowley soil survey inventory
## 78                                Beth Rowley, Joe Capella soil survey inventory
## 79                            Beth Rowley, Carmel Johnston soil survey inventory
## 80                            Carmel Johnston, Beth Rowley soil survey inventory
## 81                            Beth Rowley, Carmel Johnston soil survey inventory
## 82                              Pat O&#39;Connell, Beth Rowley soil survey inventory
## 83                              Beth Rowley, Pat O&#39;Connell soil survey inventory
## 84                              Pat O&#39;Connell, Beth Rowley soil survey inventory
## 91                      Patrick O&#39;Connell, Carmel Johnston soil survey inventory
## 93                          Patrick O&#39;Connell, Beth Rowley soil survey inventory
## 95                          Patrick O&#39;Connell, Joe Capella soil survey inventory
## 100                         Patrick O&#39;Connell, Joe Capella soil survey inventory
## 102                         Beth Rowley, Patrick O&#39;Connell soil survey inventory
## 109    Patrick O&#39;Connell, Jay Skovlin, Stephanie Shoemaker soil survey inventory
## 115    Jay Skovlin, Patrick O&#39;Connell, Stephanie Shoemaker soil survey inventory
##                 pedontype pedlabsampnum labdatadescflag tsectstopnum tsectinterval utransectid
## 1   undefined observation            NA               0           NA            NA          NA
## 2   undefined observation            NA               0           NA            NA          NA
## 4   undefined observation            NA               0           NA            NA          NA
## 5   undefined observation            NA               0           NA            NA          NA
## 6   undefined observation            NA               0           NA            NA          NA
## 7   undefined observation            NA               0           NA            NA          NA
## 9   undefined observation            NA               0           NA            NA          NA
## 20  undefined observation            NA               0           NA            NA          NA
## 21  undefined observation            NA               0           NA            NA          NA
## 22  undefined observation            NA               0           NA            NA          NA
## 23  undefined observation            NA               0           NA            NA          NA
## 25  undefined observation            NA               0           NA            NA          NA
## 26  undefined observation            NA               0           NA            NA          NA
## 27  undefined observation            NA               0           NA            NA          NA
## 28  undefined observation            NA               0           NA            NA          NA
## 31  undefined observation            NA               0           NA            NA          NA
## 32  undefined observation            NA               0           NA            NA          NA
## 33  undefined observation            NA               0           NA            NA          NA
## 36  undefined observation            NA               0           NA            NA          NA
## 37  undefined observation            NA               0           NA            NA          NA
## 39  undefined observation            NA               0           NA            NA          NA
## 40  undefined observation            NA               0           NA            NA          NA
## 41  undefined observation            NA               0           NA            NA          NA
## 46  undefined observation            NA               0           NA            NA          NA
## 48  undefined observation            NA               0           NA            NA          NA
## 52  undefined observation            NA               0           NA            NA          NA
## 54  undefined observation            NA               0           NA            NA          NA
## 55  undefined observation            NA               0           NA            NA          NA
## 57              OSD pedon            NA               0           NA            NA          NA
## 59  undefined observation            NA               0           NA            NA          NA
## 60  undefined observation            NA               0           NA            NA          NA
## 61  undefined observation            NA               0           NA            NA          NA
## 63  undefined observation            NA               0           NA            NA          NA
## 64  undefined observation            NA               0           NA            NA          NA
## 65  undefined observation            NA               0           NA            NA          NA
## 66  undefined observation            NA               0           NA            NA          NA
## 67  undefined observation            NA               0           NA            NA          NA
## 68  undefined observation            NA               0           NA            NA          NA
## 69  undefined observation            NA               0           NA            NA          NA
## 70  undefined observation            NA               0           NA            NA          NA
## 71  undefined observation            NA               0           NA            NA          NA
## 72  undefined observation            NA               0           NA            NA          NA
## 73  undefined observation            NA               0           NA            NA          NA
## 74  undefined observation            NA               0           NA            NA          NA
## 75  undefined observation            NA               0           NA            NA          NA
## 76  undefined observation            NA               0           NA            NA          NA
## 77  undefined observation            NA               0           NA            NA          NA
## 78  undefined observation            NA               0           NA            NA          NA
## 79  undefined observation            NA               0           NA            NA          NA
## 80  undefined observation            NA               0           NA            NA          NA
## 81  undefined observation            NA               0           NA            NA          NA
## 82  undefined observation            NA               0           NA            NA          NA
## 83  undefined observation            NA               0           NA            NA          NA
## 84  undefined observation            NA               0           NA            NA          NA
## 91  undefined observation            NA               0           NA            NA          NA
## 93  undefined observation            NA               0           NA            NA          NA
## 95  undefined observation            NA               0           NA            NA          NA
## 100 undefined observation            NA               0           NA            NA          NA
## 102 undefined observation            NA               0           NA            NA          NA
## 109 undefined observation            NA               0           NA            NA          NA
## 115 undefined observation            NA               0           NA            NA          NA
##     tsectkind tsectselmeth elev_field slope_field aspect_field   plantassocnm earthcovkind1
## 1        &lt;NA&gt;         &lt;NA&gt;       1859          55          330      ABLA/MEFE          &lt;NA&gt;
## 2        &lt;NA&gt;         &lt;NA&gt;       1670          58          155           &lt;NA&gt;          &lt;NA&gt;
## 4        &lt;NA&gt;         &lt;NA&gt;       1828          16          300           &lt;NA&gt;          &lt;NA&gt;
## 5        &lt;NA&gt;         &lt;NA&gt;       1495           8          100           &lt;NA&gt;          &lt;NA&gt;
## 6        &lt;NA&gt;         &lt;NA&gt;       1490           5          140           &lt;NA&gt;          &lt;NA&gt;
## 7        &lt;NA&gt;         &lt;NA&gt;       1636          20           20           &lt;NA&gt;          &lt;NA&gt;
## 9        &lt;NA&gt;         &lt;NA&gt;       1495           4           80           &lt;NA&gt;          &lt;NA&gt;
## 20       &lt;NA&gt;         &lt;NA&gt;       1372          34           12           &lt;NA&gt;          &lt;NA&gt;
## 21       &lt;NA&gt;         &lt;NA&gt;       1288           2          110           &lt;NA&gt;          &lt;NA&gt;
## 22       &lt;NA&gt;         &lt;NA&gt;       1299          30          240           &lt;NA&gt;          &lt;NA&gt;
## 23       &lt;NA&gt;         &lt;NA&gt;       1294          15          110           &lt;NA&gt;          &lt;NA&gt;
## 25       &lt;NA&gt;         &lt;NA&gt;       1373          15          260           &lt;NA&gt;          &lt;NA&gt;
## 26       &lt;NA&gt;         &lt;NA&gt;       1273           3          335           &lt;NA&gt;          &lt;NA&gt;
## 27       &lt;NA&gt;         &lt;NA&gt;       1311          40          240           &lt;NA&gt;          &lt;NA&gt;
## 28       &lt;NA&gt;         &lt;NA&gt;       1334           3          205           &lt;NA&gt;          &lt;NA&gt;
## 31       &lt;NA&gt;         &lt;NA&gt;       1358           5          280           &lt;NA&gt;          &lt;NA&gt;
## 32       &lt;NA&gt;         &lt;NA&gt;       1358          16          245           &lt;NA&gt;          &lt;NA&gt;
## 33       &lt;NA&gt;         &lt;NA&gt;       1357          35          135           &lt;NA&gt;          &lt;NA&gt;
## 36       &lt;NA&gt;         &lt;NA&gt;       1423          20          160           &lt;NA&gt;          &lt;NA&gt;
## 37       &lt;NA&gt;         &lt;NA&gt;       1592          43          255           &lt;NA&gt;          &lt;NA&gt;
## 39       &lt;NA&gt;         &lt;NA&gt;       1666          48          167           &lt;NA&gt;          &lt;NA&gt;
## 40       &lt;NA&gt;         &lt;NA&gt;       1570          36          182           &lt;NA&gt;          &lt;NA&gt;
## 41       &lt;NA&gt;         &lt;NA&gt;       1352           1           78           &lt;NA&gt;          &lt;NA&gt;
## 46       &lt;NA&gt;         &lt;NA&gt;       2149          13          190           &lt;NA&gt;          &lt;NA&gt;
## 48       &lt;NA&gt;         &lt;NA&gt;       1272          22          121 PSME/SYAL-CARU    tree cover
## 52       &lt;NA&gt;         &lt;NA&gt;       1765           5           30           &lt;NA&gt;          &lt;NA&gt;
## 54       &lt;NA&gt;         &lt;NA&gt;       1884          NA           NA           &lt;NA&gt;          &lt;NA&gt;
## 55       &lt;NA&gt;         &lt;NA&gt;       1989          40          200           &lt;NA&gt;          &lt;NA&gt;
## 57       &lt;NA&gt;         &lt;NA&gt;       1458           5           NA           &lt;NA&gt;          &lt;NA&gt;
## 59       &lt;NA&gt;         &lt;NA&gt;       1328           5           NA           &lt;NA&gt;          &lt;NA&gt;
## 60       &lt;NA&gt;         &lt;NA&gt;       1531          36          140           &lt;NA&gt;          &lt;NA&gt;
## 61       &lt;NA&gt;         &lt;NA&gt;       1600          24          120           &lt;NA&gt;          &lt;NA&gt;
## 63       &lt;NA&gt;         &lt;NA&gt;       1517           3           NA           &lt;NA&gt;          &lt;NA&gt;
## 64       &lt;NA&gt;         &lt;NA&gt;       1486           7          275           &lt;NA&gt;          &lt;NA&gt;
## 65       &lt;NA&gt;         &lt;NA&gt;       1657          11          210           &lt;NA&gt;          &lt;NA&gt;
## 66       &lt;NA&gt;         &lt;NA&gt;       1844          56          300           &lt;NA&gt;          &lt;NA&gt;
## 67       &lt;NA&gt;         &lt;NA&gt;       1818           6          312           &lt;NA&gt;          &lt;NA&gt;
## 68       &lt;NA&gt;         &lt;NA&gt;       1333           1           NA           &lt;NA&gt;          &lt;NA&gt;
## 69       &lt;NA&gt;         &lt;NA&gt;       1357          27          227           &lt;NA&gt;          &lt;NA&gt;
## 70       &lt;NA&gt;         &lt;NA&gt;       1396           5          280           &lt;NA&gt;          &lt;NA&gt;
## 71       &lt;NA&gt;         &lt;NA&gt;       1368          26          260           &lt;NA&gt;          &lt;NA&gt;
## 72       &lt;NA&gt;         &lt;NA&gt;       2086          13          160           &lt;NA&gt;          &lt;NA&gt;
## 73       &lt;NA&gt;         &lt;NA&gt;       2120          55          200           &lt;NA&gt;          &lt;NA&gt;
## 74       &lt;NA&gt;         &lt;NA&gt;       1435           3           NA           &lt;NA&gt;          &lt;NA&gt;
## 75       &lt;NA&gt;         &lt;NA&gt;       1398           1           NA           &lt;NA&gt;          &lt;NA&gt;
## 76       &lt;NA&gt;         &lt;NA&gt;       1425          25          280           &lt;NA&gt;          &lt;NA&gt;
## 77       &lt;NA&gt;         &lt;NA&gt;       1508          42          270           &lt;NA&gt;          &lt;NA&gt;
## 78       &lt;NA&gt;         &lt;NA&gt;       1446           8          240           &lt;NA&gt;          &lt;NA&gt;
## 79       &lt;NA&gt;         &lt;NA&gt;       1502          70          200           &lt;NA&gt;          &lt;NA&gt;
## 80       &lt;NA&gt;         &lt;NA&gt;       1409           0           NA           &lt;NA&gt;          &lt;NA&gt;
## 81       &lt;NA&gt;         &lt;NA&gt;       1372          20          120           &lt;NA&gt;          &lt;NA&gt;
## 82       &lt;NA&gt;         &lt;NA&gt;       1760           5          240           &lt;NA&gt;          &lt;NA&gt;
## 83       &lt;NA&gt;         &lt;NA&gt;       1759          18          110           &lt;NA&gt;          &lt;NA&gt;
## 84       &lt;NA&gt;         &lt;NA&gt;       1725           2           NA           &lt;NA&gt;          &lt;NA&gt;
## 91       &lt;NA&gt;         &lt;NA&gt;          0          35          185           &lt;NA&gt;          &lt;NA&gt;
## 93       &lt;NA&gt;         &lt;NA&gt;       1485           5          186           &lt;NA&gt;          &lt;NA&gt;
## 95       &lt;NA&gt;         &lt;NA&gt;       1442          19          284           &lt;NA&gt;          &lt;NA&gt;
## 100      &lt;NA&gt;         &lt;NA&gt;       1460           3          318           &lt;NA&gt;          &lt;NA&gt;
## 102      &lt;NA&gt;         &lt;NA&gt;       2245           8          200           &lt;NA&gt;          &lt;NA&gt;
## 109      &lt;NA&gt;         &lt;NA&gt;       2027           6          290           &lt;NA&gt;          &lt;NA&gt;
## 115      &lt;NA&gt;         &lt;NA&gt;       2156          12          190           &lt;NA&gt;          &lt;NA&gt;
##     earthcovkind2 erocl bedrckdepth  bedrckkind bedrckhardness hillslopeprof geomslopeseg
## 1            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 2            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 4            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 5            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 6            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      toeslope         &lt;NA&gt;
## 7            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 9            &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      toeslope         &lt;NA&gt;
## 20           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 21           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 22           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 23           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 25           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      shoulder         &lt;NA&gt;
## 26           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 27           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 28           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 31           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 32           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 33           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 36           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      shoulder         &lt;NA&gt;
## 37           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 39           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 40           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 41           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 46           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 48           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 52           &lt;NA&gt;  &lt;NA&gt;          20   argillite      indurated      shoulder         &lt;NA&gt;
## 54           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 55           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 57           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      toeslope         &lt;NA&gt;
## 59           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 60           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 61           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 63           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 64           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 65           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 66           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 67           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 68           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 69           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 70           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 71           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 72           &lt;NA&gt;  &lt;NA&gt;          53 pillow lava           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 73           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 74           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 75           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 76           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 77           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 78           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 79           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 80           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      shoulder         &lt;NA&gt;
## 81           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 82           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      shoulder         &lt;NA&gt;
## 83           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 84           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 91           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     backslope         &lt;NA&gt;
## 93           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;          &lt;NA&gt;         &lt;NA&gt;
## 95           &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;     footslope         &lt;NA&gt;
## 100          &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      toeslope         &lt;NA&gt;
## 102          &lt;NA&gt;  &lt;NA&gt;          54   argillite      indurated      shoulder         &lt;NA&gt;
## 109          &lt;NA&gt;  &lt;NA&gt;          41   argillite      indurated      toeslope         &lt;NA&gt;
## 115          &lt;NA&gt;  &lt;NA&gt;          NA        &lt;NA&gt;           &lt;NA&gt;      toeslope         &lt;NA&gt;
##     shapeacross shapedown slopecomplex  drainagecl flodfreqcl       floddurcl flodmonthbeg
## 1        linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 2        convex    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 4        linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 5        convex    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 6        linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 7        linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 9        linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 20       convex    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 21       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 22       linear    convex         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 23       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 25       linear    convex         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 26       linear    linear         &lt;NA&gt;        well  very rare extremely brief         &lt;NA&gt;
## 27       linear   concave         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 28       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 31       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 32       convex    linear         &lt;NA&gt; very poorly       none            &lt;NA&gt;         &lt;NA&gt;
## 33       convex    convex         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 36       convex    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 37       convex    convex         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 39       convex    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 40      concave    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 41       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 46       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 48       linear    linear         &lt;NA&gt;        well       none            &lt;NA&gt;         &lt;NA&gt;
## 52       linear    convex         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 54       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 55       convex    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 57       convex    linear         &lt;NA&gt;      poorly       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 59       linear    convex         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 60       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 61       convex    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 63       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 64       convex    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 65       convex    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 66       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 67       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 68       linear    linear         &lt;NA&gt; very poorly       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 69       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 70       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 71      concave    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 72       linear   concave         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 73       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 74       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 75       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 76       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 77       convex    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 78       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 79       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 80       convex    convex         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 81       convex    convex         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 82       linear    convex         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 83       linear    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 84       linear    linear         &lt;NA&gt; very poorly       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 91       linear   concave         &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 93       linear    linear         &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 95      concave    linear         &lt;NA&gt;      poorly       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 100      convex    convex         &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 102     concave    linear         &lt;NA&gt;        well       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 109      convex    linear         &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
## 115      convex    linear         &lt;NA&gt; very poorly       &lt;NA&gt;            &lt;NA&gt;         &lt;NA&gt;
##     pondfreqcl ponddurcl pondmonthbeg geomposhill                geomposmntn geomposflats
## 1         none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 2         none      &lt;NA&gt;         &lt;NA&gt;  nose slope                       &lt;NA&gt;         &lt;NA&gt;
## 4         none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 5         none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 6         none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 7         none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 9         none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 20        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 21        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 22        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 23        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 25        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 26        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 27        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 28        none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 31        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 32        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 33        none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 36        none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 37        none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 39        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 40        none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 41        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 46        none      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 48        none      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 52        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 54        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 55        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 57        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  nose slope                       &lt;NA&gt;         &lt;NA&gt;
## 59        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 60        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 61        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  base slope                       &lt;NA&gt;         &lt;NA&gt;
## 63        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 64        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 65        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  nose slope                       &lt;NA&gt;         &lt;NA&gt;
## 66        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 67        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 68        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 69        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 70        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 71        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 72        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 73        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 74        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 75        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 76        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 77        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  nose slope                       &lt;NA&gt;         &lt;NA&gt;
## 78        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 79        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 80        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 81        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  nose slope                       &lt;NA&gt;         &lt;NA&gt;
## 82        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 83        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 84        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;        &lt;NA&gt;                       &lt;NA&gt;         &lt;NA&gt;
## 91        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope mountainflank, lower third         &lt;NA&gt;
## 93        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope                       &lt;NA&gt;         &lt;NA&gt;
## 95        &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  side slope mountainflank, lower third         &lt;NA&gt;
## 100       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  base slope                       &lt;NA&gt;         &lt;NA&gt;
## 102       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;       crest                       &lt;NA&gt;         &lt;NA&gt;
## 109       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  base slope                       &lt;NA&gt;         &lt;NA&gt;
## 115       &lt;NA&gt;      &lt;NA&gt;         &lt;NA&gt;  base slope                       &lt;NA&gt;         &lt;NA&gt;
##     swaterdepth      slope_shape  classdate  classifier classtype taxonname localphase taxonkind
## 1            NA  linear / linear 2015-12-09         JMS     field      null         NA    series
## 2            NA  convex / linear 2015-12-09         JMS     field      null         NA    series
## 4            NA  linear / linear 2015-12-09         JMS     field      null         NA    series
## 5            NA  convex / linear 2015-12-10         JMS     field      null         NA    series
## 6            NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 7            NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 9            NA  linear / linear 2015-12-10         JMS     field      null         NA    family
## 20           NA  convex / linear 2015-12-10         JMS     field      null         NA    series
## 21           NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 22           NA  linear / convex 2015-12-10         JMS     field      null         NA    series
## 23           NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 25           NA  linear / convex 2015-12-10         JMS     field      null         NA    series
## 26           NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 27           NA linear / concave 2015-12-10         JMS     field      null         NA    series
## 28           NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 31           NA  linear / linear 2015-12-10         JMS     field      null         NA    series
## 32           NA  convex / linear 2015-12-10         JMS     field      null         NA    series
## 33           NA  convex / convex 2015-12-11         JMS     field      null         NA    series
## 36           NA  convex / linear 2015-12-11         JMS     field      null         NA    series
## 37           NA  convex / convex 2015-12-11         JMS     field      null         NA    series
## 39           NA  convex / linear 2015-12-11         JMS     field      null         NA    series
## 40           NA concave / linear 2015-12-11         JMS     field      null         NA    series
## 41           NA  linear / linear 2015-12-11         JMS     field      null         NA    series
## 46           NA  linear / linear 2015-12-11         JMS     field      null         NA    series
## 48           NA  linear / linear 2015-12-08 Jay Skovlin     field      null         NA    series
## 52           NA  linear / convex 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 54           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 55           NA  convex / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 57           NA  convex / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 59           NA  linear / convex 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 60           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 61           NA  convex / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 63           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 64           NA  convex / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 65           NA  convex / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 66           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 67           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 68           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 69           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 70           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 71           NA concave / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 72           NA linear / concave 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 73           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 74           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 75           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 76           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 77           NA  convex / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 78           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 79           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 80           NA  convex / convex 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 81           NA  convex / convex 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 82           NA  linear / convex 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 83           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 84           NA  linear / linear 2015-11-06        &lt;NA&gt;     field   unnamed         NA    family
## 91           NA linear / concave 2015-11-04        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
## 93           NA  linear / linear 2015-11-03        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
## 95           NA concave / linear 2015-11-04        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
## 100          NA  convex / convex 2015-11-05        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
## 102          NA concave / linear 2015-11-05        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
## 109          NA  convex / linear 2015-11-05        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
## 115          NA  convex / linear 2015-11-06        &lt;NA&gt;      &lt;NA&gt;      null         NA    family
##     seriesstatus                                 taxpartsize    taxorder taxsuborder   taxgrtgroup
## 1           &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 2           &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 4           &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 5           &lt;NA&gt; loamy-skeletal over sandy or sandy-skeletal inceptisols     cryepts  haplocryepts
## 6           &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 7           &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 9           &lt;NA&gt;                              loamy-skeletal    entisols    fluvents  cryofluvents
## 20          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 21          &lt;NA&gt; loamy-skeletal over sandy or sandy-skeletal inceptisols     cryepts  haplocryepts
## 22          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 23          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 25          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 26          &lt;NA&gt;   coarse-loamy over sandy or sandy-skeletal    entisols    fluvents  cryofluvents
## 27          &lt;NA&gt; loamy-skeletal over sandy or sandy-skeletal inceptisols     cryepts  haplocryepts
## 28          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 31          &lt;NA&gt;                              sandy-skeletal inceptisols     cryepts  haplocryepts
## 32          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs  haplocryalfs
## 33          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 36          &lt;NA&gt;           ashy-skeletal over loamy-skeletal inceptisols     cryepts  haplocryepts
## 37          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 39          &lt;NA&gt;                              loamy-skeletal   mollisols     cryolls  haplocryolls
## 40          &lt;NA&gt;           ashy-skeletal over loamy-skeletal inceptisols     cryepts  haplocryepts
## 41          &lt;NA&gt;                                        ashy    andisols     cryands  haplocryands
## 46          &lt;NA&gt;                              loamy-skeletal    andisols     cryands  haplocryands
## 48          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs  haplocryalfs
## 52          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 54          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 55          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 57          &lt;NA&gt;                                  fine-loamy    alfisols     cryalfs  haplocryalfs
## 59          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts dystrocryepts
## 60          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 61          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 63          &lt;NA&gt;                             ashy over loamy   spodosols      cryods   haplocryods
## 64          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs  glossaqualfs
## 65          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 66          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 67          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs  haplocryalfs
## 68          &lt;NA&gt;                                  fine-loamy    alfisols     aqualfs    cryaqualfs
## 69          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 70          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 71          &lt;NA&gt;           ashy-skeletal over loamy-skeletal inceptisols     cryepts  haplocryepts
## 72          &lt;NA&gt;           ashy-skeletal over loamy-skeletal inceptisols     cryepts  haplocryepts
## 73          &lt;NA&gt;                              sandy-skeletal    entisols    orthents   cryorthents
## 74          &lt;NA&gt;  ashy-skeletal over sandy or sandy-skeletal   spodosols      cryods   haplocryods
## 75          &lt;NA&gt;                                  fine-loamy    alfisols     cryalfs  haplocryalfs
## 76          &lt;NA&gt;           ashy-skeletal over loamy-skeletal   spodosols      cryods   haplocryods
## 77          &lt;NA&gt;           ashy-skeletal over loamy-skeletal   spodosols      cryods   haplocryods
## 78          &lt;NA&gt;                    ashy over loamy-skeletal inceptisols     cryepts  haplocryepts
## 79          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 80          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs  haplocryalfs
## 81          &lt;NA&gt; loamy-skeletal over sandy or sandy-skeletal    alfisols     cryalfs  haplocryalfs
## 82          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs glossocryalfs
## 83          &lt;NA&gt;                              loamy-skeletal    alfisols     cryalfs glossocryalfs
## 84          &lt;NA&gt;                                        fine   vertisols     aquerts    epiaquerts
## 91          &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 93          &lt;NA&gt;                              loamy-skeletal   mollisols     cryolls  haplocryolls
## 95          &lt;NA&gt;                                        fine    alfisols     cryalfs  haplocryalfs
## 100         &lt;NA&gt;                              sandy-skeletal inceptisols     cryepts  haplocryepts
## 102         &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 109         &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
## 115         &lt;NA&gt;                              loamy-skeletal inceptisols     cryepts  haplocryepts
##                  taxsubgrp   soiltaxedition osdtypelocflag taxmoistcl taxtempregime taxfamother
## 1       typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 2       typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 4       typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 5       andic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 6       typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 7       andic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 9       typic cryofluvents eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 20      typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 21      typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 22      andic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 23      typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 25     andic dystrocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 26      typic cryofluvents eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 27      typic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 28     andic dystrocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 31      andic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 32      andic haplocryalfs eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 33     andic dystrocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 36      andic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 37     andic dystrocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 39     lithic haplocryolls eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 40      andic haplocryepts eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 41     spodic haplocryands eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 46     spodic haplocryands eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 48      typic haplocryalfs eleventh edition              0       &lt;NA&gt;         cryic        &lt;NA&gt;
## 52    lithic dystrocryepts             &lt;NA&gt;              0       udic         cryic     shallow
## 54     andic dystrocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 55     calcic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 57   oxyaquic haplocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 59     andic dystrocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 60      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 61      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 63       andic haplocryods             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 64     andic glossocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 65      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 66      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 67   inceptic haplocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 68        typic cryaqualfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 69      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 70  fluventic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 71      andic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 72      andic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 73       typic cryorthents             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 74       andic haplocryods             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 75      andic haplocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 76       andic haplocryods             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 77       andic haplocryods             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 78      andic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 79      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 80      andic haplocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 81      typic haplocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 82     typic glossocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 83     typic glossocryalfs             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 84      chromic epiaquerts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 91      typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 93      typic haplocryolls             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 95     eutric haplocryalfs             &lt;NA&gt;              0       udic          &lt;NA&gt;        &lt;NA&gt;
## 100     typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 102     typic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 109    lithic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
## 115     aquic haplocryepts             &lt;NA&gt;              0       udic         cryic        &lt;NA&gt;
##     psctopdepth pscbotdepth selection_method ochric.epipedon cambic.horizon lithic.contact
## 1            30         105    single record            TRUE           TRUE          FALSE
## 2            27          84    single record            TRUE           TRUE           TRUE
## 4            30          68    single record            TRUE           TRUE           TRUE
## 5            29         104    single record            TRUE           TRUE          FALSE
## 6            27         102    single record            TRUE           TRUE          FALSE
## 7            29         104    single record            TRUE           TRUE          FALSE
## 9            29         104    single record            TRUE          FALSE          FALSE
## 20           33         108    single record            TRUE           TRUE          FALSE
## 21           37         112    single record            TRUE           TRUE          FALSE
## 22           35         110    single record            TRUE           TRUE          FALSE
## 23           31         106    single record            TRUE           TRUE          FALSE
## 25           28          71    single record            TRUE           TRUE           TRUE
## 26           28         103    single record            TRUE          FALSE          FALSE
## 27           29          74    single record            TRUE           TRUE           TRUE
## 28           29         104    single record            TRUE           TRUE          FALSE
## 31           29         104    single record            TRUE           TRUE          FALSE
## 32           48          75    single record            TRUE           TRUE          FALSE
## 33           48          98    single record            TRUE           TRUE          FALSE
## 36           30         105    single record            TRUE           TRUE          FALSE
## 37           32         107    single record            TRUE          FALSE          FALSE
## 39            1          36    single record            TRUE           TRUE           TRUE
## 40           34         109    single record            TRUE           TRUE          FALSE
## 41           30         105    single record            TRUE           TRUE          FALSE
## 46           28         103    single record            TRUE           TRUE          FALSE
## 48           51          98    single record            TRUE          FALSE          FALSE
## 52            1          20    single record            TRUE           TRUE           TRUE
## 54           25         100    single record            TRUE          FALSE          FALSE
## 55           25         100    single record            TRUE          FALSE          FALSE
## 57           16         100    single record            TRUE          FALSE          FALSE
## 59           25         100    single record            TRUE          FALSE          FALSE
## 60           25         100    single record            TRUE           TRUE          FALSE
## 61           25         100    single record            TRUE           TRUE          FALSE
## 63           25         100    single record            TRUE          FALSE          FALSE
## 64           30         100    single record            TRUE           TRUE          FALSE
## 65           25         100    single record            TRUE           TRUE          FALSE
## 66           25         100    single record            TRUE           TRUE          FALSE
## 67           19         100    single record            TRUE           TRUE          FALSE
## 68           17         100    single record            TRUE          FALSE          FALSE
## 69           25         100    single record            TRUE           TRUE          FALSE
## 70           25         100    single record            TRUE           TRUE          FALSE
## 71           25         100    single record            TRUE           TRUE          FALSE
## 72           25          53    single record            TRUE           TRUE           TRUE
## 73           25         100    single record            TRUE          FALSE          FALSE
## 74           25         100    single record            TRUE          FALSE          FALSE
## 75           47         100    single record            TRUE           TRUE          FALSE
## 76           25         100    single record            TRUE          FALSE          FALSE
## 77           NA          NA    single record            TRUE          FALSE          FALSE
## 78           25         100    single record            TRUE           TRUE          FALSE
## 79           25         100    single record            TRUE           TRUE          FALSE
## 80           32         100    single record            TRUE           TRUE          FALSE
## 81           45         100    single record            TRUE           TRUE          FALSE
## 82           11         100    single record            TRUE          FALSE          FALSE
## 83           21         100    single record            TRUE          FALSE          FALSE
## 84           25         100    single record            TRUE          FALSE          FALSE
## 91           25         100    single record            TRUE           TRUE          FALSE
## 93            6          56    single record            TRUE          FALSE          FALSE
## 95            9          59    single record            TRUE           TRUE          FALSE
## 100          25         100    single record            TRUE          FALSE          FALSE
## 102          25          54    single record            TRUE           TRUE           TRUE
## 109          25          41    single record            TRUE           TRUE           TRUE
## 115          25         100    single record            TRUE          FALSE          FALSE
##     mollic.epipedon argillic.horizon redox.concentrations andic.soil.properties
## 1             FALSE            FALSE                FALSE                 FALSE
## 2             FALSE            FALSE                FALSE                 FALSE
## 4             FALSE            FALSE                FALSE                  TRUE
## 5             FALSE            FALSE                FALSE                  TRUE
## 6             FALSE            FALSE                FALSE                 FALSE
## 7             FALSE            FALSE                FALSE                  TRUE
## 9             FALSE            FALSE                FALSE                 FALSE
## 20            FALSE            FALSE                FALSE                  TRUE
## 21            FALSE            FALSE                FALSE                 FALSE
## 22            FALSE            FALSE                FALSE                 FALSE
## 23            FALSE            FALSE                FALSE                 FALSE
## 25            FALSE            FALSE                FALSE                  TRUE
## 26            FALSE            FALSE                FALSE                 FALSE
## 27            FALSE            FALSE                FALSE                 FALSE
## 28            FALSE            FALSE                FALSE                  TRUE
## 31            FALSE            FALSE                FALSE                  TRUE
## 32            FALSE             TRUE                FALSE                  TRUE
## 33            FALSE             TRUE                FALSE                  TRUE
## 36            FALSE            FALSE                FALSE                  TRUE
## 37            FALSE            FALSE                FALSE                  TRUE
## 39            FALSE            FALSE                FALSE                 FALSE
## 40            FALSE            FALSE                FALSE                  TRUE
## 41            FALSE             TRUE                FALSE                  TRUE
## 46            FALSE            FALSE                FALSE                  TRUE
## 48            FALSE             TRUE                FALSE                 FALSE
## 52            FALSE            FALSE                FALSE                 FALSE
## 54            FALSE            FALSE                FALSE                  TRUE
## 55            FALSE            FALSE                FALSE                 FALSE
## 57            FALSE             TRUE                FALSE                 FALSE
## 59            FALSE            FALSE                FALSE                  TRUE
## 60            FALSE            FALSE                FALSE                 FALSE
## 61            FALSE            FALSE                FALSE                 FALSE
## 63            FALSE            FALSE                FALSE                  TRUE
## 64            FALSE             TRUE                FALSE                 FALSE
## 65            FALSE            FALSE                FALSE                 FALSE
## 66            FALSE            FALSE                FALSE                 FALSE
## 67            FALSE             TRUE                FALSE                  TRUE
## 68            FALSE             TRUE                FALSE                 FALSE
## 69            FALSE            FALSE                FALSE                  TRUE
## 70            FALSE            FALSE                FALSE                 FALSE
## 71            FALSE            FALSE                FALSE                  TRUE
## 72            FALSE            FALSE                FALSE                 FALSE
## 73            FALSE            FALSE                FALSE                 FALSE
## 74            FALSE            FALSE                FALSE                  TRUE
## 75            FALSE             TRUE                FALSE                 FALSE
## 76            FALSE            FALSE                FALSE                  TRUE
## 77            FALSE            FALSE                FALSE                  TRUE
## 78            FALSE            FALSE                FALSE                  TRUE
## 79            FALSE            FALSE                FALSE                 FALSE
## 80            FALSE             TRUE                FALSE                  TRUE
## 81            FALSE             TRUE                FALSE                 FALSE
## 82            FALSE             TRUE                FALSE                 FALSE
## 83            FALSE             TRUE                FALSE                 FALSE
## 84            FALSE            FALSE                FALSE                 FALSE
## 91            FALSE            FALSE                FALSE                 FALSE
## 93            FALSE             TRUE                FALSE                 FALSE
## 95            FALSE             TRUE                FALSE                 FALSE
## 100           FALSE            FALSE                FALSE                 FALSE
## 102           FALSE            FALSE                FALSE                 FALSE
## 109           FALSE            FALSE                FALSE                 FALSE
## 115           FALSE            FALSE                FALSE                 FALSE
##     secondary.carbonates aquic.conditions sapric.soil.materials reduced.matrix albic.horizon
## 1                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 2                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 4                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 5                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 6                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 7                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 9                  FALSE            FALSE                 FALSE          FALSE         FALSE
## 20                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 21                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 22                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 23                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 25                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 26                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 27                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 28                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 31                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 32                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 33                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 36                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 37                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 39                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 40                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 41                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 46                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 48                  TRUE            FALSE                 FALSE          FALSE         FALSE
## 52                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 54                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 55                  TRUE            FALSE                 FALSE          FALSE         FALSE
## 57                 FALSE            FALSE                 FALSE           TRUE         FALSE
## 59                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 60                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 61                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 63                 FALSE            FALSE                 FALSE          FALSE          TRUE
## 64                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 65                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 66                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 67                 FALSE            FALSE                 FALSE          FALSE          TRUE
## 68                 FALSE            FALSE                 FALSE           TRUE         FALSE
## 69                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 70                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 71                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 72                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 73                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 74                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 75                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 76                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 77                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 78                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 79                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 80                 FALSE            FALSE                 FALSE          FALSE          TRUE
## 81                 FALSE            FALSE                 FALSE          FALSE          TRUE
## 82                 FALSE            FALSE                 FALSE          FALSE          TRUE
## 83                 FALSE            FALSE                 FALSE          FALSE          TRUE
## 84                 FALSE            FALSE                 FALSE           TRUE         FALSE
## 91                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 93                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 95                 FALSE            FALSE                 FALSE          FALSE         FALSE
## 100                FALSE            FALSE                 FALSE          FALSE         FALSE
## 102                FALSE            FALSE                 FALSE          FALSE         FALSE
## 109                FALSE            FALSE                 FALSE          FALSE         FALSE
## 115                FALSE            FALSE                 FALSE          FALSE         FALSE
##     spodic.horizon glossic.horizon spodic.materials lithologic.discontinuity densic.materials
## 1            FALSE           FALSE            FALSE                    FALSE            FALSE
## 2            FALSE           FALSE            FALSE                    FALSE            FALSE
## 4            FALSE           FALSE            FALSE                    FALSE            FALSE
## 5            FALSE           FALSE            FALSE                    FALSE            FALSE
## 6            FALSE           FALSE            FALSE                    FALSE            FALSE
## 7            FALSE           FALSE            FALSE                    FALSE            FALSE
## 9            FALSE           FALSE            FALSE                    FALSE            FALSE
## 20           FALSE           FALSE            FALSE                    FALSE            FALSE
## 21           FALSE           FALSE            FALSE                    FALSE            FALSE
## 22           FALSE           FALSE            FALSE                    FALSE            FALSE
## 23           FALSE           FALSE            FALSE                    FALSE            FALSE
## 25           FALSE           FALSE            FALSE                    FALSE            FALSE
## 26           FALSE           FALSE            FALSE                    FALSE            FALSE
## 27           FALSE           FALSE            FALSE                    FALSE            FALSE
## 28           FALSE           FALSE            FALSE                    FALSE            FALSE
## 31           FALSE           FALSE            FALSE                    FALSE            FALSE
## 32           FALSE           FALSE            FALSE                    FALSE            FALSE
## 33           FALSE           FALSE            FALSE                    FALSE            FALSE
## 36           FALSE           FALSE            FALSE                    FALSE            FALSE
## 37           FALSE           FALSE            FALSE                    FALSE            FALSE
## 39           FALSE           FALSE            FALSE                    FALSE            FALSE
## 40           FALSE           FALSE            FALSE                    FALSE            FALSE
## 41           FALSE           FALSE            FALSE                    FALSE            FALSE
## 46           FALSE           FALSE            FALSE                    FALSE            FALSE
## 48           FALSE           FALSE            FALSE                    FALSE            FALSE
## 52           FALSE           FALSE            FALSE                    FALSE            FALSE
## 54           FALSE           FALSE            FALSE                    FALSE            FALSE
## 55           FALSE           FALSE            FALSE                    FALSE            FALSE
## 57           FALSE           FALSE            FALSE                    FALSE            FALSE
## 59           FALSE           FALSE            FALSE                    FALSE            FALSE
## 60           FALSE           FALSE            FALSE                    FALSE            FALSE
## 61           FALSE           FALSE            FALSE                    FALSE            FALSE
## 63            TRUE           FALSE            FALSE                    FALSE            FALSE
## 64           FALSE            TRUE            FALSE                    FALSE            FALSE
## 65           FALSE           FALSE            FALSE                    FALSE            FALSE
## 66           FALSE           FALSE            FALSE                    FALSE            FALSE
## 67           FALSE           FALSE            FALSE                    FALSE            FALSE
## 68           FALSE           FALSE            FALSE                    FALSE            FALSE
## 69           FALSE           FALSE            FALSE                    FALSE            FALSE
## 70           FALSE           FALSE            FALSE                    FALSE            FALSE
## 71           FALSE           FALSE             TRUE                    FALSE            FALSE
## 72           FALSE           FALSE            FALSE                     TRUE            FALSE
## 73           FALSE           FALSE            FALSE                    FALSE            FALSE
## 74            TRUE           FALSE            FALSE                    FALSE            FALSE
## 75           FALSE           FALSE            FALSE                    FALSE            FALSE
## 76            TRUE           FALSE            FALSE                    FALSE            FALSE
## 77            TRUE           FALSE            FALSE                    FALSE            FALSE
## 78           FALSE           FALSE            FALSE                    FALSE            FALSE
## 79           FALSE           FALSE            FALSE                    FALSE            FALSE
## 80           FALSE           FALSE            FALSE                     TRUE             TRUE
## 81           FALSE           FALSE            FALSE                    FALSE            FALSE
## 82           FALSE            TRUE            FALSE                    FALSE            FALSE
## 83           FALSE            TRUE            FALSE                    FALSE            FALSE
## 84           FALSE           FALSE            FALSE                    FALSE            FALSE
## 91           FALSE           FALSE            FALSE                    FALSE            FALSE
## 93           FALSE           FALSE            FALSE                    FALSE            FALSE
## 95           FALSE           FALSE            FALSE                    FALSE            FALSE
## 100          FALSE           FALSE            FALSE                    FALSE            FALSE
## 102          FALSE           FALSE            FALSE                    FALSE            FALSE
## 109          FALSE           FALSE            FALSE                    FALSE            FALSE
## 115          FALSE           FALSE            FALSE                    FALSE            FALSE
##     umbric.epipedon albic.materials surface_fgravel surface_gravel surface_cobbles surface_stones
## 1             FALSE           FALSE               0              0             0.0            0.0
## 2             FALSE           FALSE               0              0             0.4            0.5
## 4             FALSE           FALSE               0              0             0.0            0.0
## 5             FALSE           FALSE               0              0             0.0            0.0
## 6             FALSE           FALSE               0              0             0.0            0.0
## 7             FALSE           FALSE               0              0             0.0            0.0
## 9             FALSE           FALSE               0              0             0.0            0.0
## 20            FALSE           FALSE               0              0             0.0            0.0
## 21            FALSE           FALSE               0              0             0.0            0.0
## 22            FALSE           FALSE               0              0             0.0            0.0
## 23            FALSE           FALSE               0              0             0.0            0.0
## 25            FALSE           FALSE               0              0             0.0            1.7
## 26            FALSE           FALSE               0              0             0.0            0.0
## 27            FALSE           FALSE               0              0             0.0            0.4
## 28            FALSE           FALSE               0              0             0.0            0.0
## 31            FALSE           FALSE               0              0             0.0            0.0
## 32            FALSE           FALSE               0              0             0.0            0.0
## 33            FALSE           FALSE               0              0             0.0            0.0
## 36            FALSE           FALSE               0              0             0.0            0.0
## 37            FALSE           FALSE               0              0             0.0            0.0
## 39            FALSE           FALSE               0              0             0.0            1.0
## 40            FALSE           FALSE               0              0             0.0            0.8
## 41            FALSE           FALSE               0              0             0.0            0.0
## 46            FALSE           FALSE               0              0             0.0            0.8
## 48            FALSE           FALSE               0              0             0.0            1.0
## 52            FALSE           FALSE               0              0             0.0            0.0
## 54            FALSE           FALSE               0              0             0.0            0.0
## 55            FALSE           FALSE               0              0             0.0            0.0
## 57            FALSE           FALSE               0              0             0.0            0.0
## 59            FALSE           FALSE               0              0             0.0            0.0
## 60            FALSE           FALSE               0              0             0.0            0.0
## 61            FALSE           FALSE               0              0             0.0            0.0
## 63            FALSE           FALSE               0              0             0.0            0.0
## 64            FALSE           FALSE               0              0             0.0            0.0
## 65            FALSE           FALSE               0              0             0.0            0.0
## 66            FALSE           FALSE               0              0             0.0            0.0
## 67            FALSE           FALSE               0              0             0.0            0.0
## 68            FALSE           FALSE               0              0             0.0            0.0
## 69            FALSE           FALSE               0              0             0.0            0.0
## 70            FALSE           FALSE               0              0             0.0            0.0
## 71            FALSE           FALSE               0              0             0.0            0.0
## 72            FALSE           FALSE               0              0             0.0            0.0
## 73            FALSE           FALSE               0              0             0.0            0.0
## 74            FALSE           FALSE               0              0             0.0            0.0
## 75            FALSE           FALSE               0              0             0.0            0.0
## 76            FALSE           FALSE               0              0             0.0            0.0
## 77            FALSE           FALSE               0              0             0.0            0.0
## 78            FALSE           FALSE               0              0             0.0            0.0
## 79            FALSE           FALSE               0              0             0.0            0.0
## 80            FALSE           FALSE               0              0             0.0            0.0
## 81            FALSE           FALSE               0              0             0.0            0.0
## 82            FALSE           FALSE               0              0             0.0            0.0
## 83            FALSE           FALSE               0              0             0.0            0.0
## 84            FALSE           FALSE               0              0             0.0            0.0
## 91            FALSE           FALSE               0              0             0.0            0.0
## 93            FALSE           FALSE               0              0             0.0            0.0
## 95            FALSE           FALSE               0              0             0.0            0.0
## 100           FALSE           FALSE               0              0             0.0            0.0
## 102           FALSE           FALSE               0              0             0.0            0.0
## 109           FALSE           FALSE               0              0             0.0            0.0
## 115           FALSE           FALSE               0              0             0.0            0.0
##     surface_boulders surface_channers surface_flagstones surface_paragravel surface_paracobbles
## 1               0.00                0                  0                  0                   0
## 2               0.00                0                  0                  0                   0
## 4               0.00                0                  0                  0                   0
## 5               0.00                0                  0                  0                   0
## 6               0.00                0                  0                  0                   0
## 7               0.00                0                  0                  0                   0
## 9               0.00                0                  0                  0                   0
## 20              0.00                0                  0                  0                   0
## 21              0.00                0                  0                  0                   0
## 22              0.00                0                  0                  0                   0
## 23              0.00                0                  0                  0                   0
## 25              0.00                0                  0                  0                   0
## 26              0.00                0                  0                  0                   0
## 27              0.00                0                  0                  0                   0
## 28              0.00                0                  0                  0                   0
## 31              0.00                0                  0                  0                   0
## 32              0.00                0                  0                  0                   0
## 33              0.00                0                  0                  0                   0
## 36              0.25                0                  0                  0                   0
## 37              0.00                0                  0                  0                   0
## 39              0.00                0                  0                  0                   0
## 40              0.00                0                  0                  0                   0
## 41              0.00                0                  0                  0                   0
## 46              0.00                0                  0                  0                   0
## 48              0.00                0                  0                  0                   0
## 52              0.00                0                  0                  0                   0
## 54              0.00                0                  0                  0                   0
## 55              0.00                0                  0                  0                   0
## 57              0.00                0                  0                  0                   0
## 59              0.00                0                  0                  0                   0
## 60              0.00                0                  0                  0                   0
## 61              0.00                0                  0                  0                   0
## 63              0.00                0                  0                  0                   0
## 64              0.00                0                  0                  0                   0
## 65              0.00                0                  0                  0                   0
## 66              0.00                0                  0                  0                   0
## 67              0.00                0                  0                  0                   0
## 68              0.00                0                  0                  0                   0
## 69              0.00                0                  0                  0                   0
## 70              0.00                0                  0                  0                   0
## 71              0.00                0                  0                  0                   0
## 72              0.00                0                  0                  0                   0
## 73              0.00                0                  0                  0                   0
## 74              0.00                0                  0                  0                   0
## 75              0.00                0                  0                  0                   0
## 76              0.00                0                  0                  0                   0
## 77              0.00                0                  0                  0                   0
## 78              0.00                0                  0                  0                   0
## 79              0.00                0                  0                  0                   0
## 80              0.00                0                  0                  0                   0
## 81              0.00                0                  0                  0                   0
## 82              0.00                0                  0                  0                   0
## 83              0.00                0                  0                  0                   0
## 84              0.00                0                  0                  0                   0
## 91              0.00                0                  0                  0                   0
## 93              0.00                0                  0                  0                   0
## 95              0.00                0                  0                  0                   0
## 100             0.00                0                  0                  0                   0
## 102             0.00                0                  0                  0                   0
## 109             0.00                0                  0                  0                   0
## 115             0.00                0                  0                  0                   0
##                                landform_string                                     pmkind
## 1                               mountain slope                       colluvium &amp; residuum
## 2                               mountain slope                       colluvium &amp; residuum
## 4             bench &amp; cirque &amp; U-shaped valley                       colluvium &amp; residuum
## 5               alluvial fan &amp; U-shaped valley                    volcanic ash &amp; alluvium
## 6               alluvial fan &amp; U-shaped valley                                   alluvium
## 7                                 cirque floor           volcanic ash &amp; till, unspecified
## 9               alluvial fan &amp; U-shaped valley                                   alluvium
## 20        mountain slope &amp; glacial-valley wall           volcanic ash &amp; till, unspecified
## 21         alluvial fan &amp; glacial-valley floor                                   alluvium
## 22      lateral moraine &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 23       glacial-valley wall &amp; U-shaped valley                       alluvium &amp; colluvium
## 25                ridge &amp; glacial-valley floor                    volcanic ash &amp; residuum
## 26       stream terrace &amp; glacial-valley floor                                   alluvium
## 27            dip slope &amp; glacial-valley floor               till, unspecified &amp; residuum
## 28                        glacial-valley floor           volcanic ash &amp; till, unspecified
## 31                        glacial-valley floor volcanic ash &amp; outwash &amp; till, unspecified
## 32                bench &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 33                         glacial-valley wall           volcanic ash &amp; till, unspecified
## 36  recessional moraine &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 37                         glacial-valley wall           volcanic ash &amp; till, unspecified
## 39                         glacial-valley wall                       colluvium &amp; residuum
## 40                         glacial-valley wall       volcanic ash &amp; colluvium &amp; colluvium
## 41                 bench &amp; glacial-valley wall           volcanic ash &amp; till, unspecified
## 46                                cirque floor           volcanic ash &amp; till, unspecified
## 48            mountain slope &amp; U-shaped valley                          till, unspecified
## 52                                      cirque                                   residuum
## 54                                 cirque wall                   volcanic ash &amp; colluvium
## 55                            debris avalanche                                  colluvium
## 57      lateral moraine &amp; glacial-valley floor                             slope alluvium
## 59              moraine &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 60                glacial-valley wall &amp; trough              colluvium &amp; till, unspecified
## 61                glacial-valley wall &amp; trough              colluvium &amp; till, unspecified
## 63              moraine &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 64                glacial-valley wall &amp; trough                     volcanic ash &amp; outwash
## 65                             avalanche chute                                  colluvium
## 66                              mountain slope                                  colluvium
## 67                                     moraine           volcanic ash &amp; till, unspecified
## 68       stream terrace &amp; glacial-valley floor                                   alluvium
## 69                              mountain slope           volcanic ash &amp; till, unspecified
## 70                             avalanche chute                                  colluvium
## 71                              mountain slope           volcanic ash &amp; till, unspecified
## 72                depression &amp; roche moutonnee                    volcanic ash &amp; residuum
## 73                             colluvial apron                                  colluvium
## 74              moraine &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 75                             outwash terrace                     volcanic ash &amp; outwash
## 76      avalanche chute &amp; glacial-valley floor                   volcanic ash &amp; colluvium
## 77                                     moraine           volcanic ash &amp; till, unspecified
## 78                                     moraine           volcanic ash &amp; till, unspecified
## 79                              mountain slope                                  colluvium
## 80                             lateral moraine           volcanic ash &amp; till, unspecified
## 81      lateral moraine &amp; glacial-valley floor           volcanic ash &amp; till, unspecified
## 82                     ridge &amp; lateral moraine                          till, unspecified
## 83                             lateral moraine                          till, unspecified
## 84                   pothole &amp; lateral moraine   organic, unspecified &amp; till, unspecified
## 91                              mountain slope                          till, unspecified
## 93                                     moraine                outwash &amp; till, unspecified
## 95                              mountain slope                                  colluvium
## 100                             mountain slope                          till, unspecified
## 102                                      ridge                                   residuum
## 109                               cirque floor                                   residuum
## 115                               cirque floor                                  colluvium
##                                     pmorigin
## 1               metasedimentary, unspecified
## 2               metasedimentary, unspecified
## 4               metasedimentary, unspecified
## 5          NA &amp; metasedimentary, unspecified
## 6                                  argillite
## 7          NA &amp; metasedimentary, unspecified
## 9                    limestone and siltstone
## 20         NA &amp; metasedimentary, unspecified
## 21              metasedimentary, unspecified
## 22         NA &amp; metasedimentary, unspecified
## 23              metasedimentary, unspecified
## 25                            NA &amp; argillite
## 26              metasedimentary, unspecified
## 27  metasedimentary, unspecified &amp; quartzite
## 28         NA &amp; metasedimentary, unspecified
## 31         NA &amp; metasedimentary, unspecified
## 32         NA &amp; metasedimentary, unspecified
## 33         NA &amp; metasedimentary, unspecified
## 36         NA &amp; metasedimentary, unspecified
## 37         NA &amp; metasedimentary, unspecified
## 39                                 argillite
## 40         NA &amp; metasedimentary, unspecified
## 41         NA &amp; metasedimentary, unspecified
## 46         NA &amp; metasedimentary, unspecified
## 48              metasedimentary, unspecified
## 52                                        NA
## 54                                        NA
## 55                                        NA
## 57                                        NA
## 59                                        NA
## 60                                        NA
## 61                                        NA
## 63                                        NA
## 64                                        NA
## 65                                        NA
## 66                                        NA
## 67                                        NA
## 68                                        NA
## 69                                        NA
## 70                                        NA
## 71                                        NA
## 72                                        NA
## 73                                        NA
## 74                                        NA
## 75                                        NA
## 76                                        NA
## 77                                        NA
## 78                                        NA
## 79                                        NA
## 80                                        NA
## 81                                        NA
## 82                                        NA
## 83                                        NA
## 84                                        NA
## 91              metasedimentary, unspecified
## 93                                        NA
## 95                  sedimentary, unspecified
## 100             metasedimentary, unspecified
## 102             metasedimentary, unspecified
## 109             metasedimentary, unspecified
## 115             metasedimentary, unspecified</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="the-data-we-use.html#cb101-1"></a><span class="co"># these are the mt663 bad.pedon.ids</span></span>
<span id="cb101-2"><a href="the-data-we-use.html#cb101-2"></a><span class="kw">get</span>(<span class="st">&#39;bad.pedon.ids&#39;</span>, <span class="dt">envir =</span> soilDB.env)</span></code></pre></div>
<pre><code>##  [1] &quot;2015MT6630502&quot; &quot;2015MT6630503&quot; &quot;2015MT6630505&quot; &quot;2015MT6630506&quot; &quot;2015MT6630507&quot; &quot;2015MT6630508&quot;
##  [7] &quot;2015MT6630509&quot; &quot;2015MT6630511&quot; &quot;2015MT6630516&quot; &quot;2015MT6630522&quot; &quot;2015MT6630523&quot; &quot;2015MT6630524&quot;
## [13] &quot;2015MT6630525&quot; &quot;2015MT6630527&quot; &quot;2015MT6630528&quot; &quot;2015MT6630529&quot; &quot;2015MT6630531&quot; &quot;2015MT6630534&quot;
## [19] &quot;2015MT6630535&quot; &quot;2015MT6630536&quot; &quot;2015MT6630538&quot; &quot;2015MT6630539&quot; &quot;2015MT6630540&quot; &quot;2015MT6630541&quot;
## [25] &quot;2015MT6630542&quot; &quot;2015MT6630543&quot; &quot;2015MT6630544&quot; &quot;2015MT6630545&quot; &quot;2015MT6630500&quot; &quot;2015MT6633506&quot;
## [31] &quot;2015MT6633507&quot; &quot;2015MT6633508&quot; &quot;2015MT6633510&quot; &quot;2015MT6633511&quot; &quot;2015MT6633512&quot; &quot;2015MT6633514&quot;
## [37] &quot;2015MT6633515&quot; &quot;2015MT6633516&quot; &quot;2015MT6633518&quot; &quot;2015MT6633519&quot; &quot;2015MT6633521&quot; &quot;2015MT6633523&quot;
## [43] &quot;2015MT6633524&quot; &quot;2015MT6633525&quot; &quot;2015MT6633526&quot; &quot;2015MT6633527&quot; &quot;2015MT6633528&quot; &quot;2015MT6633531&quot;
## [49] &quot;2015MT6633532&quot; &quot;2015MT6633533&quot; &quot;2015MT6633534&quot; &quot;2015MT6633535&quot; &quot;2015MT6633536&quot; &quot;2015MT6633538&quot;
## [55] &quot;2015MT6633539&quot; &quot;2015MT6633540&quot; &quot;2015MT6633541&quot; &quot;2015MT6633542&quot; &quot;2015MT6635249&quot; &quot;2015MT6635250&quot;
## [61] &quot;2015MT6635256&quot; &quot;2015MT6635257&quot; &quot;2015MT6635258&quot; &quot;2015MT6635259&quot; &quot;2015MT6635261&quot; &quot;2015MT6635262&quot;
## [67] &quot;2015MT6635263&quot; &quot;2015MT6635264&quot; &quot;2015MT6635277&quot;</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="the-data-we-use.html#cb103-1"></a><span class="co"># none of the bad pedons are in mt663 (rmHzErrors=TRUE)</span></span>
<span id="cb103-2"><a href="the-data-we-use.html#cb103-2"></a><span class="kw">get</span>(<span class="st">&#39;bad.pedon.ids&#39;</span>, <span class="dt">envir =</span> soilDB.env) <span class="op">%in%</span><span class="st"> </span>mt663<span class="op">$</span>pedon_id</span></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [17] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [33] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [65] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="the-data-we-use.html#cb105-1"></a><span class="co"># all of the bad pedons are in mt663err (rmHzErrors=FALSE)</span></span>
<span id="cb105-2"><a href="the-data-we-use.html#cb105-2"></a><span class="kw">get</span>(<span class="st">&#39;bad.pedon.ids&#39;</span>, <span class="dt">envir =</span> soilDB.env) <span class="op">%in%</span><span class="st"> </span>mt663err<span class="op">$</span>pedon_id</span></code></pre></div>
<pre><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [20] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [39] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [58] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="the-data-we-use.html#cb107-1"></a><span class="co"># both good and bad pedons are in mt663err</span></span>
<span id="cb107-2"><a href="the-data-we-use.html#cb107-2"></a>mt663err<span class="op">$</span>pedon_id <span class="op">%in%</span><span class="st"> </span><span class="kw">get</span>(<span class="st">&#39;bad.pedon.ids&#39;</span>, <span class="dt">envir =</span> soilDB.env)</span></code></pre></div>
<pre><code>##   [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE
##  [16] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
##  [31]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
##  [46] FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
##  [61]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE
##  [76]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
##  [91] FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
## [106] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE</code></pre>
</div>
<div id="extended-data-functions" class="section level2">
<h2><span class="header-section-number">3.8</span> Extended Data Functions</h2>
<p>Additional data related to both site and horizon information can be fetched using the <a href="http://ncss-tech.github.io/soilDB/docs/reference/get_extended_data_from_NASIS.html"><code>get_extended_data_from_NASIS()</code></a> function. This function returns a named <code>list()</code> with several tables that fetchNASIS draws from in addition to the typical Site/Pedon/Component/Horizon tables.</p>
<p>All these “extended” data are not brought into a <code>SoilProfileCollection</code> <em>automatically</em> because these data elements are related to the site or horizon data in one-to-many relationships.</p>
<p>There are a variety of calculated fields that are included in the default fetchNASIS result, and you can make use of these to simplify queries and aggregations for a variety of analyses.</p>
<div id="elements-of-get_extended_data_from_nasis" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Elements of <code>get_extended_data_from_NASIS()</code></h3>
<ul>
<li><p>Ecological Site History (<code>"ecositehistory"</code>)</p></li>
<li><p>Diagnostic Features (<code>"diagnostic"</code>)</p></li>
<li><p>Diagnostic Feature <code>TRUE</code>/<code>FALSE</code> Summary (<code>"diagHzBoolean"</code>)</p></li>
<li><p>Restrictions (<code>"restriction"</code>)</p></li>
<li><p>Fragment and Texture Summaries</p></li>
<li><p>Horizon Fragments (<code>"frag_summary"</code>)</p></li>
<li><p>Horizon Artifacts (<code>"art_summary"</code>)</p></li>
<li><p>Surface Fragments (<code>"surf_frag_summary"</code>)</p></li>
<li><p>Texture Class Modifiers (<code>"texmodifier"</code>)</p></li>
<li><p>Geomorphic Table Summaries (<code>"geomorph"</code>)</p></li>
<li><p>Parent Material Summaries (<code>"pm"</code>)</p></li>
<li><p>Taxonomic History (<code>"taxhistory"</code>)</p></li>
<li><p>Site Text Notes w/ Photo links(<code>"photo"</code>)</p></li>
<li><p>Horizon Structure (<code>"struct"</code>)</p></li>
<li><p>Horizon Designation (<code>"hzdesgn"</code>)</p></li>
</ul>
<p>Below is a summary of additional information that can be readily brought into R from your NASIS selected set via the <code>get_extended_data_from_NASIS()</code> function.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="the-data-we-use.html#cb109-1"></a><span class="co">## fetch extended site and horizon data from local NASIS</span></span>
<span id="cb109-2"><a href="the-data-we-use.html#cb109-2"></a><span class="co"># mt663ext &lt;- get_extended_data_from_NASIS_db()</span></span></code></pre></div>
<p>We could use the <code>get_extended_data_from_NASIS_db()</code> function if <code>2015MT663%</code> or other data were in the selected set, but we will use the <code>mt663ext</code> data we loaded from the <em>.rda</em> file.</p>
<p>The column names are the names of variables that you could join to your site or horizon data by various means. Generally these variable names, with a few exceptions, mirror the <a href="https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/survey/tools/?cid=nrcs142p2_053547">NASIS 7 data model names</a>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="the-data-we-use.html#cb110-1"></a><span class="co">### </span></span>
<span id="cb110-2"><a href="the-data-we-use.html#cb110-2"></a><span class="co">### site and pedon related extended data</span></span>
<span id="cb110-3"><a href="the-data-we-use.html#cb110-3"></a><span class="co">###</span></span>
<span id="cb110-4"><a href="the-data-we-use.html#cb110-4"></a></span>
<span id="cb110-5"><a href="the-data-we-use.html#cb110-5"></a><span class="co"># vegetation data summary</span></span>
<span id="cb110-6"><a href="the-data-we-use.html#cb110-6"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>ecositehistory) </span></code></pre></div>
<pre><code>## [1] &quot;siteiid&quot;         &quot;ecositeid&quot;       &quot;ecositenm&quot;       &quot;ecositecorrdate&quot; &quot;es_classifier&quot;</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="the-data-we-use.html#cb112-1"></a><span class="co"># diagnostic features</span></span>
<span id="cb112-2"><a href="the-data-we-use.html#cb112-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>diagnostic) </span></code></pre></div>
<pre><code>## [1] &quot;peiid&quot;    &quot;featkind&quot; &quot;featdept&quot; &quot;featdepb&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="the-data-we-use.html#cb114-1"></a><span class="co"># surface rock fragments</span></span>
<span id="cb114-2"><a href="the-data-we-use.html#cb114-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>surf_frag_summary)</span></code></pre></div>
<pre><code>##  [1] &quot;peiid&quot;               &quot;surface_fgravel&quot;     &quot;surface_gravel&quot;      &quot;surface_cobbles&quot;    
##  [5] &quot;surface_stones&quot;      &quot;surface_boulders&quot;    &quot;surface_channers&quot;    &quot;surface_flagstones&quot; 
##  [9] &quot;surface_paragravel&quot;  &quot;surface_paracobbles&quot;</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="the-data-we-use.html#cb116-1"></a><span class="co"># geomorphic description</span></span>
<span id="cb116-2"><a href="the-data-we-use.html#cb116-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>geomorph)</span></code></pre></div>
<pre><code>## [1] &quot;peiid&quot;        &quot;geomfmod&quot;     &quot;geomfname&quot;    &quot;geomfeatid&quot;   &quot;existsonfeat&quot; &quot;geomfiidref&quot; 
## [7] &quot;geomftname&quot;</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="the-data-we-use.html#cb118-1"></a><span class="co"># taxonomic history data</span></span>
<span id="cb118-2"><a href="the-data-we-use.html#cb118-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>taxhistory)</span></code></pre></div>
<pre><code>##  [1] &quot;peiid&quot;          &quot;classdate&quot;      &quot;classifier&quot;     &quot;classtype&quot;      &quot;taxonname&quot;     
##  [6] &quot;localphase&quot;     &quot;taxonkind&quot;      &quot;seriesstatus&quot;   &quot;taxpartsize&quot;    &quot;taxorder&quot;      
## [11] &quot;taxsuborder&quot;    &quot;taxgrtgroup&quot;    &quot;taxsubgrp&quot;      &quot;soiltaxedition&quot; &quot;osdtypelocflag&quot;
## [16] &quot;taxmoistcl&quot;     &quot;taxtempregime&quot;  &quot;taxfamother&quot;    &quot;psctopdepth&quot;    &quot;pscbotdepth&quot;</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="the-data-we-use.html#cb120-1"></a><span class="co"># linked photo stored in site textnotes</span></span>
<span id="cb120-2"><a href="the-data-we-use.html#cb120-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>photo) </span></code></pre></div>
<pre><code>## [1] &quot;siteiid&quot;   &quot;recdate&quot;   &quot;textcat&quot;   &quot;imagepath&quot; &quot;imagename&quot;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="the-data-we-use.html#cb122-1"></a><span class="co"># site parent materials</span></span>
<span id="cb122-2"><a href="the-data-we-use.html#cb122-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>pm)</span></code></pre></div>
<pre><code>##  [1] &quot;siteiid&quot;      &quot;seqnum&quot;       &quot;pmorder&quot;      &quot;pmdept&quot;       &quot;pmdepb&quot;       &quot;pmmodifier&quot;  
##  [7] &quot;pmgenmod&quot;     &quot;pmkind&quot;       &quot;pmorigin&quot;     &quot;pmweathering&quot;</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="the-data-we-use.html#cb124-1"></a><span class="co">###</span></span>
<span id="cb124-2"><a href="the-data-we-use.html#cb124-2"></a><span class="co">### horizon related extended data</span></span>
<span id="cb124-3"><a href="the-data-we-use.html#cb124-3"></a><span class="co">### </span></span>
<span id="cb124-4"><a href="the-data-we-use.html#cb124-4"></a></span>
<span id="cb124-5"><a href="the-data-we-use.html#cb124-5"></a><span class="co"># rock fragments </span></span>
<span id="cb124-6"><a href="the-data-we-use.html#cb124-6"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>frag_summary) </span></code></pre></div>
<pre><code>##  [1] &quot;phiid&quot;                &quot;fine_gravel&quot;          &quot;gravel&quot;               &quot;cobbles&quot;             
##  [5] &quot;stones&quot;               &quot;boulders&quot;             &quot;channers&quot;             &quot;flagstones&quot;          
##  [9] &quot;parafine_gravel&quot;      &quot;paragravel&quot;           &quot;paracobbles&quot;          &quot;parastones&quot;          
## [13] &quot;paraboulders&quot;         &quot;parachanners&quot;         &quot;paraflagstones&quot;       &quot;unspecified&quot;         
## [17] &quot;total_frags_pct_nopf&quot; &quot;total_frags_pct&quot;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="the-data-we-use.html#cb126-1"></a><span class="co"># soil texture modifers</span></span>
<span id="cb126-2"><a href="the-data-we-use.html#cb126-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>texmodifier)</span></code></pre></div>
<pre><code>## [1] &quot;peiid&quot;  &quot;phiid&quot;  &quot;phtiid&quot; &quot;seqnum&quot; &quot;texmod&quot;</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="the-data-we-use.html#cb128-1"></a><span class="co"># soil structure data</span></span>
<span id="cb128-2"><a href="the-data-we-use.html#cb128-2"></a><span class="kw">colnames</span>(mt663ext<span class="op">$</span>struct) </span></code></pre></div>
<pre><code>## [1] &quot;phiid&quot;         &quot;structgrade&quot;   &quot;structsize&quot;    &quot;structtype&quot;    &quot;structid&quot;      &quot;structpartsto&quot;</code></pre>
</div>
<div id="visualizing-common-landforms" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Visualizing Common Landforms</h3>
<p>The following code generates a simple graphical summary of the 10 most commonly occurring <code>"landform_string"</code> (a calculated field in <code>fetchNASIS()</code>) to inspect which are the most common.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="the-data-we-use.html#cb130-1"></a><span class="co"># load data from a NASIS selected set (or sample object)</span></span>
<span id="cb130-2"><a href="the-data-we-use.html#cb130-2"></a>pedons &lt;-<span class="st"> </span>mt663err</span>
<span id="cb130-3"><a href="the-data-we-use.html#cb130-3"></a></span>
<span id="cb130-4"><a href="the-data-we-use.html#cb130-4"></a><span class="co"># create &#39;lf&#39; object of landform factors sorted in descending order</span></span>
<span id="cb130-5"><a href="the-data-we-use.html#cb130-5"></a>lf &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">table</span>(pedons<span class="op">$</span>landform_string), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span>
<span id="cb130-6"><a href="the-data-we-use.html#cb130-6"></a></span>
<span id="cb130-7"><a href="the-data-we-use.html#cb130-7"></a><span class="co"># plot top 10 or length, whichever is shorter</span></span>
<span id="cb130-8"><a href="the-data-we-use.html#cb130-8"></a>Hmisc<span class="op">::</span><span class="kw">dotchart2</span>(lf[<span class="dv">1</span><span class="op">:</span><span class="kw">pmin</span>(<span class="dv">10</span>, <span class="kw">length</span>(lf))],</span>
<span id="cb130-9"><a href="the-data-we-use.html#cb130-9"></a>                 <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb130-10"><a href="the-data-we-use.html#cb130-10"></a>                 <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(lf)),</span>
<span id="cb130-11"><a href="the-data-we-use.html#cb130-11"></a>                 <span class="dt">cex.labels =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/owndata_c-1.png" width="672" /></p>
</div>
<div id="diagnostic-features" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Diagnostic Features</h3>
<div id="boolean-diagnostic-features-in-fetchnasis" class="section level4">
<h4><span class="header-section-number">3.8.3.1</span> Boolean Diagnostic Features in <code>fetchNASIS</code></h4>
<p>If diagnostic features are populated in the Pedon Diagnostic Features table in NASIS, then Boolean (<code>TRUE</code> or <code>FALSE</code>) fields are created for each diagnostic feature type found in the data brought in by <code>fetchNASIS</code>.</p>
<p>These fields can be used to model presence / absence of a diagnostic soil feature by extracting the site data from the <code>SoilProfileCollection</code> with <code>site()</code>.</p>
</div>
<div id="thickness-based-on-diagnostic-features-table" class="section level4">
<h4><span class="header-section-number">3.8.3.2</span> Thickness based on Diagnostic Features Table</h4>
<p>The following is an example of how you could use the diagnostic features (if populated!) from the extended data to determine the thickness of a diagnostic feature of interest.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="the-data-we-use.html#cb131-1"></a>f &lt;-<span class="st"> </span>mt663err</span>
<span id="cb131-2"><a href="the-data-we-use.html#cb131-2"></a></span>
<span id="cb131-3"><a href="the-data-we-use.html#cb131-3"></a><span class="co"># get diagnostic features associated with pedons loaded from selected set</span></span>
<span id="cb131-4"><a href="the-data-we-use.html#cb131-4"></a>d &lt;-<span class="st"> </span><span class="kw">diagnostic_hz</span>(f)</span>
<span id="cb131-5"><a href="the-data-we-use.html#cb131-5"></a></span>
<span id="cb131-6"><a href="the-data-we-use.html#cb131-6"></a><span class="co"># summary of the diagnostic features in your data!</span></span>
<span id="cb131-7"><a href="the-data-we-use.html#cb131-7"></a><span class="kw">unique</span>(d<span class="op">$</span>featkind)</span></code></pre></div>
<pre><code>##  [1] &quot;ochric epipedon&quot;          &quot;cambic horizon&quot;           &quot;lithic contact&quot;          
##  [4] &quot;mollic epipedon&quot;          &quot;argillic horizon&quot;         &quot;redox concentrations&quot;    
##  [7] &quot;andic soil properties&quot;    &quot;secondary carbonates&quot;     &quot;aquic conditions&quot;        
## [10] &quot;sapric soil materials&quot;    &quot;reduced matrix&quot;           &quot;albic horizon&quot;           
## [13] &quot;spodic horizon&quot;           &quot;glossic horizon&quot;          &quot;spodic materials&quot;        
## [16] &quot;lithologic discontinuity&quot; &quot;densic materials&quot;         &quot;umbric epipedon&quot;         
## [19] &quot;albic materials&quot;          NA</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="the-data-we-use.html#cb133-1"></a><span class="co"># tabulate</span></span>
<span id="cb133-2"><a href="the-data-we-use.html#cb133-2"></a><span class="kw">sort</span>(<span class="kw">table</span>(<span class="kw">droplevels</span>(<span class="kw">factor</span>(d<span class="op">$</span>featkind))), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##          ochric epipedon           cambic horizon         argillic horizon          mollic epipedon 
##                       61                       54                       43                       42 
##    andic soil properties           lithic contact     secondary carbonates          umbric epipedon 
##                       30                       20                        7                        7 
##            albic horizon           spodic horizon          glossic horizon           reduced matrix 
##                        6                        4                        3                        3 
##    sapric soil materials lithologic discontinuity          albic materials         aquic conditions 
##                        3                        2                        1                        1 
##         densic materials     redox concentrations         spodic materials 
##                        1                        1                        1</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="the-data-we-use.html#cb135-1"></a><span class="co"># subset argillic horizons</span></span>
<span id="cb135-2"><a href="the-data-we-use.html#cb135-2"></a>d &lt;-<span class="st"> </span>d[d<span class="op">$</span>featkind <span class="op">==</span><span class="st"> &#39;argillic horizon&#39;</span>, ]</span>
<span id="cb135-3"><a href="the-data-we-use.html#cb135-3"></a></span>
<span id="cb135-4"><a href="the-data-we-use.html#cb135-4"></a><span class="co"># create a new column and subtract the upper from the lower depth</span></span>
<span id="cb135-5"><a href="the-data-we-use.html#cb135-5"></a>d<span class="op">$</span>argillic_thickness_cm &lt;-<span class="st"> </span>d<span class="op">$</span>featdepb <span class="op">-</span><span class="st"> </span>d<span class="op">$</span>featdept</span>
<span id="cb135-6"><a href="the-data-we-use.html#cb135-6"></a></span>
<span id="cb135-7"><a href="the-data-we-use.html#cb135-7"></a><span class="co"># create another new column with the upper depth to the diagnostic feature</span></span>
<span id="cb135-8"><a href="the-data-we-use.html#cb135-8"></a>d<span class="op">$</span>depth_to_argillic_cm &lt;-<span class="st"> </span>d<span class="op">$</span>featdept</span>
<span id="cb135-9"><a href="the-data-we-use.html#cb135-9"></a></span>
<span id="cb135-10"><a href="the-data-we-use.html#cb135-10"></a><span class="co"># omit NA values</span></span>
<span id="cb135-11"><a href="the-data-we-use.html#cb135-11"></a>d &lt;-<span class="st"> </span><span class="kw">na.omit</span>(d)</span>
<span id="cb135-12"><a href="the-data-we-use.html#cb135-12"></a></span>
<span id="cb135-13"><a href="the-data-we-use.html#cb135-13"></a><span class="co"># subset to pedon records IDs and calculated thickness</span></span>
<span id="cb135-14"><a href="the-data-we-use.html#cb135-14"></a>d &lt;-<span class="st"> </span>d[, <span class="kw">c</span>(<span class="st">&#39;peiid&#39;</span>, <span class="st">&#39;argillic_thickness_cm&#39;</span>, <span class="st">&#39;depth_to_argillic_cm&#39;</span>)]</span>
<span id="cb135-15"><a href="the-data-we-use.html#cb135-15"></a><span class="kw">head</span>(d)</span></code></pre></div>
<pre><code>##      peiid argillic_thickness_cm depth_to_argillic_cm
## 7  1092610                    56                   30
## 24 1092617                    38                   34
## 26 1092618                    29                   23
## 28 1092619                    38                   32
## 30 1092620                    29                   24
## 33 1092621                    23                   19</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="the-data-we-use.html#cb137-1"></a><span class="co"># left-join with existing site data</span></span>
<span id="cb137-2"><a href="the-data-we-use.html#cb137-2"></a><span class="kw">site</span>(f) &lt;-<span class="st"> </span>d</span>
<span id="cb137-3"><a href="the-data-we-use.html#cb137-3"></a></span>
<span id="cb137-4"><a href="the-data-we-use.html#cb137-4"></a><span class="co"># plot as histogram</span></span>
<span id="cb137-5"><a href="the-data-we-use.html#cb137-5"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb137-6"><a href="the-data-we-use.html#cb137-6"></a></span>
<span id="cb137-7"><a href="the-data-we-use.html#cb137-7"></a><span class="kw">hist</span>(f<span class="op">$</span>argillic_thickness_cm, <span class="dt">xlab =</span> <span class="st">&#39;Thickness of argillic (cm)&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-25-1.png" width="576" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="the-data-we-use.html#cb138-1"></a><span class="kw">hist</span>(f<span class="op">$</span>depth_to_argillic_cm, <span class="dt">xlab =</span> <span class="st">&#39;Depth to argillic top depth (cm)&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-25-2.png" width="576" /></p>
<p>Quick check: <em>What can you do with the boolean diagnostic feature data stored in the site table of a <code>fetchNASIS</code> <code>SoilProfileCollection</code>?</em></p>
</div>
<div id="diagnostic-feature-diagrams" class="section level4">
<h4><span class="header-section-number">3.8.3.3</span> Diagnostic Feature Diagrams</h4>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="the-data-we-use.html#cb139-1"></a><span class="co">## work up diagnostic plot based on gopheridge dataset</span></span>
<span id="cb139-2"><a href="the-data-we-use.html#cb139-2"></a><span class="kw">library</span>(aqp)</span>
<span id="cb139-3"><a href="the-data-we-use.html#cb139-3"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb139-4"><a href="the-data-we-use.html#cb139-4"></a><span class="kw">library</span>(sharpshootR)</span>
<span id="cb139-5"><a href="the-data-we-use.html#cb139-5"></a></span>
<span id="cb139-6"><a href="the-data-we-use.html#cb139-6"></a><span class="co"># can limit which diagnostic features to show by setting &#39;v&#39; manually</span></span>
<span id="cb139-7"><a href="the-data-we-use.html#cb139-7"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;ochric.epipedon&#39;</span>, <span class="st">&#39;cambic.horizon&#39;</span>, </span>
<span id="cb139-8"><a href="the-data-we-use.html#cb139-8"></a>       <span class="st">&#39;argillic.horizon&#39;</span>, <span class="st">&#39;paralithic.contact&#39;</span>, </span>
<span id="cb139-9"><a href="the-data-we-use.html#cb139-9"></a>       <span class="st">&#39;lithic.contact&#39;</span>)</span>
<span id="cb139-10"><a href="the-data-we-use.html#cb139-10"></a></span>
<span id="cb139-11"><a href="the-data-we-use.html#cb139-11"></a><span class="co"># the default concatenated landform_string may have multiple levels</span></span>
<span id="cb139-12"><a href="the-data-we-use.html#cb139-12"></a><span class="co">#  depending on how the geomorphic tables were populated</span></span>
<span id="cb139-13"><a href="the-data-we-use.html#cb139-13"></a><span class="co">#  these are concatenated using the ampersand (&amp;) character</span></span>
<span id="cb139-14"><a href="the-data-we-use.html#cb139-14"></a><span class="co">#  so take the first string split using ampersand as a delimiter</span></span>
<span id="cb139-15"><a href="the-data-we-use.html#cb139-15"></a>mt663err<span class="op">$</span>first_landform &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(mt663err<span class="op">$</span>landform_string, <span class="st">&quot;&amp;&quot;</span>), </span>
<span id="cb139-16"><a href="the-data-we-use.html#cb139-16"></a>                                  <span class="cf">function</span>(x) x[[<span class="dv">1</span>]])</span>
<span id="cb139-17"><a href="the-data-we-use.html#cb139-17"></a></span>
<span id="cb139-18"><a href="the-data-we-use.html#cb139-18"></a><span class="co"># plot with diagnostic features ordered according to co-occurrence</span></span>
<span id="cb139-19"><a href="the-data-we-use.html#cb139-19"></a><span class="kw">diagnosticPropertyPlot</span>(mt663err[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>,], v, <span class="dt">k =</span> <span class="dv">5</span>,</span>
<span id="cb139-20"><a href="the-data-we-use.html#cb139-20"></a>                       <span class="dt">grid.label =</span> <span class="st">&#39;site_id&#39;</span>, </span>
<span id="cb139-21"><a href="the-data-we-use.html#cb139-21"></a>                       <span class="dt">dend.label =</span> <span class="st">&#39;first_landform&#39;</span>, </span>
<span id="cb139-22"><a href="the-data-we-use.html#cb139-22"></a>                       <span class="dt">sort.vars =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-26-1.png" width="864" /></p>
</div>
</div>
<div id="comparing-horizon-data-within-diagnostic-featuresintervals" class="section level3">
<h3><span class="header-section-number">3.8.4</span> Comparing Horizon Data within Diagnostic Features/Intervals</h3>
<p>This is a stub – will drop in code here if all looks good.</p>
<div id="follow-along-with-your-own-data" class="section level4">
<h4><span class="header-section-number">3.8.4.1</span> Follow along with your own data</h4>
<p>Use the following script to generate a diagnostic-feature diagram for the pedon data you’ve loaded from your NASIS selected set.</p>
<p>Select a series of diagnostic properties or automatically pull diagnostic feature columns.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="the-data-we-use.html#cb140-1"></a><span class="kw">library</span>(aqp)</span>
<span id="cb140-2"><a href="the-data-we-use.html#cb140-2"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb140-3"><a href="the-data-we-use.html#cb140-3"></a><span class="kw">library</span>(sharpshootR)</span>
<span id="cb140-4"><a href="the-data-we-use.html#cb140-4"></a></span>
<span id="cb140-5"><a href="the-data-we-use.html#cb140-5"></a><span class="co"># Load data</span></span>
<span id="cb140-6"><a href="the-data-we-use.html#cb140-6"></a>f &lt;-<span class="st"> </span><span class="kw">fetchNASIS</span>(<span class="dt">from =</span> <span class="st">&#39;pedons&#39;</span>)</span>
<span id="cb140-7"><a href="the-data-we-use.html#cb140-7"></a></span>
<span id="cb140-8"><a href="the-data-we-use.html#cb140-8"></a><span class="co"># ... May need to subset to reduce the number of pedons!</span></span>
<span id="cb140-9"><a href="the-data-we-use.html#cb140-9"></a></span>
<span id="cb140-10"><a href="the-data-we-use.html#cb140-10"></a><span class="co"># get all diagnostic feature columns from site data </span></span>
<span id="cb140-11"><a href="the-data-we-use.html#cb140-11"></a><span class="co"># by pattern matching on &#39;[.]&#39; in the colnames; not a generic rule</span></span>
<span id="cb140-12"><a href="the-data-we-use.html#cb140-12"></a>idx &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&#39;[.]&#39;</span>, <span class="kw">colnames</span>(<span class="kw">site</span>(f)))</span>
<span id="cb140-13"><a href="the-data-we-use.html#cb140-13"></a>v &lt;-<span class="st"> </span><span class="kw">colnames</span>(<span class="kw">site</span>(f))[idx]</span>
<span id="cb140-14"><a href="the-data-we-use.html#cb140-14"></a></span>
<span id="cb140-15"><a href="the-data-we-use.html#cb140-15"></a><span class="co"># inspect v</span></span>
<span id="cb140-16"><a href="the-data-we-use.html#cb140-16"></a>v</span>
<span id="cb140-17"><a href="the-data-we-use.html#cb140-17"></a></span>
<span id="cb140-18"><a href="the-data-we-use.html#cb140-18"></a><span class="co"># insert diagnostics of interest from the possible list in &#39;v&#39;</span></span>
<span id="cb140-19"><a href="the-data-we-use.html#cb140-19"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;ochric.epipedon&#39;</span>, <span class="st">&#39;cambic.horizon&#39;</span>, </span>
<span id="cb140-20"><a href="the-data-we-use.html#cb140-20"></a>       <span class="st">&#39;argillic.horizon&#39;</span>, <span class="st">&#39;paralithic.contact&#39;</span>,</span>
<span id="cb140-21"><a href="the-data-we-use.html#cb140-21"></a>       <span class="st">&#39;lithic.contact&#39;</span>)</span>
<span id="cb140-22"><a href="the-data-we-use.html#cb140-22"></a></span>
<span id="cb140-23"><a href="the-data-we-use.html#cb140-23"></a><span class="co"># generate diagnostic property diagram</span></span>
<span id="cb140-24"><a href="the-data-we-use.html#cb140-24"></a><span class="kw">diagnosticPropertyPlot</span>(f, v, <span class="dt">k =</span> <span class="dv">5</span>, </span>
<span id="cb140-25"><a href="the-data-we-use.html#cb140-25"></a>                       <span class="dt">grid.label =</span> <span class="st">&#39;site_id&#39;</span>, </span>
<span id="cb140-26"><a href="the-data-we-use.html#cb140-26"></a>                       <span class="dt">dend.label =</span> <span class="st">&#39;taxonname&#39;</span>)</span></code></pre></div>
<p>For more information on generating diagnostic feature diagrams, see the following tutorial:</p>
<ul>
<li><a href="http://ncss-tech.github.io/AQP/sharpshootR/diagnostic-property-plot.html"><strong>Diagnostic Feature Property Plots</strong></a>.</li>
</ul>
</div>
</div>
</div>
<div id="soil-reports" class="section level2">
<h2><span class="header-section-number">3.9</span> Soil Reports</h2>
<p>One of the strengths of NASIS is that it that has many queries and reports to access the complex data. This makes it easy for the average user to load their data, process it and run numerous reports.</p>
<p>The <code>soilReports</code> R package is essentially just a collection of R Markdown (<em>.Rmd</em>) documents, each with a “manifest” that describes any required dependencies, configuration files or inputs. These <em>.Rmd</em> files can be used to generate HTML, PDF, Word, Markdown documents with a variety of forms, templates and applications.</p>
<p>You can convert any of your own R-based analyses to the <code>soilReports</code> format.</p>
<ul>
<li><p>Example report output can be found at the following link: <a href="https://github.com/ncss-tech/soilReports#example-output">https://github.com/ncss-tech/soilReports#example-output</a>.</p></li>
<li><p>Detailed instructions are provided for each report: <a href="https://github.com/ncss-tech/soilReports#choose-an-available-report">https://github.com/ncss-tech/soilReports#choose-an-available-report</a></p></li>
</ul>
<div id="extending-soilreports" class="section level3">
<h3><span class="header-section-number">3.9.1</span> Extending <code>soilReports</code></h3>
<p>R Markdown is a plain text markup format for creating reproducible, dynamic reports with R.</p>
<p>It allows R code and text to be mingled in the same document and executed like an R script using special notation. This allows for generating reports similar to and even more powerful than those from NASIS.</p>
<p>Running or expanding on one of these reports would be a fine class project – as long as you include relevant interpretation.</p>
<p>Let’s demonstrate how to run an existing <em>.Rmd</em> report to summarize laboratory data for a soil series.</p>
</div>
<div id="requirements" class="section level3">
<h3><span class="header-section-number">3.9.2</span> Requirements</h3>
<ul>
<li>Data are properly populated, otherwise the report may fail. Common examples include:
- Horizon depths don’t lineup
- Either the Pedon or Site tables isn’t loaded</li>
<li>ODBC connection to NASIS is set up</li>
<li>Beware each report has a unique configuration file that may need to be edited.</li>
</ul>
</div>
<div id="instructions" class="section level3">
<h3><span class="header-section-number">3.9.3</span> Instructions</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Load</strong> your NASIS selected set. <strong>Run</strong> a query such as “POINT - Pedon/Site/NCSSlabdata by upedonid and Taxon Name” from the Region 11 report folder to load your selected set. Be sure to target both the site, pedon and lab layer tables. <strong>Remove</strong> from your selected set the pedons and sites you wish to exclude from the report.</p></li>
<li><p><strong>Install/re-install</strong> the <code>soilReports</code> package. This package is updated regularly (e.g. weekly), and should be installed from GitHub regularly.</p></li>
</ol>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="the-data-we-use.html#cb141-1"></a><span class="co"># Install the soilReports package from GitHub</span></span>
<span id="cb141-2"><a href="the-data-we-use.html#cb141-2"></a>remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ncss-tech/soilReports&quot;</span>, <span class="dt">dependencies=</span><span class="ot">FALSE</span>, <span class="dt">build=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>View</strong> the list of available reports.</li>
</ol>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="the-data-we-use.html#cb142-1"></a><span class="co"># Load the soilReports </span></span>
<span id="cb142-2"><a href="the-data-we-use.html#cb142-2"></a><span class="kw">library</span>(soilReports)</span>
<span id="cb142-3"><a href="the-data-we-use.html#cb142-3"></a></span>
<span id="cb142-4"><a href="the-data-we-use.html#cb142-4"></a><span class="co"># List reports</span></span>
<span id="cb142-5"><a href="the-data-we-use.html#cb142-5"></a><span class="kw">listReports</span>()</span></code></pre></div>
<pre><code>##                                     name version
## 1  region11/component_summary_by_project     0.1
## 2      region11/lab_summary_by_taxonname     1.0
## 3  region11/mupolygon_summary_by_project     0.1
## 4    region11/pedon_summary_by_taxonname       1
## 5                       region2/dmu-diff     0.7
## 6        region2/mlra-comparison-dynamic     0.1
## 7                region2/mlra-comparison     1.0
## 8        region2/mu-comparison-dashboard   0.0.0
## 9                  region2/mu-comparison   3.4.0
## 10                    region2/mu-summary       1
## 11                 region2/pedon-summary     0.9
## 12                    region2/QA-summary     0.5
## 13           region2/shiny-pedon-summary     1.0
##                                                                                   description
## 1                                                summarize component data for an MLRA project
## 2                                               summarize lab data from NASIS Lab Layer table
## 3                                                summarize mupolygon layer from a geodatabase
## 4                                               summarize field pedons from NASIS pedon table
## 5                                                              Differences between select DMU
## 6                          compare MLRA/LRU-scale delineations, based on mu-comparison report
## 7                                        compare MLRA using pre-made, raster sample databases
## 8  interactively subset and summarize SSURGO data for input to `region2/mu-comparison` report
## 9           compare stack of raster data, sampled from polygons associated with 1-8 map units
## 10                          summarize raster data for a large collection of map unit polygons
## 11                            Generate summaries from pedons (NASIS) and associated GIS data.
## 12                                                                          QA Summary Report
## 13             Interactively subset and summarize NASIS pedon data from one or more map units</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><strong>Copy</strong> the lab summary to your working directory.</li>
</ol>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="the-data-we-use.html#cb144-1"></a><span class="kw">copyReport</span>(<span class="dt">reportName =</span> <span class="st">&quot;region11/lab_summary_by_taxonname&quot;</span>, <span class="dt">outputDir =</span> <span class="st">&quot;C:/workspace2/lab_sum&quot;</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><strong>Examine</strong> the report folder contents.</li>
</ol>
<p>The report is titled <code>report.Rmd</code>. Notice there are several other support files. The parameters for the report are contained in the <code>config.R</code> file.</p>
<p><img src="static-figures/report_folder.png" /></p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Check</strong> or <strong>create</strong> a genhz_rules file for a soil series. In order to aggregate the pedons by horizon designation, a genhz_rules file (e.g., Miami_rules.R) is needed. See above.</li>
</ol>
<p>If none exists see the following job aid on how to create one, <a href="http://ncss-tech.github.io/AQP/aqp/gen-hz-assignment.html">Assigning Generalized Horizon Labels</a>.</p>
<p><img src="static-figures/miamian_rules.png" /></p>
<p>Pay special attention to how caret <code>^</code> and dollar <code>$</code> symbols are used in REGEX. They function as <em>anchors</em> for the beginning and end of the string, respectively.</p>
<ul>
<li><p>A <code>^</code> placed before an A horizon, <code>^A</code>, will match any horizon designation that starts with A, such as Ap, Ap1, but <em>not</em> something merely containing A, such as BA.</p></li>
<li><p>Placing a <code>$</code> after a Bt horizon, <code>Bt$</code>, will match any horizon designation that ends with Bt, such as 2Bt or 3Bt, but <em>not</em> something with a vertical subdivision, such as Bt2.</p></li>
<li><p>Wrapping pattern with both <code>^</code> and <code>$</code> symbols will result only in exact matches – i.e. that start and end with the contents between <code>^</code> and <code>$</code>. For example <code>^[AC]$</code>, will only match A or C, <em>not</em> Ap, Ap2, or Cg.</p></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><strong>Execute</strong> the report.</li>
</ol>
<p><strong>Command-line approach</strong></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="the-data-we-use.html#cb145-1"></a><span class="co"># Set report parameters</span></span>
<span id="cb145-2"><a href="the-data-we-use.html#cb145-2"></a>series &lt;-<span class="st"> &quot;Miami&quot;</span></span>
<span id="cb145-3"><a href="the-data-we-use.html#cb145-3"></a>genhz_rules &lt;-<span class="st"> &quot;C:/workspace2/lab_sum/Miami_rules.R&quot;</span></span>
<span id="cb145-4"><a href="the-data-we-use.html#cb145-4"></a></span>
<span id="cb145-5"><a href="the-data-we-use.html#cb145-5"></a><span class="co"># report file path</span></span>
<span id="cb145-6"><a href="the-data-we-use.html#cb145-6"></a>report_path &lt;-<span class="st"> &quot;C:/workspace2/lab_sum/report.Rmd&quot;</span></span>
<span id="cb145-7"><a href="the-data-we-use.html#cb145-7"></a></span>
<span id="cb145-8"><a href="the-data-we-use.html#cb145-8"></a><span class="co"># Run the report</span></span>
<span id="cb145-9"><a href="the-data-we-use.html#cb145-9"></a><span class="kw">render</span>(<span class="dt">input =</span> report_path, </span>
<span id="cb145-10"><a href="the-data-we-use.html#cb145-10"></a>       <span class="dt">output_dir =</span> <span class="st">&quot;C:/workspace2&quot;</span>, </span>
<span id="cb145-11"><a href="the-data-we-use.html#cb145-11"></a>       <span class="dt">output_file =</span> <span class="st">&quot;C:/workspace2/lab_sum.html&quot;</span>, </span>
<span id="cb145-12"><a href="the-data-we-use.html#cb145-12"></a>       <span class="dt">envir =</span> <span class="kw">new.env</span>(), </span>
<span id="cb145-13"><a href="the-data-we-use.html#cb145-13"></a>       <span class="dt">params =</span> <span class="kw">list</span>(<span class="dt">series =</span> series,</span>
<span id="cb145-14"><a href="the-data-we-use.html#cb145-14"></a>                     <span class="dt">genhz_rules =</span> genhz_rules</span>
<span id="cb145-15"><a href="the-data-we-use.html#cb145-15"></a>                     )</span>
<span id="cb145-16"><a href="the-data-we-use.html#cb145-16"></a>       )</span></code></pre></div>
<p><strong>Manual approach</strong></p>
<p><strong>Open</strong> the report.Rmd, <strong>hit</strong> the Knit drop down arrow, and select <strong>Knit with Parameters</strong>.</p>
<p><img src="static-figures/knit_button.png" /></p>
<ol start="7" style="list-style-type: decimal">
<li><strong>Save</strong> the report. The report is automatically saved upon creation in the same folder as the R report. However, it is given the same generic name as the R report (i.e., “C:/workspace/lab_sum/report.html”), and will be overwritten the next time the report is run. Therefore, if you wish to save the report, rename the .html file to a name of your choosing and/or convert it to a PDF.</li>
</ol>
<p>Also, beware when opening the .html file with Internet Explorer – be sure to click on “Allow blocked content” if prompted. Otherwise, Internet Explorer will alter the formatting of tables etc. within the document.</p>
<p><strong>Sample pedon report</strong></p>
<p><img src="static-figures/rmd_sample.png" /></p>
</div>
<div id="exercise-run-the-region11lab_summary_by_taxonname" class="section level3">
<h3><span class="header-section-number">3.9.4</span> Exercise: run the region11/lab_summary_by_taxonname</h3>
<ul>
<li>Load your selected set with the pedon and site table for an existing GHL file, or make your own (highly encouraged)</li>
<li>Run the <code>lab_summary_by_taxonname.Rmd</code> report on a soil series of your choice.</li>
<li>Show your work and submit the results to your mentor.</li>
</ul>
</div>
<div id="exercise-run-mapunit-comparison" class="section level3">
<h3><span class="header-section-number">3.9.5</span> Exercise: Run Mapunit Comparison</h3>
<p>Another popular report in <code>soilReports</code> is the <code>region2/mu-comparison</code> report.</p>
<p>This report uses constant density sampling (<code>sharpshootR::constantDensitySampling()</code>) to extract numeric and categorical values from multiple raster data sources that overlap a set of user-supplied polygons.</p>
<p>In this example, we clip a small portion of SSURGO polygons from the CA630 soil survey area extent. We then select a small set of mapunit symbols (5012, 3046, 7083, 7085, 7088) that occur within the clipping extent. These mapunits have soil forming factors we expect to contrast with one another in several ways. You can inspect other mapunit symbols by changing <code>mu.set</code> in <code>config.R</code>.</p>
<ol style="list-style-type: decimal">
<li><strong>Download</strong> the demo data:</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="the-data-we-use.html#cb146-1"></a><span class="co"># set up ch4 path and path for report</span></span>
<span id="cb146-2"><a href="the-data-we-use.html#cb146-2"></a>ch4.data.path &lt;-<span class="st"> &quot;C:/workspace2/chapter4&quot;</span></span>
<span id="cb146-3"><a href="the-data-we-use.html#cb146-3"></a>ch4.mucomp.path &lt;-<span class="st"> </span><span class="kw">paste0</span>(ch4.data.path,<span class="st">&quot;/mucomp&quot;</span>)</span>
<span id="cb146-4"><a href="the-data-we-use.html#cb146-4"></a></span>
<span id="cb146-5"><a href="the-data-we-use.html#cb146-5"></a><span class="co"># create any directories that may be missing</span></span>
<span id="cb146-6"><a href="the-data-we-use.html#cb146-6"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">dir.exists</span>(ch4.mucomp.path)) {</span>
<span id="cb146-7"><a href="the-data-we-use.html#cb146-7"></a>  <span class="kw">dir.create</span>(ch4.mucomp.path, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb146-8"><a href="the-data-we-use.html#cb146-8"></a>}</span>
<span id="cb146-9"><a href="the-data-we-use.html#cb146-9"></a></span>
<span id="cb146-10"><a href="the-data-we-use.html#cb146-10"></a><span class="co"># download raster data, SSURGO clip from CA630, and sample script for clipping your own raster data </span></span>
<span id="cb146-11"><a href="the-data-we-use.html#cb146-11"></a><span class="kw">download.file</span>(<span class="st">&#39;https://github.com/ncss-tech/stats_for_soil_survey/raw/master/data/chapter_4-mucomp-data/ch4_mucomp-data.zip&#39;</span>, <span class="kw">paste0</span>(ch4.mucomp.path, <span class="st">&#39;/chapter_4-mucomp-data.zip&#39;</span>))</span>
<span id="cb146-12"><a href="the-data-we-use.html#cb146-12"></a></span>
<span id="cb146-13"><a href="the-data-we-use.html#cb146-13"></a><span class="kw">unzip</span>(<span class="kw">paste0</span>(ch4.mucomp.path, <span class="st">&#39;/chapter_4-mucomp-data.zip&#39;</span>), <span class="dt">exdir =</span> ch4.mucomp.path, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Create an instance</strong> of the <code>region2/mu-comparison</code> report with <code>soilReports</code>:</li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="the-data-we-use.html#cb147-1"></a><span class="co"># create new instance of reports </span></span>
<span id="cb147-2"><a href="the-data-we-use.html#cb147-2"></a><span class="kw">library</span>(soilReports)</span>
<span id="cb147-3"><a href="the-data-we-use.html#cb147-3"></a></span>
<span id="cb147-4"><a href="the-data-we-use.html#cb147-4"></a><span class="co"># get report dependencies</span></span>
<span id="cb147-5"><a href="the-data-we-use.html#cb147-5"></a><span class="kw">reportSetup</span>(<span class="st">&#39;region2/mu-comparison&#39;</span>)</span>
<span id="cb147-6"><a href="the-data-we-use.html#cb147-6"></a></span>
<span id="cb147-7"><a href="the-data-we-use.html#cb147-7"></a><span class="co"># create report instance</span></span>
<span id="cb147-8"><a href="the-data-we-use.html#cb147-8"></a><span class="kw">copyReport</span>(<span class="st">&#39;region2/mu-comparison&#39;</span>, <span class="dt">outputDir =</span> ch4.mucomp.path, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>If you want, you can now set up the default <code>config.R</code> that is created by <code>copyReport()</code> to work with your own data. OR you can use the “sample” <code>config.R</code> file (called <code>new_config.R</code>) in the ZIP file downloaded above.</p>
<ol start="3" style="list-style-type: decimal">
<li>Run the code below to <strong>replace the default</strong> <code>config.R</code> with the sample <code>config.R</code>:</li>
</ol>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="the-data-we-use.html#cb148-1"></a><span class="co"># copy config file containing relative paths to rasters downloaded above</span></span>
<span id="cb148-2"><a href="the-data-we-use.html#cb148-2"></a><span class="kw">file.copy</span>(<span class="kw">paste0</span>(ch4.mucomp.path, <span class="st">&quot;/new_config.R&quot;</span>), <span class="kw">paste0</span>(ch4.mucomp.path,<span class="st">&quot;/config.R&quot;</span>), <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><p><strong>Open</strong> <code>report.Rmd</code> in the <code>C:/workspace2/chapter4/mucomp</code> folder and click the “Knit” button at the top of the RStudio source pane to run the report.</p></li>
<li><p>Inspect the report output HTML file, as well as the spatial and tabular data output in the <code>output</code> folder.</p></li>
</ol>
<p><em>Question: What are the major differences that you can see, based on the report, between the five different mapunit symbols that were analysed?</em></p>
</div>
<div id="exercise-run-shiny-pedon-summary" class="section level3">
<h3><span class="header-section-number">3.9.6</span> Exercise: Run Shiny Pedon Summary</h3>
<p>The <code>region2/shiny-pedon-summary</code> report is an interactive Shiny-based report that uses <code>flexdashboard</code> to help the user subset and summarize NASIS pedons from a graphical interface. This allows one to rapidly generate reports from a large set of pedons in their NASIS selected set.</p>
<p>The left INPUT sidebar has numerous options for subsetting pedon data. Specifically, you can change REGEX patterns for <em>mapunit symbol</em>, <em>taxon name</em>, <em>local phase</em>, and <em>User Pedon ID</em>. Also, you can use the drop down boxes to filter on <em>taxon kind</em> or compare different “modal”/RV pedons.</p>
<div class="figure">
<img src="https://ncss-tech.github.io/soilReports/docs/shiny-pedon-summary/shiny-pedon_loafercreek-taxadjuncts.PNG" alt="" />
<p class="caption">Example: Analyzing the Loafercreek Taxadjuncts</p>
</div>
<ol style="list-style-type: decimal">
<li><strong>Create an instance</strong> of the <code>region2/shiny-pedon-summary</code> report with <code>soilReports</code>:</li>
</ol>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="the-data-we-use.html#cb149-1"></a><span class="co"># create new instance of reports </span></span>
<span id="cb149-2"><a href="the-data-we-use.html#cb149-2"></a><span class="kw">library</span>(soilReports)</span>
<span id="cb149-3"><a href="the-data-we-use.html#cb149-3"></a></span>
<span id="cb149-4"><a href="the-data-we-use.html#cb149-4"></a><span class="co"># set path for shiny-pedon-summary report instance</span></span>
<span id="cb149-5"><a href="the-data-we-use.html#cb149-5"></a>ch4.shinyped.path &lt;-<span class="st"> &quot;C:/workspace2/chapter4/shiny-pedon&quot;</span></span>
<span id="cb149-6"><a href="the-data-we-use.html#cb149-6"></a></span>
<span id="cb149-7"><a href="the-data-we-use.html#cb149-7"></a><span class="co"># create directories (if needed)</span></span>
<span id="cb149-8"><a href="the-data-we-use.html#cb149-8"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">dir.exists</span>(ch4.shinyped.path))</span>
<span id="cb149-9"><a href="the-data-we-use.html#cb149-9"></a>  <span class="kw">dir.create</span>(ch4.shinyped.path, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb149-10"><a href="the-data-we-use.html#cb149-10"></a></span>
<span id="cb149-11"><a href="the-data-we-use.html#cb149-11"></a><span class="co"># get report dependencies</span></span>
<span id="cb149-12"><a href="the-data-we-use.html#cb149-12"></a><span class="kw">reportSetup</span>(<span class="st">&#39;region2/shiny-pedon-summary&#39;</span>)</span>
<span id="cb149-13"><a href="the-data-we-use.html#cb149-13"></a></span>
<span id="cb149-14"><a href="the-data-we-use.html#cb149-14"></a><span class="co"># copy report contents to target path</span></span>
<span id="cb149-15"><a href="the-data-we-use.html#cb149-15"></a><span class="kw">copyReport</span>(<span class="st">&#39;region2/shiny-pedon-summary&#39;</span>, <span class="dt">outputDir =</span> ch4.shinyped.path, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Update the <code>config.R</code> file</li>
</ol>
<p>You can update the <code>config.R</code> file in “C:/workspace2/chapter4/shiny-pedon” (or wherever you installed the report) to use the <code>soilDB</code> datasets <code>loafercreek</code> and <code>gopheridge</code> by setting <code>demo_mode &lt;- TRUE</code>. This is the <em>simplest</em> way to demonstrate how this report works. Alternately, when <code>demo_mode &lt;- FALSE</code>, pedons will be loaded from your NASIS selected set.</p>
<p><code>config.R</code> also allows you to specify a shapefile for overlaying the points on – to determine mapunit symbol – as well as several raster data sources whose values will be extracted at point locations and summarized. The demo dataset does not use either of these by default, due to large file sizes.</p>
<p>Furthermore, a default (very general) set of REGEX generalized horizon patterns is provided to assign generalized horizon labels for provisional grouping. These provided patterns are unlikely to cover ALL cases, and essentially <em>always</em> need to be modified for final correlation. That said, they do a decent job of making a first-pass correlation for diverse types of soils.</p>
<p>The default <code>config.R</code> settings use the general patterns: <code>use_regex_ghz &lt;- TRUE</code>. You are welcome to modify the defaults. If you want to use the values you have populated in NASIS <em>Pedon Horizon Component Layer ID</em>, set <code>use_regex_ghz &lt;- FALSE</code>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Run the report via <code>shiny.Rmd</code></li>
</ol>
<p>This report uses the Shiny <code>flexdashboard</code> interface. Open up <code>shiny.Rmd</code> and click the “Run Document” button to start the report. This will load the pedon and spatial data specified in <code>config.R</code>.</p>
<p><strong>NOTE:</strong> <em>If a Viewer Window does not pop-up right away, click the gear icon to the right of the “Run Document” button. Be sure the option “Preview in Window” is checked, then click “Run Document” again.</em></p>
<ol start="4" style="list-style-type: decimal">
<li><p>All of the subsetting parameters are in the left-hand sidebar. Play around with all of these options – the graphs and plots in the tabs to the right will automatically update as you make changes.</p></li>
<li><p>When you like what you have, you can export a non-interactive HTML file for your records. To do this, first, set the “Report name:” box to something informative – this will be your report output file name. Then, scroll down to the bottom of the INPUT sidebar and click “Export Report” button. Check the “output” folder (subdirectory of where you installed the report) for your results.</p></li>
</ol>
</div>
</div>
<div id="customized-queries-to-local-nasis-database" class="section level2">
<h2><span class="header-section-number">3.10</span> Customized Queries to Local NASIS Database</h2>
<p>Queries against the NASIS local database can be written in <a href="https://en.wikipedia.org/wiki/Transact-SQL">T-SQL</a> which is the dialect of <a href="https://en.wikipedia.org/wiki/SQL">SQL</a> used to communicate with Microsoft SQL Server that you set up a connection to for the pre-course.</p>
<p>The <code>fetchNASIS</code> and related convenience functions are essentially wrappers around commonly used chunks of SQL.</p>
<p>The following example will return all records from the <code>sitesoiltemp</code> table, along with a couple of fields from the <code>site</code>, <code>siteobs</code>, and <code>pedon</code> tables. This is a convenient way to collect all of the field-based soil temperature data associated with the pedons in your selected set for further analysis.</p>
<div id="rodbc-package" class="section level3">
<h3><span class="header-section-number">3.10.1</span> <code>RODBC</code> package</h3>
<p>This example uses <code>RODBC</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="the-data-we-use.html#cb150-1"></a><span class="kw">library</span>(soilDB)</span>
<span id="cb150-2"><a href="the-data-we-use.html#cb150-2"></a><span class="kw">library</span>(RODBC) </span>
<span id="cb150-3"><a href="the-data-we-use.html#cb150-3"></a></span>
<span id="cb150-4"><a href="the-data-we-use.html#cb150-4"></a><span class="co"># write query as a character string</span></span>
<span id="cb150-5"><a href="the-data-we-use.html#cb150-5"></a>q &lt;-<span class="st"> &quot;SELECT siteiid as siteiid, peiid, usiteid as site_id, </span></span>
<span id="cb150-6"><a href="the-data-we-use.html#cb150-6"></a><span class="st">             upedonid as pedon_id, obsdate as obs_date,</span></span>
<span id="cb150-7"><a href="the-data-we-use.html#cb150-7"></a><span class="st">             soitemp, soitempdep FROM site_View_1</span></span>
<span id="cb150-8"><a href="the-data-we-use.html#cb150-8"></a><span class="st">       INNER JOIN siteobs_View_1 ON site_View_1.siteiid = siteobs_View_1.siteiidref</span></span>
<span id="cb150-9"><a href="the-data-we-use.html#cb150-9"></a><span class="st">       LEFT OUTER JOIN sitesoiltemp_View_1 ON siteobs_View_1.siteobsiid = sitesoiltemp_View_1.siteobsiidref</span></span>
<span id="cb150-10"><a href="the-data-we-use.html#cb150-10"></a><span class="st">       LEFT OUTER JOIN pedon_View_1 ON siteobs_View_1.siteobsiid = pedon_View_1.siteobsiidref</span></span>
<span id="cb150-11"><a href="the-data-we-use.html#cb150-11"></a><span class="st">      ORDER BY obs_date, siteiid;&quot;</span></span>
<span id="cb150-12"><a href="the-data-we-use.html#cb150-12"></a></span>
<span id="cb150-13"><a href="the-data-we-use.html#cb150-13"></a><span class="co"># setup connection local NASIS</span></span>
<span id="cb150-14"><a href="the-data-we-use.html#cb150-14"></a>channel &lt;-<span class="st"> </span><span class="kw">odbcDriverConnect</span>(<span class="dt">connection =</span> <span class="kw">getOption</span>(<span class="st">&quot;soilDB.NASIS.credentials&quot;</span>))</span>
<span id="cb150-15"><a href="the-data-we-use.html#cb150-15"></a></span>
<span id="cb150-16"><a href="the-data-we-use.html#cb150-16"></a><span class="co"># exec query</span></span>
<span id="cb150-17"><a href="the-data-we-use.html#cb150-17"></a>d &lt;-<span class="st"> </span><span class="kw">sqlQuery</span>(channel, q, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb150-18"><a href="the-data-we-use.html#cb150-18"></a></span>
<span id="cb150-19"><a href="the-data-we-use.html#cb150-19"></a><span class="co"># close connection</span></span>
<span id="cb150-20"><a href="the-data-we-use.html#cb150-20"></a><span class="kw">odbcClose</span>(channel)</span>
<span id="cb150-21"><a href="the-data-we-use.html#cb150-21"></a></span>
<span id="cb150-22"><a href="the-data-we-use.html#cb150-22"></a><span class="co"># check results</span></span>
<span id="cb150-23"><a href="the-data-we-use.html#cb150-23"></a><span class="kw">str</span>(d)</span>
<span id="cb150-24"><a href="the-data-we-use.html#cb150-24"></a></span>
<span id="cb150-25"><a href="the-data-we-use.html#cb150-25"></a><span class="co"># remove records missing values</span></span>
<span id="cb150-26"><a href="the-data-we-use.html#cb150-26"></a>d &lt;-<span class="st"> </span><span class="kw">na.omit</span>(d)</span>
<span id="cb150-27"><a href="the-data-we-use.html#cb150-27"></a></span>
<span id="cb150-28"><a href="the-data-we-use.html#cb150-28"></a><span class="co"># tabulate unique soil depths</span></span>
<span id="cb150-29"><a href="the-data-we-use.html#cb150-29"></a><span class="kw">table</span>(d<span class="op">$</span>soitempdep)</span>
<span id="cb150-30"><a href="the-data-we-use.html#cb150-30"></a></span>
<span id="cb150-31"><a href="the-data-we-use.html#cb150-31"></a><span class="co"># extract doy of year</span></span>
<span id="cb150-32"><a href="the-data-we-use.html#cb150-32"></a>d<span class="op">$</span>doy &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">format</span>(d<span class="op">$</span>obs_date, <span class="st">&quot;%j&quot;</span>))</span>
<span id="cb150-33"><a href="the-data-we-use.html#cb150-33"></a></span>
<span id="cb150-34"><a href="the-data-we-use.html#cb150-34"></a><span class="co"># when where measurements collected?</span></span>
<span id="cb150-35"><a href="the-data-we-use.html#cb150-35"></a><span class="kw">hist</span>(</span>
<span id="cb150-36"><a href="the-data-we-use.html#cb150-36"></a>  d<span class="op">$</span>doy,</span>
<span id="cb150-37"><a href="the-data-we-use.html#cb150-37"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">366</span>),</span>
<span id="cb150-38"><a href="the-data-we-use.html#cb150-38"></a>  <span class="dt">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb150-39"><a href="the-data-we-use.html#cb150-39"></a>  <span class="dt">las =</span> <span class="dv">1</span>,</span>
<span id="cb150-40"><a href="the-data-we-use.html#cb150-40"></a>  <span class="dt">main =</span> <span class="st">&#39;Soil Temperature Measurements&#39;</span>,</span>
<span id="cb150-41"><a href="the-data-we-use.html#cb150-41"></a>  <span class="dt">xlab =</span> <span class="st">&#39;Day of Year&#39;</span></span>
<span id="cb150-42"><a href="the-data-we-use.html#cb150-42"></a>)</span>
<span id="cb150-43"><a href="the-data-we-use.html#cb150-43"></a></span>
<span id="cb150-44"><a href="the-data-we-use.html#cb150-44"></a><span class="co"># soil temperature by day of year</span></span>
<span id="cb150-45"><a href="the-data-we-use.html#cb150-45"></a><span class="kw">plot</span>(</span>
<span id="cb150-46"><a href="the-data-we-use.html#cb150-46"></a>  soitemp <span class="op">~</span><span class="st"> </span>doy,</span>
<span id="cb150-47"><a href="the-data-we-use.html#cb150-47"></a>  <span class="dt">data =</span> d,</span>
<span id="cb150-48"><a href="the-data-we-use.html#cb150-48"></a>  <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>,</span>
<span id="cb150-49"><a href="the-data-we-use.html#cb150-49"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">366</span>),</span>
<span id="cb150-50"><a href="the-data-we-use.html#cb150-50"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">25</span>),</span>
<span id="cb150-51"><a href="the-data-we-use.html#cb150-51"></a>  <span class="dt">xlab =</span> <span class="st">&#39;Day of Year&#39;</span>,</span>
<span id="cb150-52"><a href="the-data-we-use.html#cb150-52"></a>  <span class="dt">ylab =</span> <span class="st">&#39;Soil Temperature at 50cm (deg C)&#39;</span>,</span>
<span id="cb150-53"><a href="the-data-we-use.html#cb150-53"></a>  <span class="dt">las =</span> <span class="dv">1</span></span>
<span id="cb150-54"><a href="the-data-we-use.html#cb150-54"></a>)</span></code></pre></div>
</div>
<div id="dbi" class="section level3">
<h3><span class="header-section-number">3.10.2</span> <code>DBI</code></h3>
<p>You should know that the <code>DBI</code> and <code>odbc</code> packages provide same functions as <code>RODBC</code> via a more generic interface.</p>
<p>There are many other drivers available for <code>DBI</code>, for example <code>RSQLite</code> for SQLite databases. This will soon be the database framework used in <code>soilDB</code> for NASIS access.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exploratory-data-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["s4ssbook.pdf", "s4ssbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
