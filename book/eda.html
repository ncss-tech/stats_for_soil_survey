<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Exploratory Data Analysis | Statistics for Soil Survey - Part 1</title>
  <meta name="description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Exploratory Data Analysis | Statistics for Soil Survey - Part 1" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Exploratory Data Analysis | Statistics for Soil Survey - Part 1" />
  
  <meta name="twitter:description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  

<meta name="author" content="Soil Survey Staff" />


<meta name="date" content="2025-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="spatial.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Statistics for Soil Survey - Part 1</a></li>
<li><a href="../book2/index.html">Statistics for Soil Survey - Part 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Pre-course Assignment</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#create-workspace"><i class="fa fa-check"></i><b>0.1</b> Create Workspace</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#configure-rstudio"><i class="fa fa-check"></i><b>0.2</b> Configure RStudio</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#essentials"><i class="fa fa-check"></i><b>0.3</b> Essentials</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#personalization"><i class="fa fa-check"></i><b>0.4</b> Personalization</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#install-required-packages"><i class="fa fa-check"></i><b>0.5</b> Install Required Packages</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i><b>0.6</b> Dealing With Errors</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path="index.html"><a href="index.html#no-output-is-produced-after-pasting-into-console"><i class="fa fa-check"></i><b>0.6.1</b> No output is produced after pasting into console</a></li>
<li class="chapter" data-level="0.6.2" data-path="index.html"><a href="index.html#somepackage-is-not-available-for-r-version-x.y.z"><i class="fa fa-check"></i><b>0.6.2</b> <code>‘SOMEPACKAGE’ is not available (for R version X.Y.Z)</code></a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#packages-not-on-cran"><i class="fa fa-check"></i><b>0.7</b> Packages not on CRAN</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#install-nasis"><i class="fa fa-check"></i><b>0.8</b> Install NASIS</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#connect-local-nasis"><i class="fa fa-check"></i><b>0.9</b> Connect Local NASIS</a></li>
<li class="chapter" data-level="0.10" data-path="index.html"><a href="index.html#proof"><i class="fa fa-check"></i><b>0.10</b> Proof</a></li>
<li class="chapter" data-level="0.11" data-path="index.html"><a href="index.html#additional-soil-data-and-r-references"><i class="fa fa-check"></i><b>0.11</b> Additional Soil Data and R References</a>
<ul>
<li class="chapter" data-level="0.11.1" data-path="index.html"><a href="index.html#soil-data-videos"><i class="fa fa-check"></i><b>0.11.1</b> Soil Data Videos</a></li>
<li class="chapter" data-level="0.11.2" data-path="index.html"><a href="index.html#r-books-and-manuals"><i class="fa fa-check"></i><b>0.11.2</b> R Books and Manuals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#course-overview"><i class="fa fa-check"></i><b>1.2</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#course-objectives"><i class="fa fa-check"></i><b>1.2.1</b> Course Objectives</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#why-is-this-training-needed"><i class="fa fa-check"></i><b>1.2.2</b> Why is this training needed?</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#why-is-course-organized-this-way"><i class="fa fa-check"></i><b>1.2.3</b> Why is course organized this way?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>1.3</b> What is R?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#why-should-i-learn-r"><i class="fa fa-check"></i><b>1.3.1</b> Why Should I Learn R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#what-can-r-do"><i class="fa fa-check"></i><b>1.3.2</b> What can R do?</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.3.3</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#rstudio-an-integrated-development-environment-ide-for-r"><i class="fa fa-check"></i><b>1.4</b> RStudio: An Integrated Development Environment (IDE) for R</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#r-basics"><i class="fa fa-check"></i><b>1.5</b> R basics</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#managing-packages"><i class="fa fa-check"></i><b>1.6</b> Managing Packages</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="intro.html"><a href="intro.html#installing-packages"><i class="fa fa-check"></i><b>1.6.1</b> Installing Packages</a></li>
<li class="chapter" data-level="1.6.2" data-path="intro.html"><a href="intro.html#loading-packages"><i class="fa fa-check"></i><b>1.6.2</b> Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting Help</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#documenting-your-work"><i class="fa fa-check"></i><b>1.8</b> Documenting your work</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="intro.html"><a href="intro.html#basic-tips-for-scripting"><i class="fa fa-check"></i><b>1.8.1</b> Basic Tips for Scripting</a></li>
<li class="chapter" data-level="1.8.2" data-path="intro.html"><a href="intro.html#comments"><i class="fa fa-check"></i><b>1.8.2</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#organizing-your-work"><i class="fa fa-check"></i><b>1.9</b> Organizing your work</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="intro.html"><a href="intro.html#setting-the-working-directory"><i class="fa fa-check"></i><b>1.9.1</b> Setting the Working Directory</a></li>
<li class="chapter" data-level="1.9.2" data-path="intro.html"><a href="intro.html#rstudio-projects-.rproj-files"><i class="fa fa-check"></i><b>1.9.2</b> RStudio Projects (.Rproj files)</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#saving-your-work"><i class="fa fa-check"></i><b>1.10</b> Saving your work</a></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#exercise-1-r-packages-and-functions"><i class="fa fa-check"></i><b>1.11</b> Exercise 1: R packages and Functions</a></li>
<li class="chapter" data-level="1.12" data-path="intro.html"><a href="intro.html#loading-data"><i class="fa fa-check"></i><b>1.12</b> Loading Data</a></li>
<li class="chapter" data-level="1.13" data-path="intro.html"><a href="intro.html#data-manipulation"><i class="fa fa-check"></i><b>1.13</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="1.13.1" data-path="intro.html"><a href="intro.html#viewing-and-removing-data"><i class="fa fa-check"></i><b>1.13.1</b> Viewing and Removing Data</a></li>
<li class="chapter" data-level="1.13.2" data-path="intro.html"><a href="intro.html#filtering-or-subsetting-data"><i class="fa fa-check"></i><b>1.13.2</b> Filtering or Subsetting Data</a></li>
<li class="chapter" data-level="1.13.3" data-path="intro.html"><a href="intro.html#transforming-data"><i class="fa fa-check"></i><b>1.13.3</b> Transforming Data</a></li>
<li class="chapter" data-level="1.13.4" data-path="intro.html"><a href="intro.html#sorting-data"><i class="fa fa-check"></i><b>1.13.4</b> Sorting Data</a></li>
<li class="chapter" data-level="1.13.5" data-path="intro.html"><a href="intro.html#piping-data"><i class="fa fa-check"></i><b>1.13.5</b> Piping Data</a></li>
<li class="chapter" data-level="1.13.6" data-path="intro.html"><a href="intro.html#mergingjoining-or-combining-data"><i class="fa fa-check"></i><b>1.13.6</b> Merging/Joining or Combining Data</a></li>
<li class="chapter" data-level="1.13.7" data-path="intro.html"><a href="intro.html#aggregating-or-grouping-data"><i class="fa fa-check"></i><b>1.13.7</b> Aggregating or Grouping Data</a></li>
<li class="chapter" data-level="1.13.8" data-path="intro.html"><a href="intro.html#reshaping-data"><i class="fa fa-check"></i><b>1.13.8</b> Reshaping Data</a></li>
<li class="chapter" data-level="1.13.9" data-path="intro.html"><a href="intro.html#exporting-data"><i class="fa fa-check"></i><b>1.13.9</b> Exporting Data</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="intro.html"><a href="intro.html#exercise-2-data-manipulation"><i class="fa fa-check"></i><b>1.14</b> Exercise 2: Data Manipulation</a></li>
<li class="chapter" data-level="1.15" data-path="intro.html"><a href="intro.html#review"><i class="fa fa-check"></i><b>1.15</b> Review</a></li>
<li class="chapter" data-level="1.16" data-path="intro.html"><a href="intro.html#additional-reading-introduction"><i class="fa fa-check"></i><b>1.16</b> Additional Reading (Introduction)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> The Data We Use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#objectives-the-data-we-use"><i class="fa fa-check"></i><b>2.1</b> Objectives (The Data We Use)</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#the-structure-of-soil-data"><i class="fa fa-check"></i><b>2.2</b> The Structure of Soil Data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data.html"><a href="data.html#package-references"><i class="fa fa-check"></i><b>2.2.1</b> Package References</a></li>
<li class="chapter" data-level="2.2.2" data-path="data.html"><a href="data.html#importance-of-pedon-data"><i class="fa fa-check"></i><b>2.2.2</b> Importance of Pedon Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="data.html"><a href="data.html#some-issues-with-pedon-data"><i class="fa fa-check"></i><b>2.2.3</b> Some Issues With Pedon Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#challenges-with-pedon-data"><i class="fa fa-check"></i><b>2.3</b> Challenges with Pedon Data</a></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#the-soilprofilecollection"><i class="fa fa-check"></i><b>2.4</b> The <em>SoilProfileCollection</em></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data.html"><a href="data.html#soilprofilecollection-methods"><i class="fa fa-check"></i><b>2.4.1</b> <em>SoilProfileCollection</em> methods</a></li>
<li class="chapter" data-level="2.4.2" data-path="data.html"><a href="data.html#promoting-to-spatial-soilprofilecollection"><i class="fa fa-check"></i><b>2.4.2</b> Promoting to “Spatial” <em>SoilProfileCollection</em></a></li>
<li class="chapter" data-level="2.4.3" data-path="data.html"><a href="data.html#extracting-site-and-horizon-data"><i class="fa fa-check"></i><b>2.4.3</b> Extracting Site and Horizon Data</a></li>
<li class="chapter" data-level="2.4.4" data-path="data.html"><a href="data.html#methods-like-data.frame"><i class="fa fa-check"></i><b>2.4.4</b> Methods like <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#exercise-1-assemble-a-soilprofilecollection-from-several-csv-files"><i class="fa fa-check"></i><b>2.5</b> Exercise 1: Assemble a <em>SoilProfileCollection</em> from several CSV files</a></li>
<li class="chapter" data-level="2.6" data-path="data.html"><a href="data.html#using-the-soildb-package"><i class="fa fa-check"></i><b>2.6</b> Using the <code>soilDB</code> Package</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data.html"><a href="data.html#soildb-functions-for-tabular-data"><i class="fa fa-check"></i><b>2.6.1</b> soilDB functions for tabular data</a></li>
<li class="chapter" data-level="2.6.2" data-path="data.html"><a href="data.html#open-database-connectivity-odbc-connection-to-nasis"><i class="fa fa-check"></i><b>2.6.2</b> Open Database Connectivity (ODBC) Connection to NASIS</a></li>
<li class="chapter" data-level="2.6.3" data-path="data.html"><a href="data.html#fetchnasis"><i class="fa fa-check"></i><b>2.6.3</b> <code>fetchNASIS()</code></a></li>
<li class="chapter" data-level="2.6.4" data-path="data.html"><a href="data.html#the-gopheridge-dataset"><i class="fa fa-check"></i><b>2.6.4</b> The <code>gopheridge</code> Dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data.html"><a href="data.html#basic-data-inspection"><i class="fa fa-check"></i><b>2.7</b> Basic Data Inspection</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="data.html"><a href="data.html#table-tabulation-and-cross-tabulation"><i class="fa fa-check"></i><b>2.7.1</b> <code>table()</code>: Tabulation and Cross Tabulation</a></li>
<li class="chapter" data-level="2.7.2" data-path="data.html"><a href="data.html#missing-values"><i class="fa fa-check"></i><b>2.7.2</b> Missing Values</a></li>
<li class="chapter" data-level="2.7.3" data-path="data.html"><a href="data.html#logical-operators"><i class="fa fa-check"></i><b>2.7.3</b> Logical Operators</a></li>
<li class="chapter" data-level="2.7.4" data-path="data.html"><a href="data.html#pattern-matching"><i class="fa fa-check"></i><b>2.7.4</b> Pattern Matching</a></li>
<li class="chapter" data-level="2.7.5" data-path="data.html"><a href="data.html#filtering"><i class="fa fa-check"></i><b>2.7.5</b> Filtering</a></li>
<li class="chapter" data-level="2.7.6" data-path="data.html"><a href="data.html#dates-and-times"><i class="fa fa-check"></i><b>2.7.6</b> Dates and Times</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="data.html"><a href="data.html#exercise-2-o-horizon-thickness"><i class="fa fa-check"></i><b>2.8</b> Exercise 2: O Horizon Thickness</a></li>
<li class="chapter" data-level="2.9" data-path="data.html"><a href="data.html#generalized-horizon-labels"><i class="fa fa-check"></i><b>2.9</b> Generalized Horizon Labels</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="data.html"><a href="data.html#formal-approach"><i class="fa fa-check"></i><b>2.9.1</b> Formal Approach</a></li>
<li class="chapter" data-level="2.9.2" data-path="data.html"><a href="data.html#functions-for-handling-generalized-horizon-labels"><i class="fa fa-check"></i><b>2.9.2</b> Functions for Handling Generalized Horizon Labels</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="data.html"><a href="data.html#fetchnasis-data-checks"><i class="fa fa-check"></i><b>2.10</b> <code>fetchNASIS()</code> data checks</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="data.html"><a href="data.html#inspecting-results"><i class="fa fa-check"></i><b>2.10.1</b> Inspecting Results</a></li>
<li class="chapter" data-level="2.10.2" data-path="data.html"><a href="data.html#select-pedons-with-andic-soil-properties"><i class="fa fa-check"></i><b>2.10.2</b> Select Pedons with Andic Soil Properties</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="data.html"><a href="data.html#extended-data-functions"><i class="fa fa-check"></i><b>2.11</b> Extended Data Functions</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="data.html"><a href="data.html#elements-of-get_extended_data_from_nasis"><i class="fa fa-check"></i><b>2.11.1</b> Elements of <code>get_extended_data_from_NASIS()</code></a></li>
<li class="chapter" data-level="2.11.2" data-path="data.html"><a href="data.html#load-example-data-1"><i class="fa fa-check"></i><b>2.11.2</b> Load Example Data</a></li>
<li class="chapter" data-level="2.11.3" data-path="data.html"><a href="data.html#visualizing-common-landforms"><i class="fa fa-check"></i><b>2.11.3</b> Visualizing Common Landforms</a></li>
<li class="chapter" data-level="2.11.4" data-path="data.html"><a href="data.html#diagnostic-features"><i class="fa fa-check"></i><b>2.11.4</b> Diagnostic Features</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="data.html"><a href="data.html#exercise-3-diagnostic-horizons-in-your-own-data"><i class="fa fa-check"></i><b>2.12</b> Exercise 3: Diagnostic Horizons in Your Own Data</a></li>
<li class="chapter" data-level="2.13" data-path="data.html"><a href="data.html#custom-queries-to-local-nasis-database"><i class="fa fa-check"></i><b>2.13</b> Custom Queries to Local NASIS Database</a>
<ul>
<li class="chapter" data-level="2.13.1" data-path="data.html"><a href="data.html#example-site-soil-temperature-data-from-ca792-sequoia-kings-canyon-national-park"><i class="fa fa-check"></i><b>2.13.1</b> Example: Site Soil Temperature Data from CA792 (Sequoia-Kings Canyon National Park)</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="data.html"><a href="data.html#exercise-4-generalized-horizons-with-loafercreek"><i class="fa fa-check"></i><b>2.14</b> Exercise 4: Generalized Horizons with Loafercreek</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="eda.html"><a href="eda.html#objectives-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Objectives (Exploratory Data Analysis)</a></li>
<li class="chapter" data-level="3.2" data-path="eda.html"><a href="eda.html#statistics"><i class="fa fa-check"></i><b>3.2</b> Statistics</a></li>
<li class="chapter" data-level="3.3" data-path="eda.html"><a href="eda.html#data-inspection"><i class="fa fa-check"></i><b>3.3</b> Data Inspection</a></li>
<li class="chapter" data-level="3.4" data-path="eda.html"><a href="eda.html#calculating-weights"><i class="fa fa-check"></i><b>3.4</b> Calculating Weights</a></li>
<li class="chapter" data-level="3.5" data-path="eda.html"><a href="eda.html#exercise-1-fetch-and-inspect-data"><i class="fa fa-check"></i><b>3.5</b> Exercise 1: Fetch and Inspect Data</a></li>
<li class="chapter" data-level="3.6" data-path="eda.html"><a href="eda.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.6</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="eda.html"><a href="eda.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>3.6.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="3.6.2" data-path="eda.html"><a href="eda.html#measures-of-dispersion"><i class="fa fa-check"></i><b>3.6.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="3.6.3" data-path="eda.html"><a href="eda.html#correlation"><i class="fa fa-check"></i><b>3.6.3</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="eda.html"><a href="eda.html#exercise-2-compute-descriptive-statistics"><i class="fa fa-check"></i><b>3.7</b> Exercise 2: Compute Descriptive Statistics</a></li>
<li class="chapter" data-level="3.8" data-path="eda.html"><a href="eda.html#graphical-methods"><i class="fa fa-check"></i><b>3.8</b> Graphical Methods</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="eda.html"><a href="eda.html#distributions"><i class="fa fa-check"></i><b>3.8.1</b> Distributions</a></li>
<li class="chapter" data-level="3.8.2" data-path="eda.html"><a href="eda.html#bar-plot"><i class="fa fa-check"></i><b>3.8.2</b> Bar Plot</a></li>
<li class="chapter" data-level="3.8.3" data-path="eda.html"><a href="eda.html#histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram</a></li>
<li class="chapter" data-level="3.8.4" data-path="eda.html"><a href="eda.html#density-curve"><i class="fa fa-check"></i><b>3.8.4</b> Density Curve</a></li>
<li class="chapter" data-level="3.8.5" data-path="eda.html"><a href="eda.html#box-plots"><i class="fa fa-check"></i><b>3.8.5</b> Box plots</a></li>
<li class="chapter" data-level="3.8.6" data-path="eda.html"><a href="eda.html#quantile-comparison-plots-qqplot"><i class="fa fa-check"></i><b>3.8.6</b> Quantile comparison plots (QQplot)</a></li>
<li class="chapter" data-level="3.8.7" data-path="eda.html"><a href="eda.html#the-normal-distribution"><i class="fa fa-check"></i><b>3.8.7</b> The ‘Normal’ distribution</a></li>
<li class="chapter" data-level="3.8.8" data-path="eda.html"><a href="eda.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>3.8.8</b> Scatterplots and Line Plots</a></li>
<li class="chapter" data-level="3.8.9" data-path="eda.html"><a href="eda.html#rd-dimension---color-shape-size-layers-etc"><i class="fa fa-check"></i><b>3.8.9</b> 3rd Dimension - Color, Shape, Size, Layers, etc…</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="eda.html"><a href="eda.html#exercise-3-graphical-methods"><i class="fa fa-check"></i><b>3.9</b> Exercise 3: Graphical Methods</a></li>
<li class="chapter" data-level="3.10" data-path="eda.html"><a href="eda.html#transformations"><i class="fa fa-check"></i><b>3.10</b> Transformations</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="eda.html"><a href="eda.html#ph"><i class="fa fa-check"></i><b>3.10.1</b> pH</a></li>
<li class="chapter" data-level="3.10.2" data-path="eda.html"><a href="eda.html#circular-data"><i class="fa fa-check"></i><b>3.10.2</b> Circular data</a></li>
<li class="chapter" data-level="3.10.3" data-path="eda.html"><a href="eda.html#texture-class-and-fine-earth-separates"><i class="fa fa-check"></i><b>3.10.3</b> Texture Class and Fine-earth Separates</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="eda.html"><a href="eda.html#the-shiny-package"><i class="fa fa-check"></i><b>3.11</b> The Shiny Package</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="eda.html"><a href="eda.html#online"><i class="fa fa-check"></i><b>3.11.1</b> Online</a></li>
<li class="chapter" data-level="3.11.2" data-path="eda.html"><a href="eda.html#locally"><i class="fa fa-check"></i><b>3.11.2</b> Locally</a></li>
<li class="chapter" data-level="3.11.3" data-path="eda.html"><a href="eda.html#web-app-demonstration"><i class="fa fa-check"></i><b>3.11.3</b> Web App Demonstration</a></li>
<li class="chapter" data-level="3.11.4" data-path="eda.html"><a href="eda.html#troubleshooting-errors"><i class="fa fa-check"></i><b>3.11.4</b> Troubleshooting Errors</a></li>
<li class="chapter" data-level="3.11.5" data-path="eda.html"><a href="eda.html#shiny-app-embedding"><i class="fa fa-check"></i><b>3.11.5</b> Shiny App Embedding</a></li>
<li class="chapter" data-level="3.11.6" data-path="eda.html"><a href="eda.html#questions"><i class="fa fa-check"></i><b>3.11.6</b> Questions</a></li>
<li class="chapter" data-level="3.11.7" data-path="eda.html"><a href="eda.html#examples"><i class="fa fa-check"></i><b>3.11.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="eda.html"><a href="eda.html#exercise-4-using-the-north-central-region-web-app"><i class="fa fa-check"></i><b>3.12</b> Exercise 4: Using the North Central Region Web App</a></li>
<li class="chapter" data-level="3.13" data-path="eda.html"><a href="eda.html#soilreports"><i class="fa fa-check"></i><b>3.13</b> soilReports</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="eda.html"><a href="eda.html#extending-soilreports"><i class="fa fa-check"></i><b>3.13.1</b> Extending <code>soilReports</code></a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="eda.html"><a href="eda.html#exercise-5-run-lab-summary-by-taxon-name-soil-report"><i class="fa fa-check"></i><b>3.14</b> Exercise 5: Run Lab Summary By Taxon Name Soil Report</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="eda.html"><a href="eda.html#requirements"><i class="fa fa-check"></i><b>3.14.1</b> Requirements</a></li>
<li class="chapter" data-level="3.14.2" data-path="eda.html"><a href="eda.html#instructions"><i class="fa fa-check"></i><b>3.14.2</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="eda.html"><a href="eda.html#exercise-6-run-mapunit-comparison"><i class="fa fa-check"></i><b>3.15</b> Exercise 6: Run Mapunit Comparison</a></li>
<li class="chapter" data-level="3.16" data-path="eda.html"><a href="eda.html#exercise-7-run-shiny-pedon-summary"><i class="fa fa-check"></i><b>3.16</b> Exercise 7: Run Shiny Pedon Summary</a></li>
<li class="chapter" data-level="3.17" data-path="eda.html"><a href="eda.html#additional-reading-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.17</b> Additional Reading (Exploratory Data Analysis)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>4</b> Spatial Data in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial.html"><a href="spatial.html#objectives-spatial-data"><i class="fa fa-check"></i><b>4.1</b> Objectives (Spatial Data)</a></li>
<li class="chapter" data-level="4.2" data-path="spatial.html"><a href="spatial.html#making-maps-with-r"><i class="fa fa-check"></i><b>4.2</b> Making Maps with R</a></li>
<li class="chapter" data-level="4.3" data-path="spatial.html"><a href="spatial.html#spatial-data-sources"><i class="fa fa-check"></i><b>4.3</b> Spatial Data Sources</a></li>
<li class="chapter" data-level="4.4" data-path="spatial.html"><a href="spatial.html#viewing-pedon-locations"><i class="fa fa-check"></i><b>4.4</b> Viewing Pedon Locations</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="spatial.html"><a href="spatial.html#plotting-geographic-data"><i class="fa fa-check"></i><b>4.4.1</b> Plotting Geographic Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="spatial.html"><a href="spatial.html#exercise-1-pedon-locations"><i class="fa fa-check"></i><b>4.5</b> Exercise 1: Pedon Locations</a></li>
<li class="chapter" data-level="4.6" data-path="spatial.html"><a href="spatial.html#packages-for-vector-data"><i class="fa fa-check"></i><b>4.6</b> Packages for Vector Data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="spatial.html"><a href="spatial.html#the-sf-package"><i class="fa fa-check"></i><b>4.6.1</b> The <code>sf</code> package</a></li>
<li class="chapter" data-level="4.6.2" data-path="spatial.html"><a href="spatial.html#the-sp-package"><i class="fa fa-check"></i><b>4.6.2</b> The <code>sp</code> Package</a></li>
<li class="chapter" data-level="4.6.3" data-path="spatial.html"><a href="spatial.html#converting-sp-and-sf"><i class="fa fa-check"></i><b>4.6.3</b> Converting <code>sp</code> and <code>sf</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="spatial.html"><a href="spatial.html#importing-exporting-vector-data"><i class="fa fa-check"></i><b>4.6.4</b> Importing / Exporting Vector Data</a></li>
<li class="chapter" data-level="4.6.5" data-path="spatial.html"><a href="spatial.html#interactive-mapping-with-mapview-and-leaflet"><i class="fa fa-check"></i><b>4.6.5</b> Interactive mapping with <code>mapview</code> and <code>leaflet</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="spatial.html"><a href="spatial.html#exercise-2-map-your-favorite-soil-series-extents"><i class="fa fa-check"></i><b>4.7</b> Exercise 2: Map your favorite soil series extents</a></li>
<li class="chapter" data-level="4.8" data-path="spatial.html"><a href="spatial.html#packages-for-raster-data"><i class="fa fa-check"></i><b>4.8</b> Packages for Raster Data</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="spatial.html"><a href="spatial.html#the-terra-package"><i class="fa fa-check"></i><b>4.8.1</b> The <code>terra</code> Package</a></li>
<li class="chapter" data-level="4.8.2" data-path="spatial.html"><a href="spatial.html#converting-vector-to-raster"><i class="fa fa-check"></i><b>4.8.2</b> Converting Vector to Raster</a></li>
<li class="chapter" data-level="4.8.3" data-path="spatial.html"><a href="spatial.html#converting-raster-to-vector"><i class="fa fa-check"></i><b>4.8.3</b> Converting Raster to Vector</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="spatial.html"><a href="spatial.html#coordinate-reference-systems-crs"><i class="fa fa-check"></i><b>4.9</b> Coordinate Reference Systems (CRS)</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="spatial.html"><a href="spatial.html#assigning-and-transforming-coordinate-systems"><i class="fa fa-check"></i><b>4.9.1</b> Assigning and Transforming Coordinate Systems</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="spatial.html"><a href="spatial.html#load-required-packages"><i class="fa fa-check"></i><b>4.10</b> Load Required Packages</a></li>
<li class="chapter" data-level="4.11" data-path="spatial.html"><a href="spatial.html#download-example-data"><i class="fa fa-check"></i><b>4.11</b> Download Example Data</a></li>
<li class="chapter" data-level="4.12" data-path="spatial.html"><a href="spatial.html#load-example-mlra-data"><i class="fa fa-check"></i><b>4.12</b> Load Example MLRA Data</a></li>
<li class="chapter" data-level="4.13" data-path="spatial.html"><a href="spatial.html#vector-data"><i class="fa fa-check"></i><b>4.13</b> Vector Data</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="spatial.html"><a href="spatial.html#sf-2"><i class="fa fa-check"></i><b>4.13.1</b> <code>sf</code></a></li>
<li class="chapter" data-level="4.13.2" data-path="spatial.html"><a href="spatial.html#terra"><i class="fa fa-check"></i><b>4.13.2</b> <code>terra</code></a></li>
<li class="chapter" data-level="4.13.3" data-path="spatial.html"><a href="spatial.html#sp-2"><i class="fa fa-check"></i><b>4.13.3</b> <code>sp</code></a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="spatial.html"><a href="spatial.html#raster-data"><i class="fa fa-check"></i><b>4.14</b> Raster Data</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="spatial.html"><a href="spatial.html#object-properties"><i class="fa fa-check"></i><b>4.14.1</b> Object Properties</a></li>
<li class="chapter" data-level="4.14.2" data-path="spatial.html"><a href="spatial.html#rasters-in-memory-vs.-file-based"><i class="fa fa-check"></i><b>4.14.2</b> Rasters “In Memory” vs. “File-Based”</a></li>
<li class="chapter" data-level="4.14.3" data-path="spatial.html"><a href="spatial.html#rasters-continuous-vs.-categorical"><i class="fa fa-check"></i><b>4.14.3</b> Rasters “Continuous” vs. “Categorical”</a></li>
<li class="chapter" data-level="4.14.4" data-path="spatial.html"><a href="spatial.html#writing-rasters-to-file"><i class="fa fa-check"></i><b>4.14.4</b> Writing Rasters to File</a></li>
<li class="chapter" data-level="4.14.5" data-path="spatial.html"><a href="spatial.html#data-types"><i class="fa fa-check"></i><b>4.14.5</b> Data Types</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="spatial.html"><a href="spatial.html#exercise-3-creating-a-slope-map"><i class="fa fa-check"></i><b>4.15</b> Exercise 3: Creating a Slope Map</a></li>
<li class="chapter" data-level="4.16" data-path="spatial.html"><a href="spatial.html#spatial-overlay-operations"><i class="fa fa-check"></i><b>4.16</b> Spatial Overlay Operations</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="spatial.html"><a href="spatial.html#working-with-vector-and-raster-data"><i class="fa fa-check"></i><b>4.16.1</b> Working with Vector and Raster Data</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="spatial.html"><a href="spatial.html#exercise-4-extracting-raster-data"><i class="fa fa-check"></i><b>4.17</b> Exercise 4: Extracting Raster Data</a>
<ul>
<li class="chapter" data-level="4.17.1" data-path="spatial.html"><a href="spatial.html#raster-summary-by-point-nasis-pedon-locations"><i class="fa fa-check"></i><b>4.17.1</b> Raster Summary By Point: NASIS Pedon Locations</a></li>
<li class="chapter" data-level="4.17.2" data-path="spatial.html"><a href="spatial.html#raster-summary-by-polygon-series-extent"><i class="fa fa-check"></i><b>4.17.2</b> Raster Summary By Polygon: Series Extent</a></li>
<li class="chapter" data-level="4.17.3" data-path="spatial.html"><a href="spatial.html#raster-summary-by-polygon-mlra"><i class="fa fa-check"></i><b>4.17.3</b> Raster Summary By Polygon: MLRA</a></li>
<li class="chapter" data-level="4.17.4" data-path="spatial.html"><a href="spatial.html#zonal-statistics-with-exactextractr"><i class="fa fa-check"></i><b>4.17.4</b> Zonal Statistics with <code>exactextractr</code></a></li>
<li class="chapter" data-level="4.17.5" data-path="spatial.html"><a href="spatial.html#example-summarizing-mlra-raster-data-with-lattice-graphics"><i class="fa fa-check"></i><b>4.17.5</b> Example: Summarizing MLRA Raster Data with <code>lattice</code> graphics</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="spatial.html"><a href="spatial.html#additional-reading-spatial"><i class="fa fa-check"></i><b>4.18</b> Additional Reading (Spatial)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>5</b> Sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sampling.html"><a href="sampling.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sampling.html"><a href="sampling.html#dsm-classes"><i class="fa fa-check"></i><b>5.1.1</b> DSM classes</a></li>
<li class="chapter" data-level="5.1.2" data-path="sampling.html"><a href="sampling.html#rules-of-thumb"><i class="fa fa-check"></i><b>5.1.2</b> Rules of thumb</a></li>
<li class="chapter" data-level="5.1.3" data-path="sampling.html"><a href="sampling.html#nssh-627.8"><i class="fa fa-check"></i><b>5.1.3</b> NSSH 627.8</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sampling.html"><a href="sampling.html#sampling-strategies"><i class="fa fa-check"></i><b>5.2</b> Sampling Strategies</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sampling.html"><a href="sampling.html#simple-random"><i class="fa fa-check"></i><b>5.2.1</b> Simple Random</a></li>
<li class="chapter" data-level="5.2.2" data-path="sampling.html"><a href="sampling.html#systematic"><i class="fa fa-check"></i><b>5.2.2</b> Systematic</a></li>
<li class="chapter" data-level="5.2.3" data-path="sampling.html"><a href="sampling.html#stratified-random"><i class="fa fa-check"></i><b>5.2.3</b> Stratified Random</a></li>
<li class="chapter" data-level="5.2.4" data-path="sampling.html"><a href="sampling.html#multistage-stratified-random"><i class="fa fa-check"></i><b>5.2.4</b> Multistage Stratified Random</a></li>
<li class="chapter" data-level="5.2.5" data-path="sampling.html"><a href="sampling.html#spatial-coverage-sampling-e.g.-k-means-clustering"><i class="fa fa-check"></i><b>5.2.5</b> Spatial Coverage Sampling (e.g. k-means clustering)</a></li>
<li class="chapter" data-level="5.2.6" data-path="sampling.html"><a href="sampling.html#covariate-space-coverage-sampling-e.g.-k-means-clustering"><i class="fa fa-check"></i><b>5.2.6</b> Covariate space coverage sampling (e.g. k-means clustering)</a></li>
<li class="chapter" data-level="5.2.7" data-path="sampling.html"><a href="sampling.html#conditioned-latin-hypercube-clhs"><i class="fa fa-check"></i><b>5.2.7</b> Conditioned Latin Hypercube (cLHS)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sampling.html"><a href="sampling.html#evaluating-a-sampling-strategy"><i class="fa fa-check"></i><b>5.3</b> Evaluating a Sampling Strategy</a></li>
<li class="chapter" data-level="5.4" data-path="sampling.html"><a href="sampling.html#exercise-design-a-sampling-strategy"><i class="fa fa-check"></i><b>5.4</b> Exercise: Design a Sampling Strategy</a></li>
<li class="chapter" data-level="5.5" data-path="sampling.html"><a href="sampling.html#additional-reading-sampling"><i class="fa fa-check"></i><b>5.5</b> Additional Reading (Sampling)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Soil Survey - Part 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eda" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Exploratory Data Analysis<a href="eda.html#eda" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="static-figures/logo.jpg" /></p>
<p>NASIS has an abundance of tabular data. These records capture a large amount of raw information about our soil series and map unit component concepts. In many cases, the data are not as clear to interpret or detailed as we would like. Before embarking on developing statistical models and generating predictions, it is essential to understand your data. This chapter will demonstrate ways to characterize a variety of different data types.</p>
<p>John Tukey (<span class="citation">(<a href="#ref-tukey1977">Tukey 1977</a>)</span>) advocated the practice of exploratory data analysis (EDA) as a critical part of the scientific process:</p>
<blockquote>
<p>“No catalog of techniques can convey a willingness to look for what can be seen, whether or not anticipated. Yet this is at the heart of exploratory data analysis. The graph paper and transparencies are there, not as a technique, but rather as a recognition that the picture examining eye is the best finder we have of the wholly unanticipated.”</p>
</blockquote>
<p>Fortunately, we can dispense with the graph paper and use software that makes it easy to develop graphical output and descriptive statistics for our data.</p>
<div id="objectives-exploratory-data-analysis" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Objectives (Exploratory Data Analysis)<a href="eda.html#objectives-exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter will demonstrate the following:</p>
<ul>
<li>Methods for estimating Low, RV, and High values</li>
<li>Methods for visualizing soil data</li>
<li>Methods for data transformation</li>
<li>Effects of weighting and missing values on summary statistics</li>
</ul>
</div>
<div id="statistics" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Statistics<a href="eda.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Descriptive statistics include:</p>
<ul>
<li><strong>Mean</strong> - arithmetic average<br />
</li>
<li><strong>Median</strong> - middle value<br />
</li>
<li><strong>Mode</strong> - most frequent value<br />
</li>
<li><strong>Standard Deviation</strong> - variation around the mean<br />
</li>
<li><strong>Interquartile Range</strong> - range encompasses 50% of the values<br />
</li>
<li><strong>Kurtosis</strong> - peakedness of the data distribution<br />
</li>
<li><strong>Skewness</strong> - symmetry of the data distribution</li>
</ul>
<p>Graphical methods include:</p>
<ul>
<li><strong>Histogram</strong> - a bar plot where each bar represents the frequency of observations for a given range of values</li>
<li><strong>Density estimation</strong> - an estimation of the frequency distribution based on the sample data</li>
<li><strong>Quantile-quantile plot</strong> - a plot of the actual data values against a normal distribution</li>
<li><strong>Box plots</strong> - a visual representation of median, quartiles, symmetry, skewness, and outliers</li>
<li><strong>Scatter plots</strong> - a graphical display of one variable plotted on the x axis and another on the y axis</li>
<li><strong>Radial plots</strong> - plots formatted for the representation of circular data</li>
</ul>
</div>
<div id="data-inspection" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Data Inspection<a href="eda.html#data-inspection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before you start an EDA, you should inspect your data and correct all typos and blatant errors. EDA can then be used to identify additional errors such as outliers and help you determine the appropriate statistical analyses. For this chapter we’ll use the <code>loafercreek</code> dataset from the CA630 Soil Survey Area.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb192-1"><a href="eda.html#cb192-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb192-2"><a href="eda.html#cb192-2" tabindex="-1"></a></span>
<span id="cb192-3"><a href="eda.html#cb192-3" tabindex="-1"></a><span class="co"># Load from the the loakercreek dataset</span></span>
<span id="cb192-4"><a href="eda.html#cb192-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;loafercreek&quot;</span>, <span class="at">package =</span> <span class="st">&quot;soilDB&quot;</span>) </span>
<span id="cb192-5"><a href="eda.html#cb192-5" tabindex="-1"></a></span>
<span id="cb192-6"><a href="eda.html#cb192-6" tabindex="-1"></a><span class="co"># Extract the horizon table</span></span>
<span id="cb192-7"><a href="eda.html#cb192-7" tabindex="-1"></a>h <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">horizons</span>(loafercreek)</span>
<span id="cb192-8"><a href="eda.html#cb192-8" tabindex="-1"></a></span>
<span id="cb192-9"><a href="eda.html#cb192-9" tabindex="-1"></a><span class="co"># Construct generalized horizon designations</span></span>
<span id="cb192-10"><a href="eda.html#cb192-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,</span>
<span id="cb192-11"><a href="eda.html#cb192-11" tabindex="-1"></a>       <span class="st">&quot;BAt&quot;</span>,</span>
<span id="cb192-12"><a href="eda.html#cb192-12" tabindex="-1"></a>       <span class="st">&quot;Bt1&quot;</span>,</span>
<span id="cb192-13"><a href="eda.html#cb192-13" tabindex="-1"></a>       <span class="st">&quot;Bt2&quot;</span>,</span>
<span id="cb192-14"><a href="eda.html#cb192-14" tabindex="-1"></a>       <span class="st">&quot;Cr&quot;</span>,</span>
<span id="cb192-15"><a href="eda.html#cb192-15" tabindex="-1"></a>       <span class="st">&quot;R&quot;</span>)</span>
<span id="cb192-16"><a href="eda.html#cb192-16" tabindex="-1"></a><span class="co"># REGEX rules</span></span>
<span id="cb192-17"><a href="eda.html#cb192-17" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,</span>
<span id="cb192-18"><a href="eda.html#cb192-18" tabindex="-1"></a>       <span class="st">&quot;BA|AB&quot;</span>,</span>
<span id="cb192-19"><a href="eda.html#cb192-19" tabindex="-1"></a>       <span class="st">&quot;Bt|Bw&quot;</span>,</span>
<span id="cb192-20"><a href="eda.html#cb192-20" tabindex="-1"></a>       <span class="st">&quot;Bt3|Bt4|2B|C&quot;</span>,</span>
<span id="cb192-21"><a href="eda.html#cb192-21" tabindex="-1"></a>       <span class="st">&quot;Cr&quot;</span>,</span>
<span id="cb192-22"><a href="eda.html#cb192-22" tabindex="-1"></a>       <span class="st">&quot;R&quot;</span>)</span>
<span id="cb192-23"><a href="eda.html#cb192-23" tabindex="-1"></a></span>
<span id="cb192-24"><a href="eda.html#cb192-24" tabindex="-1"></a><span class="co"># Compute genhz labels and add to loafercreek dataset</span></span>
<span id="cb192-25"><a href="eda.html#cb192-25" tabindex="-1"></a>h<span class="sc">$</span>genhz <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">generalize.hz</span>(h<span class="sc">$</span>hzname, n, p)</span>
<span id="cb192-26"><a href="eda.html#cb192-26" tabindex="-1"></a></span>
<span id="cb192-27"><a href="eda.html#cb192-27" tabindex="-1"></a><span class="co"># Examine genhz vs hznames</span></span>
<span id="cb192-28"><a href="eda.html#cb192-28" tabindex="-1"></a><span class="fu">table</span>(h<span class="sc">$</span>genhz, h<span class="sc">$</span>hzname)</span></code></pre></div>
<pre><code>##           
##            2BC 2BCt 2Bt1 2Bt2 2Bt3 2Bt4 2Bt5 2CB 2CBt 2Cr 2Crt 2R  A A1 A2 AB ABt
##   A          0    0    0    0    0    0    0   0    0   0    0  0 97  7  7  0   0
##   BAt        0    0    0    0    0    0    0   0    0   0    0  0  0  0  0  1   0
##   Bt1        0    0    0    0    0    0    0   0    0   0    0  0  0  0  0  0   2
##   Bt2        1    1    3    8    8    6    1   1    1   0    0  0  0  0  0  0   0
##   Cr         0    0    0    0    0    0    0   0    0   4    2  0  0  0  0  0   0
##   R          0    0    0    0    0    0    0   0    0   0    0  6  0  0  0  0   0
##   not-used   0    0    0    0    0    0    0   0    0   0    0  0  0  0  0  0   0
##           
##            Ad Ap  B BA BAt BC BCt Bt Bt1 Bt2 Bt3 Bt4 Bw Bw1 Bw2 Bw3  C CBt Cd Cr
##   A         1  1  0  0   0  0   0  0   0   0   0   0  0   0   0   0  0   0  0  0
##   BAt       0  0  0 31   8  0   0  0   0   0   0   0  0   0   0   0  0   0  0  0
##   Bt1       0  0  0  0   0  0   0  8  93  88   0   0 10   2   2   1  0   0  0  0
##   Bt2       0  0  0  0   0  4  16  0   0   0  47   8  0   0   0   0  6   6  1  0
##   Cr        0  0  0  0   0  0   0  0   0   0   0   0  0   0   0   0  0   0  0 49
##   R         0  0  0  0   0  0   0  0   0   0   0   0  0   0   0   0  0   0  0  0
##   not-used  0  0  1  0   0  0   0  0   0   0   0   0  0   0   0   0  0   0  0  0
##           
##            Cr/R Crt H1 Oi  R Rt
##   A           0   0  0  0  0  0
##   BAt         0   0  0  0  0  0
##   Bt1         0   0  0  0  0  0
##   Bt2         0   0  0  0  0  0
##   Cr          0  20  0  0  0  0
##   R           1   0  0  0 40  1
##   not-used    0   0  1 24  0  0</code></pre>
<p>As noted in Chapter 1, a visual examination of the raw data is possible by clicking on the dataset in the environment tab, or via commandline:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb194-1"><a href="eda.html#cb194-1" tabindex="-1"></a><span class="fu">View</span>(h) </span></code></pre></div>
<p>This view is fine for a small dataset, but can be cumbersome for larger ones. The <code>summary()</code> function can be used to quickly summarize a dataset however, even for our small example dataset, the output can be voluminous. Therefore in the interest of saving space we’ll only look at a sample of columns.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb195-1"><a href="eda.html#cb195-1" tabindex="-1"></a>h <span class="sc">%&gt;%</span></span>
<span id="cb195-2"><a href="eda.html#cb195-2" tabindex="-1"></a>  <span class="fu">select</span>(genhz, claytotest, total_frags_pct, phfield, effclass) <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="eda.html#cb195-3" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>##       genhz       claytotest    total_frags_pct    phfield       effclass        
##  A       :113   Min.   :10.00   Min.   : 0.00   Min.   :4.90   Length:626        
##  BAt     : 40   1st Qu.:18.00   1st Qu.: 0.00   1st Qu.:6.00   Class :character  
##  Bt1     :206   Median :22.00   Median : 5.00   Median :6.30   Mode  :character  
##  Bt2     :118   Mean   :23.63   Mean   :13.88   Mean   :6.18                     
##  Cr      : 75   3rd Qu.:28.00   3rd Qu.:20.00   3rd Qu.:6.50                     
##  R       : 48   Max.   :60.00   Max.   :95.00   Max.   :7.00                     
##  not-used: 26   NA&#39;s   :167                     NA&#39;s   :381</code></pre>
<p>The <code>summary()</code> function is known as a generic R function. It will return a summary for any R object.</p>
<p>Because <code>h</code> is a data frame, we get a summary of each column. Factors will be summarized by their frequency (i.e., number of observations), while numeric or integer variables will print out a five number summary, and characters simply print their length. The number of missing observations for any variable will also be printed if they are present. If any of these metrics look unfamiliar to you, don’t worry we’ll cover them shortly.</p>
<p>When you do have missing data and the function you want to run will not run with missing values, the following options are available:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Exclude</strong> all rows or columns that contain missing values using the function <code>na.exclude()</code>, such as <code>h2 &lt;- na.exclude(h)</code>. However this can be wasteful because it removes all rows (e.g., horizons), regardless if the row only has 1 missing value. Instead it’s sometimes best to create a temporary copy of the variable in question and then remove the missing variables, such as <code>claytotest &lt;- na.exclude(h$claytotest)</code>.</p></li>
<li><p><strong>Replace</strong> missing values with another value, such as zero, a global constant, or the mean or median value for that column, such as <code>h$claytotest &lt;- ifelse(is.na(h$claytotest), 0, h$claytotest) # or h[is.na(h$claytotest), ] &lt;- 0</code>.</p></li>
<li><p><strong>Read</strong> the help file for the function you’re attempting to use. Many functions have additional arguments for dealing with missing values, such as <code>na.rm</code>.</p></li>
</ol>
<p>A quick check for typos would be to examine the list of levels for a factor or character, such as:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb197-1"><a href="eda.html#cb197-1" tabindex="-1"></a><span class="co"># just for factors</span></span>
<span id="cb197-2"><a href="eda.html#cb197-2" tabindex="-1"></a><span class="fu">levels</span>(h<span class="sc">$</span>genhz)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot;        &quot;BAt&quot;      &quot;Bt1&quot;      &quot;Bt2&quot;      &quot;Cr&quot;       &quot;R&quot;        &quot;not-used&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb199-1"><a href="eda.html#cb199-1" tabindex="-1"></a><span class="co"># for characters and factors</span></span>
<span id="cb199-2"><a href="eda.html#cb199-2" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(h<span class="sc">$</span>hzname)) </span></code></pre></div>
<pre><code>##  [1] &quot;2BC&quot;  &quot;2BCt&quot; &quot;2Bt1&quot; &quot;2Bt2&quot; &quot;2Bt3&quot; &quot;2Bt4&quot; &quot;2Bt5&quot; &quot;2CB&quot;  &quot;2CBt&quot; &quot;2Cr&quot;  &quot;2Crt&quot;
## [12] &quot;2R&quot;   &quot;A&quot;    &quot;A1&quot;   &quot;A2&quot;   &quot;AB&quot;   &quot;ABt&quot;  &quot;Ad&quot;   &quot;Ap&quot;   &quot;B&quot;    &quot;BA&quot;   &quot;BAt&quot; 
## [23] &quot;BC&quot;   &quot;BCt&quot;  &quot;Bt&quot;   &quot;Bt1&quot;  &quot;Bt2&quot;  &quot;Bt3&quot;  &quot;Bt4&quot;  &quot;Bw&quot;   &quot;Bw1&quot;  &quot;Bw2&quot;  &quot;Bw3&quot; 
## [34] &quot;C&quot;    &quot;CBt&quot;  &quot;Cd&quot;   &quot;Cr&quot;   &quot;Cr/R&quot; &quot;Crt&quot;  &quot;H1&quot;   &quot;Oi&quot;   &quot;R&quot;    &quot;Rt&quot;</code></pre>
<p>If the <code>unique()</code> function returned typos such as “BT” or “B t”, you could either fix your original dataset or you could make an adjustment in R, such as:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb201-1"><a href="eda.html#cb201-1" tabindex="-1"></a>h<span class="sc">$</span>hzname <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(h<span class="sc">$</span>hzname <span class="sc">==</span> <span class="st">&quot;BT&quot;</span>, <span class="st">&quot;Bt&quot;</span>, h<span class="sc">$</span>hzname)</span></code></pre></div>
<p>Typo errors such as these are a common problem with old pedon data in NASIS.</p>
</div>
<div id="calculating-weights" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Calculating Weights<a href="eda.html#calculating-weights" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we can begin calculating statistics from our data we need to calculate their weight. A weight (w) is the number of observations a sample (n) represents within a population (N).</p>
<ul>
<li>w = N / n</li>
<li>N = sum(w)</li>
</ul>
<p>Weights will either inflate or deflate the contribution of each observation to the final results. The more unbalanced the sample is from the population, the more substantial the weights impact will be.</p>
<p>Inflation</p>
<ul>
<li>w = 100 / 10 = 10</li>
<li>each 1 sample represents 10 units within the population</li>
</ul>
<p>Diluation</p>
<ul>
<li>w = 10 / 30 = 0.33</li>
<li>each 1 samples represents 0.33 units within the population</li>
</ul>
<p>Commonly we use the weighted mean for depth-weighted averages in individual pedons or components and, also, for map unit averages.</p>
<p>Depth-weighted averages commonly use horizon thicknesses as weights, while map unit averages commonly use component percentages (or component acres) as weights.</p>
<p>When we want to scale the contribution of particular observations or variables to a final result, weights may be derived from expert knowledge or some other data source.</p>
<p>The example below calculates both the horizon thickness and genhz weight for each pedon and horizon. Each of these measures can be used as weights</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb202-1"><a href="eda.html#cb202-1" tabindex="-1"></a><span class="co"># calculate thickness</span></span>
<span id="cb202-2"><a href="eda.html#cb202-2" tabindex="-1"></a>h <span class="ot">&lt;-</span> h <span class="sc">%&gt;%</span></span>
<span id="cb202-3"><a href="eda.html#cb202-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb202-4"><a href="eda.html#cb202-4" tabindex="-1"></a>    <span class="at">thk =</span> hzdepb <span class="sc">-</span> hzdept</span>
<span id="cb202-5"><a href="eda.html#cb202-5" tabindex="-1"></a>    ) </span>
<span id="cb202-6"><a href="eda.html#cb202-6" tabindex="-1"></a></span>
<span id="cb202-7"><a href="eda.html#cb202-7" tabindex="-1"></a><span class="co"># calculate a genhz weight by pedon</span></span>
<span id="cb202-8"><a href="eda.html#cb202-8" tabindex="-1"></a>h <span class="ot">&lt;-</span> h <span class="sc">%&gt;%</span></span>
<span id="cb202-9"><a href="eda.html#cb202-9" tabindex="-1"></a>  <span class="fu">group_by</span>(peiid, genhz) <span class="sc">%&gt;%</span></span>
<span id="cb202-10"><a href="eda.html#cb202-10" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb202-11"><a href="eda.html#cb202-11" tabindex="-1"></a>    phiid,</span>
<span id="cb202-12"><a href="eda.html#cb202-12" tabindex="-1"></a>    <span class="at">genhz_wt =</span> thk <span class="sc">/</span> <span class="fu">sum</span>(thk)</span>
<span id="cb202-13"><a href="eda.html#cb202-13" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb202-14"><a href="eda.html#cb202-14" tabindex="-1"></a>  <span class="fu">select</span>(phiid, genhz_wt) <span class="sc">%&gt;%</span></span>
<span id="cb202-15"><a href="eda.html#cb202-15" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="at">x =</span> h, <span class="at">y =</span> ., <span class="at">by =</span> <span class="st">&quot;phiid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb202-16"><a href="eda.html#cb202-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
</div>
<div id="exercise-1-fetch-and-inspect-data" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Exercise 1: Fetch and Inspect Data<a href="eda.html#exercise-1-fetch-and-inspect-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Save the code you use in an R script, add answers as comments, and send to your mentor. Exercises 2 and 3 will build on Exercise 1.</p>
<ol style="list-style-type: decimal">
<li><p>Load the <code>gopheridge</code> dataset found within the soilDB package or use your own data.</p></li>
<li><p>Inspect the <code>gopheridge</code> object. How many sites or profiles are in the collection? How many horizons?</p></li>
<li><p>Apply the generalized horizon rules below or develop your own, see the following <a href="http://ncss-tech.github.io/AQP/aqp/gen-hz-assignment.html">job-aid</a> and the <a href="https://ncss-tech.github.io/stats_for_soil_survey/book/data.html#pattern-matching">Pattern Matching</a> section of Chapter 2 for details.</p></li>
</ol>
<div class="sourceCode" id="cb203"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb203-1"><a href="eda.html#cb203-1" tabindex="-1"></a><span class="co"># gopheridge rules</span></span>
<span id="cb203-2"><a href="eda.html#cb203-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;Bt1&#39;</span>, <span class="st">&#39;Bt2&#39;</span>, <span class="st">&#39;Bt3&#39;</span>,<span class="st">&#39;Cr&#39;</span>,<span class="st">&#39;R&#39;</span>)</span>
<span id="cb203-3"><a href="eda.html#cb203-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;^A|BA$&#39;</span>, <span class="st">&#39;Bt1|Bw&#39;</span>,<span class="st">&#39;Bt$|Bt2&#39;</span>, <span class="st">&#39;Bt3|CBt$|BCt&#39;</span>, <span class="st">&#39;Cr&#39;</span>, <span class="st">&#39;R&#39;</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Summarize the <code>hzdept</code>, <code>genhz</code>, <code>texture_class</code>, <code>sandtotest</code>, and <code>fine gravel</code> columns using the <code>summary()</code> function.</li>
</ol>
</div>
<div id="descriptive-statistics" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Descriptive Statistics<a href="eda.html#descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<caption><span id="tab:unnamed-chunk-86">Table 3.1: </span>Short Description of Summary Statistics and R Functions.</caption>
<colgroup>
<col width="18%" />
<col width="7%" />
<col width="53%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">NASIS</th>
<th align="left">Description</th>
<th align="left">R functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left">RV ?</td>
<td align="left">arithmetic average</td>
<td align="left"><code>mean()</code></td>
</tr>
<tr class="even">
<td align="left">Median</td>
<td align="left">RV</td>
<td align="left">middle value, 50% quantile</td>
<td align="left"><code>median()</code></td>
</tr>
<tr class="odd">
<td align="left">Mode</td>
<td align="left">RV</td>
<td align="left">most frequent value</td>
<td align="left"><code>DescTools::Mode()</code></td>
</tr>
<tr class="even">
<td align="left">Standard Deviation</td>
<td align="left">L &amp; H ?</td>
<td align="left">variation around mean</td>
<td align="left"><code>sd()</code></td>
</tr>
<tr class="odd">
<td align="left">Quantiles</td>
<td align="left">L &amp; H</td>
<td align="left">percent rank of values, such that all values are &lt;= p</td>
<td align="left"><code>quantile()</code></td>
</tr>
</tbody>
</table>
<div id="other-weighted-statistics" class="section level4 hasAnchor" number="3.6.0.1">
<h4><span class="header-section-number">3.6.0.1</span> Other Weighted Statistics<a href="eda.html#other-weighted-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are many other weighted statistics available. Essentially all will use a matrix of data values and a matrix of weights to scale the contribution of data values to the final statistic value.</p>
<p>The package <code>Hmisc</code> defines several <a href="https://search.r-project.org/CRAN/refmans/Hmisc/html/wtd.stats.html">weighted variants of common summary statistics</a>, notably <code>Hmisc::wtd.quantile()</code>. The <code>DescTools</code> package also defines <a href="https://search.r-project.org/CRAN/refmans/DescTools/html/Quantile.html"><code>Quantile()</code></a> which strictly follows the Eurostat definition of a weighted quantile.</p>
</div>
<div id="measures-of-central-tendency" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Measures of Central Tendency<a href="eda.html#measures-of-central-tendency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These measures are used to determine the mid-point of the range of observed values. In NASIS speak this should ideally be equivalent to the representative value (RV) for numeric and integer data. The mean and median are the most commonly used statistics for central tendency.</p>
<div id="mean" class="section level4 hasAnchor" number="3.6.1.1">
<h4><span class="header-section-number">3.6.1.1</span> Mean<a href="eda.html#mean" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Mean</strong> - is the arithmetic average all are familiar with, formally expressed as: <span class="math inline">\(\bar{x} =\frac{\sum_{i=1}^{n}x_i}{n}\)</span> which sums ( <span class="math inline">\(\sum\)</span> ) all the X values in the sample and divides by the number (n) of samples. It is assumed that all references in this document refer to samples rather than a population.</p>
<p>The mean clay content from the loafercreek dataset may be determined:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb204-1"><a href="eda.html#cb204-1" tabindex="-1"></a><span class="fu">mean</span>(h<span class="sc">$</span>claytotest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 23.62767</code></pre>
</div>
<div id="weighted-mean" class="section level4 hasAnchor" number="3.6.1.2">
<h4><span class="header-section-number">3.6.1.2</span> Weighted Mean<a href="eda.html#weighted-mean" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Weighted Mean</strong> - is the weighted arithmetic average. In the ordinary arithmetic average, each data point is assigned the same weight, whereas in a weighted average the contribution of each data point to the mean can vary.</p>
<p>The function <code>weighted.mean()</code> takes two major inputs: <code>x</code>, a vector of data values, and <code>w</code>, a vector of weights. Like other statistics, you can remove missing values with <code>na.rm=TRUE</code>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb206-1"><a href="eda.html#cb206-1" tabindex="-1"></a><span class="co"># calculate horizon thickness</span></span>
<span id="cb206-2"><a href="eda.html#cb206-2" tabindex="-1"></a>h<span class="sc">$</span>hzthk <span class="ot">&lt;-</span> h<span class="sc">$</span>hzdepb <span class="sc">-</span> h<span class="sc">$</span>hzdept</span>
<span id="cb206-3"><a href="eda.html#cb206-3" tabindex="-1"></a></span>
<span id="cb206-4"><a href="eda.html#cb206-4" tabindex="-1"></a><span class="co"># weighted mean (across all horizons and profiles)</span></span>
<span id="cb206-5"><a href="eda.html#cb206-5" tabindex="-1"></a><span class="fu">weighted.mean</span>(h<span class="sc">$</span>claytotest, h<span class="sc">$</span>hzthk, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 25.24812</code></pre>
<p>The above example is applied to all profiles and all horizons. We only get one value across 106 profiles and 626 horizons.</p>
<p>A more practical application of <code>weighted.mean()</code> is Particle Size Control Section (PSCS) weighted average properties. For this we need to use the horizon thickness <em>within the control section</em> as weights.</p>
<p>The aqp function <a href="https://ncss-tech.github.io/aqp/reference/glom.html"><code>trunc()</code></a> allows you to remove portions of profiles that are outside specified depth intervals (such as the PSCS boundaries). <a href="https://ncss-tech.github.io/aqp/reference/profileApply.html"><code>profileApply()</code></a> allows for iterating over all profiles in a <em>SoilProfileCollection</em> to call some function on each one.</p>
<p>Here we calculate the PSCS weighted mean clay content for each profile in <code>loafercreek</code>:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb208-1"><a href="eda.html#cb208-1" tabindex="-1"></a><span class="co"># calculate a &quot;truncated&quot; SPC with just the PSCS; drop = FALSE retains empty profiles for missing PSCS</span></span>
<span id="cb208-2"><a href="eda.html#cb208-2" tabindex="-1"></a>loafercreek_pscs <span class="ot">&lt;-</span> <span class="fu">trunc</span>(loafercreek, loafercreek<span class="sc">$</span>psctopdepth, loafercreek<span class="sc">$</span>pscbotdepth, <span class="at">drop =</span> <span class="cn">FALSE</span>)</span>
<span id="cb208-3"><a href="eda.html#cb208-3" tabindex="-1"></a></span>
<span id="cb208-4"><a href="eda.html#cb208-4" tabindex="-1"></a><span class="co"># calculate weighted mean for each profile, using the truncated horizon thicknesses as weights</span></span>
<span id="cb208-5"><a href="eda.html#cb208-5" tabindex="-1"></a>loafercreek<span class="sc">$</span>pscs_clay <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(loafercreek_pscs, <span class="cf">function</span>(p) {</span>
<span id="cb208-6"><a href="eda.html#cb208-6" tabindex="-1"></a>  <span class="fu">weighted.mean</span>(p<span class="sc">$</span>claytotest, <span class="at">w =</span> p<span class="sc">$</span>hzdepb <span class="sc">-</span> p<span class="sc">$</span>hzdept, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-7"><a href="eda.html#cb208-7" tabindex="-1"></a>})</span>
<span id="cb208-8"><a href="eda.html#cb208-8" tabindex="-1"></a></span>
<span id="cb208-9"><a href="eda.html#cb208-9" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb208-10"><a href="eda.html#cb208-10" tabindex="-1"></a>loafercreek<span class="sc">$</span>pscs_clay</span></code></pre></div>
<pre><code>##   [1] 28.76471 28.76471 25.88000      NaN 16.00000 37.32000 32.63415      NaN
##   [9] 33.78571 29.57576 29.00000 23.02632 25.28000 23.36364 26.25000 34.12000
##  [17] 47.69565 30.73171 28.32609 32.00000 27.12500 27.76316 25.00000 28.60870
##  [25] 23.39535 22.32000 24.10000 20.91600 22.52000 20.48780 44.38000 37.88000
##  [33] 28.70000 28.80000 36.46000 23.78000 30.72000 24.33333 23.76000 21.78000
##  [41] 28.72727 20.83871 19.56000 25.48000 28.92000 33.95122 20.18000 18.86486
##  [49] 18.12500 25.56000 17.34000 25.84000 19.00000 28.37500 27.10870 24.72000
##  [57] 26.20370 25.13514 26.00000 24.38000 24.20000 26.24000 27.44444 29.90000
##  [65] 24.00000 42.08000 28.34000 29.36842 23.10000 24.56818 29.10000 24.16000
##  [73] 28.82000      NaN 18.77500      NaN 45.82917 25.25161      NaN 20.50000
##  [81] 21.28889 24.86000 32.34000 33.36585 31.04000 23.05405 17.22000 26.52000
##  [89] 29.22000 20.00000 24.60000 19.74000 18.25000 20.70000 31.84000 21.97959
##  [97] 32.44737 29.56000      NaN 22.09412 21.34000 27.46154 26.68000 20.10526
## [105] 31.00000 22.65000</code></pre>
<p>Note that several of these pedons have <code>NaN</code> values in the result. This can happen even with <code>na.rm=TRUE</code> because pedons either do not have both <code>psctopdepth</code> and <code>pscbotdepth</code> populated in NASIS or all horizons in the PSCS have <code>NA</code> clay content.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb210-1"><a href="eda.html#cb210-1" tabindex="-1"></a><span class="co"># inspect new site-level column pscs_clay</span></span>
<span id="cb210-2"><a href="eda.html#cb210-2" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">site</span>(loafercreek)[, <span class="fu">c</span>(<span class="st">&quot;peiid&quot;</span>, <span class="st">&quot;upedonid&quot;</span>, <span class="st">&quot;psctopdepth&quot;</span>, <span class="st">&quot;pscbotdepth&quot;</span>, <span class="st">&quot;pscs_clay&quot;</span>)])</span>
<span id="cb210-3"><a href="eda.html#cb210-3" tabindex="-1"></a></span>
<span id="cb210-4"><a href="eda.html#cb210-4" tabindex="-1"></a><span class="co"># plot just the pedons with missing pscs_clay</span></span>
<span id="cb210-5"><a href="eda.html#cb210-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">subset</span>(loafercreek, <span class="fu">is.na</span>(pscs_clay)), <span class="at">color =</span> <span class="st">&quot;claytotest&quot;</span>)</span></code></pre></div>
<p>You always need to pay attention to the possibility of missing data or weights because missing values can dramatically the final result–sometimes in unexpected ways!</p>
</div>
<div id="median" class="section level4 hasAnchor" number="3.6.1.3">
<h4><span class="header-section-number">3.6.1.3</span> Median<a href="eda.html#median" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Median</strong> is the middle measurement of a sample set, and as such is a more robust estimate of central tendency than the mean. This is known as the middle or 50th quantile, meaning there are an equal number of samples with values less than and greater than the median. For example, assuming there are 21 samples, sorted in ascending order, the median would be the 11th sample.</p>
<p>The median from the sample dataset may be determined:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb211-1"><a href="eda.html#cb211-1" tabindex="-1"></a><span class="fu">median</span>(h<span class="sc">$</span>claytotest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 22</code></pre>
</div>
<div id="mode" class="section level4 hasAnchor" number="3.6.1.4">
<h4><span class="header-section-number">3.6.1.4</span> Mode<a href="eda.html#mode" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Mode</strong> - is the most frequent measurement in the sample. The use of mode is typically reserved for factors, which we will discuss shortly. One issue with using the mode for numeric data is that the data need to be rounded to the level of desired precision. R does not include a function for calculating the mode, but we can calculate it using the <code>Mode()</code> function from the <code>DescTools</code> package.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb213-1"><a href="eda.html#cb213-1" tabindex="-1"></a>h<span class="sc">$</span>claytotest <span class="sc">%&gt;%</span></span>
<span id="cb213-2"><a href="eda.html#cb213-2" tabindex="-1"></a>  <span class="fu">round</span>() <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="eda.html#cb213-3" tabindex="-1"></a>  DescTools<span class="sc">::</span><span class="fu">Mode</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 25
## attr(,&quot;freq&quot;)
## [1] 42</code></pre>
</div>
<div id="frequencies" class="section level4 hasAnchor" number="3.6.1.5">
<h4><span class="header-section-number">3.6.1.5</span> Frequencies<a href="eda.html#frequencies" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Frequencies</strong></p>
<p>To summarize factors and characters we can examine their frequency or number of observations. This is accomplished using the <code>table()</code> or <code>summary()</code> functions.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb215-1"><a href="eda.html#cb215-1" tabindex="-1"></a><span class="fu">table</span>(h<span class="sc">$</span>genhz)</span></code></pre></div>
<pre><code>## 
##        A      BAt      Bt1      Bt2       Cr        R not-used 
##      113       40      206      118       75       48       26</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb217-1"><a href="eda.html#cb217-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb217-2"><a href="eda.html#cb217-2" tabindex="-1"></a></span>
<span id="cb217-3"><a href="eda.html#cb217-3" tabindex="-1"></a><span class="fu">summary</span>(h<span class="sc">$</span>genhz)</span></code></pre></div>
<pre><code>##        A      BAt      Bt1      Bt2       Cr        R not-used 
##      113       40      206      118       75       48       26</code></pre>
<p>This gives us a count of the number of observations for each horizon. If we want to see the comparison between two different factors or characters, we can include two variables.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb219-1"><a href="eda.html#cb219-1" tabindex="-1"></a><span class="fu">table</span>(h<span class="sc">$</span>genhz, h<span class="sc">$</span>texcl)</span></code></pre></div>
<pre><code>##           
##              c  cl   l scl sic sicl sil  sl
##   A          0   0  78   0   0    0  27   6
##   BAt        0   2  31   0   0    1   4   1
##   Bt1        2  44 127   4   1    5  20   1
##   Bt2       16  54  29   5   1    3   5   0
##   Cr         1   0   0   0   0    0   0   0
##   R          0   0   0   0   0    0   0   0
##   not-used   0   1   0   0   0    0   0   0</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb221-1"><a href="eda.html#cb221-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb221-2"><a href="eda.html#cb221-2" tabindex="-1"></a></span>
<span id="cb221-3"><a href="eda.html#cb221-3" tabindex="-1"></a>h <span class="sc">%&gt;%</span> </span>
<span id="cb221-4"><a href="eda.html#cb221-4" tabindex="-1"></a>  <span class="fu">count</span>(genhz, texcl) <span class="sc">%&gt;%</span></span>
<span id="cb221-5"><a href="eda.html#cb221-5" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   genhz texcl  n
## 1     A     l 78
## 2     A   sil 27
## 3     A    sl  6
## 4     A  &lt;NA&gt;  2
## 5   BAt    cl  2
## 6   BAt     l 31</code></pre>
<p>To calculate a weighted frequencies we need to use the <code>xtabs()</code> function, which uses a different syntax style, but can perform more complex tabulations. Notice how when the thickness is incorporated as a weight how it impacts the resulting frequencies. In the following example the results represent the total thickness of each <code>texcl</code>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb223-1"><a href="eda.html#cb223-1" tabindex="-1"></a><span class="fu">xtabs</span>(thk <span class="sc">~</span> texcl, <span class="at">data =</span> h)</span></code></pre></div>
<pre><code>## texcl
##    c   cl    l  scl  sic sicl  sil   sl 
##  338 1948 3659  173   40  150  776   81</code></pre>
<p>If instead we do a cross tabulation and weight by the <code>genhz_wt</code> we created early, the results represent the total number of pedons (i.e. <code>peiid</code>) that have the same <code>genhz</code>.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb225-1"><a href="eda.html#cb225-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(genhz_wt <span class="sc">~</span> genhz <span class="sc">+</span> texcl, <span class="at">data =</span> h, <span class="at">addNA =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span>
<span id="cb225-2"><a href="eda.html#cb225-2" tabindex="-1"></a>tb</span></code></pre></div>
<pre><code>##           texcl
## genhz       c cl  l scl sic sicl sil sl &lt;NA&gt;
##   A         0  0 73   0   0    0  24  5    2
##   BAt       0  2 30   0   0    1   4  1    1
##   Bt1       1 25 61   2   1    3  10  1    1
##   Bt2       8 33 18   4   1    2   4  0    3
##   Cr        1  0  0   0   0    0   0  0   74
##   R         0  0  0   0   0    0   0  0   48
##   not-used  0  1  0   0   0    0   0  0   25</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb227-1"><a href="eda.html#cb227-1" tabindex="-1"></a><span class="fu">sum</span>(tb)</span></code></pre></div>
<pre><code>## [1] 470</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb229-1"><a href="eda.html#cb229-1" tabindex="-1"></a><span class="fu">sum</span>(h<span class="sc">$</span>genhz_wt)</span></code></pre></div>
<pre><code>## [1] 469</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb231-1"><a href="eda.html#cb231-1" tabindex="-1"></a><span class="fu">paste</span>(h<span class="sc">$</span>peiid, h<span class="sc">$</span>genhz) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code></pre></div>
<pre><code>## [1] 469</code></pre>
<p>We can also add margin totals to tables or convert the table frequencies to proportions.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb233-1"><a href="eda.html#cb233-1" tabindex="-1"></a><span class="co"># append the table with row and column sums</span></span>
<span id="cb233-2"><a href="eda.html#cb233-2" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(h<span class="sc">$</span>genhz, h<span class="sc">$</span>texcl))</span></code></pre></div>
<pre><code>##           
##              c  cl   l scl sic sicl sil  sl Sum
##   A          0   0  78   0   0    0  27   6 111
##   BAt        0   2  31   0   0    1   4   1  39
##   Bt1        2  44 127   4   1    5  20   1 204
##   Bt2       16  54  29   5   1    3   5   0 113
##   Cr         1   0   0   0   0    0   0   0   1
##   R          0   0   0   0   0    0   0   0   0
##   not-used   0   1   0   0   0    0   0   0   1
##   Sum       19 101 265   9   2    9  56   8 469</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb235-1"><a href="eda.html#cb235-1" tabindex="-1"></a><span class="co"># calculate the proportions relative to the rows, margin = 1 calculates for rows, margin = 2 calculates for columns, margin = NULL calculates for total observations</span></span>
<span id="cb235-2"><a href="eda.html#cb235-2" tabindex="-1"></a><span class="fu">table</span>(h<span class="sc">$</span>genhz, h<span class="sc">$</span>texture_class) <span class="sc">%&gt;%</span></span>
<span id="cb235-3"><a href="eda.html#cb235-3" tabindex="-1"></a>  <span class="fu">prop.table</span>(<span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb235-4"><a href="eda.html#cb235-4" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>##           
##             br   c  cb  cl  gr   l  pg scl sic sicl sil  sl spm
##   A          0   0   0   0   0  70   0   0   0    0  24   5   0
##   BAt        0   0   0   5   0  79   0   0   0    3  10   3   0
##   Bt1        0   1   0  22   0  62   0   2   0    2  10   0   0
##   Bt2        0  14   1  46   2  25   1   4   1    3   4   0   0
##   Cr        97   2   0   0   2   0   0   0   0    0   0   0   0
##   R        100   0   0   0   0   0   0   0   0    0   0   0   0
##   not-used   0   0   0   4   0   0   0   0   0    0   0   0  96</code></pre>
<p>To determine the mean by a group or category, use the <code>group_by</code> and <code>summarize</code> functions:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb237-1"><a href="eda.html#cb237-1" tabindex="-1"></a>h <span class="sc">%&gt;%</span></span>
<span id="cb237-2"><a href="eda.html#cb237-2" tabindex="-1"></a>  <span class="fu">group_by</span>(genhz) <span class="sc">%&gt;%</span></span>
<span id="cb237-3"><a href="eda.html#cb237-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb237-4"><a href="eda.html#cb237-4" tabindex="-1"></a>    <span class="at">clay_avg =</span> <span class="fu">mean</span>(claytotest,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb237-5"><a href="eda.html#cb237-5" tabindex="-1"></a>    <span class="at">clay_med =</span> <span class="fu">median</span>(claytotest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-6"><a href="eda.html#cb237-6" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## # A tibble: 7 × 3
##   genhz    clay_avg clay_med
##   &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;
## 1 A            16.2       16
## 2 BAt          19.5       19
## 3 Bt1          24.0       24
## 4 Bt2          31.2       30
## 5 Cr           15         15
## 6 R           NaN         NA
## 7 not-used    NaN         NA</code></pre>
</div>
</div>
<div id="measures-of-dispersion" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Measures of Dispersion<a href="eda.html#measures-of-dispersion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are measures used to determine the spread of values around the mid-point. This is useful to determine if the samples are spread widely across the range of observations or concentrated near the mid-point. In NASIS speak these values might equate to the low (L) and high (H) values for numeric and integer data.</p>
<div id="variance" class="section level4 hasAnchor" number="3.6.2.1">
<h4><span class="header-section-number">3.6.2.1</span> Variance<a href="eda.html#variance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Variance</strong> is a positive value indicating deviation from the mean:</p>
<p><span class="math inline">\(s^2 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})^2} {n - 1}\)</span></p>
<p>This is the square of the sum of the deviations from the mean, divided by the number of samples minus 1. It is commonly referred to as the sum of squares. As the deviation increases, the variance increases. Conversely, if there is no deviation, the variance will equal 0. As a squared value, variance is always positive. Variance is an important component for many statistical analyses including the most commonly referred to measure of dispersion, the <em>standard deviation</em>. Variance for the sample dataset is:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb239-1"><a href="eda.html#cb239-1" tabindex="-1"></a><span class="fu">var</span>(h<span class="sc">$</span>claytotest, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 64.27607</code></pre>
</div>
<div id="standard-deviation" class="section level4 hasAnchor" number="3.6.2.2">
<h4><span class="header-section-number">3.6.2.2</span> Standard Deviation<a href="eda.html#standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Standard Deviation</strong> is the square root of the variance:</p>
<p><span class="math inline">\(s = \sqrt\frac{\sum_{i=1}^{n}(x_i - \bar{x})^2} {n - 1}\)</span></p>
<p>The units of the standard deviation are the same as the units measured. From the formula you can see that the standard deviation is simply the square root of the variance. Standard deviation for the sample dataset is:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb241-1"><a href="eda.html#cb241-1" tabindex="-1"></a><span class="fu">sd</span>(h<span class="sc">$</span>claytotest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 8.017236</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb243-1"><a href="eda.html#cb243-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb243-2"><a href="eda.html#cb243-2" tabindex="-1"></a></span>
<span id="cb243-3"><a href="eda.html#cb243-3" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(h<span class="sc">$</span>claytotest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] 8.017236</code></pre>
</div>
<div id="coefficient-of-variation" class="section level4 hasAnchor" number="3.6.2.3">
<h4><span class="header-section-number">3.6.2.3</span> Coefficient of Variation<a href="eda.html#coefficient-of-variation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Coefficient of Variation</strong> (CV) is a relative (i.e., unitless) measure of standard deviation:</p>
<p><span class="math inline">\(CV = \frac{s}{\bar{x}} \times 100\)</span></p>
<p>CV is calculated by dividing the standard deviation by the mean and multiplying by 100. Since standard deviation varies in magnitude with the value of the mean, the CV is useful for comparing relative variation amongst different datasets. However Webster (2001) discourages using CV to compare different variables. Webster (2001) also stresses that CV is reserved for variables that have an absolute 0, like clay content. CV may be calculated for the sample dataset as:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb245-1"><a href="eda.html#cb245-1" tabindex="-1"></a><span class="co"># remove NA values and create a new variable</span></span>
<span id="cb245-2"><a href="eda.html#cb245-2" tabindex="-1"></a>clay <span class="ot">&lt;-</span> <span class="fu">na.exclude</span>(h<span class="sc">$</span>claytotest)</span>
<span id="cb245-3"><a href="eda.html#cb245-3" tabindex="-1"></a></span>
<span id="cb245-4"><a href="eda.html#cb245-4" tabindex="-1"></a><span class="fu">sd</span>(clay) <span class="sc">/</span> <span class="fu">mean</span>(clay) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 33.93156</code></pre>
</div>
<div id="quantiles-percentiles" class="section level4 hasAnchor" number="3.6.2.4">
<h4><span class="header-section-number">3.6.2.4</span> Quantiles (Percentiles)<a href="eda.html#quantiles-percentiles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Quantiles (a.k.a. Percentiles)</strong> - the percentile is the value that cuts off the first nth percent of the data values when sorted in ascending order.</p>
<p>The default for the <code>quantile()</code> function returns the min, 25th percentile, median or 50th percentile, 75th percentile, and max, known as the five number summary originally proposed by Tukey. Other probabilities however can be used. At present the 5th, 50th, and 95th are being proposed for determining the range in characteristics (RIC) for a given soil property.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb247-1"><a href="eda.html#cb247-1" tabindex="-1"></a><span class="fu">quantile</span>(h<span class="sc">$</span>claytotest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##   10   18   22   28   60</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb249-1"><a href="eda.html#cb249-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb249-2"><a href="eda.html#cb249-2" tabindex="-1"></a></span>
<span id="cb249-3"><a href="eda.html#cb249-3" tabindex="-1"></a><span class="fu">quantile</span>(h<span class="sc">$</span>claytotest, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   5%  50%  95% 
## 13.0 22.0 38.1</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb251-1"><a href="eda.html#cb251-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb251-2"><a href="eda.html#cb251-2" tabindex="-1"></a></span>
<span id="cb251-3"><a href="eda.html#cb251-3" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">Quantile</span>(h<span class="sc">$</span>claytotest, <span class="at">weights =</span> h<span class="sc">$</span>thk, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##   10   20   25   29   60</code></pre>
<p>Thus, for the five number summary 25% of the observations fall between each of the intervals. <a href="https://ncss-tech.github.io/soil-range-in-characteristics/why-percentiles.html">Quantiles are a useful metric because they are largely unaffected by the distribution of the data, and have a simple interpretation</a>.</p>
<p>The National Soil Survey Handbook Part 618.2 specifies that new aggregate component data in NASIS should use quantiles for low, RV, and high values. For low and high the 5th, 10th, 20th and 80th, 90th, 95th can be used, respectively, according to which percentiles best capture the spread of a particular dataset. For newly populated information in NASIS, the RV is used to approximate the 50th percentile (median) of a dataset.</p>
</div>
<div id="range" class="section level4 hasAnchor" number="3.6.2.5">
<h4><span class="header-section-number">3.6.2.5</span> Range<a href="eda.html#range" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Range</strong> is the difference between the highest and lowest measurement of a group. Using a vector of sample data (<code>clay</code>) the range can be may be determined with:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb253-1"><a href="eda.html#cb253-1" tabindex="-1"></a><span class="fu">range</span>(clay)</span></code></pre></div>
<pre><code>## [1] 10 60</code></pre>
<p>which returns the minimum and maximum values observed.</p>
<p>To get the width of the range you can do:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb255-1"><a href="eda.html#cb255-1" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(clay))</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb257-1"><a href="eda.html#cb257-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb257-2"><a href="eda.html#cb257-2" tabindex="-1"></a></span>
<span id="cb257-3"><a href="eda.html#cb257-3" tabindex="-1"></a><span class="fu">max</span>(clay) <span class="sc">-</span> <span class="fu">min</span>(clay)</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
</div>
<div id="interquartile-range" class="section level4 hasAnchor" number="3.6.2.6">
<h4><span class="header-section-number">3.6.2.6</span> Interquartile Range<a href="eda.html#interquartile-range" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Interquartile Range</strong> (IQR) is the range from the upper (75%) quartile to the lower (25%) quartile. This represents 50% of the observations occurring in the mid-range of a sample. IQR is a robust measure of dispersion, unaffected by the distribution of data. In soil survey lingo you could consider the IQR to estimate the central concept of a soil property. IQR may be calculated for the sample dataset as:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb259-1"><a href="eda.html#cb259-1" tabindex="-1"></a><span class="fu">IQR</span>(clay)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb261-1"><a href="eda.html#cb261-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb261-2"><a href="eda.html#cb261-2" tabindex="-1"></a></span>
<span id="cb261-3"><a href="eda.html#cb261-3" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">quantile</span>(clay, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)))</span></code></pre></div>
<pre><code>## 75% 
##  10</code></pre>
</div>
</div>
<div id="correlation" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Correlation<a href="eda.html#correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A correlation matrix is a table of the calculated correlation coefficients of all variables. This provides a quantitative measure to guide the decision making process. The following will produce a correlation matrix for the sp4 dataset:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb263-1"><a href="eda.html#cb263-1" tabindex="-1"></a>h<span class="sc">$</span>hzdepm <span class="ot">&lt;-</span> (h<span class="sc">$</span>hzdepb <span class="sc">+</span> h<span class="sc">$</span>hzdept) <span class="sc">/</span> <span class="dv">2</span> <span class="co"># Compute the middle horizon depth</span></span>
<span id="cb263-2"><a href="eda.html#cb263-2" tabindex="-1"></a></span>
<span id="cb263-3"><a href="eda.html#cb263-3" tabindex="-1"></a>h <span class="sc">%&gt;%</span></span>
<span id="cb263-4"><a href="eda.html#cb263-4" tabindex="-1"></a>  <span class="fu">select</span>(hzdepm, claytotest, sandtotest, total_frags_pct, phfield) <span class="sc">%&gt;%</span></span>
<span id="cb263-5"><a href="eda.html#cb263-5" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb263-6"><a href="eda.html#cb263-6" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                 hzdepm claytotest sandtotest total_frags_pct phfield
## hzdepm            1.00       0.59      -0.08            0.50   -0.03
## claytotest        0.59       1.00      -0.17            0.28    0.13
## sandtotest       -0.08      -0.17       1.00           -0.05    0.12
## total_frags_pct   0.50       0.28      -0.05            1.00   -0.16
## phfield          -0.03       0.13       0.12           -0.16    1.00</code></pre>
<p>Variables are perfectly correlated with themselves so they have a correlation coefficient of 1.0. Negative values indicate a negative relationship between variables.</p>
<p>What is considered “highly correlated”? A good rule of thumb is anything with a value of <strong>0.7</strong> or greater is considered highly correlated.</p>
</div>
</div>
<div id="exercise-2-compute-descriptive-statistics" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Exercise 2: Compute Descriptive Statistics<a href="eda.html#exercise-2-compute-descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Add to your existing R script from Exercise 1, add answers as comments, and send to your mentor. Exercise 3 will build on Exercises 1 and 2.</p>
<ol style="list-style-type: decimal">
<li>Aggregate by <code>genhz</code> and calculate several descriptive statistics for <code>hzdept</code>, <code>gravel</code> and <code>phfield</code>.</li>
<li>Repeat step one, but include the <code>genhz_wt</code> as a weight in the statistics. How different are the results from step 1?</li>
<li>Cross-tabulate <code>geomposhill</code> and <code>argillic.horizon</code> from the site table, as a percentage.</li>
<li>Compute a correlation matrix between <code>hzdept</code>, <code>gravel</code> and <code>phfield</code>.</li>
</ol>
</div>
<div id="graphical-methods" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Graphical Methods<a href="eda.html#graphical-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we’ve checked for missing values and typos and made corrections, we can graphically examine the sample data distribution of our data. Frequency distributions are useful because they can help us visualize the center (e.g., RV) and spread or dispersion (e.g., low and high) of our data. Typically in introductory statistics the normal (i.e., Gaussian) distribution is emphasized.</p>
<table>
<caption><span id="tab:graphical-descriptions">Table 3.2: </span>Short Description of Graphical Methods</caption>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Plot Types</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bar</td>
<td align="left">a plot where each bar represents the frequency of observations for a ‘group’</td>
</tr>
<tr class="even">
<td align="left">Histogram</td>
<td align="left">a plot where each bar represents the frequency of observations for a ‘given range of values’</td>
</tr>
<tr class="odd">
<td align="left">Density</td>
<td align="left">an estimation of the frequency distribution based on the sample data</td>
</tr>
<tr class="even">
<td align="left">Quantile-Quantile</td>
<td align="left">a plot of the actual data values against a normal distribution</td>
</tr>
<tr class="odd">
<td align="left">Box-Whisker</td>
<td align="left">a visual representation of median, quartiles, symmetry, skewness, and outliers</td>
</tr>
<tr class="even">
<td align="left">Scatter &amp; Line</td>
<td align="left">a graphical display of one variable plotted on the x axis and another on the y axis</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:graphical-functions">Table 3.3: </span>Comparison of R’s 3 Graphing Systems and their Equivalent Functions for Plotting</caption>
<thead>
<tr class="header">
<th align="left">Plot Types</th>
<th align="left">Base R</th>
<th align="left">lattice</th>
<th align="left">ggplot2 geoms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bar</td>
<td align="left">barplot()</td>
<td align="left">barchart()</td>
<td align="left">geom_bar()</td>
</tr>
<tr class="even">
<td align="left">Histogram</td>
<td align="left">hist()</td>
<td align="left">histogram()</td>
<td align="left">geom_histogram()</td>
</tr>
<tr class="odd">
<td align="left">Density</td>
<td align="left">plot(density())</td>
<td align="left">densityplot()</td>
<td align="left">geom_density()</td>
</tr>
<tr class="even">
<td align="left">Quantile-Quantile</td>
<td align="left">qqnorm()</td>
<td align="left">qq()</td>
<td align="left">geom_qq()</td>
</tr>
<tr class="odd">
<td align="left">Box-Whisker</td>
<td align="left">boxplot()</td>
<td align="left">bwplot()</td>
<td align="left">geom_boxplot()</td>
</tr>
<tr class="even">
<td align="left">Scatter &amp; Line</td>
<td align="left">plot()</td>
<td align="left">xyplot</td>
<td align="left">geom_point()</td>
</tr>
</tbody>
</table>
<p>The <code>ggplot2 geoms</code> allow for the incorporation of weights using the <code>weight</code> argument in the <code>aes()</code> function, where appropriate.</p>
<div id="distributions" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Distributions<a href="eda.html#distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="s4ssbook_files/figure-html/distribution%20comparison-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="bar-plot" class="section level3 hasAnchor" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Bar Plot<a href="eda.html#bar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A bar plot is a graphical display of the frequency (i.e. number of observations (count or n)), such as soil texture, that fall within a given class. It is a graphical alternative to to the <code>table()</code> function.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb265-1"><a href="eda.html#cb265-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb265-2"><a href="eda.html#cb265-2" tabindex="-1"></a></span>
<span id="cb265-3"><a href="eda.html#cb265-3" tabindex="-1"></a><span class="co"># bar plot</span></span>
<span id="cb265-4"><a href="eda.html#cb265-4" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> texcl, <span class="at">weight =</span> thk)) <span class="sc">+</span></span>
<span id="cb265-5"><a href="eda.html#cb265-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/barplot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="histogram" class="section level3 hasAnchor" number="3.8.3">
<h3><span class="header-section-number">3.8.3</span> Histogram<a href="eda.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A histogram is similar to a bar plot, except that instead of summarizing categorical data, it categorizes a continuous variable like clay content into non-overlappying intervals for the sake of display. The number of intervals can be specified by the user, or can be automatically determined using an algorithm, such as <code>nclass.Sturges()</code>. Since histograms are dependent on the number of bins, for small datasets they’re not the best method of determining the shape of a distribution.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb266-1"><a href="eda.html#cb266-1" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> claytotest)) <span class="sc">+</span></span>
<span id="cb266-2"><a href="eda.html#cb266-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="fu">nclass.Sturges</span>(h<span class="sc">$</span>claytotest))</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/histogram-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="density-curve" class="section level3 hasAnchor" number="3.8.4">
<h3><span class="header-section-number">3.8.4</span> Density Curve<a href="eda.html#density-curve" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A density estimation, also known as a Kernel density plot, generally provides a better visualization of the shape of the distribution in comparison to the histogram. Compared to the histogram where the y-axis represents the number or percent (i.e., frequency) of observations, the y-axis for the density plot represents the probability of observing any given value, such that the area under the curve equals one. One curious feature of the density curve is the hint of two peaks (i.e. bimodal distribution?). Given that our sample includes a mixture of surface and subsurface horizons, we may have two different populations. However, considering how much the two distributions overlap, it seems impractical to separate them in this instance.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb267-1"><a href="eda.html#cb267-1" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> claytotest)) <span class="sc">+</span></span>
<span id="cb267-2"><a href="eda.html#cb267-2" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/densityplot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="box-plots" class="section level3 hasAnchor" number="3.8.5">
<h3><span class="header-section-number">3.8.5</span> Box plots<a href="eda.html#box-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Box plots are a graphical representation of the five number summary, depicting quartiles (i.e. the 25%, 50%, and 75% quantiles), minimum, maximum and outliers (if present). Boxplots convey the shape of the data distribution, the presence of extreme values, and the ability to compare with other variables using the same scale, providing an excellent tool for screening data, determining thresholds for variables and developing working hypotheses.</p>
<p>The parts of the boxplot are shown in the figure below. The “box” of the boxplot is defined as the 1st quartile and the 3rd quartile. The median, or 2nd quartile, is the dark line in the box. The whiskers (typically) show data that is 1.5 * IQR above and below the 3rd and 1st quartile. Any data point that is beyond a whisker is considered an outlier.</p>
<p>That is not to say the outlier points are in error, just that they are extreme compared to the rest of the data set. However, you may want to evaluate these points to ensure that they are correct.</p>
<p><img src="s4ssbook_files/figure-html/bp-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb268-1"><a href="eda.html#cb268-1" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> genhz, <span class="at">y =</span> claytotest)) <span class="sc">+</span></span>
<span id="cb268-2"><a href="eda.html#cb268-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/boxplots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The above box plot shows a steady increase in clay content with depth. Notice the outliers in the box plots, identified by the individual circles.</p>
</div>
<div id="quantile-comparison-plots-qqplot" class="section level3 hasAnchor" number="3.8.6">
<h3><span class="header-section-number">3.8.6</span> Quantile comparison plots (QQplot)<a href="eda.html#quantile-comparison-plots-qqplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A QQ plot is a plot of the actual data values against a normal distribution (which has a mean of 0 and standard deviation of 1).</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb269-1"><a href="eda.html#cb269-1" tabindex="-1"></a><span class="co"># QQ Plot for Clay</span></span>
<span id="cb269-2"><a href="eda.html#cb269-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">sample =</span> claytotest)) <span class="sc">+</span> </span>
<span id="cb269-3"><a href="eda.html#cb269-3" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb269-4"><a href="eda.html#cb269-4" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-107-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb270-1"><a href="eda.html#cb270-1" tabindex="-1"></a><span class="co"># QQ Plot for Frags</span></span>
<span id="cb270-2"><a href="eda.html#cb270-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">sample =</span> total_frags_pct)) <span class="sc">+</span> </span>
<span id="cb270-3"><a href="eda.html#cb270-3" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb270-4"><a href="eda.html#cb270-4" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-107-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>If the data set is perfectly symmetric (i.e. normal), the data points will form a straight line. Overall this plot shows that our clay example is more or less symmetric. However the second plot shows that our rock fragments are far from evenly distributed.</p>
<p>A more detailed explanation of QQ plots may be found on Wikipedia:<br />
<a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">https://en.wikipedia.org/wiki/QQ_plot</a></p>
</div>
<div id="the-normal-distribution" class="section level3 hasAnchor" number="3.8.7">
<h3><span class="header-section-number">3.8.7</span> The ‘Normal’ distribution<a href="eda.html#the-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is a normal distribution and why should you care? Many statistical methods are based on the properties of a normal distribution. Applying certain methods to data that are not normally distributed can give misleading or incorrect results. Most methods that assume normality are robust enough for all data except the very abnormal. This section is not meant to be a recipe for decision making, but more an extension of tools available to help you examine your data and proceed accordingly. The impact of normality is most commonly seen for parameters used by pedologists for documenting the ranges of a variable (i.e., Low, RV and High values). Often a rule-of thumb similar to: “two standard deviations” is used to define the low and high values of a variable. This is fine if the data are normally distributed. However, if the data are skewed, using the standard deviation as a parameter does not provide useful information of the data distribution. The quantitative measures of Kurtosis (peakedness) and Skewness (symmetry) can be used to assist in accessing normality and can be found in the <a href="https://cran.r-project.org/web/packages/psych/index.html">fBasics</a> package, but Webster <span class="citation">(<a href="#ref-webster2001">2001</a>)</span> cautions against using significance tests for assessing normality. The preceding sections and chapters will demonstrate various methods to cope with alternative distributions.</p>
<p>A Gaussian distribution is often referred to as “Bell Curve”, and has the following properties:</p>
<ol style="list-style-type: decimal">
<li>Gaussian distributions are <strong>symmetric</strong> around their mean</li>
<li>The mean, median, and mode of a Gaussian distribution are <strong>equal</strong></li>
<li>The area under the curve is equal to <strong>1.0</strong></li>
<li>Gaussian distributions are <strong>denser</strong> in the center and less dense in the tails</li>
<li>Gaussian distributions are <strong>defined</strong> by two parameters, the mean and the standard deviation</li>
<li><strong>68%</strong> of the area under the curve is within one standard deviation of the mean</li>
<li>Approximately <strong>95%</strong> of the area of a Gaussian distribution is within two standard deviations of the mean</li>
</ol>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-108-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Viewing a histogram or density plot of your data provides a quick visual reference for determining normality. Distributions are typically normal, Bimodal or Skewed:</p>
<div class="float">
<img src="static-figures/ch4_fig35.jpg" alt="Examples of different types of distributions" />
<div class="figcaption">Examples of different types of distributions</div>
</div>
<p>Occasionally distributions are Uniform, or nearly so:</p>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-109-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>With the loafercreek dataset the mean and median for clay were only slightly different, so we can safely assume that we have a normal distribution. However many soil variables often have a non-normal distribution. For example, let’s look at graphical examination of the mean vs. median for clay and rock fragments:</p>
<p><img src="s4ssbook_files/figure-html/clay%20vs%20frags-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The solid lines represent the breakpoint for the mean and standard deviations. The dashed lines represents the median and quantiles. The median is a more robust measure of central tendency compared to the mean. In order for the mean to be a useful measure, the data distribution must be approximately normal. The further the data departs from normality, the less meaningful the mean becomes.</p>
<p>The median always represents the same thing independent of the data distribution, namely, 50% of the samples are below and 50% are above the median. The example for clay again indicates that distribution is approximately normal.</p>
<p>However for rock fragments, we commonly see a long tailed distribution (e.g., skewed). Using the mean in this instance would overestimate the rock fragments. Although in this instance the difference between the mean and median is only 9 percent.</p>
</div>
<div id="scatterplots-and-line-plots" class="section level3 hasAnchor" number="3.8.8">
<h3><span class="header-section-number">3.8.8</span> Scatterplots and Line Plots<a href="eda.html#scatterplots-and-line-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-110-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Plotting points of one ratio or interval variable against another is a scatter plot. Plots can be produced for a single or multiple pairs of variables. Many independent variables are often under consideration in soil survey work. This is especially common when GIS is used, which offers the potential to correlate soil attributes with a large variety of raster datasets.</p>
<p>The purpose of a scatterplot is to see how one variable relates to another. With modeling in general the goal is parsimony (i.e., simple). The goal is to determine the fewest number of variables required to explain or describe a relationship. If two variables explain the same thing, i.e., they are highly correlated, only one variable is needed. The scatterplot provides a perfect visual reference for this.</p>
<p>Create a basic scatter plot using the loafercreek dataset.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb271-1"><a href="eda.html#cb271-1" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb271-2"><a href="eda.html#cb271-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> claytotest, <span class="at">y =</span> hzdepm)) <span class="sc">+</span></span>
<span id="cb271-3"><a href="eda.html#cb271-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb271-4"><a href="eda.html#cb271-4" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">100</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-111-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb272-1"><a href="eda.html#cb272-1" tabindex="-1"></a><span class="co"># line plot</span></span>
<span id="cb272-2"><a href="eda.html#cb272-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">y =</span> claytotest, <span class="at">x =</span> hzdepm, <span class="at">group =</span> peiid)) <span class="sc">+</span></span>
<span id="cb272-3"><a href="eda.html#cb272-3" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb272-4"><a href="eda.html#cb272-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb272-5"><a href="eda.html#cb272-5" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">100</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-111-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>This plots clay on the X axis and depth on the X axis. As shown in the scatterplot above, there is a moderate correlation between these variables.</p>
<p>The function below produces a scatterplot matrix for all the numeric variables in the dataset. This is a good command to use for determining rough linear correlations for continuous variables.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb273-1"><a href="eda.html#cb273-1" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb273-2"><a href="eda.html#cb273-2" tabindex="-1"></a>  </span>
<span id="cb273-3"><a href="eda.html#cb273-3" tabindex="-1"></a>h <span class="sc">%&gt;%</span></span>
<span id="cb273-4"><a href="eda.html#cb273-4" tabindex="-1"></a>  <span class="fu">select</span>(hzdepm, claytotest, phfield, total_frags_pct) <span class="sc">%&gt;%</span></span>
<span id="cb273-5"><a href="eda.html#cb273-5" tabindex="-1"></a>  <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-112-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="rd-dimension---color-shape-size-layers-etc" class="section level3 hasAnchor" number="3.8.9">
<h3><span class="header-section-number">3.8.9</span> 3rd Dimension - Color, Shape, Size, Layers, etc…<a href="eda.html#rd-dimension---color-shape-size-layers-etc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-113-1.png" width="768" style="display: block; margin: auto;" /></p>
<div id="color-and-groups" class="section level4 hasAnchor" number="3.8.9.1">
<h4><span class="header-section-number">3.8.9.1</span> Color and Groups<a href="eda.html#color-and-groups" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb274"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb274-1"><a href="eda.html#cb274-1" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb274-2"><a href="eda.html#cb274-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> claytotest, <span class="at">y =</span> hzdepm, <span class="at">color =</span> genhz)) <span class="sc">+</span></span>
<span id="cb274-3"><a href="eda.html#cb274-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb274-4"><a href="eda.html#cb274-4" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">100</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/color-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb275-1"><a href="eda.html#cb275-1" tabindex="-1"></a><span class="co"># density plot</span></span>
<span id="cb275-2"><a href="eda.html#cb275-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> claytotest, <span class="at">color =</span> genhz)) <span class="sc">+</span></span>
<span id="cb275-3"><a href="eda.html#cb275-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/color-2.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb276-1"><a href="eda.html#cb276-1" tabindex="-1"></a><span class="co"># bar plot</span></span>
<span id="cb276-2"><a href="eda.html#cb276-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> genhz, <span class="at">fill =</span> texture_class)) <span class="sc">+</span></span>
<span id="cb276-3"><a href="eda.html#cb276-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/color-3.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb277-1"><a href="eda.html#cb277-1" tabindex="-1"></a><span class="co"># box plot</span></span>
<span id="cb277-2"><a href="eda.html#cb277-2" tabindex="-1"></a><span class="fu">ggplot</span>(h, <span class="fu">aes</span>(<span class="at">x =</span> genhz, <span class="at">y =</span> claytotest)) <span class="sc">+</span> </span>
<span id="cb277-3"><a href="eda.html#cb277-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/color-4.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb278-1"><a href="eda.html#cb278-1" tabindex="-1"></a><span class="co"># heat map (pseudo bar plot)</span></span>
<span id="cb278-2"><a href="eda.html#cb278-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(loafercreek)</span>
<span id="cb278-3"><a href="eda.html#cb278-3" tabindex="-1"></a></span>
<span id="cb278-4"><a href="eda.html#cb278-4" tabindex="-1"></a><span class="fu">ggplot</span>(s, <span class="fu">aes</span>(<span class="at">x =</span> landform_string, <span class="at">y =</span> pmkind)) <span class="sc">+</span> </span>
<span id="cb278-5"><a href="eda.html#cb278-5" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) </span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/color-5.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="facets---box-plots" class="section level4 hasAnchor" number="3.8.9.2">
<h4><span class="header-section-number">3.8.9.2</span> Facets - box plots<a href="eda.html#facets---box-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb279"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb279-1"><a href="eda.html#cb279-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb279-2"><a href="eda.html#cb279-2" tabindex="-1"></a></span>
<span id="cb279-3"><a href="eda.html#cb279-3" tabindex="-1"></a><span class="co"># convert to long format</span></span>
<span id="cb279-4"><a href="eda.html#cb279-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> h <span class="sc">%&gt;%</span> </span>
<span id="cb279-5"><a href="eda.html#cb279-5" tabindex="-1"></a>  <span class="fu">select</span>(peiid, genhz, hzdepm, claytotest, phfield, total_frags_pct) <span class="sc">%&gt;%</span> </span>
<span id="cb279-6"><a href="eda.html#cb279-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;claytotest&quot;</span>, <span class="st">&quot;phfield&quot;</span>, <span class="st">&quot;total_frags_pct&quot;</span>))</span>
<span id="cb279-7"><a href="eda.html#cb279-7" tabindex="-1"></a></span>
<span id="cb279-8"><a href="eda.html#cb279-8" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> genhz, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb279-9"><a href="eda.html#cb279-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb279-10"><a href="eda.html#cb279-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;genhz&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-11"><a href="eda.html#cb279-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/facets-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="facets---depth-plots" class="section level4 hasAnchor" number="3.8.9.3">
<h4><span class="header-section-number">3.8.9.3</span> Facets - depth plots<a href="eda.html#facets---depth-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb280"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb280-1"><a href="eda.html#cb280-1" tabindex="-1"></a><span class="fu">data</span>(loafercreek, <span class="at">package =</span> <span class="st">&quot;soilDB&quot;</span>)</span>
<span id="cb280-2"><a href="eda.html#cb280-2" tabindex="-1"></a></span>
<span id="cb280-3"><a href="eda.html#cb280-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">slab</span>(loafercreek, </span>
<span id="cb280-4"><a href="eda.html#cb280-4" tabindex="-1"></a>               <span class="at">fm =</span> <span class="sc">~</span> claytotest <span class="sc">+</span> phfield <span class="sc">+</span> total_frags_pct,</span>
<span id="cb280-5"><a href="eda.html#cb280-5" tabindex="-1"></a>               <span class="at">slab.structure =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb280-6"><a href="eda.html#cb280-6" tabindex="-1"></a>               <span class="at">slab.fun =</span> <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb280-7"><a href="eda.html#cb280-7" tabindex="-1"></a></span>
<span id="cb280-8"><a href="eda.html#cb280-8" tabindex="-1"></a><span class="fu">ggplot</span>(s, <span class="fu">aes</span>(<span class="at">x =</span> top, <span class="at">y =</span> X50.)) <span class="sc">+</span></span>
<span id="cb280-9"><a href="eda.html#cb280-9" tabindex="-1"></a>  <span class="co"># plot median</span></span>
<span id="cb280-10"><a href="eda.html#cb280-10" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb280-11"><a href="eda.html#cb280-11" tabindex="-1"></a>  <span class="co"># plot 10th &amp; 90th quantiles</span></span>
<span id="cb280-12"><a href="eda.html#cb280-12" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X10., <span class="at">ymax =</span> X90., <span class="at">x =</span> top), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb280-13"><a href="eda.html#cb280-13" tabindex="-1"></a>  <span class="co"># invert depths</span></span>
<span id="cb280-14"><a href="eda.html#cb280-14" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb280-15"><a href="eda.html#cb280-15" tabindex="-1"></a>  <span class="co"># flip axis</span></span>
<span id="cb280-16"><a href="eda.html#cb280-16" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb280-17"><a href="eda.html#cb280-17" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-114-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="exercise-3-graphical-methods" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Exercise 3: Graphical Methods<a href="eda.html#exercise-3-graphical-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Add to your existing R script from Exercise 2, add answers as comments, and send to your mentor.</p>
<ol style="list-style-type: decimal">
<li><p>Create a faceted boxplot of <code>genhz</code> vs <code>gravel</code> and <code>phfield</code>, and use <code>genhz</code> as a weight in the <code>aes()</code> function.</p></li>
<li><p>Create a faceted depth plot for <code>gravel</code> and <code>phfield</code>.</p></li>
<li><p>Why is it not necessary to include a weight in the faceted depth plot?</p></li>
</ol>
</div>
<div id="transformations" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Transformations<a href="eda.html#transformations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Slope aspect and pH are two common variables warranting special consideration.</p>
<div id="ph" class="section level3 hasAnchor" number="3.10.1">
<h3><span class="header-section-number">3.10.1</span> pH<a href="eda.html#ph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is debate about the best way to average <strong>pH</strong> since is it a log transformed variable. Remember, pHs of 6 and 5 correspond to hydrogen ion concentrations of 0.000001 and 0.00001 respectively. The actual average is 5.26; -log10((0.000001 + 0.00001) / 2). If no conversions are made for pH, the mean and sd in the summary are considered the geometric mean and sd, not the arithmetic. The wider the pH range, the greater the difference between the geometric and arithmetic mean. The difference between the arithmetic average of 5.26 and the geometric average of 5.5 is small. <span class="citation">Boyd, Tucker, and Viriyatum (<a href="#ref-boyd2011">2011</a>)</span> examined the issue in detail, and suggests that regardless of the method used, the choice should be documented.</p>
<p>If you have a table with pH values and wish to calculate the arithmetic mean using R, this example will work:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb281-1"><a href="eda.html#cb281-1" tabindex="-1"></a><span class="co"># arithmetic mean</span></span>
<span id="cb281-2"><a href="eda.html#cb281-2" tabindex="-1"></a><span class="fu">log10</span>(<span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">10</span><span class="sc">^-</span>h<span class="sc">$</span>phfield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
<pre><code>## [1] 6.371026</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb283-1"><a href="eda.html#cb283-1" tabindex="-1"></a><span class="co"># geometric mean</span></span>
<span id="cb283-2"><a href="eda.html#cb283-2" tabindex="-1"></a><span class="fu">mean</span>(h<span class="sc">$</span>phfield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## [1] 6.18</code></pre>
</div>
<div id="circular-data" class="section level3 hasAnchor" number="3.10.2">
<h3><span class="header-section-number">3.10.2</span> Circular data<a href="eda.html#circular-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Slope aspect</strong> - requires the use of circular statistics for numerical summaries, or graphical interpretation using circular plots. For example, if soil map units being summarized have a uniform distribution of slope aspects ranging from 335 degrees to 25 degrees, the Zonal Statistics tool in ArcGIS would return a mean of 180.</p>
<p>The most intuitive means available for evaluating and describing slope aspect are circular plots available with the circular package in R and the radial plot option in the <a href="https://www.fs.usda.gov/about-agency/gtac/teui">TEUI Toolkit</a>. The circular package in R will also calculate circular statistics like mean, median, quartiles etc.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb285-1"><a href="eda.html#cb285-1" tabindex="-1"></a><span class="fu">library</span>(circular)</span>
<span id="cb285-2"><a href="eda.html#cb285-2" tabindex="-1"></a></span>
<span id="cb285-3"><a href="eda.html#cb285-3" tabindex="-1"></a><span class="co"># Extract the site table</span></span>
<span id="cb285-4"><a href="eda.html#cb285-4" tabindex="-1"></a>s <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(loafercreek) </span>
<span id="cb285-5"><a href="eda.html#cb285-5" tabindex="-1"></a></span>
<span id="cb285-6"><a href="eda.html#cb285-6" tabindex="-1"></a>aspect <span class="ot">&lt;-</span> s<span class="sc">$</span>aspect_field</span>
<span id="cb285-7"><a href="eda.html#cb285-7" tabindex="-1"></a>aspect <span class="ot">&lt;-</span> <span class="fu">circular</span>(aspect, <span class="at">template=</span><span class="st">&quot;geographic&quot;</span>, <span class="at">units=</span><span class="st">&quot;degrees&quot;</span>, <span class="at">modulo=</span><span class="st">&quot;2pi&quot;</span>)</span>
<span id="cb285-8"><a href="eda.html#cb285-8" tabindex="-1"></a></span>
<span id="cb285-9"><a href="eda.html#cb285-9" tabindex="-1"></a><span class="fu">summary</span>(aspect)</span></code></pre></div>
<pre><code>##        n     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.      Rho     NA&#39;s 
## 101.0000  12.0000 255.0000 195.0000 199.5000 115.0000  20.0000   0.1772   5.0000</code></pre>
<p>The numeric output is fine, but a following graphic is more revealing, which shows the dominant Southwest slope aspect.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb287-1"><a href="eda.html#cb287-1" tabindex="-1"></a><span class="fu">rose.diag</span>(aspect, <span class="at">bins =</span> <span class="dv">8</span>, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-117-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="texture-class-and-fine-earth-separates" class="section level3 hasAnchor" number="3.10.3">
<h3><span class="header-section-number">3.10.3</span> Texture Class and Fine-earth Separates<a href="eda.html#texture-class-and-fine-earth-separates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many pedon descriptions include soil texture class and modifiers, but lack numeric estimates such as clay content and rock fragments percentage. This lack of “continuous” numeric data makes it difficult to analyze and estimate certain properties precisely.</p>
<p>While numeric data on textural separates may be missing, it can still be estimated by the class ranges and averages. NASIS has many calculations used to estimate missing values. To facilitate this process in R, several new functions have recently been added to the aqp package. These new aqp functions are intended to impute missing values or check existing values. The <code>ssc_to_texcl()</code> function uses the same logic as the particle size estimator calculation in NASIS to classify sand and clay into texture class. The results are stored in <code>data(soiltexture)</code> and used by <code>texcl_to_ssc()</code> as a lookup table to convert texture class to sand, silt and clay. The function <code>texcl_to_ssc()</code> replicates the functionality described by Levi (2017). Unlike the other functions, <code>texture_to_taxpartsize()</code> is intended to be computed on weighted averages within the family particle size control section. Below is a demonstration of these new aqp R functions.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb288-1"><a href="eda.html#cb288-1" tabindex="-1"></a><span class="fu">library</span>(aqp)</span>
<span id="cb288-2"><a href="eda.html#cb288-2" tabindex="-1"></a><span class="fu">library</span>(soiltexture)</span>
<span id="cb288-3"><a href="eda.html#cb288-3" tabindex="-1"></a></span>
<span id="cb288-4"><a href="eda.html#cb288-4" tabindex="-1"></a><span class="co"># example of texcl_to_ssc(texcl)</span></span>
<span id="cb288-5"><a href="eda.html#cb288-5" tabindex="-1"></a>texcl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s&quot;</span>, <span class="st">&quot;ls&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;cl&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb288-6"><a href="eda.html#cb288-6" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">texcl_to_ssc</span>(texcl)</span>
<span id="cb288-7"><a href="eda.html#cb288-7" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(texcl, test))</span>
<span id="cb288-8"><a href="eda.html#cb288-8" tabindex="-1"></a></span>
<span id="cb288-9"><a href="eda.html#cb288-9" tabindex="-1"></a><span class="co"># example of ssc_to_texcl()</span></span>
<span id="cb288-10"><a href="eda.html#cb288-10" tabindex="-1"></a>ssc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb288-11"><a href="eda.html#cb288-11" tabindex="-1"></a>  <span class="at">CLAY =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">33</span>, <span class="dv">18</span>, <span class="dv">6</span>, <span class="dv">3</span>),</span>
<span id="cb288-12"><a href="eda.html#cb288-12" tabindex="-1"></a>  <span class="at">SAND =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">42</span>, <span class="dv">82</span>, <span class="dv">93</span>),</span>
<span id="cb288-13"><a href="eda.html#cb288-13" tabindex="-1"></a>  <span class="at">SILT =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">34</span>, <span class="dv">40</span>, <span class="dv">12</span>, <span class="dv">4</span>)</span>
<span id="cb288-14"><a href="eda.html#cb288-14" tabindex="-1"></a>)</span>
<span id="cb288-15"><a href="eda.html#cb288-15" tabindex="-1"></a></span>
<span id="cb288-16"><a href="eda.html#cb288-16" tabindex="-1"></a>texcl <span class="ot">&lt;-</span> <span class="fu">ssc_to_texcl</span>(<span class="at">sand =</span> ssc<span class="sc">$</span>SAND, <span class="at">clay =</span> ssc<span class="sc">$</span>CLAY)</span>
<span id="cb288-17"><a href="eda.html#cb288-17" tabindex="-1"></a>ssc_texcl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ssc, texcl)</span>
<span id="cb288-18"><a href="eda.html#cb288-18" tabindex="-1"></a><span class="fu">head</span>(ssc_texcl)</span>
<span id="cb288-19"><a href="eda.html#cb288-19" tabindex="-1"></a></span>
<span id="cb288-20"><a href="eda.html#cb288-20" tabindex="-1"></a><span class="co"># plot on a textural triangle</span></span>
<span id="cb288-21"><a href="eda.html#cb288-21" tabindex="-1"></a><span class="fu">TT.plot</span>(</span>
<span id="cb288-22"><a href="eda.html#cb288-22" tabindex="-1"></a>  <span class="at">class.sys =</span> <span class="st">&quot;USDA-NCSS.TT&quot;</span>,</span>
<span id="cb288-23"><a href="eda.html#cb288-23" tabindex="-1"></a>  <span class="at">tri.data =</span> ssc_texcl,</span>
<span id="cb288-24"><a href="eda.html#cb288-24" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb288-25"><a href="eda.html#cb288-25" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb288-26"><a href="eda.html#cb288-26" tabindex="-1"></a>)</span>
<span id="cb288-27"><a href="eda.html#cb288-27" tabindex="-1"></a></span>
<span id="cb288-28"><a href="eda.html#cb288-28" tabindex="-1"></a><span class="co"># example of texmod_to_fragvoltol()</span></span>
<span id="cb288-29"><a href="eda.html#cb288-29" tabindex="-1"></a>frags <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gr&quot;</span>, <span class="st">&quot;grv&quot;</span>, <span class="st">&quot;grx&quot;</span>, <span class="st">&quot;pgr&quot;</span>, <span class="st">&quot;pgrv&quot;</span>, <span class="st">&quot;pgrx&quot;</span>)</span>
<span id="cb288-30"><a href="eda.html#cb288-30" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">texmod_to_fragvoltot</span>(frags)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb288-31"><a href="eda.html#cb288-31" tabindex="-1"></a><span class="fu">head</span>(test)</span>
<span id="cb288-32"><a href="eda.html#cb288-32" tabindex="-1"></a></span>
<span id="cb288-33"><a href="eda.html#cb288-33" tabindex="-1"></a><span class="co"># example of texture_to_taxpartsize()</span></span>
<span id="cb288-34"><a href="eda.html#cb288-34" tabindex="-1"></a>tex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb288-35"><a href="eda.html#cb288-35" tabindex="-1"></a>  <span class="at">texcl =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;cl&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;ls&quot;</span>, <span class="st">&quot;s&quot;</span>),</span>
<span id="cb288-36"><a href="eda.html#cb288-36" tabindex="-1"></a>  <span class="at">clay  =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">33</span>, <span class="dv">18</span>, <span class="dv">6</span>, <span class="dv">3</span>),</span>
<span id="cb288-37"><a href="eda.html#cb288-37" tabindex="-1"></a>  <span class="at">sand  =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">42</span>, <span class="dv">82</span>, <span class="dv">93</span>),</span>
<span id="cb288-38"><a href="eda.html#cb288-38" tabindex="-1"></a>  <span class="at">fragvoltot =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">15</span>, <span class="dv">34</span>, <span class="dv">60</span>, <span class="dv">91</span>)</span>
<span id="cb288-39"><a href="eda.html#cb288-39" tabindex="-1"></a>)</span>
<span id="cb288-40"><a href="eda.html#cb288-40" tabindex="-1"></a></span>
<span id="cb288-41"><a href="eda.html#cb288-41" tabindex="-1"></a>tex<span class="sc">$</span>fpsc <span class="ot">&lt;-</span> <span class="fu">texture_to_taxpartsize</span>(</span>
<span id="cb288-42"><a href="eda.html#cb288-42" tabindex="-1"></a>  <span class="at">texcl =</span> tex<span class="sc">$</span>texcl,</span>
<span id="cb288-43"><a href="eda.html#cb288-43" tabindex="-1"></a>  <span class="at">clay =</span> tex<span class="sc">$</span>clay,</span>
<span id="cb288-44"><a href="eda.html#cb288-44" tabindex="-1"></a>  <span class="at">sand =</span> tex<span class="sc">$</span>sand,</span>
<span id="cb288-45"><a href="eda.html#cb288-45" tabindex="-1"></a>  <span class="at">fragvoltot =</span> tex<span class="sc">$</span>fragvoltot</span>
<span id="cb288-46"><a href="eda.html#cb288-46" tabindex="-1"></a>)</span>
<span id="cb288-47"><a href="eda.html#cb288-47" tabindex="-1"></a></span>
<span id="cb288-48"><a href="eda.html#cb288-48" tabindex="-1"></a><span class="fu">head</span>(tex)</span></code></pre></div>
</div>
</div>
<div id="the-shiny-package" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> The Shiny Package<a href="eda.html#the-shiny-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Shiny is an R package which combines R programming with the interactivity of the web.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb289-1"><a href="eda.html#cb289-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;shiny&quot;</span>)</span></code></pre></div>
<p>Methods for Use</p>
<ul>
<li>Online</li>
<li>Locally</li>
</ul>
<div class="notes">
<p>The shiny package, created by RStudio, enables users to not only use interactive applications created by others, but to build them as well.</p>
</div>
<div id="online" class="section level3 hasAnchor" number="3.11.1">
<h3><span class="header-section-number">3.11.1</span> Online<a href="eda.html#online" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Easiest Method</p>
<ul>
<li>Click a Link: <a href="https://gallery.shinyapps.io/lake_erie_fisheries_stock_assessment_app/" class="uri">https://gallery.shinyapps.io/lake_erie_fisheries_stock_assessment_app/</a></li>
<li>Open a web browser</li>
<li>Navigate to a URL</li>
</ul>
<div class="notes">
<p>The ability to use a shiny app online is one of the most useful features of the package. All of the R code is executed on a remote computer which sends the results over a live http connection. Very little is required of the user in order to obtain results.</p>
</div>
</div>
<div id="locally" class="section level3 hasAnchor" number="3.11.2">
<h3><span class="header-section-number">3.11.2</span> Locally<a href="eda.html#locally" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>No Internet required once configured</p>
<ul>
<li>Install R and RStudio (done)</li>
<li>Install Required packages (app dependent)</li>
<li>Download, open in RStudio and click “Run App”</li>
</ul>
<p>The online method may be easy for the user, but it does require a significant amount of additional effort for the creator. We won’t get into those details here! The local method, however simply requires the creator to share a single app.R file. It is the user which needs to put forth the additional effort.</p>
</div>
<div id="web-app-demonstration" class="section level3 hasAnchor" number="3.11.3">
<h3><span class="header-section-number">3.11.3</span> Web App Demonstration<a href="eda.html#web-app-demonstration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Online:</p>
<ul>
<li><a href="https://usda.shinyapps.io/ncr_app/" class="uri">https://usda.shinyapps.io/ncr_app/</a></li>
</ul>
<p>Local:</p>
<ul>
<li><a href="https://github.com/ncss-tech/vitrusa/raw/master/r11_smp_app/app.R" class="uri">https://github.com/ncss-tech/vitrusa/raw/master/r11_smp_app/app.R</a></li>
</ul>
<p>Online apps such as the North Central Region Web App are useful tools, available for all to use during soil survey, ecological site development, or other evaluations. The North Central Region app is however limited to data which is already available online, such as SDA (Soil Data Access) and NASIS (National Soil Information System) Web Reports.</p>
<p>It is also reliant on the successful operation of those data systems. If the NASIS Web Reports or SDA is down for maintenance, the app fails. Local apps have the ability to leverage local data systems more easily like NASIS or other proprietary data.</p>
</div>
<div id="troubleshooting-errors" class="section level3 hasAnchor" number="3.11.4">
<h3><span class="header-section-number">3.11.4</span> Troubleshooting Errors<a href="eda.html#troubleshooting-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Reload the app and try again. (refresh browser, or click stop, and run app again in RStudio) When the app throws an error, it stops. All other tabs/reports will no longer function until the app is reloaded.</p></li>
<li><p>Read the getting started section on the home page. This is a quick summary of tips to avoid issues, and will be updated as needed.</p></li>
<li><p>Check to see if SDA and NASIS Web Reports are operational, if they aren’t working, then the app won’t work either.</p></li>
<li><p>Double check your query inputs. (typos, wildcards, null data, and too much data, can be common issues)</p></li>
<li><p>5 minutes of inactivity will cause the connection to drop, be sure you are actively using the app.</p></li>
<li><p>Run the app locally - the online app does not show console activity, which can be a big help when identifying problems.</p></li>
<li><p>Check the app issues page to see if the issue you are experiencing is already documented. (Polite but not required)</p></li>
<li><p>Contact the app author (<a href="mailto:john.hammerly@usda.gov" class="email">john.hammerly@usda.gov</a>)</p></li>
</ol>
<p>When you run into trouble, there are a few steps you can take on your own to get things working again. This list may help you get your issue resolved. If not, contact (<a href="mailto:john.hammerly@usda.gov" class="email">john.hammerly@usda.gov</a>) for assistance.</p>
</div>
<div id="shiny-app-embedding" class="section level3 hasAnchor" number="3.11.5">
<h3><span class="header-section-number">3.11.5</span> Shiny App Embedding<a href="eda.html#shiny-app-embedding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Shiny apps are extremely versatile, they can be embedded into presentations, Markdown, or HTML Those same formats can also be embedded in to a shiny app. This is a very simple example of a shiny app which consists of an interactive dropdown menu which controls what region is displayed in the bar chart. Let’s take a look at the code.</p>
<div id="shiny-app-code" class="section level4 hasAnchor" number="3.11.5.1">
<h4><span class="header-section-number">3.11.5.1</span> Shiny App Code<a href="eda.html#shiny-app-code" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb290"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb290-1"><a href="eda.html#cb290-1" tabindex="-1"></a><span class="fu">shinyApp</span>(</span>
<span id="cb290-2"><a href="eda.html#cb290-2" tabindex="-1"></a>  </span>
<span id="cb290-3"><a href="eda.html#cb290-3" tabindex="-1"></a>  <span class="co"># Use a fluid Bootstrap layout</span></span>
<span id="cb290-4"><a href="eda.html#cb290-4" tabindex="-1"></a>  <span class="at">ui =</span> <span class="fu">fluidPage</span>(    </span>
<span id="cb290-5"><a href="eda.html#cb290-5" tabindex="-1"></a>    </span>
<span id="cb290-6"><a href="eda.html#cb290-6" tabindex="-1"></a>    <span class="co"># Give the page a title</span></span>
<span id="cb290-7"><a href="eda.html#cb290-7" tabindex="-1"></a>    <span class="fu">titlePanel</span>(<span class="st">&quot;Telephones by region&quot;</span>),</span>
<span id="cb290-8"><a href="eda.html#cb290-8" tabindex="-1"></a>    </span>
<span id="cb290-9"><a href="eda.html#cb290-9" tabindex="-1"></a>    <span class="co"># Generate a row with a sidebar</span></span>
<span id="cb290-10"><a href="eda.html#cb290-10" tabindex="-1"></a>    <span class="fu">sidebarLayout</span>(      </span>
<span id="cb290-11"><a href="eda.html#cb290-11" tabindex="-1"></a>      </span>
<span id="cb290-12"><a href="eda.html#cb290-12" tabindex="-1"></a>      <span class="co"># Define the sidebar with one input</span></span>
<span id="cb290-13"><a href="eda.html#cb290-13" tabindex="-1"></a>      <span class="fu">sidebarPanel</span>(</span>
<span id="cb290-14"><a href="eda.html#cb290-14" tabindex="-1"></a>        <span class="fu">selectInput</span>(<span class="st">&quot;region&quot;</span>, <span class="st">&quot;Region:&quot;</span>, </span>
<span id="cb290-15"><a href="eda.html#cb290-15" tabindex="-1"></a>                    <span class="at">choices =</span> <span class="fu">colnames</span>(datasets<span class="sc">::</span>WorldPhones)), </span>
<span id="cb290-16"><a href="eda.html#cb290-16" tabindex="-1"></a>        <span class="fu">hr</span>(),</span>
<span id="cb290-17"><a href="eda.html#cb290-17" tabindex="-1"></a>        <span class="fu">helpText</span>(<span class="st">&quot;Data from AT&amp;T (1961) The World&#39;s Telephones.&quot;</span>)</span>
<span id="cb290-18"><a href="eda.html#cb290-18" tabindex="-1"></a>      ),</span>
<span id="cb290-19"><a href="eda.html#cb290-19" tabindex="-1"></a>      </span>
<span id="cb290-20"><a href="eda.html#cb290-20" tabindex="-1"></a>      <span class="co"># Create a spot for the barplot</span></span>
<span id="cb290-21"><a href="eda.html#cb290-21" tabindex="-1"></a>      <span class="fu">mainPanel</span>(</span>
<span id="cb290-22"><a href="eda.html#cb290-22" tabindex="-1"></a>        <span class="fu">plotOutput</span>(<span class="st">&quot;phonePlot&quot;</span>)  </span>
<span id="cb290-23"><a href="eda.html#cb290-23" tabindex="-1"></a>      )</span>
<span id="cb290-24"><a href="eda.html#cb290-24" tabindex="-1"></a>      </span>
<span id="cb290-25"><a href="eda.html#cb290-25" tabindex="-1"></a>    )</span>
<span id="cb290-26"><a href="eda.html#cb290-26" tabindex="-1"></a>  ),</span>
<span id="cb290-27"><a href="eda.html#cb290-27" tabindex="-1"></a>  <span class="co"># Define a server function for the Shiny app</span></span>
<span id="cb290-28"><a href="eda.html#cb290-28" tabindex="-1"></a>  <span class="at">server =</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb290-29"><a href="eda.html#cb290-29" tabindex="-1"></a>    </span>
<span id="cb290-30"><a href="eda.html#cb290-30" tabindex="-1"></a>    <span class="co"># Fill in the spot we created for a plot</span></span>
<span id="cb290-31"><a href="eda.html#cb290-31" tabindex="-1"></a>    output<span class="sc">$</span>phonePlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb290-32"><a href="eda.html#cb290-32" tabindex="-1"></a>      </span>
<span id="cb290-33"><a href="eda.html#cb290-33" tabindex="-1"></a>      <span class="co"># Render a barplot</span></span>
<span id="cb290-34"><a href="eda.html#cb290-34" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb290-35"><a href="eda.html#cb290-35" tabindex="-1"></a>        datasets<span class="sc">::</span>WorldPhones[, input<span class="sc">$</span>region] <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb290-36"><a href="eda.html#cb290-36" tabindex="-1"></a>        <span class="at">main =</span> input<span class="sc">$</span>region,</span>
<span id="cb290-37"><a href="eda.html#cb290-37" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Number of Telephones&quot;</span>,</span>
<span id="cb290-38"><a href="eda.html#cb290-38" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb290-39"><a href="eda.html#cb290-39" tabindex="-1"></a>      )</span>
<span id="cb290-40"><a href="eda.html#cb290-40" tabindex="-1"></a>    })</span>
<span id="cb290-41"><a href="eda.html#cb290-41" tabindex="-1"></a>  }</span>
<span id="cb290-42"><a href="eda.html#cb290-42" tabindex="-1"></a>)</span></code></pre></div>
<p>Shiny apps consist of a <em>ui</em> and a <em>server</em>. The ui is the part of the shiny app the user sees, the user interface. In the ui, a user can choose or enter inputs for processing and viewing the results. The server takes the inputs, performs some data processing and rendering of those inputs and generates the outputs for the ui to display.</p>
</div>
</div>
<div id="questions" class="section level3 hasAnchor" number="3.11.6">
<h3><span class="header-section-number">3.11.6</span> Questions<a href="eda.html#questions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>What new features in RStudio are available for you to use once the <code>shiny</code> package is installed?</p></li>
<li><p>The Region 11 Web App uses which two data sources for reports?</p></li>
<li><p>If an error occurs while using the Region 11 Web App, what should you do?</p></li>
</ol>
</div>
<div id="examples" class="section level3 hasAnchor" number="3.11.7">
<h3><span class="header-section-number">3.11.7</span> Examples<a href="eda.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="nasis-reports" class="section level4 hasAnchor" number="3.11.7.1">
<h4><span class="header-section-number">3.11.7.1</span> NASIS Reports<a href="eda.html#nasis-reports" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="static-figures/usda.shinyapps.io_r11_app_nasis.png" /></p>
<p>The NASIS Reports button is a link to a master list of NASIS Web reports for Regions 10 and 11.</p>
</div>
<div id="water-table" class="section level4 hasAnchor" number="3.11.7.2">
<h4><span class="header-section-number">3.11.7.2</span> Water Table<a href="eda.html#water-table" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="static-figures/usda.shinyapps.io_r11_app_wt.png" /></p>
<p>The query method option allows you to choose between MUKEY, NATSYM, MUNAME. It also has a radio button for switching between flooding and ponding.</p>
<p>Plots and Data Tables are on separate sub-menu items.</p>
</div>
<div id="organic-matter" class="section level4 hasAnchor" number="3.11.7.3">
<h4><span class="header-section-number">3.11.7.3</span> Organic Matter<a href="eda.html#organic-matter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="static-figures/usda.shinyapps.io_r11_app_om.png" /></p>
<p>Same options as the Water Table Tab except no radio button. The query method option allows you to choose between MUKEY, NATSYM, MUNAME.</p>
<p>Plots and Data Tables are on separate sub-menu items.</p>
</div>
<div id="project-report" class="section level4 hasAnchor" number="3.11.7.4">
<h4><span class="header-section-number">3.11.7.4</span> Project Report<a href="eda.html#project-report" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The project report can accept multiple projects. Use the semicolon (;) as a separator. You can also save a copy of the report by clicking the link below the submit button.</p>
<p><img src="static-figures/usda.shinyapps.io_r11_app_pr.png" /></p>
</div>
<div id="project-extent" class="section level4 hasAnchor" number="3.11.7.5">
<h4><span class="header-section-number">3.11.7.5</span> Project Extent<a href="eda.html#project-extent" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="static-figures/usda.shinyapps.io_r11_app_pe.png" /></p>
<p>Type in Year, type or select office and type project name for the Project extent query. Zoom and pan to view extent. Use the layers button to change the basemap or toggle layers. Click the link below the submit button to download a .zip containing the extent as a ESRI shapefile.</p>
</div>
<div id="long-range-plan" class="section level4 hasAnchor" number="3.11.7.6">
<h4><span class="header-section-number">3.11.7.6</span> Long Range Plan<a href="eda.html#long-range-plan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="static-figures/usda.shinyapps.io_r11_app_lrp.png" /></p>
<p>Enter an office symbol to generate a long range plan report.</p>
</div>
<div id="interpretations" class="section level4 hasAnchor" number="3.11.7.7">
<h4><span class="header-section-number">3.11.7.7</span> Interpretations<a href="eda.html#interpretations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="static-figures/usda.shinyapps.io_r11_app_i.png" /></p>
<p>Enter the national mapunit symbol to plot all available interpretations for the mapunit from SDA.</p>
</div>
</div>
</div>
<div id="exercise-4-using-the-north-central-region-web-app" class="section level2 hasAnchor" number="3.12">
<h2><span class="header-section-number">3.12</span> Exercise 4: Using the North Central Region Web App<a href="eda.html#exercise-4-using-the-north-central-region-web-app" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="project-report-1" class="section level4 hasAnchor" number="3.12.0.1">
<h4><span class="header-section-number">3.12.0.1</span> Project Report<a href="eda.html#project-report-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Use the project report to generate a report on a project in your own area. Save the results and explain the results of pH plots for one of your components.</p>
</div>
<div id="project-extent-1" class="section level4 hasAnchor" number="3.12.0.2">
<h4><span class="header-section-number">3.12.0.2</span> Project Extent<a href="eda.html#project-extent-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Map an extent of a project. How many layers are available to choose from as a basemap? How many layers can be toggled on or off?</p>
</div>
<div id="long-range-plan-1" class="section level4 hasAnchor" number="3.12.0.3">
<h4><span class="header-section-number">3.12.0.3</span> Long Range Plan<a href="eda.html#long-range-plan-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Choose an office to generate a long range plan. What is the highest acreage project for 2025?</p>
</div>
</div>
<div id="soilreports" class="section level2 hasAnchor" number="3.13">
<h2><span class="header-section-number">3.13</span> soilReports<a href="eda.html#soilreports" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the strengths of NASIS is that it that has many queries and reports to access the complex data. This makes it easy for the average user to load their data, process it, and run numerous reports.</p>
<p>The <code>soilReports</code> R package is essentially just a collection of R Markdown (<em>.Rmd</em>) documents.</p>
<p>R Markdown is a plain text markup format for creating reproducible, dynamic reports with R. These <em>.Rmd</em> files can be used to generate HTML, PDF, Word, Markdown documents with a variety of forms, templates and applications.</p>
<ul>
<li><p>Example report output can be found at the following link: <a href="https://github.com/ncss-tech/soilReports#example-output" class="uri">https://github.com/ncss-tech/soilReports#example-output</a>.</p></li>
<li><p>Detailed instructions are provided for each report: <a href="https://github.com/ncss-tech/soilReports#choose-an-available-report" class="uri">https://github.com/ncss-tech/soilReports#choose-an-available-report</a></p></li>
</ul>
<p><strong>Install</strong> the <code>soilReports</code> package. This package is updated regularly and should be installed from GitHub.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb291-1"><a href="eda.html#cb291-1" tabindex="-1"></a><span class="co"># Install the soilReports package from GitHub</span></span>
<span id="cb291-2"><a href="eda.html#cb291-2" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;ncss-tech/soilReports&quot;</span>, <span class="at">dependencies =</span> <span class="cn">FALSE</span>, <span class="at">build =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>To view the list of available reports first load the package then use the <code>listReports()</code> function.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb292-1"><a href="eda.html#cb292-1" tabindex="-1"></a><span class="co"># Load the soilReports package</span></span>
<span id="cb292-2"><a href="eda.html#cb292-2" tabindex="-1"></a><span class="fu">library</span>(soilReports)</span>
<span id="cb292-3"><a href="eda.html#cb292-3" tabindex="-1"></a></span>
<span id="cb292-4"><a href="eda.html#cb292-4" tabindex="-1"></a><span class="co"># List reports</span></span>
<span id="cb292-5"><a href="eda.html#cb292-5" tabindex="-1"></a><span class="fu">listReports</span>()</span></code></pre></div>
<pre><code>##                                         name version
## 1                         national/DT-report     1.0
## 2                 national/NASIS-site-export     1.0
## 3  northcentral/component_summary_by_project     0.1
## 4      northcentral/lab_summary_by_taxonname     1.1
## 5  northcentral/mupolygon_summary_by_project     0.1
## 6    northcentral/pedon_summary_by_taxonname     1.2
## 7                         southwest/dmu-diff     0.7
## 8                      southwest/dmu-summary     0.5
## 9               southwest/edit-soil-features   0.2.1
## 10                     southwest/gdb-acreage     1.0
## 11         southwest/mlra-comparison-dynamic     0.1
## 12                 southwest/mlra-comparison     2.0
## 13         southwest/mu-comparison-dashboard   0.0.0
## 14                   southwest/mu-comparison   5.0.0
## 15                      southwest/mu-summary       1
## 16                   southwest/pedon-summary     1.1
## 17                      southwest/QA-summary     0.6
## 18             southwest/shiny-pedon-summary     1.2
## 19                  southwest/spatial-pedons     1.1
## 20                         templates/minimal     1.0
##                                                                                              description
## 1                                                          Create interactive data tables from CSV files
## 2                                                                    Export NASIS Sites to Spatial Layer
## 3                                                           summarize component data for an MLRA project
## 4                                                          summarize lab data from NASIS Lab Layer table
## 5                                                           summarize mupolygon layer from a geodatabase
## 6                                                          summarize field pedons from NASIS pedon table
## 7                                                                         Differences between select DMU
## 8                                                                                     DMU Summary Report
## 9                                 Generate summaries of NASIS components for EDIT Soil Features sections
## 10                                                            Geodatabase Mapunit Acreage Summary Report
## 11                                    compare MLRA/LRU-scale delineations, based on mu-comparison report
## 12                                                  compare MLRA using pre-made, raster sample databases
## 13          interactively subset and summarize SSURGO data for input to `southwest/mu-comparison` report
## 14                     compare stack of raster data, sampled from polygons associated with 1-8 map units
## 15                                     summarize raster data for a large collection of map unit polygons
## 16                                      Generate summaries from NASIS pedons and associated spatial data
## 17                                                                                     QA Summary Report
## 18                        Interactively subset and summarize NASIS pedon data from one or more map units
## 19 Visualize NASIS pedons in interactive HTML report with overlays of SSURGO, STATSGO or custom polygons
## 20                                                                        A minimal soilReports template</code></pre>
<div id="extending-soilreports" class="section level3 hasAnchor" number="3.13.1">
<h3><span class="header-section-number">3.13.1</span> Extending <code>soilReports</code><a href="eda.html#extending-soilreports" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each report in <code>soilReports</code> has a “manifest” that describes any dependencies, configuration files or inputs for your R Markdown report document. If you can identify these things it is easy to convert your own R-based analyses to the <code>soilReports</code> format.</p>
<p>The <em>.Rmd</em> file allows R code and text with Markdown markup to be mingled in the same document and then “executed” like an R script.</p>
</div>
</div>
<div id="exercise-5-run-lab-summary-by-taxon-name-soil-report" class="section level2 hasAnchor" number="3.14">
<h2><span class="header-section-number">3.14</span> Exercise 5: Run Lab Summary By Taxon Name Soil Report<a href="eda.html#exercise-5-run-lab-summary-by-taxon-name-soil-report" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For another exercise you can use the <code>region11/lab_summary_by_taxonname</code> report report to summarize laboratory data for a soil series. This report requires you to get some data from the Pedon “NCSS Lab” tables in NASIS.</p>
<div id="requirements" class="section level3 hasAnchor" number="3.14.1">
<h3><span class="header-section-number">3.14.1</span> Requirements<a href="eda.html#requirements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Data are properly populated, otherwise the report may fail. Common examples include:</p>
<ul>
<li>Horizon depths don’t lineup</li>
<li>Either the Pedon or Site tables isn’t loaded</li>
</ul></li>
<li><p>ODBC connection to NASIS is set up</p></li>
<li><p>NASIS local database and selected set contains site, pedon, NCSS Lab Pedon Lab Data tables</p></li>
<li><p>Beware each report has a unique configuration file that may need to be edited.</p></li>
</ul>
</div>
<div id="instructions" class="section level3 hasAnchor" number="3.14.2">
<h3><span class="header-section-number">3.14.2</span> Instructions<a href="eda.html#instructions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p><strong>Load</strong> your NASIS selected set. <strong>Run</strong> a query such as “POINT - Pedon/Site/NCSSlabdata by taxonname” from the <em>NSSC Pangaea</em> report folder to load your selected set. You can use <code>Miami</code> as the taxon name, or any taxon of your choice that has lab data. Be sure to target both the site, pedon and lab layer objects in query of national database. <strong>Remove</strong> from your selected set any pedons and sites you wish to exclude from the report.</p></li>
<li><p><strong>Copy</strong> the lab summary to your working directory.</p></li>
</ol>
<div class="sourceCode" id="cb294"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb294-1"><a href="eda.html#cb294-1" tabindex="-1"></a><span class="fu">copyReport</span>(<span class="at">reportName =</span> <span class="st">&quot;region11/lab_summary_by_taxonname&quot;</span>, <span class="at">outputDir =</span> <span class="st">&quot;C:/workspace2/lab_sum&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Examine</strong> the report folder contents.</li>
</ol>
<p>The report is titled <code>report.Rmd</code>. Notice there are several other support files. The parameters for the report are contained in the <code>config.R</code> file.</p>
<p><img src="static-figures/report_folder.png" /></p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Check</strong> or <strong>create</strong> a genhz_rules file for a soil series. In order to aggregate the pedons by horizon designation, a genhz_rules file (e.g., Miami_rules.R) is needed. See above.</li>
</ol>
<p>If none exists see the following job aid on how to create one, <a href="http://ncss-tech.github.io/AQP/aqp/gen-hz-assignment.html">Assigning Generalized Horizon Labels</a>.</p>
<p><img src="static-figures/miamian_rules.png" /></p>
<p>Pay special attention to how caret <code>^</code> and dollar <code>$</code> symbols are used in REGEX. They function as <em>anchors</em> for the beginning and end of the string, respectively.</p>
<ul>
<li><p>A <code>^</code> placed before an A horizon, <code>^A</code>, will match any horizon designation that starts with A, such as Ap, Ap1, but <em>not</em> something merely containing A, such as BA.</p></li>
<li><p>Placing a <code>$</code> after a Bt horizon, <code>Bt$</code>, will match any horizon designation that ends with Bt, such as 2Bt or 3Bt, but <em>not</em> something with a vertical subdivision, such as Bt2.</p></li>
<li><p>Wrapping pattern with both <code>^</code> and <code>$</code> symbols will result only in exact matches – i.e. that start and end with the contents between <code>^</code> and <code>$</code>. For example <code>^[AC]$</code>, will only match A or C, <em>not</em> Ap, Ap2, or Cg.</p></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Execute</strong> the report.</li>
</ol>
<p><strong>Command-line approach</strong></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb295-1"><a href="eda.html#cb295-1" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb295-2"><a href="eda.html#cb295-2" tabindex="-1"></a></span>
<span id="cb295-3"><a href="eda.html#cb295-3" tabindex="-1"></a><span class="co"># Set report parameters</span></span>
<span id="cb295-4"><a href="eda.html#cb295-4" tabindex="-1"></a>series <span class="ot">&lt;-</span> <span class="st">&quot;Miami&quot;</span></span>
<span id="cb295-5"><a href="eda.html#cb295-5" tabindex="-1"></a>genhz_rules <span class="ot">&lt;-</span> <span class="st">&quot;C:/workspace2/lab_sum/Miami_rules.R&quot;</span></span>
<span id="cb295-6"><a href="eda.html#cb295-6" tabindex="-1"></a></span>
<span id="cb295-7"><a href="eda.html#cb295-7" tabindex="-1"></a><span class="co"># report file path</span></span>
<span id="cb295-8"><a href="eda.html#cb295-8" tabindex="-1"></a>report_path <span class="ot">&lt;-</span> <span class="st">&quot;C:/workspace2/lab_sum/report.Rmd&quot;</span></span>
<span id="cb295-9"><a href="eda.html#cb295-9" tabindex="-1"></a></span>
<span id="cb295-10"><a href="eda.html#cb295-10" tabindex="-1"></a><span class="co"># Run the report</span></span>
<span id="cb295-11"><a href="eda.html#cb295-11" tabindex="-1"></a><span class="fu">render</span>(</span>
<span id="cb295-12"><a href="eda.html#cb295-12" tabindex="-1"></a>  <span class="at">input =</span> report_path,</span>
<span id="cb295-13"><a href="eda.html#cb295-13" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">&quot;C:/workspace2&quot;</span>,</span>
<span id="cb295-14"><a href="eda.html#cb295-14" tabindex="-1"></a>  <span class="at">output_file =</span> <span class="st">&quot;C:/workspace2/lab_sum.html&quot;</span>,</span>
<span id="cb295-15"><a href="eda.html#cb295-15" tabindex="-1"></a>  <span class="at">envir =</span> <span class="fu">new.env</span>(),</span>
<span id="cb295-16"><a href="eda.html#cb295-16" tabindex="-1"></a>  <span class="at">params =</span> <span class="fu">list</span>(<span class="at">series =</span> series, </span>
<span id="cb295-17"><a href="eda.html#cb295-17" tabindex="-1"></a>                <span class="at">genhz_rules =</span> genhz_rules)</span>
<span id="cb295-18"><a href="eda.html#cb295-18" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Manual approach</strong></p>
<p><strong>Open</strong> the report.Rmd, <strong>ckucj</strong> the Knit drop down arrow, and select <strong>Knit with Parameters</strong>.</p>
<p><img src="static-figures/knit_button.png" /></p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Save</strong> the report. The report is automatically saved upon creation in the same folder as the R report. However, it is given the same generic name as the R report (i.e., “C:/workspace/lab_sum/report.html”), and will be overwritten the next time the report is run. Therefore, if you wish to save the report, rename the .html file to a name of your choosing and/or convert it to a PDF.</li>
</ol>
<p><strong>Sample pedon report</strong></p>
<p><img src="static-figures/rmd_sample.png" /></p>
<p><em>Brief summary of steps:</em></p>
<ul>
<li>Load your selected set with the pedon and site table for an existing GHL file, or make your own (highly encouraged)</li>
<li>Run the lab_summary_by_taxonname report on a soil series of your choice by opening <em>report.Rmd</em> and clicking Knit with Parameters in RStudio, or using the <code>render()</code> function.</li>
<li>Show your work and submit the results to your mentor.</li>
</ul>
</div>
</div>
<div id="exercise-6-run-mapunit-comparison" class="section level2 hasAnchor" number="3.15">
<h2><span class="header-section-number">3.15</span> Exercise 6: Run Mapunit Comparison<a href="eda.html#exercise-6-run-mapunit-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another popular report in <code>soilReports</code> is the <code>region2/mu-comparison</code> report.</p>
<p>This report uses constant density sampling (<code>sharpshootR::constantDensitySampling()</code>) to extract numeric and categorical values from multiple raster data sources that overlap a set of user-supplied polygons.</p>
<p>In this example, we clip a small portion of SSURGO polygons from the CA630 soil survey area extent. We then select a small set of mapunit symbols (5012, 3046, 7083, 7085, 7088) that occur within the clipping extent. These mapunits have soil forming factors we expect to contrast with one another in several ways. You can inspect other mapunit symbols by changing <code>mu.set</code> in <code>config.R</code>.</p>
<ol style="list-style-type: decimal">
<li><strong>Download the demo data</strong>:</li>
</ol>
<div class="sourceCode" id="cb296"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb296-1"><a href="eda.html#cb296-1" tabindex="-1"></a><span class="co"># set up ch4 path and path for report</span></span>
<span id="cb296-2"><a href="eda.html#cb296-2" tabindex="-1"></a>mucomp.path <span class="ot">&lt;-</span> <span class="st">&quot;C:/workspace2/chapter3/mucomp&quot;</span></span>
<span id="cb296-3"><a href="eda.html#cb296-3" tabindex="-1"></a></span>
<span id="cb296-4"><a href="eda.html#cb296-4" tabindex="-1"></a><span class="co"># create any directories that may be missing</span></span>
<span id="cb296-5"><a href="eda.html#cb296-5" tabindex="-1"></a><span class="fu">dir.create</span>(mucomp.path, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb296-6"><a href="eda.html#cb296-6" tabindex="-1"></a></span>
<span id="cb296-7"><a href="eda.html#cb296-7" tabindex="-1"></a>mucomp.zip <span class="ot">&lt;-</span> <span class="fu">file.path</span>(mucomp.path, <span class="st">&#39;mucomp-data.zip&#39;</span>)</span>
<span id="cb296-8"><a href="eda.html#cb296-8" tabindex="-1"></a></span>
<span id="cb296-9"><a href="eda.html#cb296-9" tabindex="-1"></a><span class="co"># download raster data, SSURGO clip from CA630, and sample script for clipping your own raster data </span></span>
<span id="cb296-10"><a href="eda.html#cb296-10" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&#39;https://github.com/ncss-tech/stats_for_soil_survey/raw/master/data/chapter_3-mucomp-data/mucomp-data.zip&#39;</span>, mucomp.zip)</span>
<span id="cb296-11"><a href="eda.html#cb296-11" tabindex="-1"></a></span>
<span id="cb296-12"><a href="eda.html#cb296-12" tabindex="-1"></a><span class="fu">unzip</span>(mucomp.zip, <span class="at">exdir =</span> mucomp.path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Create an instance of the <code>region2/mu-comparison</code> report with <code>soilReports</code></strong>:</li>
</ol>
<div class="sourceCode" id="cb297"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb297-1"><a href="eda.html#cb297-1" tabindex="-1"></a><span class="co"># create new instance of reports </span></span>
<span id="cb297-2"><a href="eda.html#cb297-2" tabindex="-1"></a><span class="fu">library</span>(soilReports)</span>
<span id="cb297-3"><a href="eda.html#cb297-3" tabindex="-1"></a></span>
<span id="cb297-4"><a href="eda.html#cb297-4" tabindex="-1"></a><span class="co"># get report dependencies</span></span>
<span id="cb297-5"><a href="eda.html#cb297-5" tabindex="-1"></a><span class="fu">reportSetup</span>(<span class="st">&#39;region2/mu-comparison&#39;</span>)</span>
<span id="cb297-6"><a href="eda.html#cb297-6" tabindex="-1"></a></span>
<span id="cb297-7"><a href="eda.html#cb297-7" tabindex="-1"></a><span class="co"># create report instance</span></span>
<span id="cb297-8"><a href="eda.html#cb297-8" tabindex="-1"></a><span class="fu">copyReport</span>(<span class="st">&#39;region2/mu-comparison&#39;</span>, <span class="at">outputDir =</span> mucomp.path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>If you want, you can now set up the default <em>config.R</em> that is created by <code>copyReport()</code> to work with your own data. OR you can use the “sample” <code>config.R</code> file (called <em>new_config.R</em>) in the ZIP file downloaded above.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Run this code to replace the default <code>config.R</code> with the sample data <code>config.R</code></strong>:</li>
</ol>
<div class="sourceCode" id="cb298"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb298-1"><a href="eda.html#cb298-1" tabindex="-1"></a><span class="co"># copy config file containing relative paths to rasters downloaded above</span></span>
<span id="cb298-2"><a href="eda.html#cb298-2" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> <span class="fu">file.path</span>(mucomp.path, <span class="st">&quot;new_config.R&quot;</span>), </span>
<span id="cb298-3"><a href="eda.html#cb298-3" tabindex="-1"></a>          <span class="at">to =</span> <span class="fu">file.path</span>(mucomp.path, <span class="st">&quot;config.R&quot;</span>), </span>
<span id="cb298-4"><a href="eda.html#cb298-4" tabindex="-1"></a>          <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><p><strong>Open <code>report.Rmd</code> in the <code>C:/workspace2/chapter3/mucomp</code> folder and click the “Knit” button at the top of the RStudio source pane to run the report.</strong></p></li>
<li><p><strong>Inspect the report output HTML file, as well as the spatial and tabular data output in the <code>output</code> folder.</strong></p></li>
</ol>
<p><em>Question: What differences can you see between the five mapunit symbols that were analyzed?</em></p>
</div>
<div id="exercise-7-run-shiny-pedon-summary" class="section level2 hasAnchor" number="3.16">
<h2><span class="header-section-number">3.16</span> Exercise 7: Run Shiny Pedon Summary<a href="eda.html#exercise-7-run-shiny-pedon-summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>region2/shiny-pedon-summary</code> report is an interactive Shiny-based report that uses <code>flexdashboard</code> to help the user subset and summarize NASIS pedons from a graphical interface.</p>
<ul>
<li>You can try a ShinyApps.io demo <a href="https://brownag.shinyapps.io/ShinyPedonSummary/">here</a></li>
</ul>
<p>The “Shiny Pedon Summary” allows one to rapidly generate reports from a large set of pedons in their NASIS selected set.</p>
<p>The left INPUT sidebar has numerous options for subsetting pedon data. Specifically, you can change REGEX patterns for <em>mapunit symbol</em>, <em>taxon name</em>, <em>local phase</em>, and <em>User Pedon ID</em>. Also, you can use the drop down boxes to filter on <em>taxon kind</em> or compare different “modal”/RV pedons.</p>
<div class="float">
<img src="https://ncss-tech.github.io/soilReports/docs/shiny-pedon-summary/shiny-pedon_loafercreek-taxadjuncts.PNG" alt="Example: Analyzing the Loafercreek Taxadjuncts" />
<div class="figcaption">Example: Analyzing the Loafercreek Taxadjuncts</div>
</div>
<ol style="list-style-type: decimal">
<li><strong>Create an instance of the <code>region2/shiny-pedon-summary</code> report with <code>soilReports</code></strong>:</li>
</ol>
<div class="sourceCode" id="cb299"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb299-1"><a href="eda.html#cb299-1" tabindex="-1"></a><span class="co"># create new instance of reports </span></span>
<span id="cb299-2"><a href="eda.html#cb299-2" tabindex="-1"></a><span class="fu">library</span>(soilReports)</span>
<span id="cb299-3"><a href="eda.html#cb299-3" tabindex="-1"></a></span>
<span id="cb299-4"><a href="eda.html#cb299-4" tabindex="-1"></a><span class="co"># set path for shiny-pedon-summary report instance</span></span>
<span id="cb299-5"><a href="eda.html#cb299-5" tabindex="-1"></a>shinyped.path <span class="ot">&lt;-</span> <span class="st">&quot;C:/workspace2/chapter3/shiny-pedon&quot;</span></span>
<span id="cb299-6"><a href="eda.html#cb299-6" tabindex="-1"></a></span>
<span id="cb299-7"><a href="eda.html#cb299-7" tabindex="-1"></a><span class="co"># create directories (if needed)</span></span>
<span id="cb299-8"><a href="eda.html#cb299-8" tabindex="-1"></a><span class="fu">dir.create</span>(shinyped.path, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb299-9"><a href="eda.html#cb299-9" tabindex="-1"></a></span>
<span id="cb299-10"><a href="eda.html#cb299-10" tabindex="-1"></a><span class="co"># get report dependencies</span></span>
<span id="cb299-11"><a href="eda.html#cb299-11" tabindex="-1"></a><span class="fu">reportSetup</span>(<span class="st">&#39;region2/shiny-pedon-summary&#39;</span>)</span>
<span id="cb299-12"><a href="eda.html#cb299-12" tabindex="-1"></a></span>
<span id="cb299-13"><a href="eda.html#cb299-13" tabindex="-1"></a><span class="co"># copy report contents to target path</span></span>
<span id="cb299-14"><a href="eda.html#cb299-14" tabindex="-1"></a><span class="fu">copyReport</span>(<span class="st">&#39;region2/shiny-pedon-summary&#39;</span>, <span class="at">outputDir =</span> shinyped.path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Update the <code>config.R</code> file</strong></li>
</ol>
<p>You can update the <em>config.R</em> file in <code>"C:/workspace2/chapter3/shiny-pedon"</code> (or wherever you installed the report) to use the <code>soilDB</code> datasets <code>loafercreek</code> and <code>gopheridge</code> by setting <code>demo_mode &lt;- TRUE</code>. This is the simplest way to demonstrate how this report works. Alternately, when <code>demo_mode &lt;- FALSE</code>, pedons will be loaded from your NASIS selected set.</p>
<p><em>config.R</em> also allows you to specify a shapefile for overlaying the points on–to determine mapunit symbol–as well as several raster data sources whose values will be extracted at point locations and summarized. The demo data does not use either of these by default due to large file sizes.</p>
<p>A very general default set of REGEX generalized horizon patterns is provided to assign generalized horizon labels for provisional grouping. These patterns are unlikely to cover ALL cases and <em>always</em> need to be modified for final correlation.</p>
<p>The default <em>config.R</em> settings use the general patterns: <code>use_regex_ghz &lt;- TRUE</code>. You are welcome to modify the defaults. If you want to use the values you have populated in NASIS <em>Pedon Horizon Component Layer ID</em>, set <code>use_regex_ghz &lt;- FALSE</code>.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Run the report via <code>shiny.Rmd</code></strong></li>
</ol>
<p>This report uses the Shiny <code>flexdashboard</code> interface. Open up <em>shiny.Rmd</em> and click the “Run Document” button to start the report. This will load the pedon and spatial data specified in <em>config.R</em>.</p>
<p><strong>NOTE:</strong> <em>If a Viewer Window does not pop-up right away, click the gear icon to the right of the “Run Document” button. Be sure the option “Preview in Window” is checked, then click “Run Document” again.</em></p>
<ol start="4" style="list-style-type: decimal">
<li><p>All of the subset parameters are in the left-hand sidebar. Play around with all of these options. The graphs and plots in the tabs to the right will automatically update as you make changes.</p></li>
<li><p>When you like what you have, you can export a non-interactive HTML file for your records. To do this first set the “Report name:” box to something informative; this will be your report output file name. Then, scroll down to the bottom of the INPUT sidebar and click “Export Report” button. When rendering completes check the “output” folder in the directory where you installed the report.</p></li>
</ol>
</div>
<div id="additional-reading-exploratory-data-analysis" class="section level2 hasAnchor" number="3.17">
<h2><span class="header-section-number">3.17</span> Additional Reading (Exploratory Data Analysis)<a href="eda.html#additional-reading-exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Healy, K., 2018. Data Visualization: a practical introduction. Princeton University Press. <a href="http://socviz.co/" class="uri">http://socviz.co/</a></p>
<p>Helsel, D.R., Hirsch, R.M., Ryberg, K.R., Archfield, S.A., and Gilroy, E.J., 2020, Statistical methods in water resources: U.S. Geological Survey Techniques and Methods, book 4, chap. A3, 458 p., <a href="https://doi.org/10.3133/tm4a3" class="uri">https://doi.org/10.3133/tm4a3</a>. [Supersedes USGS Techniques of Water-Resources Investigations, book 4, chap. A3, version 1.1.]</p>
<p>Kabacoff, R.I., 2018. Data Visualization in R. <a href="https://rkabacoff.github.io/datavis/" class="uri">https://rkabacoff.github.io/datavis/</a></p>
<p>Peng, R. D., 2016. Exploratory Data Analysis with R. Leanpub. <a href="https://bookdown.org/rdpeng/exdata/" class="uri">https://bookdown.org/rdpeng/exdata/</a></p>
<p>Wilke, C.O., 2019. Fundamentals of Data Visualization. O’Reily Media, Inc. <a href="https://clauswilke.com/dataviz/" class="uri">https://clauswilke.com/dataviz/</a></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-boyd2011" class="csl-entry">
Boyd, Claude E., Craig S. Tucker, and Rawee Viriyatum. 2011. <span>“Interpretation of <span class="nocase">pH</span>, <span>Acidity</span>, and <span>Alkalinity</span> in <span>Aquaculture</span> and <span>Fisheries</span>.”</span> <em>North American Journal of Aquaculture</em> 73 (4): 403–8. <a href="https://doi.org/10.1080/15222055.2011.620861">https://doi.org/10.1080/15222055.2011.620861</a>.
</div>
<div id="ref-tukey1977" class="csl-entry">
Tukey, John Wilder. 1977. <em>Exploratory Data Analysis</em>. Addison-<span>Wesley</span> Series in Behavioral Science. Reading, Mass: Addison-Wesley Pub. Co. <a href="https://archive.org/details/exploratorydataa0000tuke_7616">https://archive.org/details/exploratorydataa0000tuke_7616</a>.
</div>
<div id="ref-webster2001" class="csl-entry">
Webster, R. 2001. <span>“Statistics to Support Soil Research and Their Presentation.”</span> <em>European Journal of Soil Science</em> 52 (2): 331–40. <a href="https://doi.org/10.1046/j.1365-2389.2001.00383.x">https://doi.org/10.1046/j.1365-2389.2001.00383.x</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["s4ssbook.pdf", "s4ssbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
