<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Sampling | Statistics for Soil Survey - Part 1</title>
  <meta name="description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Sampling | Statistics for Soil Survey - Part 1" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Sampling | Statistics for Soil Survey - Part 1" />
  
  <meta name="twitter:description" content="Web-based course content for Statistics for Soil Survey - Part 1 made with bookdown::gitbook." />
  

<meta name="author" content="Soil Survey Staff" />


<meta name="date" content="2023-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Statistics for Soil Survey - Part 1</a></li>
<li><a href="../book2/index.html">Statistics for Soil Survey - Part 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Pre-course Assignment</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#create-workspace"><i class="fa fa-check"></i><b>0.1</b> Create Workspace</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#configure-rstudio"><i class="fa fa-check"></i><b>0.2</b> Configure RStudio</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#essentials"><i class="fa fa-check"></i><b>0.3</b> Essentials</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#personalization"><i class="fa fa-check"></i><b>0.4</b> Personalization</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#install-required-packages"><i class="fa fa-check"></i><b>0.5</b> Install Required Packages</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i><b>0.6</b> Dealing With Errors</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path="index.html"><a href="index.html#no-output-is-produced-after-pasting-into-console"><i class="fa fa-check"></i><b>0.6.1</b> No output is produced after pasting into console</a></li>
<li class="chapter" data-level="0.6.2" data-path="index.html"><a href="index.html#somepackage-is-not-available-for-r-version-x.y.z"><i class="fa fa-check"></i><b>0.6.2</b> <code>‘SOMEPACKAGE’ is not available (for R version X.Y.Z)</code></a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#packages-not-on-cran"><i class="fa fa-check"></i><b>0.7</b> Packages not on CRAN</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#connect-local-nasis"><i class="fa fa-check"></i><b>0.8</b> Connect Local NASIS</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#proof"><i class="fa fa-check"></i><b>0.9</b> Proof</a></li>
<li class="chapter" data-level="0.10" data-path="index.html"><a href="index.html#additional-supportoptional-readings"><i class="fa fa-check"></i><b>0.10</b> Additional Support/Optional Readings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#course-overview"><i class="fa fa-check"></i><b>1.2</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#course-objectives"><i class="fa fa-check"></i><b>1.2.1</b> Course Objectives</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#why-is-this-training-needed"><i class="fa fa-check"></i><b>1.2.2</b> Why is this training needed?</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#why-is-course-organized-this-way"><i class="fa fa-check"></i><b>1.2.3</b> Why is course organized this way?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>1.3</b> What is R?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#why-should-i-learn-r"><i class="fa fa-check"></i><b>1.3.1</b> Why Should I Learn R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#what-can-r-do"><i class="fa fa-check"></i><b>1.3.2</b> What can R do?</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.3.3</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#rstudio-an-integrated-development-environment-ide-for-r"><i class="fa fa-check"></i><b>1.4</b> RStudio: An Integrated Development Environment (IDE) for R</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#rcmdr-r-commander-a-graphical-user-interface-for-r"><i class="fa fa-check"></i><b>1.5</b> Rcmdr (R Commander): A Graphical User Interface for R</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#r-basics"><i class="fa fa-check"></i><b>1.6</b> R basics</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#managing-packages"><i class="fa fa-check"></i><b>1.7</b> Managing Packages</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#installing-packages"><i class="fa fa-check"></i><b>1.7.1</b> Installing Packages</a></li>
<li class="chapter" data-level="1.7.2" data-path="intro.html"><a href="intro.html#loading-packages"><i class="fa fa-check"></i><b>1.7.2</b> Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>1.8</b> Getting Help</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#documenting-your-work"><i class="fa fa-check"></i><b>1.9</b> Documenting your work</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="intro.html"><a href="intro.html#basic-tips-for-scripting"><i class="fa fa-check"></i><b>1.9.1</b> Basic Tips for Scripting</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#organizing-your-work"><i class="fa fa-check"></i><b>1.10</b> Organizing your work</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="intro.html"><a href="intro.html#setting-the-working-directory"><i class="fa fa-check"></i><b>1.10.1</b> Setting the Working Directory</a></li>
<li class="chapter" data-level="1.10.2" data-path="intro.html"><a href="intro.html#rstudio-projects-.rproj-files"><i class="fa fa-check"></i><b>1.10.2</b> RStudio Projects (.Rproj files)</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#saving-your-work"><i class="fa fa-check"></i><b>1.11</b> Saving your work</a></li>
<li class="chapter" data-level="1.12" data-path="intro.html"><a href="intro.html#exercise-1"><i class="fa fa-check"></i><b>1.12</b> Exercise 1</a></li>
<li class="chapter" data-level="1.13" data-path="intro.html"><a href="intro.html#loading-data"><i class="fa fa-check"></i><b>1.13</b> Loading Data</a></li>
<li class="chapter" data-level="1.14" data-path="intro.html"><a href="intro.html#data-manipulation"><i class="fa fa-check"></i><b>1.14</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="1.14.1" data-path="intro.html"><a href="intro.html#viewing-and-removing-data"><i class="fa fa-check"></i><b>1.14.1</b> Viewing and Removing Data</a></li>
<li class="chapter" data-level="1.14.2" data-path="intro.html"><a href="intro.html#filtering-or-subsetting-data"><i class="fa fa-check"></i><b>1.14.2</b> Filtering or Subsetting Data</a></li>
<li class="chapter" data-level="1.14.3" data-path="intro.html"><a href="intro.html#transforming-data"><i class="fa fa-check"></i><b>1.14.3</b> Transforming Data</a></li>
<li class="chapter" data-level="1.14.4" data-path="intro.html"><a href="intro.html#sorting-data"><i class="fa fa-check"></i><b>1.14.4</b> Sorting Data</a></li>
<li class="chapter" data-level="1.14.5" data-path="intro.html"><a href="intro.html#piping-data"><i class="fa fa-check"></i><b>1.14.5</b> Piping Data</a></li>
<li class="chapter" data-level="1.14.6" data-path="intro.html"><a href="intro.html#mergingjoining-or-combining-data"><i class="fa fa-check"></i><b>1.14.6</b> Merging/Joining or Combining Data</a></li>
<li class="chapter" data-level="1.14.7" data-path="intro.html"><a href="intro.html#aggregating-or-grouping-data"><i class="fa fa-check"></i><b>1.14.7</b> Aggregating or Grouping Data</a></li>
<li class="chapter" data-level="1.14.8" data-path="intro.html"><a href="intro.html#reshaping-data"><i class="fa fa-check"></i><b>1.14.8</b> Reshaping Data</a></li>
<li class="chapter" data-level="1.14.9" data-path="intro.html"><a href="intro.html#exporting-data"><i class="fa fa-check"></i><b>1.14.9</b> Exporting Data</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="intro.html"><a href="intro.html#exercise-2"><i class="fa fa-check"></i><b>1.15</b> Exercise 2</a></li>
<li class="chapter" data-level="1.16" data-path="intro.html"><a href="intro.html#review"><i class="fa fa-check"></i><b>1.16</b> Review</a></li>
<li class="chapter" data-level="1.17" data-path="intro.html"><a href="intro.html#additional-reading-introduction"><i class="fa fa-check"></i><b>1.17</b> Additional Reading (Introduction)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> The Data We Use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#objectives-tabular-data-structures"><i class="fa fa-check"></i><b>2.1</b> Objectives (Tabular Data Structures)</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#the-structure-of-soil-data"><i class="fa fa-check"></i><b>2.2</b> The Structure of Soil Data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data.html"><a href="data.html#package-references"><i class="fa fa-check"></i><b>2.2.1</b> Package References</a></li>
<li class="chapter" data-level="2.2.2" data-path="data.html"><a href="data.html#soildb-functions-for-tabular-data"><i class="fa fa-check"></i><b>2.2.2</b> soilDB functions for tabular data</a></li>
<li class="chapter" data-level="2.2.3" data-path="data.html"><a href="data.html#importance-of-pedon-data"><i class="fa fa-check"></i><b>2.2.3</b> Importance of Pedon Data</a></li>
<li class="chapter" data-level="2.2.4" data-path="data.html"><a href="data.html#some-issues-with-pedon-data"><i class="fa fa-check"></i><b>2.2.4</b> Some Issues With Pedon Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#challenges-with-pedon-data"><i class="fa fa-check"></i><b>2.3</b> Challenges with Pedon Data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data.html"><a href="data.html#meeting-the-challenges"><i class="fa fa-check"></i><b>2.3.1</b> Meeting the Challenges</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#the-soilprofilecollection"><i class="fa fa-check"></i><b>2.4</b> The <code>SoilProfileCollection</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data.html"><a href="data.html#soilprofilecollection-methods"><i class="fa fa-check"></i><b>2.4.1</b> <code>SoilProfileCollection</code> methods</a></li>
<li class="chapter" data-level="2.4.2" data-path="data.html"><a href="data.html#exercise-assemble-a-soilprofilecollection-from-several-csv-files"><i class="fa fa-check"></i><b>2.4.2</b> Exercise: Assemble a <code>SoilProfileCollection</code> from several CSV files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#using-the-soildb-package"><i class="fa fa-check"></i><b>2.5</b> Using the <code>soilDB</code> Package</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data.html"><a href="data.html#open-database-connectivity-odbc-connection-to-nasis"><i class="fa fa-check"></i><b>2.5.1</b> Open Database Connectivity (ODBC) Connection to NASIS</a></li>
<li class="chapter" data-level="2.5.2" data-path="data.html"><a href="data.html#fetchnasis"><i class="fa fa-check"></i><b>2.5.2</b> <code>fetchNASIS()</code></a></li>
<li class="chapter" data-level="2.5.3" data-path="data.html"><a href="data.html#the-gopheridge-dataset"><i class="fa fa-check"></i><b>2.5.3</b> The <code>gopheridge</code> Dataset</a></li>
<li class="chapter" data-level="2.5.4" data-path="data.html"><a href="data.html#further-reading-reference"><i class="fa fa-check"></i><b>2.5.4</b> Further Reading / Reference</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data.html"><a href="data.html#working-with-data-in-r"><i class="fa fa-check"></i><b>2.6</b> Working with Data in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data.html"><a href="data.html#summaries"><i class="fa fa-check"></i><b>2.6.1</b> Summaries</a></li>
<li class="chapter" data-level="2.6.2" data-path="data.html"><a href="data.html#missing-values"><i class="fa fa-check"></i><b>2.6.2</b> Missing Values</a></li>
<li class="chapter" data-level="2.6.3" data-path="data.html"><a href="data.html#logical-operators"><i class="fa fa-check"></i><b>2.6.3</b> Logical Operators</a></li>
<li class="chapter" data-level="2.6.4" data-path="data.html"><a href="data.html#pattern-matching"><i class="fa fa-check"></i><b>2.6.4</b> Pattern Matching</a></li>
<li class="chapter" data-level="2.6.5" data-path="data.html"><a href="data.html#filtering"><i class="fa fa-check"></i><b>2.6.5</b> Filtering</a></li>
<li class="chapter" data-level="2.6.6" data-path="data.html"><a href="data.html#dates-and-times"><i class="fa fa-check"></i><b>2.6.6</b> Dates and Times</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data.html"><a href="data.html#fetchnasis-data-checks"><i class="fa fa-check"></i><b>2.7</b> <code>fetchNASIS</code> data checks</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="data.html"><a href="data.html#inspecting-results"><i class="fa fa-check"></i><b>2.7.1</b> Inspecting Results</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="data.html"><a href="data.html#extended-data-functions"><i class="fa fa-check"></i><b>2.8</b> Extended Data Functions</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="data.html"><a href="data.html#elements-of-get_extended_data_from_nasis"><i class="fa fa-check"></i><b>2.8.1</b> Elements of <code>get_extended_data_from_NASIS()</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="data.html"><a href="data.html#load-example-data-1"><i class="fa fa-check"></i><b>2.8.2</b> Load Example Data</a></li>
<li class="chapter" data-level="2.8.3" data-path="data.html"><a href="data.html#visualizing-common-landforms"><i class="fa fa-check"></i><b>2.8.3</b> Visualizing Common Landforms</a></li>
<li class="chapter" data-level="2.8.4" data-path="data.html"><a href="data.html#diagnostic-features"><i class="fa fa-check"></i><b>2.8.4</b> Diagnostic Features</a></li>
<li class="chapter" data-level="2.8.5" data-path="data.html"><a href="data.html#comparing-horizon-data-with-diagnostic-intervals"><i class="fa fa-check"></i><b>2.8.5</b> Comparing Horizon Data with Diagnostic “Intervals”</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="data.html"><a href="data.html#custom-queries-to-local-nasis-database"><i class="fa fa-check"></i><b>2.9</b> Custom Queries to Local NASIS Database</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="eda.html"><a href="eda.html#objectives-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Objectives (Exploratory Data Analysis)</a></li>
<li class="chapter" data-level="3.2" data-path="eda.html"><a href="eda.html#statistics"><i class="fa fa-check"></i><b>3.2</b> Statistics</a></li>
<li class="chapter" data-level="3.3" data-path="eda.html"><a href="eda.html#data-inspection"><i class="fa fa-check"></i><b>3.3</b> Data Inspection</a></li>
<li class="chapter" data-level="3.4" data-path="eda.html"><a href="eda.html#exercise-1-fetch-and-inspect"><i class="fa fa-check"></i><b>3.4</b> Exercise 1: fetch and inspect</a></li>
<li class="chapter" data-level="3.5" data-path="eda.html"><a href="eda.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.5</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="eda.html"><a href="eda.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>3.5.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="3.5.2" data-path="eda.html"><a href="eda.html#measures-of-dispersion"><i class="fa fa-check"></i><b>3.5.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="3.5.3" data-path="eda.html"><a href="eda.html#correlation"><i class="fa fa-check"></i><b>3.5.3</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="eda.html"><a href="eda.html#exercise-2-compute-descriptive-statistics"><i class="fa fa-check"></i><b>3.6</b> Exercise 2: Compute Descriptive Statistics</a></li>
<li class="chapter" data-level="3.7" data-path="eda.html"><a href="eda.html#graphical-methods"><i class="fa fa-check"></i><b>3.7</b> Graphical Methods</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="eda.html"><a href="eda.html#distributions"><i class="fa fa-check"></i><b>3.7.1</b> Distributions</a></li>
<li class="chapter" data-level="3.7.2" data-path="eda.html"><a href="eda.html#bar-plot"><i class="fa fa-check"></i><b>3.7.2</b> Bar Plot</a></li>
<li class="chapter" data-level="3.7.3" data-path="eda.html"><a href="eda.html#histogram"><i class="fa fa-check"></i><b>3.7.3</b> Histogram</a></li>
<li class="chapter" data-level="3.7.4" data-path="eda.html"><a href="eda.html#density-curve"><i class="fa fa-check"></i><b>3.7.4</b> Density Curve</a></li>
<li class="chapter" data-level="3.7.5" data-path="eda.html"><a href="eda.html#box-plots"><i class="fa fa-check"></i><b>3.7.5</b> Box plots</a></li>
<li class="chapter" data-level="3.7.6" data-path="eda.html"><a href="eda.html#quantile-comparison-plots-qqplot"><i class="fa fa-check"></i><b>3.7.6</b> Quantile comparison plots (QQplot)</a></li>
<li class="chapter" data-level="3.7.7" data-path="eda.html"><a href="eda.html#the-normal-distribution"><i class="fa fa-check"></i><b>3.7.7</b> The ‘Normal’ distribution</a></li>
<li class="chapter" data-level="3.7.8" data-path="eda.html"><a href="eda.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>3.7.8</b> Scatterplots and Line Plots</a></li>
<li class="chapter" data-level="3.7.9" data-path="eda.html"><a href="eda.html#rd-dimension---color-shape-size-layers-etc"><i class="fa fa-check"></i><b>3.7.9</b> 3rd Dimension - Color, Shape, Size, Layers, etc…</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="eda.html"><a href="eda.html#exercise-3-graphical-methods"><i class="fa fa-check"></i><b>3.8</b> Exercise 3: Graphical Methods</a></li>
<li class="chapter" data-level="3.9" data-path="eda.html"><a href="eda.html#transformations"><i class="fa fa-check"></i><b>3.9</b> Transformations</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="eda.html"><a href="eda.html#ph"><i class="fa fa-check"></i><b>3.9.1</b> pH</a></li>
<li class="chapter" data-level="3.9.2" data-path="eda.html"><a href="eda.html#circular-data"><i class="fa fa-check"></i><b>3.9.2</b> Circular data</a></li>
<li class="chapter" data-level="3.9.3" data-path="eda.html"><a href="eda.html#texture-class-and-fine-earth-separates"><i class="fa fa-check"></i><b>3.9.3</b> Texture Class and Fine-earth Separates</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="eda.html"><a href="eda.html#the-shiny-package"><i class="fa fa-check"></i><b>3.10</b> The Shiny Package</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="eda.html"><a href="eda.html#online"><i class="fa fa-check"></i><b>3.10.1</b> Online</a></li>
<li class="chapter" data-level="3.10.2" data-path="eda.html"><a href="eda.html#locally"><i class="fa fa-check"></i><b>3.10.2</b> Locally</a></li>
<li class="chapter" data-level="3.10.3" data-path="eda.html"><a href="eda.html#web-app-demonstration"><i class="fa fa-check"></i><b>3.10.3</b> Web App Demonstration</a></li>
<li class="chapter" data-level="3.10.4" data-path="eda.html"><a href="eda.html#troubleshooting-errors"><i class="fa fa-check"></i><b>3.10.4</b> Troubleshooting Errors</a></li>
<li class="chapter" data-level="3.10.5" data-path="eda.html"><a href="eda.html#shiny-app-embedding"><i class="fa fa-check"></i><b>3.10.5</b> Shiny App Embedding</a></li>
<li class="chapter" data-level="3.10.6" data-path="eda.html"><a href="eda.html#questions"><i class="fa fa-check"></i><b>3.10.6</b> Questions</a></li>
<li class="chapter" data-level="3.10.7" data-path="eda.html"><a href="eda.html#examples"><i class="fa fa-check"></i><b>3.10.7</b> Examples</a></li>
<li class="chapter" data-level="3.10.8" data-path="eda.html"><a href="eda.html#work-on-your-own"><i class="fa fa-check"></i><b>3.10.8</b> Work on your Own</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="eda.html"><a href="eda.html#soilreports"><i class="fa fa-check"></i><b>3.11</b> soilReports</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="eda.html"><a href="eda.html#extending-soilreports"><i class="fa fa-check"></i><b>3.11.1</b> Extending <code>soilReports</code></a></li>
<li class="chapter" data-level="3.11.2" data-path="eda.html"><a href="eda.html#exercise-run-shiny-pedon-summary"><i class="fa fa-check"></i><b>3.11.2</b> Exercise: Run Shiny Pedon Summary</a></li>
<li class="chapter" data-level="3.11.3" data-path="eda.html"><a href="eda.html#exercise-run-mapunit-comparison"><i class="fa fa-check"></i><b>3.11.3</b> Exercise: Run Mapunit Comparison</a></li>
<li class="chapter" data-level="3.11.4" data-path="eda.html"><a href="eda.html#exercise-run-lab-summary-by-taxon-name-soil-report"><i class="fa fa-check"></i><b>3.11.4</b> Exercise: Run Lab Summary By Taxon Name Soil Report</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="eda.html"><a href="eda.html#additional-reading-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.12</b> Additional Reading (Exploratory Data Analysis)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>4</b> Spatial Data in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial.html"><a href="spatial.html#objectives-spatial-data"><i class="fa fa-check"></i><b>4.1</b> Objectives (Spatial Data)</a></li>
<li class="chapter" data-level="4.2" data-path="spatial.html"><a href="spatial.html#making-maps-with-r"><i class="fa fa-check"></i><b>4.2</b> Making Maps with R</a></li>
<li class="chapter" data-level="4.3" data-path="spatial.html"><a href="spatial.html#spatial-data-sources"><i class="fa fa-check"></i><b>4.3</b> Spatial Data Sources</a></li>
<li class="chapter" data-level="4.4" data-path="spatial.html"><a href="spatial.html#viewing-pedon-locations"><i class="fa fa-check"></i><b>4.4</b> Viewing Pedon Locations</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="spatial.html"><a href="spatial.html#plotting-geographic-data"><i class="fa fa-check"></i><b>4.4.1</b> Plotting Geographic Data</a></li>
<li class="chapter" data-level="4.4.2" data-path="spatial.html"><a href="spatial.html#exercise-1-spatial-intro"><i class="fa fa-check"></i><b>4.4.2</b> EXERCISE 1 (Spatial Intro)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="spatial.html"><a href="spatial.html#many-packages-many-spatial-representations"><i class="fa fa-check"></i><b>4.5</b> Many Packages, Many Spatial Representations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="spatial.html"><a href="spatial.html#the-sf-package"><i class="fa fa-check"></i><b>4.5.1</b> The <code>sf</code> package</a></li>
<li class="chapter" data-level="4.5.2" data-path="spatial.html"><a href="spatial.html#the-sp-and-rgdal-packages"><i class="fa fa-check"></i><b>4.5.2</b> The <code>sp</code> and <code>rgdal</code> Packages</a></li>
<li class="chapter" data-level="4.5.3" data-path="spatial.html"><a href="spatial.html#converting-sp-and-sf"><i class="fa fa-check"></i><b>4.5.3</b> Converting <code>sp</code> and <code>sf</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="spatial.html"><a href="spatial.html#importing-exporting-vector-data"><i class="fa fa-check"></i><b>4.5.4</b> Importing / Exporting Vector Data</a></li>
<li class="chapter" data-level="4.5.5" data-path="spatial.html"><a href="spatial.html#interactive-mapping-with-mapview-and-leaflet"><i class="fa fa-check"></i><b>4.5.5</b> Interactive mapping with <code>mapview</code> and <code>leaflet</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="spatial.html"><a href="spatial.html#the-raster-package"><i class="fa fa-check"></i><b>4.5.6</b> The <code>raster</code> Package</a></li>
<li class="chapter" data-level="4.5.7" data-path="spatial.html"><a href="spatial.html#converting-vector-to-raster"><i class="fa fa-check"></i><b>4.5.7</b> Converting Vector to Raster</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="spatial.html"><a href="spatial.html#coordinate-reference-systems-crs"><i class="fa fa-check"></i><b>4.6</b> Coordinate Reference Systems (CRS)</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="spatial.html"><a href="spatial.html#assigning-and-transforming-coordinate-systems"><i class="fa fa-check"></i><b>4.6.1</b> Assigning and Transforming Coordinate Systems</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="spatial.html"><a href="spatial.html#raster-data"><i class="fa fa-check"></i><b>4.7</b> Raster data</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="spatial.html"><a href="spatial.html#in-memory-versus-disk-based-processing"><i class="fa fa-check"></i><b>4.7.1</b> In-memory versus disk-based processing</a></li>
<li class="chapter" data-level="4.7.2" data-path="spatial.html"><a href="spatial.html#object-properties"><i class="fa fa-check"></i><b>4.7.2</b> Object Properties</a></li>
<li class="chapter" data-level="4.7.3" data-path="spatial.html"><a href="spatial.html#data-types"><i class="fa fa-check"></i><b>4.7.3</b> Data Types</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="spatial.html"><a href="spatial.html#spatial-overlay-operations"><i class="fa fa-check"></i><b>4.8</b> Spatial Overlay Operations</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="spatial.html"><a href="spatial.html#vector-data"><i class="fa fa-check"></i><b>4.8.1</b> Vector Data</a></li>
<li class="chapter" data-level="4.8.2" data-path="spatial.html"><a href="spatial.html#spatial-data-extraction"><i class="fa fa-check"></i><b>4.8.2</b> Spatial Data Extraction</a></li>
<li class="chapter" data-level="4.8.3" data-path="spatial.html"><a href="spatial.html#approach"><i class="fa fa-check"></i><b>4.8.3</b> Approach</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="spatial.html"><a href="spatial.html#additional-reading-spatial"><i class="fa fa-check"></i><b>4.9</b> Additional Reading (Spatial)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>5</b> Sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sampling.html"><a href="sampling.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sampling.html"><a href="sampling.html#dsm-classes"><i class="fa fa-check"></i><b>5.1.1</b> DSM classes</a></li>
<li class="chapter" data-level="5.1.2" data-path="sampling.html"><a href="sampling.html#rules-of-thumb"><i class="fa fa-check"></i><b>5.1.2</b> Rules of thumb</a></li>
<li class="chapter" data-level="5.1.3" data-path="sampling.html"><a href="sampling.html#nssh-627.8"><i class="fa fa-check"></i><b>5.1.3</b> NSSH 627.8</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sampling.html"><a href="sampling.html#sampling-strategies"><i class="fa fa-check"></i><b>5.2</b> Sampling Strategies</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sampling.html"><a href="sampling.html#simple-random"><i class="fa fa-check"></i><b>5.2.1</b> Simple Random</a></li>
<li class="chapter" data-level="5.2.2" data-path="sampling.html"><a href="sampling.html#systematic"><i class="fa fa-check"></i><b>5.2.2</b> Systematic</a></li>
<li class="chapter" data-level="5.2.3" data-path="sampling.html"><a href="sampling.html#spatial-coverage-sampling"><i class="fa fa-check"></i><b>5.2.3</b> Spatial Coverage Sampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="sampling.html"><a href="sampling.html#stratified-random"><i class="fa fa-check"></i><b>5.2.4</b> Stratified Random</a></li>
<li class="chapter" data-level="5.2.5" data-path="sampling.html"><a href="sampling.html#multistage-stratified-random"><i class="fa fa-check"></i><b>5.2.5</b> Multistage Stratified Random</a></li>
<li class="chapter" data-level="5.2.6" data-path="sampling.html"><a href="sampling.html#conditioned-latin-hypercube-clhs"><i class="fa fa-check"></i><b>5.2.6</b> Conditioned Latin Hypercube (cLHS)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sampling.html"><a href="sampling.html#evaluating-a-sampling-strategy"><i class="fa fa-check"></i><b>5.3</b> Evaluating a Sampling Strategy</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sampling.html"><a href="sampling.html#exercise-design-a-sampling-strategy"><i class="fa fa-check"></i><b>5.3.1</b> Exercise: Design a Sampling Strategy</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sampling.html"><a href="sampling.html#additional-reading-sampling"><i class="fa fa-check"></i><b>5.4</b> Additional Reading (Sampling)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Soil Survey - Part 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Sampling<a href="sampling.html#sampling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="static-figures/logo.jpg" /></p>
<div id="introduction" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="sampling.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sampling is a fundamental part of statistics. Samples are collected to achieve an understanding of a population because it is typically not feasible to observe all members of the population. The goal is to collect samples that provide an accurate representation of the population. Constraints on time and money dictate that the sampling effort must be efficient. More samples are needed to characterize the nature of highly variable populations than less variable populations.</p>
<p><strong>Define your purpose:</strong> What are you investigating? Examples include soil properties, soil classes, and plant productivity.</p>
<p><strong>How many samples are needed?</strong></p>
<p>The question of how many samples are required is complex. As per usual, the answer is ‘it depends’. For example, it depends on the type of analysis (e.g. non-spatial vs spatial) and properties of the data (e.g. continuous vs categorical). In all cases it requires an understanding/assumptions of the underlying population. If a scientist can estimate the several population variables, formulas exist to estimate the required number of samples. The following are a list of methods for estimating sample size:</p>
<ol style="list-style-type: decimal">
<li>Standard error</li>
<li>Confidence interval</li>
<li>Power analysis (hypothesis testing)</li>
<li>Distance/time</li>
<li>Prediction error</li>
<li>Rules of thumb</li>
<li>NSSH 627.8</li>
</ol>
<p>The first 3 methods use formulas for their corresponding statistics to solve for the sample size, each results in progressively higher sample size requirements. The <code>PracTools</code> R package <span class="citation">(<a href="#ref-valliant2022" role="doc-biblioref">Valliant and Dever 2022</a>)</span> offers several functions for the 1st and 2nd methods. The <code>pwr</code> <span class="citation">(<a href="#ref-champely2020" role="doc-biblioref">Champely 2020</a>)</span> and <code>WebPower</code> <span class="citation">(<a href="#ref-zhang2021" role="doc-biblioref">Zhang and Mai 2021</a>)</span> R packages offer several functions for the 3rd method, based on a variety of statistical models. <span class="citation">Gelman, Hill, and Vehtari (<a href="#ref-gelman2020" role="doc-biblioref">2020</a>)</span> provides a nice graphical illustration of the variables involved with these methods.</p>
<div id="dsm-classes" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> DSM classes<a href="sampling.html#dsm-classes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A variation of the 2nd method is described by <span class="citation">Congalton and Green (<a href="#ref-congalton2019" role="doc-biblioref">2019</a>)</span> for use with categorical data, which is applicable to digital soil mapping.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb355-1"><a href="sampling.html#cb355-1" aria-hidden="true" tabindex="-1"></a>nMultinomial <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">k =</span> <span class="cn">NULL</span>, <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">error =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb355-2"><a href="sampling.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># k     = number of classes</span></span>
<span id="cb355-3"><a href="sampling.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p     = proportion of the largest class</span></span>
<span id="cb355-4"><a href="sampling.html#cb355-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error = margin of error</span></span>
<span id="cb355-5"><a href="sampling.html#cb355-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alpha = confidence level probability</span></span>
<span id="cb355-6"><a href="sampling.html#cb355-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ceiling</span>(<span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> k, <span class="dv">1</span>) <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> error<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb355-7"><a href="sampling.html#cb355-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb355-8"><a href="sampling.html#cb355-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nMultinomial</span>(<span class="at">k =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>))</span></code></pre></div>
<pre><code>## [1] 197 229 248</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb357-1"><a href="sampling.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nMultinomial</span>(<span class="at">k =</span> <span class="dv">10</span>, <span class="at">error =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## [1] 788 197  50</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb359-1"><a href="sampling.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nMultinomial</span>(<span class="at">k =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## [1] 197 166 136</code></pre>
<!-- Because you are typically interested in using field point data to derive inferences, you need enough samples to be confident that they approximate the target population. In the case of calibrating a laboratory device, you might only need two measurements, each at opposite ends of the measurement scale. This illustrates the point that sample size is closely related to the inherent variability in the data. The number of samples required increases with increasing variability. Also, the more samples you have, the greater the confidence level you can achieve. For example, sampling at an 85 percent confidence level is less intensive than sampling at a 95 percent confidence level. -->
<!-- If you have prior knowledge about the soil attribute being sampled, you can use a t-test to estimate the number (n) of samples needed to detect a significant difference. You can use either the `power.t.test()` or `power.prop.tes()` functions. See the following example of differences in clay content. -->
<!-- ```{r, eval=TRUE} -->
<!-- # Clay example. Test to see the number of samples necessary to detect a 3 percent difference in clay between two horizons. -->
<!-- power.t.test(power = 0.95, sd = 2, delta = 16 - 19) # delta = the difference between the two means -->
<!-- power.t.test(power = 0.95, sd = 3, delta = 16 - 19) -->
<!-- ``` -->
<!-- ```{r, echo=FALSE,, eval=TRUE} -->
<!-- # Generate a graphical comparison of a fictitious clay example with 2 standard deviations -->
<!-- x1 <- seq(12, 20, 0.1) -->
<!-- y1 <- dnorm(x1, mean = 16, sd = 2) -->
<!-- x2 <- seq(15, 23, 0.1) -->
<!-- y2 <- dnorm(x2, mean = 19, sd = 2) -->
<!-- summary(c(x1, x2)) -->
<!-- plot(x1, y1, type = "l", xlim = range(c(x1, x2)),  -->
<!--      main = "Overlapping Populations",  -->
<!--      xlab = "Clay %" -->
<!--      ) -->
<!-- lines(x2, y2) -->
<!-- abline(v = mean(c(x1, x2)), lty = 2) -->
<!-- ``` -->
<!-- From the figure above, you can see how difficult it is to separate two overlapping populations (e.g., horizons). Also, a 1-unit increase in the standard deviation doubles the number of samples required. This simplistic example, although enlightening, is hard to implement in practice and serves only as a theoretical exercise.  -->
</div>
<div id="rules-of-thumb" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Rules of thumb<a href="sampling.html#rules-of-thumb" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some rules of thumb for regression models are as follows:</p>
<ul>
<li>Use &gt; 10 observations (n) per predictor (m) (<span class="citation">Kutner et al. (<a href="#ref-kutner2005" role="doc-biblioref">2005</a>)</span>).</li>
<li>Use &gt; 20 n per m and n &gt; 104 + m to test regression coefficients <span class="citation">(<a href="#ref-rossiter2017" role="doc-biblioref">Rossiter 2017</a>; <a href="#ref-franklin2009" role="doc-biblioref">Franklin and Miller 2009</a>)</span>.</li>
<li>Never use n &lt; 5*m <span class="citation">(<a href="#ref-rossiter2017" role="doc-biblioref">Rossiter 2017</a>)</span>.</li>
</ul>
<!-- **Soil Survey Applications:** -->
<!-- 1. Capture range of soil-forming factors -->
<!-- 2. Determine map unit composition -->
</div>
<div id="nssh-627.8" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> NSSH 627.8<a href="sampling.html#nssh-627.8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Documentation requirement for the following data elements are specified in the section <a href="https://directives.sc.egov.usda.gov/OpenNonWebContent.aspx?content=45136.wba">627.8</a> of the National Soil Survey Handbook (NSSH).</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb361-1"><a href="sampling.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NSSH 627.8 Documentation</span></span>
<span id="cb361-2"><a href="sampling.html#cb361-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-3"><a href="sampling.html#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soil series</span></span>
<span id="cb361-4"><a href="sampling.html#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb361-5"><a href="sampling.html#cb361-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="st">&quot;soil series&quot;</span>, </span>
<span id="cb361-6"><a href="sampling.html#cb361-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n     =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb361-7"><a href="sampling.html#cb361-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">acres =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">20000</span>)</span>
<span id="cb361-8"><a href="sampling.html#cb361-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##         level  n acres
## 1 soil series  5  2000
## 2 soil series 10 20000</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb363-1"><a href="sampling.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># components</span></span>
<span id="cb363-2"><a href="sampling.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb363-3"><a href="sampling.html#cb363-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="st">&quot;components&quot;</span>,</span>
<span id="cb363-4"><a href="sampling.html#cb363-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n     =</span> <span class="dv">1</span>,</span>
<span id="cb363-5"><a href="sampling.html#cb363-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">acres =</span> <span class="dv">3000</span></span>
<span id="cb363-6"><a href="sampling.html#cb363-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##        level n acres
## 1 components 1  3000</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb365-1"><a href="sampling.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map units</span></span>
<span id="cb365-2"><a href="sampling.html#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb365-3"><a href="sampling.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="st">&quot;map unit&quot;</span>,</span>
<span id="cb365-4"><a href="sampling.html#cb365-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n     =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">30</span>, <span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">3</span>))),</span>
<span id="cb365-5"><a href="sampling.html#cb365-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">acres =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">4000</span>, <span class="at">by =</span> <span class="dv">4000</span>, <span class="at">length.out =</span> <span class="dv">3</span>))</span>
<span id="cb365-6"><a href="sampling.html#cb365-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##      level  n acres
## 1 map unit 30  2000
## 2 map unit 40  4000
## 3 map unit 50  8000
## 4 map unit 60 12000</code></pre>
</div>
</div>
<div id="sampling-strategies" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Sampling Strategies<a href="sampling.html#sampling-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb367"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb367-1"><a href="sampling.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb367-2"><a href="sampling.html#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb367-3"><a href="sampling.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="sampling.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set the seed for the random number generator</span></span>
<span id="cb367-5"><a href="sampling.html#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb367-6"><a href="sampling.html#cb367-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-7"><a href="sampling.html#cb367-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sixteen square polygon</span></span>
<span id="cb367-8"><a href="sampling.html#cb367-8" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(<span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">4</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">4</span>)), <span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb367-9"><a href="sampling.html#cb367-9" aria-hidden="true" tabindex="-1"></a>grd <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(bb)</span>
<span id="cb367-10"><a href="sampling.html#cb367-10" aria-hidden="true" tabindex="-1"></a>grd<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bb)</span></code></pre></div>
<div id="simple-random" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Simple Random<a href="sampling.html#simple-random" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In simple random sampling, all samples within the region have an equal chance of being selected. A simple random selection of points can be made using either the <code>st_sample()</code> function within the sf R package or the Create Random Points tool in ArcGIS.</p>
<p><strong>Advantages</strong></p>
<ul>
<li>Simple</li>
<li>Unbiased (equal probability of inclusion)</li>
<li>Requires little prior knowledge of the population</li>
<li>Howell et al. (2004) - produced a “much more sensitive, more accurate, and greater range of estimated values” than the models from the subjective samples</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Inefficient (requires large numbers)</li>
<li>Lower accuracy</li>
<li>Higher cost</li>
<li>Samples may not be representative of the feature attribute(s)</li>
<li>Uneven spatial distribution (e.g. clustered)</li>
</ul>
<div class="sourceCode" id="cb368"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb368-1"><a href="sampling.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate simple random sample</span></span>
<span id="cb368-2"><a href="sampling.html#cb368-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(grd, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb368-3"><a href="sampling.html#cb368-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-4"><a href="sampling.html#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb368-5"><a href="sampling.html#cb368-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grd) <span class="sc">+</span> </span>
<span id="cb368-6"><a href="sampling.html#cb368-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> test) <span class="sc">+</span> </span>
<span id="cb368-7"><a href="sampling.html#cb368-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Simple&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/simple-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="systematic" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Systematic<a href="sampling.html#systematic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In systematic sampling, a sample is taken according to a regularized pattern. This approach ensures even spatial coverage. Patterns may be rectilinear, triangular, or hexagonal. This sampling strategy can be inaccurate if the variation in the population doesn’t coincide with the regular pattern (e.g., if the population exhibits periodicity).</p>
<p><strong>Advantages</strong></p>
<ul>
<li>Simple</li>
<li>Precise estimates</li>
<li>Even spatial coverage</li>
<li>Greater efficiency</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Biased estimates (particularly sampling variance)</li>
<li>May miss individuals that don’t coincide with the sampling interval</li>
<li>If so, the density needs to be increased</li>
<li>Limited utility for areas larger than a single field</li>
<li>Grid may not optimally fit irregular shapes</li>
</ul>
<div class="sourceCode" id="cb369"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb369-1"><a href="sampling.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate systematic random sample</span></span>
<span id="cb369-2"><a href="sampling.html#cb369-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(grd, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>)</span>
<span id="cb369-3"><a href="sampling.html#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="sampling.html#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb369-5"><a href="sampling.html#cb369-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grd) <span class="sc">+</span> </span>
<span id="cb369-6"><a href="sampling.html#cb369-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> test) <span class="sc">+</span> </span>
<span id="cb369-7"><a href="sampling.html#cb369-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Systematic&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/systematic-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="spatial-coverage-sampling" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Spatial Coverage Sampling<a href="sampling.html#spatial-coverage-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb370"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb370-1"><a href="sampling.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spcosa ----</span></span>
<span id="cb370-2"><a href="sampling.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spcosa)</span>
<span id="cb370-3"><a href="sampling.html#cb370-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-4"><a href="sampling.html#cb370-4" aria-hidden="true" tabindex="-1"></a>grd2 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(grd, <span class="cn">NA</span>)</span>
<span id="cb370-5"><a href="sampling.html#cb370-5" aria-hidden="true" tabindex="-1"></a>grd_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(grd, <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb370-6"><a href="sampling.html#cb370-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-7"><a href="sampling.html#cb370-7" aria-hidden="true" tabindex="-1"></a>strata <span class="ot">&lt;-</span> <span class="fu">stratify</span>(grd_sp, <span class="at">nStrata =</span> <span class="dv">16</span>) </span>
<span id="cb370-8"><a href="sampling.html#cb370-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-9"><a href="sampling.html#cb370-9" aria-hidden="true" tabindex="-1"></a>pts    <span class="ot">&lt;-</span> <span class="fu">spsample</span>(strata)</span>
<span id="cb370-10"><a href="sampling.html#cb370-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(strata, pts) <span class="sc">+</span> </span>
<span id="cb370-11"><a href="sampling.html#cb370-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Spatial Coverage&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/spcosa-1.png" width="384" style="display: block; margin: auto;" /></p>
<!-- ### Cluster -->
<!-- In cluster sampling, a cluster or group of points is selected at one or more sites. The transect is an example of this strategy, although other shapes are possible (e.g., square, triangle, or cross shapes). It is common to orient the transect in the direction of greatest variability. -->
<!-- **Advantages** -->
<!--  - Greater efficiency -->
<!--  - Lower cost    -->
<!-- **Disadvantages** -->
<!--  - Lower precision   -->
<!-- ```{r clustered, fig.width=4, fig.height=4, eval=TRUE}  -->
<!-- plot(polys, main = "Clustered (n = 3) random sample") -->
<!-- # Generate cluster random sample -->
<!-- test <- spsample(polys, nclusters = 3, type = "clustered") -->
<!-- points(test, pch = 19) -->
<!-- ``` -->
</div>
<div id="stratified-random" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Stratified Random<a href="sampling.html#stratified-random" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In stratified random sampling, the sampling region is spatially subset into different strata, and random sampling is applied to each strata. If prior information is available about the study area, it can be used to develop the strata. Strata may be sampled equally or in proportion to area; however, if the target of interest is rare in the population, it may be preferable to sample the strata equally <span class="citation">Franklin and Miller (<a href="#ref-franklin2009" role="doc-biblioref">2009</a>)</span>].</p>
<p><strong>Advantages</strong></p>
<ul>
<li>More efficient than simple-random</li>
<li>Higher accuracy</li>
<li>Lower cost</li>
<li>Sampling can be sized relative to proportion or variance</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Require pre-existing knowledge of the population (which may be flawed)</li>
<li>If sampling is uneven, weights need to be known</li>
<li>May need to construct the strata manually</li>
</ul>
<div class="sourceCode" id="cb371"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb371-1"><a href="sampling.html#cb371-1" aria-hidden="true" tabindex="-1"></a>grd2 <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(grd, <span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb371-2"><a href="sampling.html#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(grd2) <span class="ot">&lt;-</span> <span class="dv">5070</span></span>
<span id="cb371-3"><a href="sampling.html#cb371-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-4"><a href="sampling.html#cb371-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(grd2, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>, <span class="at">by_polygon =</span> <span class="cn">TRUE</span>)</span>
<span id="cb371-5"><a href="sampling.html#cb371-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-6"><a href="sampling.html#cb371-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb371-7"><a href="sampling.html#cb371-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grd) <span class="sc">+</span> </span>
<span id="cb371-8"><a href="sampling.html#cb371-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> test) <span class="sc">+</span> </span>
<span id="cb371-9"><a href="sampling.html#cb371-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Stratified&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/stratified-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note that the <code>spsample()</code> function only stratifies the points spatially. Other more sophisticated designs can be implemented using the <a href="https://cran.r-project.org/package=spsurvey">spsurvey</a>, <a href="http://ncss-tech.github.io/sharpshootR/docs/reference/constantDensitySampling.html">sharpshootR</a>, or <a href="https://cran.r-project.org/package=clhs">clhs</a> packages.</p>
</div>
<div id="multistage-stratified-random" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Multistage Stratified Random<a href="sampling.html#multistage-stratified-random" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In multistage random sampling, the region is separated into different subsets that are randomly selected (i.e., first stage), and then the selected subsets are randomly sampled (i.e., second stage). This is similar to stratified random sampling, except that with stratified random sampling each strata is sampled.</p>
<p><strong>Advantages</strong></p>
<ul>
<li>Most efficient</li>
<li>Lower cost</li>
<li>Sampling can be sized relative to proportion or variance</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Less precise</li>
<li>Uneven spatial distribution (e.g. clustered)</li>
<li>Require pre-existing knowledge of the population (which may be flawed)</li>
<li>If sampling is uneven, weights need to be known</li>
<li>May need to construct the strata manually</li>
</ul>
<div class="sourceCode" id="cb372"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb372-1"><a href="sampling.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select 8 samples from each square</span></span>
<span id="cb372-2"><a href="sampling.html#cb372-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grd), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb372-3"><a href="sampling.html#cb372-3" aria-hidden="true" tabindex="-1"></a>grd_sub <span class="ot">&lt;-</span> grd[idx, ]</span>
<span id="cb372-4"><a href="sampling.html#cb372-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="cf">function</span>(i) {</span>
<span id="cb372-5"><a href="sampling.html#cb372-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_coordinates</span>(<span class="fu">st_sample</span>(grd_sub[i, ], <span class="at">size =</span> <span class="dv">8</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>))</span>
<span id="cb372-6"><a href="sampling.html#cb372-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb372-7"><a href="sampling.html#cb372-7" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.data.frame</span>(test), <span class="at">coords =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb372-8"><a href="sampling.html#cb372-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-9"><a href="sampling.html#cb372-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb372-10"><a href="sampling.html#cb372-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grd) <span class="sc">+</span> </span>
<span id="cb372-11"><a href="sampling.html#cb372-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> test) <span class="sc">+</span> </span>
<span id="cb372-12"><a href="sampling.html#cb372-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Two-stage&quot;</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/two_stage-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="conditioned-latin-hypercube-clhs" class="section level3 hasAnchor" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Conditioned Latin Hypercube (cLHS)<a href="sampling.html#conditioned-latin-hypercube-clhs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditioned Latin hypercube sampling is a stratified random sampling technique to obtain representative samples from feature (attribute) space <span class="citation">(<a href="#ref-minasny2006" role="doc-biblioref">Minasny and McBratney 2006</a>)</span>.</p>
<p><strong>Advantages</strong></p>
<ul>
<li>Maximumly stratifies the predictors</li>
<li>Automated sample selection</li>
<li>Incorporates cost constraints</li>
<li>Can incorporate legacy points</li>
<li>Easily scales to multiple GIS layers</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Not ideal for map validation (non – probability sample)</li>
<li>Not ideal for developing map unit concepts (puts points in weird landscape positions)</li>
<li>Difficult to find alternatives for non-accessible points</li>
<li>Inefficient with large GIS layers</li>
</ul>
<p>For example, assume you have prior knowledge of a study area and have the time and resources to collect 120 points. You also know the following variables (strata), which are represented as coregistered raster datasets, to be of importance to the soil property or class being investigated:</p>
<ul>
<li>Normalized Difference Vegetation Index (NDVI),<br />
</li>
<li>Topographic Wetness Index (a.k.a. Wetness Index, compound topographic index),<br />
</li>
<li>Solar insolation (potential incoming solar radiation), and</li>
<li>Relative elevation (a.k.a. relative position, normalized slope height).</li>
</ul>
<p>The cLHS procedure iteratively selects samples from the strata variables such that they replicate the range of values from each stratum. Without a technique such as cLHS, obtaining a sample that is representative of the feature space becomes increasingly difficult as the number of variables (strata) increases.</p>
<p>To perform cLHS using R, you can use the clhs package <span class="citation">(<a href="#ref-roudier2011" role="doc-biblioref">Roudier 2011</a>)</span>.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb373-1"><a href="sampling.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clhs)</span>
<span id="cb373-2"><a href="sampling.html#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb373-3"><a href="sampling.html#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="sampling.html#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import volcano DEM, details at http://geomorphometry.org/content/volcano-maungawhau</span></span>
<span id="cb373-5"><a href="sampling.html#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(volcano)</span>
<span id="cb373-6"><a href="sampling.html#cb373-6" aria-hidden="true" tabindex="-1"></a>volcano_r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">as.matrix</span>(volcano[<span class="dv">87</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">61</span><span class="sc">:</span><span class="dv">1</span>]), </span>
<span id="cb373-7"><a href="sampling.html#cb373-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:27200&quot;</span>), </span>
<span id="cb373-8"><a href="sampling.html#cb373-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmn =</span> <span class="dv">2667405</span>, <span class="at">xmx =</span> <span class="dv">2667405</span> <span class="sc">+</span> <span class="dv">61</span> <span class="sc">*</span> <span class="dv">10</span>, </span>
<span id="cb373-9"><a href="sampling.html#cb373-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymn =</span> <span class="dv">6478705</span>, <span class="at">ymx =</span> <span class="dv">6478705</span> <span class="sc">+</span> <span class="dv">87</span> <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb373-10"><a href="sampling.html#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(volcano_r) <span class="ot">&lt;-</span> <span class="st">&quot;elev&quot;</span></span>
<span id="cb373-11"><a href="sampling.html#cb373-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-12"><a href="sampling.html#cb373-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate slope from the DEM</span></span>
<span id="cb373-13"><a href="sampling.html#cb373-13" aria-hidden="true" tabindex="-1"></a>slope_r <span class="ot">&lt;-</span> <span class="fu">terrain</span>(volcano_r, <span class="at">opt =</span> <span class="st">&quot;slope&quot;</span>, <span class="at">unit =</span> <span class="st">&quot;degrees&quot;</span>)</span>
<span id="cb373-14"><a href="sampling.html#cb373-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-15"><a href="sampling.html#cb373-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack Elevation and Slope</span></span>
<span id="cb373-16"><a href="sampling.html#cb373-16" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">stack</span>(volcano_r, slope_r)</span>
<span id="cb373-17"><a href="sampling.html#cb373-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-18"><a href="sampling.html#cb373-18" aria-hidden="true" tabindex="-1"></a><span class="co"># generate cLHS design</span></span>
<span id="cb373-19"><a href="sampling.html#cb373-19" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">clhs</span>(rs, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>, <span class="at">simple =</span> <span class="cn">FALSE</span>)</span>
<span id="cb373-20"><a href="sampling.html#cb373-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-21"><a href="sampling.html#cb373-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cLHS Samples</span></span>
<span id="cb373-22"><a href="sampling.html#cb373-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb373-23"><a href="sampling.html#cb373-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(volcano_r, <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb373-24"><a href="sampling.html#cb373-24" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(cs<span class="sc">$</span>sampled_data)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/clhs-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb374-1"><a href="sampling.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of clhs object</span></span>
<span id="cb374-2"><a href="sampling.html#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cs<span class="sc">$</span>sampled_data)<span class="sc">$</span>data</span></code></pre></div>
<pre><code>##       elev           slope       
##  Min.   : 96.0   Min.   : 0.000  
##  1st Qu.:109.5   1st Qu.: 7.023  
##  Median :126.0   Median :13.832  
##  Mean   :130.8   Mean   :14.718  
##  3rd Qu.:146.8   3rd Qu.:21.348  
##  Max.   :181.0   Max.   :37.351  
##                  NA&#39;s   :1</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb376-1"><a href="sampling.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of raster objects</span></span>
<span id="cb376-2"><a href="sampling.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">summary</span>(volcano_r), <span class="fu">summary</span>(slope_r))</span></code></pre></div>
<pre><code>##         elev      slope
## Min.      94   0.000000
## 1st Qu.  108   7.054131
## Median   124  14.103463
## 3rd Qu.  150  21.665758
## Max.     195  43.032469
## NA&#39;s       0 292.000000</code></pre>
<p>Although the above example works well on our small volcano dataset, the clhs package is inefficient if you are working with large raster datasets. To overcome this limitation, you can first take a large random sample and then subsample it using cLHS.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb378-1"><a href="sampling.html#cb378-1" aria-hidden="true" tabindex="-1"></a>sub_s <span class="ot">&lt;-</span> <span class="fu">sampleRandom</span>(volcano_r, <span class="at">size =</span> <span class="dv">200</span>, <span class="at">sp =</span> <span class="cn">TRUE</span>) <span class="co"># random sample function from the raster package</span></span>
<span id="cb378-2"><a href="sampling.html#cb378-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-3"><a href="sampling.html#cb378-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">clhs</span>(sub_s, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>, <span class="at">simple =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="evaluating-a-sampling-strategy" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Evaluating a Sampling Strategy<a href="sampling.html#evaluating-a-sampling-strategy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To gauge the representativeness of a sampling strategy, you can compare the results it produces to the results for other variables you think might coincide with the soil properties or classes of interest <span class="citation">(<a href="#ref-hengl2009" role="doc-biblioref">Hengl 2009</a>)</span>. Examples include slope gradient, slope aspect, and vegetative cover. These other variables may be used to stratify the sampling design or to assess the representativeness of our existing samples (e.g., NASIS pedons).</p>
<p>The simple example below demonstrates how to compare several sampling strategies by evaluating how well they replicate the distribution of elevation.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb379-1"><a href="sampling.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb379-2"><a href="sampling.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb379-3"><a href="sampling.html#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="sampling.html#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a polygon from the spatial extent of the volcano dataset</span></span>
<span id="cb379-5"><a href="sampling.html#cb379-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(<span class="fu">extent</span>(volcano_r), <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb379-6"><a href="sampling.html#cb379-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-7"><a href="sampling.html#cb379-7" aria-hidden="true" tabindex="-1"></a><span class="co"># take a large random sample</span></span>
<span id="cb379-8"><a href="sampling.html#cb379-8" aria-hidden="true" tabindex="-1"></a>sr400 <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(test, <span class="at">size =</span> <span class="dv">400</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb379-9"><a href="sampling.html#cb379-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-10"><a href="sampling.html#cb379-10" aria-hidden="true" tabindex="-1"></a><span class="co"># take a small random sample</span></span>
<span id="cb379-11"><a href="sampling.html#cb379-11" aria-hidden="true" tabindex="-1"></a>sr  <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(test, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb379-12"><a href="sampling.html#cb379-12" aria-hidden="true" tabindex="-1"></a>sr2 <span class="ot">&lt;-</span> <span class="fu">sampleRandom</span>(volcano_r, <span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb379-13"><a href="sampling.html#cb379-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-14"><a href="sampling.html#cb379-14" aria-hidden="true" tabindex="-1"></a><span class="co"># take a small systematic random sample</span></span>
<span id="cb379-15"><a href="sampling.html#cb379-15" aria-hidden="true" tabindex="-1"></a>sys  <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(test, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>)</span>
<span id="cb379-16"><a href="sampling.html#cb379-16" aria-hidden="true" tabindex="-1"></a>sys2 <span class="ot">&lt;-</span> <span class="fu">sampleRegular</span>(volcano_r, <span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb379-17"><a href="sampling.html#cb379-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-18"><a href="sampling.html#cb379-18" aria-hidden="true" tabindex="-1"></a><span class="co"># take a cLHS sample</span></span>
<span id="cb379-19"><a href="sampling.html#cb379-19" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">clhs</span>(rs, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>, <span class="at">simple =</span> <span class="cn">FALSE</span>)</span>
<span id="cb379-20"><a href="sampling.html#cb379-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-21"><a href="sampling.html#cb379-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Combind and Extract Samples</span></span>
<span id="cb379-22"><a href="sampling.html#cb379-22" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">method =</span> <span class="st">&quot;Simple Random 400&quot;</span>, </span>
<span id="cb379-23"><a href="sampling.html#cb379-23" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">extract</span>(rs, <span class="fu">st_coordinates</span>(sr400))</span>
<span id="cb379-24"><a href="sampling.html#cb379-24" aria-hidden="true" tabindex="-1"></a>                      ),</span>
<span id="cb379-25"><a href="sampling.html#cb379-25" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>(<span class="at">method =</span> <span class="st">&quot;Simple Random&quot;</span>, </span>
<span id="cb379-26"><a href="sampling.html#cb379-26" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">extract</span>(rs, <span class="fu">st_coordinates</span>(sr))</span>
<span id="cb379-27"><a href="sampling.html#cb379-27" aria-hidden="true" tabindex="-1"></a>                      ),</span>
<span id="cb379-28"><a href="sampling.html#cb379-28" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>(<span class="at">method =</span> <span class="st">&quot;Systematic Random&quot;</span>, </span>
<span id="cb379-29"><a href="sampling.html#cb379-29" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">extract</span>(rs, <span class="fu">st_coordinates</span>(sys))</span>
<span id="cb379-30"><a href="sampling.html#cb379-30" aria-hidden="true" tabindex="-1"></a>                      ),</span>
<span id="cb379-31"><a href="sampling.html#cb379-31" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>(<span class="at">method =</span> <span class="st">&quot;cLHS&quot;</span>, </span>
<span id="cb379-32"><a href="sampling.html#cb379-32" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">slot</span>(cs<span class="sc">$</span>sampled_data, <span class="st">&#39;data&#39;</span>)</span>
<span id="cb379-33"><a href="sampling.html#cb379-33" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb379-34"><a href="sampling.html#cb379-34" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb379-35"><a href="sampling.html#cb379-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-36"><a href="sampling.html#cb379-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the sample values</span></span>
<span id="cb379-37"><a href="sampling.html#cb379-37" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(slope <span class="sc">~</span> method, <span class="at">data =</span> s, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">summary</span>(x)))</span></code></pre></div>
<pre><code>##              method slope.Min. slope.1st Qu. slope.Median slope.Mean slope.3rd Qu. slope.Max.
## 1              cLHS          1             8           14         15            21         39
## 2     Simple Random          0             7           17         15            23         28
## 3 Simple Random 400          0             6           14         15            21         37
## 4 Systematic Random          0             4           12         13            18         30</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb381-1"><a href="sampling.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot overlapping density plots to compare the distributions between the large and small samples</span></span>
<span id="cb381-2"><a href="sampling.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(s, <span class="fu">aes</span>(<span class="at">x =</span> slope, <span class="at">col =</span> method)) <span class="sc">+</span> </span>
<span id="cb381-3"><a href="sampling.html#cb381-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_density</span>(<span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/seval-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r codeBlocks"><code class="sourceCode r"><span id="cb382-1"><a href="sampling.html#cb382-1" aria-hidden="true" tabindex="-1"></a>volcano_r2 <span class="ot">&lt;-</span> <span class="fu">as</span>(volcano_r, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)</span>
<span id="cb382-2"><a href="sampling.html#cb382-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-3"><a href="sampling.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the spatial locations            </span></span>
<span id="cb382-4"><a href="sampling.html#cb382-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb382-5"><a href="sampling.html#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(volcano_r, <span class="at">main =</span> <span class="st">&quot;Simple random&quot;</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb382-6"><a href="sampling.html#cb382-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(sr), <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb382-7"><a href="sampling.html#cb382-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-8"><a href="sampling.html#cb382-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(volcano_r, <span class="at">main =</span> <span class="st">&quot;Systematic random&quot;</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb382-9"><a href="sampling.html#cb382-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">st_coordinates</span>(sys), <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb382-10"><a href="sampling.html#cb382-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-11"><a href="sampling.html#cb382-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(volcano_r, <span class="at">main =</span> <span class="st">&quot;cLHS&quot;</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb382-12"><a href="sampling.html#cb382-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(cs<span class="sc">$</span>sampled_data, <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="s4ssbook_files/figure-html/unnamed-chunk-190-1.png" width="792" style="display: block; margin: auto;" /></p>
<p>The overlapping density plots above illustrate the differences between large and small sets of samples using several sampling designs.</p>
<p>The cLHS approach best duplicates the distribution of elevation (because elevation is explicitly used in the stratification process). The contrast is less severe in the summary metrics, but again cLHS more closely resembles the larger sample. Other comparisons are possible using the approaches in the following chapters.</p>
<div id="exercise-design-a-sampling-strategy" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Exercise: Design a Sampling Strategy<a href="sampling.html#exercise-design-a-sampling-strategy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Load the “tahoe_lidar_highesthit.tif” dataset in the <code>gdalUtilities</code> package (i.e. <code>tahoe &lt;- raster::raster(system.file("extdata/tahoe.tif", package = "gdalUtilities"))</code>) or use your own data set.</li>
<li>Compare two or more sampling approaches and evaluate how representative they are.</li>
<li>Show your work and submit the results to your mentor.</li>
</ol>
<!-- ## Other Tools for Selecting Random Features   -->
<!-- An ArcGIS tool for selecting random features is available from the [Job Aids page](http://www.nrcs.usda.gov/wps/PA_NRCSConsumption/download?cid=stelprdb1258054&ext=pdf). This tool randomly selects the specified number of features from a dataset or set of selected features in ArcGIS. It is an ideal tool for the first stage of a two-stage random sample.   -->
<!-- ### cLHS Using TEUI   -->
<!-- The TEUI toolkit includes a tool for generating cLHS samples on large raster datasets. The tool is based on the clhs R package [@roudier2011]. -->
<!--  - Relative Elevation (a.k.a. relative position)   -->
<!--  - Northwestness   -->
<!--  - Normalized Difference Vegetation Difference (a.k.a. NDVI)   -->
<!-- ![R GUI image](static-figures/ch3_fig17.jpg) -->
<!-- Open ArcGIS. Add the TEUI Toolkit Toolbar by clicking the **Customize** tab, pointing to **Toolbars**, and checking **TEUI**.   -->
<!-- ![R GUI image](static-figures/ch3_fig18.jpg)   -->
<!-- The TEUI Toolbar looks like the following.   -->
<!-- ![R GUI image](static-figures/ch3_fig19.jpg)   -->
<!-- Click the **Cube icon** to open the Latin Hyper Cube Generator Tool. -->
<!-- ![R GUI image](static-figures/ch3_fig20.jpg)   -->
<!-- ![R GUI image](static-figures/ch3_fig21.jpg)   -->
<!-- The Tool requires that all raster data be in Imagine format (i.e., have the "img" extension) and share a common projection and resolution.  -->
<!-- The tool adds all raster layers in the Table of Contents to the Layers section. The layers to be used are checked.   -->
<!-- An exclusion layer is used in this example. An exclusion layer is a binary raster with values of 0 and 1. Using an exclusion layer confines the selection of points to those areas with a raster value of 1.   -->
<!-- The output file is a shapefile named "samples.shp." The Number of Points is 30. The Number of Iterations is increased from the default of 100 to 300. Increasing the number of iterations increases the processing time, but it also increases the likelihood that the samples selected are representative of the selected strata.   -->
<!-- Click **Generate** and let the routine process. This can take from several minutes to several hours, depending on how large the area is in terms of columns and rows and how many layers are used.   -->
<!-- The resulting output shows 30 points confined to the watershed of interest.   -->
<!-- ![R GUI image](static-figures/ch3_fig22.jpg)   -->
<!-- Comparing the frequency distribution of the samples to the population shows a reasonable representation, especially considering the small sample size.   -->
<!-- ![R GUI image](static-figures/ch3_fig23.jpg)  -->
<!-- ### Two-Stage Stratified Random Sample Design Using ArcGIS -->
<!-- The following example examines a sampling design executed by Wendy Noll, USDA-NRCS, Morgantown, WV and used by NRCS and USFS investigators in the Monongahela National Forest. They were interested in quantifying the depth of organic surface horizons in soils that correlated to the Mandy soil series and formed under red spruce canopy on backslopes in the Upper Greenbrier Watershed (HUC 8 -05050003). This project ultimately led to the development of new soil series and the update of thousands of acres of forest soils in West Virginia.  -->
<!-- Stage 1: Sub-watersheds in the study area were randomly selected.  -->
<!-- ![R GUI image](static-figures/ch3_fig7.jpg)   -->
<!-- Strata: Sampling was based on three stratum.   -->
<!--  - Mandy soil map units (MfE, MfF, MfG, and other) -->
<!--  - Red spruce canopy cover (>30% canopy, other) -->
<!--  - Slope (<= 35%, >= 35%)   -->
<!-- Data layers: Input layers included coregistered raster data of each stratum, reclassed as follows.   -->
<!-- ![R GUI image](static-figures/ch3_fig8.jpg)   -->
<!-- The Raster Calculator was used to add data layers together.   -->
<!-- ![R GUI image](static-figures/ch3_fig9.jpg)   -->
<!-- The resulting raster file had the following combinations.   -->
<!-- ![R GUI image](static-figures/ch3_fig10.jpg)   -->
<!-- The following guide was used to verify the selection of sample numbers allocated according to the proportionate extent of the strata.   -->
<!-- ![R GUI image](static-figures/ch3_fig11.jpg)   -->
<!-- The Create Random Points tool was used within each sub-watershed. The tool is in **Data Management Tools** > **Feature Class toolbox**.   -->
<!-- ![R GUI image](static-figures/ch3_fig12.jpg)   -->
<!-- The sub-watershed layer was specified as the Constraining Feature Class. The number of points selected was 50.   -->
<!-- ![R GUI image](static-figures/ch3_fig13.jpg)   -->
<!-- The resulting point file had 50 points per polygon.   -->
<!-- ![R GUI image](static-figures/ch3_fig14.jpg)   -->
<!-- The following image was used to check if the sample points adequately represented the proportionate extent of the data made by summarizing the GRIDCODE of the points.   -->
<!-- ![R GUI image](static-figures/ch3_fig15.jpg)   -->
<!-- The results compared well to the extent of the population.   -->
<!-- ![R GUI image](static-figures/ch3_fig16.jpg) -->
<!-- Vaughan, R., and K. Megown. 2015. The Terrestrial Ecological Unit Inventory (TEUI) Geospatial Toolkit: User guide v5.2. RSAC-10117-MAN1. Salt Lake City, UT: U.S. Department of Agriculture, Forest Service, Remote Sensing Applications Center. [http://www.fs.fed.us/eng/rsac/programs/teui/about.html](http://www.fs.fed.us/eng/rsac/programs/teui/about.html). -->
</div>
</div>
<div id="additional-reading-sampling" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Additional Reading (Sampling)<a href="sampling.html#additional-reading-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Brungard, C., &amp; Johanson, J. (2015). The gate’s locked! I can’t get to the exact sampling spot … can I sample nearby? Pedometron(37), 8-9. <a href="http://www.pedometrics.org/Pedometron/Pedometron37.pdf">http://www.pedometrics.org/Pedometron/Pedometron37.pdf</a></p>
<p>Brus, D.J. and J.J. de Gruijter. “Random sampling or geostatistical modelling? Choosing between design-based and model-based sampling strategies for soil (with discussion).” Geoderma. Vol. 80. 1. Elsevier, 1997. 1-44. <a href="https://www.sciencedirect.com/science/article/pii/S0016706197000724">https://www.sciencedirect.com/science/article/pii/S0016706197000724</a></p>
<p>Brus, Dick J. Spatial Sampling with R. First edition, CRC Press, 2022, <a href="https://github.com/DickBrus/SpatialSamplingwithR">https://github.com/DickBrus/SpatialSamplingwithR</a>.</p>
<p>de Gruijter, J., D.J. Brus, M.F.P. Bierkens, and M. Knotters. 2006. Sampling for natural resource monitoring: Springer. <a href="http://www.springer.com/us/book/9783540224860">http://www.springer.com/us/book/9783540224860</a>.</p>
<p>Viscarra Rossel, R.A., et al. “Baseline estimates of soil organic carbon by proximal sensing: Comparing design-based, model-assisted and model-based inference.” Geoderma 265 (2016): 152-163. <a href="https://www.sciencedirect.com/science/article/pii/S0016706115301312">https://www.sciencedirect.com/science/article/pii/S0016706115301312</a></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-champely2020" class="csl-entry">
Champely, Stephane. 2020. <span>“Pwr: <span>Basic</span> <span>Functions</span> for <span>Power</span> <span>Analysis</span>.”</span> <a href="https://CRAN.R-project.org/package=pwr">https://CRAN.R-project.org/package=pwr</a>.
</div>
<div id="ref-congalton2019" class="csl-entry">
Congalton, Russell G., and Kass Green. 2019. <span>“Thematic <span>Map</span> <span>Accuracy</span> <span>Assessment</span> <span>Considerations</span>.”</span> In <em>Assessing the <span>Accuracy</span> of <span>Remotely</span> <span>Sensed</span> <span>Data</span></em>, 3rd ed., 77–106. CRC Press. <a href="https://doi.org/10.1201/9780429052729-6">https://doi.org/10.1201/9780429052729-6</a>.
</div>
<div id="ref-franklin2009" class="csl-entry">
Franklin, Janet, and Jennifer A Miller. 2009. <em>Mapping <span>Species</span> <span>Distributions</span>: <span>Spatial</span> <span>Inference</span> and <span>Prediction</span></em>. Cambridge; New York: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511810602">https://doi.org/10.1017/CBO9780511810602</a>.
</div>
<div id="ref-gelman2020" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <span>“16 - <span>Design</span> and Sample Size Decisions.”</span> In <em>Regression and <span>Other</span> <span>Stories</span></em>, 1st ed., 291–312. Cambridge University Press. <a href="https://doi.org/10.1017/9781139161879">https://doi.org/10.1017/9781139161879</a>.
</div>
<div id="ref-hengl2009" class="csl-entry">
Hengl, Tomislav. 2009. <em>A Practical Guide to Geostatistical Mapping</em>. 2nd extended ed. Amsterdam: Hengl. <a href="http://spatial-analyst.net/book/">http://spatial-analyst.net/book/</a>.
</div>
<div id="ref-kutner2005" class="csl-entry">
Kutner, Michael H., Christopher J. Nachtsheism, John Neter, and William Li. 2005. <em>Applied <span>Linear</span> <span>Statistical</span> <span>Models</span></em>. 5th ed. The <span>McGraw</span>-<span>Hill</span>/<span>Irwin</span> Series Operations and Decision Sciences. Boston: McGraw-Hill Irwin.
</div>
<div id="ref-minasny2006" class="csl-entry">
Minasny, Budiman, and Alex B. McBratney. 2006. <span>“A Conditioned <span>Latin</span> Hypercube Method for Sampling in the Presence of Ancillary Information.”</span> <em>Computers &amp; Geosciences</em> 32 (9): 1378–88. <a href="https://doi.org/10.1016/j.cageo.2005.12.009">https://doi.org/10.1016/j.cageo.2005.12.009</a>.
</div>
<div id="ref-rossiter2017" class="csl-entry">
Rossiter, D. G. 2017. <span>“Sampling for Natural Resources and Environmental Modelling and Monitoring.”</span> Enschede, Netherlands: University of Twente. <a href="http://www.css.cornell.edu/faculty/dgr2/teach/index.html">http://www.css.cornell.edu/faculty/dgr2/teach/index.html</a>.
</div>
<div id="ref-roudier2011" class="csl-entry">
Roudier, Pierre. 2011. <em>Clhs: A r Package for Conditioned Latin Hypercube Sampling.</em> <a href="https://cran.r-project.org/web/packages/clhs/">https://cran.r-project.org/web/packages/clhs/</a>.
</div>
<div id="ref-valliant2022" class="csl-entry">
Valliant, Richard, and Jill A. Dever. 2022. <span>“<span>PracTools</span>: <span>Tools</span> for <span>Designing</span> and <span>Weighting</span> <span>Survey</span> <span>Samples</span>.”</span> <a href="https://CRAN.R-project.org/package=PracTools">https://CRAN.R-project.org/package=PracTools</a>.
</div>
<div id="ref-zhang2021" class="csl-entry">
Zhang, Zhiyong, and Yujiao Mai. 2021. <span>“<span>WebPower</span>: <span>Basic</span> and <span>Advanced</span> <span>Statistical</span> <span>Power</span> <span>Analysis</span>.”</span> <a href="https://CRAN.R-project.org/package=WebPower">https://CRAN.R-project.org/package=WebPower</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["s4ssbook.pdf", "s4ssbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
